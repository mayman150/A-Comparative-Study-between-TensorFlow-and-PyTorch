Issue Title,Issue Body,Is Bug
TF 2.0: tf.stack can cause a segmentation fault TF 2.0,"**System information**
- Have I written custom code: yes
- OS Platform and Distribution: Linux Ubuntu 18.04
- Mobile device: N/A
- TensorFlow installed from: binary
- TensorFlow version: 2.0.0-alpha0, 2.0.0-dev20190319
- Python version: 3.6.7
- Bazel version: N/A
- GCC/Compiler version: N/A
- CUDA/cuDNN version: 10.1 / 7.4.2
- GPU model and memory: GeForce GTX 1080 Ti (11 GB)

**Describe the current behavior**
The Python interpreter crashes with SIGSEGV (Segmentation Fault); according to gdb the fault occurs in ```EagerTensor_CheckExact(_object const*) ()```.

**Describe the expected behavior**
No segmentation fault.
Ideally a stacked tensor returned (I was adapting code I developed interactively in eager execution mode, where it worked, in a Jupyter notebook for addition to a Keras based model), or an error that the argument cannot be a tensor (this is the TF1 behavior):
```
TypeError: Expected list for 'values' argument to 'pack' Op, not <tf.Tensor 'input_1:0' shape=(?, 128, 128, 1) dtype=float32>.
``` 

**Code to reproduce the issue**
```python
import tensorflow as tf
from tensorflow.keras.layers import Input

print(tf.__version__)

input_ = Input((128, 128, 1), dtype='float32')
print(input_)
output = tf.stack(input_, axis=1)
```",True
[2.0] tf.numpy_function logs deprecation warning type:docs-bug TF 2.0,"**System information**
- Have I written custom code: Yes
- OS Platform and Distribution: Ubuntu 16.04
- TensorFlow installed from: binary
- TensorFlow version: `2.0.0.dev20190311`
- Python version: 3.6.6
- CUDA/cuDNN version: 10.0

**Describe the current behavior**

When using `tf.numpy_function`, a warning is logged about `tf.py_func` being deprecated.

**Describe the expected behavior**

As a V2 symbol, `tf.numpy_function` should not produce a deprecation warning.

**Code to reproduce the issue**

```python
import tensorflow as tf
tf.numpy_function(lambda x: x, [tf.zeros([5])], [tf.float32])
```

```text
W0315 11:05:55.860109 139695358637824 deprecation.py:323] From /home/klein/dev/OpenNMT-tf/envv2/lib/python3.6/site-packages/tensorflow/python/ops/script_ops.py:476: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
```",True
Compilation error of TensorFlow Lite on Windows ,"<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>

**System information**
- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No
- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 64bit
- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: No
- TensorFlow installed from (source or binary): source
- TensorFlow version (use command below): I don't use python since building TensorFlow Lite
- Python version: See above
- Bazel version (if compiling from source): See above
- GCC/Compiler version (if compiling from source): gcc (Rev2, Built by MSYS2 project) 8.3.0
- CUDA/cuDNN version: No
- GPU model and memory: No

**Describe the current behavior**

Compilation error

```
tensorflow/lite/experimental/c/c_api.cc:80:29: error: function 'void TFL_InterpreterOptionsSetErrorReporter(TFL_InterpreterOptions*, void (*)(void*, const char*, va_list), void*)' definition is marked dllimport
 TFL_CAPI_EXPORT extern void TFL_InterpreterOptionsSetErrorReporter(
                             ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```

**Describe the expected behavior**

Success to compile

**Code to reproduce the issue**
Provide a reproducible test case that is the bare minimum necessary to generate the problem.

See tensorflow/lite/experimental/c/c_api.cc This is broken C syntax when TFL_CAPI_EXPORT is `__declspec(dllimport)`

This is small step to way to reproduce on Windows.

foo.cc
```
__declspec(dllimport) extern void foo() {
}
```
```
$ g++ foo.cc
foo.cc:1:35: error: function 'void foo()' definition is marked dllimport
 __declspec(dllimport) extern void foo() {
```

**Other info / logs**

See above

I created pull-request https://github.com/tensorflow/tensorflow/pull/26615
",True
"[Bug report] wrong container setting in OpsTestBase::AddResourceInput, easily fix type:bug comp:ops","File: tensorflow/core/kernels/ops_testutil.h
Class: OpsTestBase
Function: [AddResourceInput](https://github.com/wendy2003888/tensorflow/commit/18b867eabd1bb8f3540ee56a8f47f96d9f3bc20d)

resource container set to empty when using default container.

Due to CLA problem,  I can't contribute rn. 
Please review pull reques [#26428](https://github.com/tensorflow/tensorflow/pull/26428)  from ppwwyyxx. 

Thank you

<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>

**System information**
- Have I written custom code (as opposed to using a stock example script provided in TensorFlow):
- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04
- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A
- TensorFlow installed from (source or binary): binary (python3 pip)
- TensorFlow version (use command below): 1.12.0
- Python version: 3.5.2
- Bazel version (if compiling from source): 0.22.0
- GCC/Compiler version (if compiling from source):  5.4.0
- CUDA/cuDNN version: 10.0 
- GPU model and memory:


You can collect some of this information using our environment capture [script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)
You can also obtain the TensorFlow version with
python -c ""import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)""

**Describe the current behavior**

**Describe the expected behavior**

**Code to reproduce the issue**
Provide a reproducible test case that is the bare minimum necessary to generate the problem.

**Other info / logs**
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.
",True
Dataset iterator is stalled indefinitely with corrupt TFRecord despite using `ignore_errors` stat:awaiting response type:feature comp:data,"**System information**
- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No
- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04
- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: n/a
- TensorFlow installed from (source or binary): binary
- TensorFlow version (use command below): v1.12.0-0-ga6d8ffae09 1.12.0
- Python version: 3.6
- Bazel version (if compiling from source): n/a
- GCC/Compiler version (if compiling from source): n/a
- CUDA/cuDNN version: 9/7
- GPU model and memory: n/a

Creating this issue per @mrry's [suggestion](https://github.com/tensorflow/tensorflow/issues/12701#issuecomment-462799443) with minimal code to reproduce the issue.

cc @guillaumekln You're [right](https://github.com/tensorflow/tensorflow/issues/13463#issuecomment-462654013), what I'm seeing may not have to do with `OutofRangeError`, but the execution stalls indefinitely when it encounters corrupt data within a TFRecord, despite using `tf.data.experimental.ignore_errors()`.

#### Example Data (for snippets below)
- [clean.tfrecord](https://drive.google.com/uc?export=view&id=1Y2yV67jAvYhqz8OJLPV7v0BN2w1Feps9)
- [corrupt.tfrecord](https://drive.google.com/uc?export=view&id=1Fh7Vah0i_XaGqdb724NIhUIZpR_t5YiG)

#### With `clean.tfrecord`:
```python3
import tensorflow as tf

filenames = ['/data/clean.tfrecord']
#filenames = ['/data/corrupt.tfrecord']

dataset = tf.data.TFRecordDataset(filenames)
dataset = dataset.apply(tf.data.experimental.ignore_errors())
dataset = dataset.batch(64)
dataset = dataset.repeat(1)

iterator = dataset.make_one_shot_iterator()
next_element = iterator.get_next()

with tf.Session() as sess:
    i = 0
    while True:
        try:
            print(i, sess.run(next_element).shape)
            i = i + 1
        except tf.errors.OutOfRangeError:
            print(""Dataset complete"")
            break
```

#### Output:
```
0 (64,)
1 (64,)
2 (64,)
3 (64,)
4 (64,)
5 (64,)
6 (64,)
7 (64,)
8 (64,)
9 (64,)
10 (64,)
11 (64,)
12 (64,)
13 (64,)
14 (64,)
15 (64,)
16 (64,)
17 (64,)
18 (64,)
19 (35,)
Dataset complete
```

#### With `corrupt.tfrecord`:
```python3
import tensorflow as tf

#filenames = ['/data/clean.tfrecord']
filenames = ['/data/corrupt.tfrecord']

dataset = tf.data.TFRecordDataset(filenames)
dataset = dataset.apply(tf.data.experimental.ignore_errors())
dataset = dataset.batch(64)
dataset = dataset.repeat(1)

iterator = dataset.make_one_shot_iterator()
next_element = iterator.get_next()

with tf.Session() as sess:
    i = 0
    while True:
        try:
            print(i, sess.run(next_element).shape)
            i = i + 1
        except tf.errors.OutOfRangeError:
            print(""Dataset complete"")
            break
```

#### Output:
```
0 (64,)
1 (64,)
2 (64,)
3 (64,)
4 (64,)
5 (64,)
6 (64,)
7 (64,)
8 (64,)
9 (64,)
10 (64,)
11 (64,)
12 (64,)
(execution stalled indefinitely here)
```

Not sure why the corrupt files within the TFRecord aren't being ignored with `tf.data.experimental.ignore_errors()`. @mrry any idea?",True
Segfault when using VLOG with with MKL on 1.13rc1 comp:mkl,"<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>

**System information**
- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): NO
- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 16.04
- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: N/A
- TensorFlow installed from (source or binary): from source with MKL
```
bazel build --config=mkl --copt=-msse4.1 --copt=-msse4.2 --copt=-mavx2 --copt=-mavx --copt=-mfma --cxxopt=""-D_GLIBCXX_USE_CXX11_ABI=0"" --copt=""-DEIGEN_USE_VML"" //tensorflow/tools/pip_package:build_pip_package
```
- TensorFlow version (use command below): 1.13 rc1
- Python version: 3.6
- Bazel version (if compiling from source): 0.21
- GCC/Compiler version (if compiling from source): 5.3
- CUDA/cuDNN version: 10.0, 7.4.1
- GPU model and memory: Nvidia V100, 16GB


You can collect some of this information using our environment capture [script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)
You can also obtain the TensorFlow version with
python -c ""import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)""

**Describe the current behavior**
Segfault when running an estimator test

**Describe the expected behavior**
No crash

**Code to reproduce the issue**
```git clone https://github.com/tensorflow/models && cd models/samples/core/get_started && TF_CPP_MIN_VLOG_LEVEL=1 python premade_estimator.py```
https://github.com/tensorflow/models/blob/master/samples/core/get_started/premade_estimator.py

**Other info / logs**
```
#0  0x00007fff474a1e57 in tensorflow::OptimizationPassRegistry::RunGrouping(tensorflow::OptimizationPassRegistry::Grouping, tensorflow::GraphOptimizationPassOptions const&) ()
   from /home/ubuntu/anaconda3/envs/python2/lib/python2.7/site-packages/tensorflow/python/../libtensorflow_framework.so
#1  0x00007fff4bb9b6dc in tensorflow::DirectSession::CreateGraphs(tensorflow::BuildGraphOptions const&, std::unordered_map<std::string, std::unique_ptr<tensorflow::Graph, std::default_delete<tensorflow::Graph> >, std::hash<std::string>, std::equal_to<std::string>, std::allocator<std::pair<std::string const, std::unique_ptr<tensorflow::Graph, std::default_delete<tensorflow::Graph> > > > >*, std::unique_ptr<tensorflow::FunctionLibraryDefinition, std::default_delete<tensorflow::FunctionLibraryDefinition> >*, tensorflow::DirectSession::RunStateArgs*, absl::InlinedVector<tensorflow::DataType, 4ul, std::allocator<tensorflow::DataType> >*, absl::InlinedVector<tensorflow::DataType, 4ul, std::allocator<tensorflow::DataType> >*, long long*) ()
   from /home/ubuntu/anaconda3/envs/python2/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#2  0x00007fff4bb9c19c in tensorflow::DirectSession::CreateExecutors(tensorflow::CallableOptions const&, std::unique_ptr<tensorflow::DirectSession::ExecutorsAndKeys, std::default_delete<tensorflow::DirectSession::ExecutorsAndKeys> >*, std::unique_ptr<tensorflow::DirectSession::FunctionInfo, std::default_delete<tensorflow::DirectSession::FunctionInfo> >*, tensorflow::DirectSession::RunStateArgs*) () from /home/ubuntu/anaconda3/envs/python2/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#3  0x00007fff4bb9e478 in tensorflow::DirectSession::GetOrCreateExecutors(absl::Span<std::string const>, absl::Span<std::string const>, absl::Span<std::string const>, tensorflow::DirectSession::ExecutorsAndKeys**, tensorflow::DirectSession::RunStateArgs*) ()
   from /home/ubuntu/anaconda3/envs/python2/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#4  0x00007fff4bb9fad4 in tensorflow::DirectSession::Run(tensorflow::RunOptions const&, std::vector<std::pair<std::string, tensorflow::Tensor>, std::allocator<std::pair<std::string, tensorflow::Tensor> > > const&, std::vector<std::string, std::allocator<std::string> > const&, std::vector<std::string, std::allocator<std::string> > const&, std::vector<tensorflow::Tensor, std::allocator<tensorflow::Tensor> >*, tensorflow::RunMetadata*) ()
   from /home/ubuntu/anaconda3/envs/python2/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#5  0x00007fff49b36ad5 in tensorflow::SessionRef::Run(tensorflow::RunOptions const&, std::vector<std::pair<std::string, tensorflow::Tensor>, std::allocator<std::pair<std::string, tensorflow::Tensor> > > const&, std::vector<std::string, std::allocator<std::string> > const&, std::vector<std::string, std::allocator<std::string> > const&, std::vector<tensorflow::Tensor, std::allocator<tensorflow::Tensor> >*, tensorflow::RunMetadata*) ()
   from /home/ubuntu/anaconda3/envs/python2/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#6  0x00007fff49d4c1ff in TF_Run_Helper(tensorflow::Session*, char const*, TF_Buffer const*, std::vector<std::pair<std::string, tensorflow::Tensor>, std::allocator<std::pair<std::string, tensorflow::Tensor> > > const&, std::vector<std::string, std::allocator<std::string> > const&, TF_Tensor**, std::vector<std::string, std::allocator<std::string> > const&, TF_Buffer*, TF_Status*) [clone .constprop.654] () from /home/ubuntu/anaconda3/envs/python2/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#7  0x00007fff49d4ca79 in TF_SessionRun () from /home/ubuntu/anaconda3/envs/python2/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#8  0x00007fff49b31ec1 in tensorflow::TF_SessionRun_wrapper_helper(TF_Session*, char const*, TF_Buffer const*, std::vector<TF_Output, std::allocator<TF_Output> > const&, std::vector<_object*, std::allocator<_object*> > const&, std::vector<TF_Output, std::allocator<TF_Output> > const&, std::vector<TF_Operation*, std::allocator<TF_Operation*> > const&, TF_Buffer*, TF_Status*, std::vector<_object*, std::allocator<_object*> >*) ()
   from /home/ubuntu/anaconda3/envs/python2/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#9  0x00007fff49b31fa2 in tensorflow::TF_SessionRun_wrapper(TF_Session*, TF_Buffer const*, std::vector<TF_Output, std::allocator<TF_Output> > const&, std::vector<_object*, std::allocator<_object*> > const&, std::vector<TF_Output, std::allocator<TF_Output> > const&, std::vector<TF_Operation*, std::allocator<TF_Operation*> > const&, TF_Buffer*, TF_Status*, std::vector<_object*, std::allocator<_object*> >*) () from /home/ubuntu/anaconda3/envs/python2/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#10 0x00007fff49ae633c in _wrap_TF_SessionRun_wrapper () from /home/ubuntu/anaconda3/envs/python2/lib/python2.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
```",True
Can't build tensorflow master with CUDA & MPI enabled type:build/install subtype: ubuntu/linux subtype:bazel,"**System information**
- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): 16.04
- TensorFlow installed from (source or binary): source
- TensorFlow version (use command below): master
- Python version: 3.5.2
- Bazel version (if compiling from source): 0.22.0 (tried with 0.21.0, 0.20.0, 0.19.0)
- GCC/Compiler version (if compiling from source): 5.4.0
- Nvidia Driver: 410.48
- CUDA/cuDNN version: 10.0.130 / 7.4.2
- GPU model and memory: Tesla V100

I use nvidia-docker/docker to build and test the master branch of tensorflow. Since a few days, I consistently get the same error over and over.

```shell
Execution platform: @bazel_tools//platforms:host_platform
tensorflow/contrib/mpi/mpi_rendezvous_mgr.cc: In lambda function:
tensorflow/contrib/mpi/mpi_rendezvous_mgr.cc:125:49: error: no matching function for call to 'tensorflow::TensorResponse::InitPartial(const tensorflow::RecvTensorResponse&)'
           tr.InitPartial(mpi_response.response());
                                                 ^
In file included from tensorflow/contrib/mpi/mpi_rendezvous_mgr.cc:31:0:
./tensorflow/core/distributed_runtime/tensor_coding.h:79:8: note: candidate: void tensorflow::TensorResponse::InitPartial(const tensorflow::RecvTensorResponse&, const tensorflow::AllocationAttributes&)
   void InitPartial(const RecvTensorResponse& response,
        ^
./tensorflow/core/distributed_runtime/tensor_coding.h:79:8: note:   candidate expects 2 arguments, 1 provided
In file included from ./tensorflow/core/platform/default/logging.h:24:0,
                 from ./tensorflow/core/platform/logging.h:25,
                 from ./tensorflow/contrib/mpi/mpi_utils.h:25,
                 from ./tensorflow/contrib/mpi/mpi_rendezvous_mgr.h:34,
                 from tensorflow/contrib/mpi/mpi_rendezvous_mgr.cc:18:
./tensorflow/core/util/tensor_format.h: In instantiation of 'T tensorflow::GetFilterDim(tensorflow::gtl::ArraySlice<T>, tensorflow::FilterTensorFormat, char) [with T = long long int; tensorflow::gtl::ArraySlice<T> = absl::Span<const long long int>]':
./tensorflow/core/util/tensor_format.h:467:54:   required from here
./tensorflow/core/util/tensor_format.h:441:29: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]
   CHECK(index >= 0 && index < dimension_attribute.size())
                             ^
./tensorflow/core/platform/macros.h:87:47: note: in definition of macro 'TF_PREDICT_FALSE'
 #define TF_PREDICT_FALSE(x) (__builtin_expect(x, 0))
                                               ^
./tensorflow/core/util/tensor_format.h:441:3: note: in expansion of macro 'CHECK'
   CHECK(index >= 0 && index < dimension_attribute.size())
   ^
Target //tensorflow/tools/pip_package:build_pip_package failed to build
INFO: Elapsed time: 555.689s, Critical Path: 278.37s
INFO: 7384 processes: 7384 local.
FAILED: Build did NOT complete successfully
FAILED: Build did NOT complete successfully
```

I build using the following:

```dockerfile
ENV LD_LIBRARY_PATH='/usr/local/lib:/usr/lib/x86_64-linux-gnu:/usr/local/cuda/lib64/:/usr/local/cuda/extras/CUPTI/lib64' \
    BLAS_INCLUDE='/usr/local/cuda/targets/x86_64-linux/include' \
    BLAS_LIB='/usr/local/cuda/targets/x86_64-linux/lib' \
    CPLUS_INCLUDE_PATH='/usr/local/cuda/$CPLUS_INCLUDE_PATH' \
    CUDA_TOOLKIT_PATH=""/usr/local/cuda"" \
    GCC_HOST_COMPILER_PATH=""/usr/bin/gcc"" \
    TF_CUDA_CLANG=0 \
    TF_CUDA_COMPUTE_CAPABILITIES=5.2,6.0,6.1,7.0,7.5 \
    TF_CUDA_VERSION=10.0 \
    TF_CUDNN_VERSION=7 \
    TF_NCCL_VERSION=2 \
    TF_ENABLE_XLA=1 \
    TF_NEED_CUDA=1 \
    TF_NEED_JEMALLOC=1 \
    TF_NEED_HDFS=1 \
    TF_NEED_MPI=1 \
    TF_NEED_VERBS=0 \
    TF_NEED_OPENCL=0 \
    TF_NEED_GDR=0 \
    TF_NEED_GCP=0 \
    TF_NEED_S3=0 \
    TF_NEED_TENSORRT=0

# Get the TF branch for later build
RUN rm -rf /opt/tensorflow && \
    git clone --branch=$TF_BUILD_BRANCH --depth=1 $TF_REPO /opt/tensorflow && \
    cd /opt/tensorflow && \
    rm -f /usr/local/cuda/lib64/stubs/libcuda.so.1 && \
    ln -s /usr/local/cuda/lib64/stubs/libcuda.so /usr/local/cuda/lib64/stubs/libcuda.so.1 && \
    echo ""/usr/local/cuda/lib64"" > /etc/ld.so.conf.d/cuda.conf && \
    echo ""/usr/local/cuda/targets/x86_64-linux/lib/stubs"" > /etc/ld.so.conf.d/cuda-stubs.conf && \
    bazel clean && \
    ldconfig && \
    tensorflow/tools/ci_build/builds/configured GPU \
    bazel build -c opt --copt=-mavx --config=cuda --verbose_failures \
        --cxxopt=""-D_GLIBCXX_USE_CXX11_ABI=0"" \
        --action_env=LD_LIBRARY_PATH=${LD_LIBRARY_PATH} \
        tensorflow/tools/pip_package:build_pip_package && \
    mkdir /opt/tensorflow/pip_pkg && \
    bazel-bin/tensorflow/tools/pip_package/build_pip_package /opt/tensorflow/pip_pkg --gpu && \
    pip --no-cache-dir install --upgrade /opt/tensorflow/pip_pkg/tensorflow_*.whl && \
    rm -f /usr/local/cuda/lib64/stubs/libcuda.so.1 && \
    rm -rf /root/.cache && \
    rm -rf opt/tensorflow/pip_pkg
```

My script is perfectly working for the branches:  `r1.12` and `r1.13`. and fails on `master`. I guess that you have updated something, because it seems that your CI builds are still passing.",True
Bad broadcasting when multiplying sparse and dense tensors ,"**System information**
- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes
- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 10 64bit
- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: NA
- TensorFlow installed from (source or binary): Binary
- TensorFlow version (use command below): b'v1.12.0-rc2-3-ga6d8ffae09' 1.12.0
- Python version: 3.6.7 Anaconda 64bit
- Bazel version (if compiling from source): NA
- GCC/Compiler version (if compiling from source): NA
- CUDA/cuDNN version: NA
- GPU model and memory: NA

**Describe the current behavior**

When multiplying (`*` operator) a sparse tensor `S` with rank `N` with a dense tensor `D` with rank `M`, where `N > M` and `S` and `D` have different but broadcast-compatible shapes, then TensorFlow attempts to perform the multiplication producing and incorrect sparse tensor as a result with the shape of `S`.

**Describe the expected behavior**

TensorFlow should refuse to perform a sparse-dense multiplication that requires broadcasting. This is the case when both tensors have the same rank or the rank of the sparse tensor is less than the rank of the dense tensor, but not when the rank of the sparse tensor is greater.

**Code to reproduce the issue**

```py
import tensorflow as tf

with tf.Graph().as_default(), tf.Session() as sess:
    a = tf.reshape(tf.range(12), [3, 4, 1])
    b = tf.SparseTensor([[0, 0, 1, 0], [0, 0, 3, 0]], [10, 20], [1, 1, 4, 2])
    c = a * b
    print(c.shape)
    # (1, 1, 4, 2)
    print(sess.run(tf.sparse.to_dense(c)))
    # [[[[ 0  0]
    #    [10  0]
    #    [ 0  0]
    #    [60  0]]]]
```

**Other info / logs**
NA",True
tf.contrib.image.transform lead to a ValueError in new releases of tensorflow ,"<em>Please make sure that this is a bug. As per our [GitHub Policy](https://github.com/tensorflow/tensorflow/blob/master/ISSUES.md), we only address code/doc bugs, performance issues, feature requests and build/installation issues on GitHub. tag:bug_template</em>

**System information**
- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): yes
- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Manjaro 18.0
- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: -
- TensorFlow installed from (source or binary): python-tensorflow-opt-cuda from manjaro repositories 
- TensorFlow version (use command below): 1.11
- Python version: 3.6/3.7
- Bazel version (if compiling from source): -
- GCC/Compiler version (if compiling from source): -
- CUDA/cuDNN version: 10.0.130-2 /   7.3.0-1
- GPU model and memory: 1080Ti 11GB


You can collect some of this information using our environment capture [script](https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh)
You can also obtain the TensorFlow version with
python -c ""import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)""

**Describe the current behavior**

After the release that Allow a different output shape from the input in `tf.contrib.image.transform` code that applied this function stopped working with a value error. For exampleon previous versions, using eager execution this worked:

`image = tf.contrib.image.translate(image, random_translation, 'NEAREST') `

But after this change I get a `ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()`` on `tf.contrib.image.transform` on the condition of the line 273-275 of `tensorflow/tensorflow/contrib/image/python/ops/image_ops.py`, where this condition is triggered (caused by empty output shape call in tf.contrib.image.translate:

```
if output_shape is None:
      output_shape = tensor_util.constant_value(
          array_ops.shape(images)[1:3]) or array_ops.shape(images)[1:3]
```

**Describe the expected behavior**

If instead of `tf.contrib.image.transform` I run it with `output_shape` argument:

`random_transformations = tf.contrib.image.translations_to_projective_transforms(random_shifts)
images = tf.contrib.image.transform(image, random_transformations, 'NEAREST',                                       output_shape=tf.convert_to_tensor(images.numpy().shape[1:3], dtype=np.int32))`

everything goes as expected. So I guess that the issue in on passing output_shape=None in line 122-126 of `tensorflow/tensorflow/contrib/image/python/ops/image_ops.py:

```
def translate(images, translations, interpolation=""NEAREST"", name=None):
  """"""Translate image(s) by the passed vectors(s).
  Args:
    images: A tensor of shape (num_images, num_rows, num_columns, num_channels)
        (NHWC), (num_rows, num_columns, num_channels) (HWC), or
        (num_rows, num_columns) (HW). The rank must be statically known (the
        shape is not `TensorShape(None)`.
    translations: A vector representing [dx, dy] or (if images has rank 4)
        a matrix of length num_images, with a [dx, dy] vector for each image in
        the batch.
    interpolation: Interpolation mode. Supported values: ""NEAREST"", ""BILINEAR"".
    name: The name of the op.
  Returns:
    Image(s) with the same type and shape as `images`, translated by the given
        vector(s). Empty space due to the translation will be filled with zeros.
  Raises:
    TypeError: If `image` is an invalid type.
  """"""
  with ops.name_scope(name, ""translate""):
    return transform(
        images,
        translations_to_projective_transforms(translations),
        interpolation=interpolation)

```",True
Incorrect masking in keras.backend.rnn ,"**System information**
```
python -c ""import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)""
('v1.12.0-rc0-2215-g6735dd4799', '1.13.0-dev20181109')
```

**Describe the current behavior**
For correct masking of `output` it is required that `output == states[0]` for  `keras.backend.rnn(..., unroll=False)`, not so with `unroll=True` or in latest version of [keras-team/keras](https://github.com/keras-team/keras). See [this line](https://github.com/tensorflow/tensorflow/blob/d703f64e452f49603a244978b13239ab7aac0168/tensorflow/python/keras/backend.py#L3496) for the reason.

**Describe the expected behavior**
As per this [PR](https://github.com/keras-team/keras/pull/11499) (and discussions in linked issues) it has been established that output should be independent of states. That is, it should _not_ be assumed that `output == states[0]` for `ouput, states = step_function(inputs, previous_states)` in the `keras.backend.rnn` implementation. For details see test below.

**Code to reproduce the issue**
See test below (basically same as [this test added keras-team/keras](https://github.com/keras-team/keras/pull/11499/files#diff-e942014d73bf67b47a3b55f7f7041797R829))

```python
import numpy as np
from tensorflow import keras

def test_rnn_output_and_state_masking_independent():
    num_samples = 2
    num_timesteps = 4
    state_and_io_size = 5
    mask_last_num_timesteps = 2  # for second sample only

    # a step function that just outputs inputs,
    # but increments states +1 per timestep
    def step_function(inputs, states):
        return inputs, [s + 1 for s in states]

    inputs_vals = np.random.random(
        (num_samples, num_timesteps, state_and_io_size))
    initial_state_vals = np.random.random((num_samples, state_and_io_size))
    # masking of two last timesteps for second sample only
    mask_vals = np.ones((num_samples, num_timesteps))
    mask_vals[1, -mask_last_num_timesteps:] = 0

    # outputs expected to be same as inputs for the first sample
    expected_outputs = inputs_vals.copy()
    # but for the second sample all outputs in masked region should be the same
    # as last output before masked region
    expected_outputs[1, -mask_last_num_timesteps:] = \
        expected_outputs[1, -(mask_last_num_timesteps + 1)]

    expected_state = initial_state_vals.copy()
    # first state should be incremented for every timestep (no masking)
    expected_state[0] += num_timesteps
    # second state should not be incremented for last two timesteps
    expected_state[1] += (num_timesteps - mask_last_num_timesteps)

    # verify same expected output for `unroll=true/false`
    inputs = keras.backend.variable(inputs_vals)
    initial_states = [keras.backend.variable(initial_state_vals)]
    mask = keras.backend.variable(mask_vals)
    for unroll in [True, False]:
        last_output, outputs, last_states = keras.backend.rnn(
            step_function,
            inputs,
            initial_states,
            mask=mask,
            unroll=unroll,
            input_length=num_timesteps if unroll else None)

        np.testing.assert_allclose(
            keras.backend.eval(outputs), expected_outputs,
            err_msg=""Unexpected output for unroll={}"".format(unroll))
        np.testing.assert_allclose(
            keras.backend.eval(last_states[0]), expected_state,
            err_msg=""Unexpected state for unroll={}"".format(unroll))
```
Gives:
```
AssertionError: 
Not equal to tolerance rtol=1e-07, atol=0
Unexpected output for unroll=False
(mismatch 25.0%)
 x: array([0.116687, 0.622734, 0.210443, 0.662715, 0.720813, 0.654062,
       0.936728, 0.451018, 0.471044, 0.560336, 0.133492, 0.228378,
       2.081284, 2.415464, 2.081284, 2.415464], dtype=float32)
 y: array([0.116687, 0.622734, 0.210443, 0.662715, 0.720813, 0.654062,
       0.936728, 0.451018, 0.471044, 0.560336, 0.133492, 0.228378,
       0.133492, 0.228378, 0.133492, 0.228378])
```
**Other info / logs**
There are a few further implications of current implementation addressed by the tests added to keras-team/keras [here](https://github.com/keras-team/keras/pull/11499/files#diff-e942014d73bf67b47a3b55f7f7041797R829))",True
tf.GradientTape() not support to MaxPool3D comp:ops,"**System information**
- Have I written custom code: **yes**
- OS Platform and Distribution: **Linux Ubuntu 16.04**
- TensorFlow installed from (source or binary): **binary, pip3 install**
- TensorFlow version (use command below): **1.10**
- Python version: **3.5**
- Bazel version (if compiling from source): N/A
- GCC/Compiler version (if compiling from source): N/A
- CUDA/cuDNN version: **CUDA Version 9.1.85**
- GPU model and memory: **TITAN V, 12066MB**

**Describe the current behavior**
I'm trying to create a simple cnn3d network, which contains a convolutional layer in 3d, a max pooling in 3d and a fully connected layer, all this using eager mode.
When trying to calculate the gradients with an optimizer I get this error:
`TypeError: 'NoneType' object has no attribute '__getitem__'`
Then, when trying to remove the MaxPool3D layer or replace with AveragePooling3D, the gradient calculation works without problems.

**Describe the expected behavior**
Calculate the gradients using the eager mode with tf.GradientTape() in a network with a Conv3D layer and a MaxPool3D layer.

**Code to reproduce the issue**
```python3
from __future__ import absolute_import, division, print_function

import tensorflow as tf

# enable eager mode
tf.enable_eager_execution()
tf.set_random_seed(0)
np.random.seed(0)


x = tf.random_uniform((10,5,10,10,3))
y = tf.random_uniform((10, 5))


class MyModel(tf.keras.Model):
  def __init__(self):
    super(MyModel, self).__init__()
    self.conv3d_1 = tf.keras.layers.Conv3D(filters=6,
                                           kernel_size=(3,3,3))
    self.max_pool_1 = tf.keras.layers.MaxPool3D(pool_size=(2, 2, 2))
    self.flatten = tf.keras.layers.Flatten()
    self.dense_1 = tf.layers.Dense(5)

  def call(self, input, training=False):
    """"""Run the model.""""""
    model = self.conv3d_1(input)
    model = self.max_pool_1(model)
    model = self.flatten(model)
    model = self.dense_1(model)
    
    return model

model = MyModel()

def loss(model, x, y):
  logits = model(x)
  return tf.losses.softmax_cross_entropy(onehot_labels=y, logits=logits), logits

def grad(model, inputs, targets):
  with tf.GradientTape() as tape:
    loss_value, logits = loss(model, inputs, targets)
  return loss_value, logits, tape.gradient(loss_value, model.trainable_variables)

# Optimize the model
optimizer = tf.train.GradientDescentOptimizer(learning_rate=0.01)
global_step = tf.train.get_or_create_global_step()
loss_value, logits, grads = grad(model, x, y)
optimizer.apply_gradients(zip(grads, model.variables), global_step)
```

**Other info / logs**
The traceback error:

```python3
TypeErrorTraceback (most recent call last)
<ipython-input-4-56cdb9bbe4e5> in <module>()
     44 # Optimize the model
     45 optimizer = tf.train.GradientDescentOptimizer(learning_rate=0.01)
---> 46 loss_value, logits, grads = grad(model, x, y)
     47 optimizer.apply_gradients(zip(grads, model.variables), global_step)

<ipython-input-4-56cdb9bbe4e5> in grad(model, inputs, targets)
     40   with tf.GradientTape() as tape:
     41     loss_value, logits = loss(model, inputs, targets)
---> 42   return loss_value, logits, tape.gradient(loss_value, model.trainable_variables)
     43 
     44 # Optimize the model

/usr/local/lib/python2.7/dist-packages/tensorflow/python/eager/backprop.pyc in gradient(self, target, sources, output_gradients)
    899         nest.flatten(target),
    900         flat_sources,
--> 901         output_gradients=output_gradients)
    902 
    903     if not self._persistent:

/usr/local/lib/python2.7/dist-packages/tensorflow/python/eager/imperative_grad.pyc in imperative_grad(tape, target, sources, output_gradients)
     62       target,
     63       sources,
---> 64       output_gradients)

/usr/local/lib/python2.7/dist-packages/tensorflow/python/eager/backprop.pyc in _gradient_function(op_name, attr_tuple, num_inputs, inputs, outputs, out_grads)
    115     return [None] * num_inputs
    116 
--> 117   return grad_fn(mock_op, *out_grads)
    118 
    119 

/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/nn_grad.pyc in _MaxPool3DGrad(op, grad)
    180   return gen_nn_ops.max_pool3d_grad(
    181       op.inputs[0],
--> 182       op.outputs[0],
    183       grad,
    184       ksize=op.get_attr(""ksize""),

TypeError: 'NoneType' object has no attribute '__getitem__'
```

",True
Bug in image_captioning_with_attention.ipynb  ,"**System information:** ***Running the notebook on Colab.***

- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): No
- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Colab
- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: NA
- TensorFlow installed from (source or binary): Colab
- TensorFlow version (use command below): Colab ('1.12.0-rc2')
- Python version: Colab (3.6)
- Bazel version (if compiling from source): NA
- GCC/Compiler version (if compiling from source): NA
- CUDA/cuDNN version: Colab
- GPU model and memory: Colab

**Describe the current behavior**

Error in Cell 27 (Training): 

`InvalidArgumentError: indices[37,0] = 5001 is not in [0, 5001) [Op:ResourceGather] name: rnn__decoder_1/embedding_1/embedding_lookup/`

**Describe the expected behavior**

If `tokenizer.word_index[tokenizer.oov_token] = top_k + 1` in Cell 10 is commented out, the notebook runs end-to-end on Colab. 

**Code to reproduce the issue**

The reason this happens could be because in Cells 9 and 10, Tokenizer is defined with `oov_token=""<unk>""` in Cell 9, which assigns ""\<unk\> : 1"" in the token dictionary, and then `tokenizer.word_index[tokenizer.oov_token] = top_k + 1` in Cell 10 assigns ""\<unk\>: top_k + 1"" which makes the number \<unk\> was previously assigned to non-existent in the dictionary and causes trouble during lookup. 

The following demonstration explains why we can get an error when we refer to the dictionary later on. 

```
import tensorflow as tf
tf.enable_eager_execution()
import re
import numpy as np

sent = ""<start> Alice in wonderland. <end>""
sent2 = ""<start> When suddenly Alice saw a White Rabbit. <end>""
x_train = [sent, sent2]

top_k = 5
tokenizer = tf.keras.preprocessing.text.Tokenizer(num_words=top_k, 
                                                  oov_token=""<unk>"", 
                                                  filters='!""#$%&()*+.,-/:;=?@[\]^_`{|}~ ')
tokenizer.fit_on_texts(x_train)
train_seqs = tokenizer.texts_to_sequences(x_train)
tokenizer.word_index = {key:value for key, value in tokenizer.word_index.items() if value <= top_k}
print(tokenizer.word_index)
idx = tokenizer.word_index['<unk>'] #saving the original index of '<unk>'
tokenizer.word_index[tokenizer.oov_token] = top_k + 1 # the problematic line
print(tokenizer.word_index)
index_word = {value:key for key, value in tokenizer.word_index.items()}
index_word[idx]
```

`Output:`
```
{'<unk>': 1, '<start>': 2, 'alice': 3, '<end>': 4, 'in': 5}
{'<unk>': 6, '<start>': 2, 'alice': 3, '<end>': 4, 'in': 5}
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
<ipython-input-11-55bbbd305835> in <module>()
     11 print(tokenizer.word_index)
     12 index_word = {value:key for key, value in tokenizer.word_index.items()}
---> 13 index_word[idx]

KeyError: 1
```

**Other info / logs**
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.
```
---------------------------------------------------------------------------
InvalidArgumentError                      Traceback (most recent call last)
<ipython-input-58-03bc9960ded7> in <module>()
     19             for i in range(1, target.shape[1]):
     20                 # passing the features through the decoder
---> 21                 predictions, hidden, _ = decoder(dec_input, features, hidden)
     22 
     23                 loss += loss_function(target[:, i], predictions)

/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/base_layer.py in __call__(self, inputs, *args, **kwargs)
    755       if not in_deferred_mode:
    756         self._in_call = True
--> 757         outputs = self.call(inputs, *args, **kwargs)
    758         self._in_call = False
    759         if outputs is None:

<ipython-input-54-b844d20e3fc2> in call(self, x, features, hidden)
     16 
     17     # x shape after passing through embedding == (batch_size, 1, embedding_dim)
---> 18     x = self.embedding(x)
     19 
     20     # x shape after concatenation == (batch_size, 1, embedding_dim + hidden_size)

/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/base_layer.py in __call__(self, inputs, *args, **kwargs)
    755       if not in_deferred_mode:
    756         self._in_call = True
--> 757         outputs = self.call(inputs, *args, **kwargs)
    758         self._in_call = False
    759         if outputs is None:

/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/layers/embeddings.py in call(self, inputs)
    175     if dtype != 'int32' and dtype != 'int64':
    176       inputs = math_ops.cast(inputs, 'int32')
--> 177     out = embedding_ops.embedding_lookup(self.embeddings, inputs)
    178     return out
    179 

/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/embedding_ops.py in embedding_lookup(params, ids, partition_strategy, name, validate_indices, max_norm)
    311       name=name,
    312       max_norm=max_norm,
--> 313       transform_fn=None)
    314 
    315 

/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/embedding_ops.py in _embedding_lookup_and_transform(params, ids, partition_strategy, name, max_norm, transform_fn)
    131     if np == 1 and (not transform_fn or ids.get_shape().ndims == 1):
    132       with ops.colocate_with(params[0]):
--> 133         result = _clip(array_ops.gather(params[0], ids, name=name),
    134                        ids, max_norm)
    135         if transform_fn:

/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/array_ops.py in gather(***failed resolving arguments***)
   2671     # TODO(apassos) find a less bad way of detecting resource variables without
   2672     # introducing a circular dependency.
-> 2673     return params.sparse_read(indices, name=name)
   2674   except AttributeError:
   2675     return gen_array_ops.gather_v2(params, indices, axis, name=name)

/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/resource_variable_ops.py in sparse_read(self, indices, name)
    756         tape.variable_accessed(self)
    757       value = gen_resource_variable_ops.resource_gather(
--> 758           self._handle, indices, dtype=self._dtype, name=name)
    759     return array_ops.identity(value)
    760 

/usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/gen_resource_variable_ops.py in resource_gather(resource, indices, dtype, validate_indices, name)
    611       else:
    612         message = e.message
--> 613       _six.raise_from(_core._status_to_exception(e.code, message), None)
    614 
    615 

/usr/local/lib/python3.6/dist-packages/six.py in raise_from(value, from_value)

InvalidArgumentError: indices[37,0] = 5001 is not in [0, 5001) [Op:ResourceGather] name: rnn__decoder_1/embedding_1/embedding_lookup/
```",True
`tf.keras.layers.Bidirectional` does not work under eager execution mode type:bug comp:eager,"**System information**
- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): NO
- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Mac OS X 10.12.6
- Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device: NO
- TensorFlow installed from (source or binary): BINARY
- TensorFlow version (use command below): v1.12.0-rc0-17-g7b08198113 1.12.0-rc1
- Python version: 3.6.5
- Bazel version (if compiling from source): NA
- GCC/Compiler version (if compiling from source): NA
- CUDA/cuDNN version: NA
- GPU model and memory: NA

**Describe the current behavior**

A very simple model with `Bidirectional` layer will stop work after we enable the eager execution mode.

**Describe the expected behavior**

Code should work with eager execution mode.

**Code to reproduce the issue**

The following code will be able to reprorduce this problem:

```py
import tensorflow as tf
import numpy as np

tf.enable_eager_execution()

x = tf.keras.layers.Input(shape=(2, 1))
y = tf.keras.layers.Bidirectional(
    tf.keras.layers.LSTM(1, return_state=True)
)(x)

model = tf.keras.Model(inputs=x, outputs=y)

data = np.array([0.1, 0.2]).reshape((1, -1, 1))
print(model.predict(data))
```
However, if we comment out the `tf.enable_eager_execution()`, then it will work as expected:

**Other info / logs**

The error message(with eager execution enabled) is:

```
Traceback (most recent call last):
  File ""src/t.py"", line 11, in <module>
    )(x)
  File ""/usr/local/lib/python3.6/site-packages/tensorflow/python/keras/layers/wrappers.py"", line 473, in __call__
    return super(Bidirectional, self).__call__(inputs, **kwargs)
  File ""/usr/local/lib/python3.6/site-packages/tensorflow/python/keras/engine/base_layer.py"", line 769, in __call__
    output_shapes = self.compute_output_shape(input_shapes)
  File ""/usr/local/lib/python3.6/site-packages/tensorflow/python/keras/utils/tf_utils.py"", line 149, in wrapper
    output_shape = fn(instance, input_shape)
  File ""/usr/local/lib/python3.6/site-packages/tensorflow/python/keras/layers/wrappers.py"", line 444, in compute_output_shape
    input_shape).as_list())
AttributeError: 'list' object has no attribute 'as_list'
```

After we disable the eager execution, then the above code works as expected.

```
[array([[0.01535364, 0.04371894]], dtype=float32), array([[0.01535364]], dtype=float32), array([[0.03121366]], dtype=float32), array([[0.04371894]], dtype=float32), array([[0.09061633]], dtype=float32)]
```",True
EMA's support for DistributionStrategy introduces worse performance comp:dist-strat,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes.
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Cent OS 7
- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: None
- **TensorFlow installed from (source or binary)**: Source
- **TensorFlow version (use command below)**: master
- **Python version**: 2.7
- **Bazel version (if compiling from source)**: 0.15
- **GCC/Compiler version (if compiling from source)**: NA
- **CUDA/cuDNN version**: 7.0
- **GPU model and memory**: NA
- **Exact command to reproduce**: NA

**Describe the current behavior**
This [PR](https://github.com/benjamintanweihao/tensorflow/commit/70af5e7ddcef853adb8af6355341bb8a97dcf736) add DistributionStrategy support to moving average APIs. However, **in MirroredStrategy**, this patch's implementation will introduce expensive MEMCPYPtoP cost, as `strategy.reduce(MEAN, value, v)` will eventually call strategy.broadcast(reduced, devices), and this get even worse when there are more devices used. Is this as expected as this implementation is just prepared for GENERAL distribution strategy? Thanks in advance. 


",True
"Unable to disable build of AWS, HDFS, Kafka and GCP ","### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: no
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: any
- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: any
- **TensorFlow installed from (source or binary)**: source
- **TensorFlow version (use command below)**: master
- **Python version**: N/A
- **Bazel version (if compiling from source)**: N/A
- **GCC/Compiler version (if compiling from source)**: N/A
- **CUDA/cuDNN version**: N/A
- **GPU model and memory**: N/A
- **Exact command to reproduce**: ./configure

### Describe the problem
When building TensorFlow as a library (and in our case using `--config=monolithic`), we used to remove as much as possible of the not used features. Recently, this was removed from master in https://github.com/tensorflow/tensorflow/commit/d56c298f1ef14b5a738e1e0b7bbc66fcd736be3e for AWS, HDFS, Kafka and GCP.

I understand that that having to deal with multiple optionnally-disabled features can be a huge burden for the future, but is it possible to have some way around ?",True
Failed to build TF from source with MPI support type:build/install,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: N/A
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 18.04 LTS
- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A
- **TensorFlow installed from (source or binary)**: source
- **TensorFlow version (use command below)**: 1.11.0-rc0
- **Python version**: 3.6.5
- **Bazel version (if compiling from source)**: 0.17.1
- **GCC/Compiler version (if compiling from source)**: 7.3.0
- **CUDA/cuDNN version**: 9.2/7.2
- **GPU model and memory**: Asus GTX 1080Ti
- **Exact command to reproduce**: See below

### Describe the problem
I canno't seem to compile tensorflow from source when I try to enable MPI support. The build always fails.
```
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.google.protobuf.UnsafeUtil (file:/home/stefan/.cache/bazel/_bazel_stefan/install/28c1d2ace0add449e21862ae9f2d2289/_embedded_binaries/A-server.jar) to field java.lang.String.value
WARNING: Please consider reporting this to the maintainers of com.google.protobuf.UnsafeUtil
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
WARNING: --batch mode is deprecated. Please instead explicitly shut down your Bazel server using the command ""bazel shutdown"".
You have bazel 0.17.1 installed.
Please specify the location of python. [Default is /home/stefan/.tmp/venv3/bin/python]: 


Traceback (most recent call last):
  File ""<string>"", line 1, in <module>
AttributeError: module 'site' has no attribute 'getsitepackages'
Found possible Python library paths:
  /home/stefan/.tmp/venv3/lib/python3.6/site-packages
Please input the desired Python library path to use.  Default is [/home/stefan/.tmp/venv3/lib/python3.6/site-packages]

Do you wish to build TensorFlow with jemalloc as malloc support? [Y/n]: 
jemalloc as malloc support will be enabled for TensorFlow.

Do you wish to build TensorFlow with Google Cloud Platform support? [Y/n]: 
Google Cloud Platform support will be enabled for TensorFlow.

Do you wish to build TensorFlow with Hadoop File System support? [Y/n]: 
Hadoop File System support will be enabled for TensorFlow.

Do you wish to build TensorFlow with Amazon AWS Platform support? [Y/n]: 
Amazon AWS Platform support will be enabled for TensorFlow.

Do you wish to build TensorFlow with Apache Kafka Platform support? [Y/n]: 
Apache Kafka Platform support will be enabled for TensorFlow.

Do you wish to build TensorFlow with XLA JIT support? [y/N]: 
No XLA JIT support will be enabled for TensorFlow.

Do you wish to build TensorFlow with GDR support? [y/N]: 
No GDR support will be enabled for TensorFlow.

Do you wish to build TensorFlow with VERBS support? [y/N]: 
No VERBS support will be enabled for TensorFlow.

Do you wish to build TensorFlow with nGraph support? [y/N]: 
No nGraph support will be enabled for TensorFlow.

Do you wish to build TensorFlow with OpenCL SYCL support? [y/N]: 
No OpenCL SYCL support will be enabled for TensorFlow.

Do you wish to build TensorFlow with CUDA support? [y/N]: y
CUDA support will be enabled for TensorFlow.

Please specify the CUDA SDK version you want to use. [Leave empty to default to CUDA 9.0]: 9.2


Please specify the location where CUDA 9.2 toolkit is installed. Refer to README.md for more details. [Default is /usr/local/cuda]: 


Please specify the cuDNN version you want to use. [Leave empty to default to cuDNN 7.0]: 7.2


Please specify the location where cuDNN 7 library is installed. Refer to README.md for more details. [Default is /usr/local/cuda]: 


Do you wish to build TensorFlow with TensorRT support? [y/N]: 
No TensorRT support will be enabled for TensorFlow.

Please specify the NCCL version you want to use. If NCCL 2.2 is not installed, then you can use version 1.3 that can be fetched automatically but it may have worse performance with multiple GPUs. [Default is 2.2]: 


Please specify the location where NCCL 2 library is installed. Refer to README.md for more details. [Default is /usr/local/cuda]:/usr/local/cuda/nccl


Please specify a list of comma-separated Cuda compute capabilities you want to build with.
You can find the compute capability of your device at: https://developer.nvidia.com/cuda-gpus.
Please note that each additional compute capability significantly increases your build time and binary size. [Default is: 6.1]: 


Do you want to use clang as CUDA compiler? [y/N]: 
nvcc will be used as CUDA compiler.

Please specify which gcc should be used by nvcc as the host compiler. [Default is /usr/bin/gcc]: 


Do you wish to build TensorFlow with MPI support? [y/N]: y
MPI support will be enabled for TensorFlow.

Please specify the MPI toolkit folder. [Default is /usr/local]: 


Please specify optimization flags to use during compilation when bazel option ""--config=opt"" is specified [Default is -march=native]: 


Would you like to interactively configure ./WORKSPACE for Android builds? [y/N]: 
Not configuring the WORKSPACE for Android builds.

Preconfigured Bazel build configs. You can use any of the below by adding ""--config=<>"" to your build command. See tools/bazel.rc for more details.
	--config=mkl         	# Build with MKL support.
	--config=monolithic  	# Config for mostly static monolithic build.
Configuration finished
```
This is my configuration. Note that the build succeeds with MPI set to no.
Error message when build fails:
```
ERROR: /home/stefan/.tmp/tensorflow/tensorflow/contrib/mpi/BUILD:60:1: C++ compilation of rule '//tensorflow/contrib/mpi:mpi_rendezvous_mgr' failed (Exit 1)
In file included from ./tensorflow/core/framework/common_shape_fns.h:22:0,
                 from ./tensorflow/core/framework/resource_mgr.h:24,
                 from ./tensorflow/core/common_runtime/device.h:43,
                 from ./tensorflow/core/common_runtime/device_mgr.h:24,
                 from ./tensorflow/core/distributed_runtime/worker_session.h:21,
                 from ./tensorflow/core/distributed_runtime/base_rendezvous_mgr.h:24,
                 from ./tensorflow/contrib/mpi/mpi_rendezvous_mgr.h:35,
                 from tensorflow/contrib/mpi/mpi_rendezvous_mgr.cc:18:
./tensorflow/core/util/tensor_format.h: In function 'tensorflow::TensorShape tensorflow::ShapeFromFormat(tensorflow::TensorFormat, tensorflow::int64, tensorflow::gtl::ArraySlice<long long int>, tensorflow::int64)':
./tensorflow/core/util/tensor_format.h:501:45: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]
     if (format == FORMAT_NHWC_VECT_W && dim == spatial.size() - 1) {
                                         ~~~~^~~~~~~~~~~~~~~~~~~~~
In file included from tensorflow/contrib/mpi/mpi_rendezvous_mgr.cc:18:0:
./tensorflow/contrib/mpi/mpi_rendezvous_mgr.h: In member function 'void tensorflow::MPISendTensorCall::Init(const tensorflow::Rendezvous::ParsedKey&, tensorflow::int64, bool)':
./tensorflow/contrib/mpi/mpi_rendezvous_mgr.h:74:36: error: 'using StringPiece = class absl::string_view {aka class absl::string_view}' has no member named 'ToString'
     mRes_.set_key(parsed.FullKey().ToString());
                                    ^~~~~~~~
tensorflow/contrib/mpi/mpi_rendezvous_mgr.cc: In member function 'virtual void tensorflow::MPIRemoteRendezvous::RecvFromRemoteAsync(const tensorflow::Rendezvous::ParsedKey&, const tensorflow::Rendezvous::Args&, tensorflow::Rendezvous::DoneCallback)':
tensorflow/contrib/mpi/mpi_rendezvous_mgr.cc:139:38: error: 'using StringPiece = class absl::string_view {aka class absl::string_view}' has no member named 'ToString'
   mgr->QueueRequest(parsed.FullKey().ToString(), step_id_,
                                      ^~~~~~~~
tensorflow/contrib/mpi/mpi_rendezvous_mgr.cc: In lambda function:
tensorflow/contrib/mpi/mpi_rendezvous_mgr.cc:261:45: error: 'using StringPiece = class absl::string_view {aka class absl::string_view}' has no member named 'ToString'
         SendQueueEntry req(parsed.FullKey().ToString().c_str(), std::move(res));
                                             ^~~~~~~~
In file included from ./tensorflow/core/platform/default/logging.h:24:0,
                 from ./tensorflow/core/platform/logging.h:25,
                 from ./tensorflow/contrib/mpi/mpi_utils.h:25,
                 from ./tensorflow/contrib/mpi/mpi_rendezvous_mgr.h:34,
                 from tensorflow/contrib/mpi/mpi_rendezvous_mgr.cc:18:
./tensorflow/core/util/tensor_format.h: In instantiation of 'T tensorflow::GetTensorDim(tensorflow::gtl::ArraySlice<T>, tensorflow::TensorFormat, char) [with T = long long int; tensorflow::gtl::ArraySlice<T> = absl::Span<const long long int>]':
./tensorflow/core/util/tensor_format.h:452:47:   required from here
./tensorflow/core/util/tensor_format.h:420:29: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]
   CHECK(index >= 0 && index < dimension_attributes.size())
./tensorflow/core/platform/macros.h:87:47: note: in definition of macro 'TF_PREDICT_FALSE'
 #define TF_PREDICT_FALSE(x) (__builtin_expect(x, 0))
                                               ^
./tensorflow/core/util/tensor_format.h:420:3: note: in expansion of macro 'CHECK'
   CHECK(index >= 0 && index < dimension_attributes.size())
   ^
./tensorflow/core/util/tensor_format.h: In instantiation of 'T tensorflow::GetFilterDim(tensorflow::gtl::ArraySlice<T>, tensorflow::FilterTensorFormat, char) [with T = long long int; tensorflow::gtl::ArraySlice<T> = absl::Span<const long long int>]':
./tensorflow/core/util/tensor_format.h:461:54:   required from here
./tensorflow/core/util/tensor_format.h:435:29: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]
   CHECK(index >= 0 && index < dimension_attribute.size())
./tensorflow/core/platform/macros.h:87:47: note: in definition of macro 'TF_PREDICT_FALSE'
 #define TF_PREDICT_FALSE(x) (__builtin_expect(x, 0))
                                               ^
./tensorflow/core/util/tensor_format.h:435:3: note: in expansion of macro 'CHECK'
   CHECK(index >= 0 && index < dimension_attribute.size())
   ^
Target //tensorflow/tools/pip_package:build_pip_package failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 863.199s, Critical Path: 65.99s
INFO: 3852 processes: 3852 local.
FAILED: Build did NOT complete successfully
```
It says that StringPiece has no member ToString.
I installed MPI with:
```
wget https://www.open-mpi.org/software/ompi/v3.0/downloads/openmpi-3.1.2.tar.gz
tar -xvf openmpi-3.1.2.tar.gz
cd openmpi-3.1.2
./configure --disable-mpi-fortran --with-cuda=/usr/local/cuda/ --prefix /usr/local/
make
make install
```
",True
crosstool_wrapper_driver_is_not_gcc failed: error executing command ,"Please go to Stack Overflow for help and support:

https://stackoverflow.com/questions/tagged/tensorflow

If you open a GitHub issue, here is our policy:

1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).
2. The form below must be filled out.
3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).

**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.

------------------------

### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 18.04
- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A
- **TensorFlow installed from (source or binary)**: source
- **TensorFlow version (use command below)**: 1.11.0rc1
- **Python version**: 3.6.5
- **Bazel version (if compiling from source)**: 0.17.1
- **GCC/Compiler version (if compiling from source)**: c++ (Ubuntu 7.3.0-16ubuntu3) 7.3.0
- **CUDA/cuDNN version**: 9.2 / 7.2.1
- **GPU model and memory**: GeForce 940MX
- **Exact command to reproduce**: bazel build -c opt --copt=-mavx --copt=-mavx2 --copt=-mfma --copt=-mfpmath=both --copt=-msse4.2 --config=cuda --verbose_failures //tensorflow/tools/pip_package:build_pip_package

You can collect some of this information using our environment capture script:

https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh

You can obtain the TensorFlow version with

python -c ""import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)""

### Describe the problem
Describe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.
**When the VERBS support is enabled the tensorflow build fails with the following error message:
~/tensorflow/tensorflow/contrib/verbs/BUILD:90:1: C++ compilation of rule '//tensorflow/contrib/verbs:rdma_rendezvous_mgr' failed (Exit 1): crosstool_wrapper_driver_is_not_gcc failed: error executing command**

### Source code / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.
```
ERROR: ~/Documents/dev/git/tensorflow/tensorflow/contrib/verbs/BUILD:90:1: C++ compilation of rule '//tensorflow/contrib/verbs:rdma_rendezvous_mgr' failed (Exit 1): crosstool_wrapper_driver_is_not_gcc failed: error executing command 
  (cd ~/.cache/bazel/_bazel_blablabla/cf67b2b2e967476eb2b1ee98e33ab5bd/execroot/org_tensorflow && \
  exec env - \
    CUDA_TOOLKIT_PATH=/usr/local/cuda \
    CUDNN_INSTALL_PATH=/usr/lib/x86_64-linux-gnu \
    GCC_HOST_COMPILER_PATH=/usr/bin/gcc \
    NCCL_INSTALL_PATH=/usr/local/nccl_2.2.13-1+cuda9.2_x86_64 \
    PATH=~/bin:/usr/local/sbin:/usr/local/lib:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/home/linuxbrew/.linuxbrew/bin:/home/linuxbrew/.linuxbrew/sbin:/home/linuxbrew/.linuxbrew/opt/coreutils/libexec/gnubin:/usr/local/cuda/bin:/usr/local/share/apache/hadoop/sbin:/usr/local/share/apache/hadoop/bin:/usr/local/share/apache/spark/sbin:/usr/local/share/apache/spark/bin:/usr/games:/usr/local/games:~/bin:/snap/bin \
    PWD=/proc/self/cwd \
    PYTHON_BIN_PATH=/usr/bin/python3 \
    PYTHON_LIB_PATH=/usr/lib/python3/dist-packages \
    TF_CUDA_CLANG=0 \
    TF_CUDA_COMPUTE_CAPABILITIES=5.0 \
    TF_CUDA_VERSION=9.2 \
    TF_CUDNN_VERSION=7 \
    TF_NCCL_VERSION=2 \
    TF_NEED_CUDA=1 \
    TF_NEED_OPENCL_SYCL=0 \
  external/local_config_cuda/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -MD -MF bazel-out/k8-opt/bin/tensorflow/contrib/verbs/_objs/rdma_rendezvous_mgr/rdma_rendezvous_mgr.pic.d '-frandom-seed=bazel-out/k8-opt/bin/tensorflow/contrib/verbs/_objs/rdma_rendezvous_mgr/rdma_rendezvous_mgr.pic.o' '-DGRPC_ARES=0' '-DPB_FIELD_16BIT=1' -D__CLANG_SUPPORT_DYN_ANNOTATION__ -DEIGEN_MPL2_ONLY '-DEIGEN_MAX_ALIGN_BYTES=64' -DTENSORFLOW_USE_JEMALLOC -DTF_USE_SNAPPY -DTENSORFLOW_USE_VERBS -DTENSORFLOW_USE_GDR -DCURL_STATICLIB -DPLATFORM_LINUX -DENABLE_CURL_CLIENT -DENABLE_NO_ENCRYPTION -iquote . -iquote bazel-out/k8-opt/genfiles -iquote bazel-out/k8-opt/bin -iquote external/protobuf_archive -iquote bazel-out/k8-opt/genfiles/external/protobuf_archive -iquote bazel-out/k8-opt/bin/external/protobuf_archive -iquote external/bazel_tools -iquote bazel-out/k8-opt/genfiles/external/bazel_tools -iquote bazel-out/k8-opt/bin/external/bazel_tools -iquote external/grpc -iquote bazel-out/k8-opt/genfiles/external/grpc -iquote bazel-out/k8-opt/bin/external/grpc -iquote external/zlib_archive -iquote bazel-out/k8-opt/genfiles/external/zlib_archive -iquote bazel-out/k8-opt/bin/external/zlib_archive -iquote external/boringssl -iquote bazel-out/k8-opt/genfiles/external/boringssl -iquote bazel-out/k8-opt/bin/external/boringssl -iquote external/com_google_absl -iquote bazel-out/k8-opt/genfiles/external/com_google_absl -iquote bazel-out/k8-opt/bin/external/com_google_absl -iquote external/nsync -iquote bazel-out/k8-opt/genfiles/external/nsync -iquote bazel-out/k8-opt/bin/external/nsync -iquote external/jemalloc -iquote bazel-out/k8-opt/genfiles/external/jemalloc -iquote bazel-out/k8-opt/bin/external/jemalloc -iquote external/eigen_archive -iquote bazel-out/k8-opt/genfiles/external/eigen_archive -iquote bazel-out/k8-opt/bin/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/k8-opt/genfiles/external/local_config_sycl -iquote bazel-out/k8-opt/bin/external/local_config_sycl -iquote external/gif_archive -iquote bazel-out/k8-opt/genfiles/external/gif_archive -iquote bazel-out/k8-opt/bin/external/gif_archive -iquote external/jpeg -iquote bazel-out/k8-opt/genfiles/external/jpeg -iquote bazel-out/k8-opt/bin/external/jpeg -iquote external/com_googlesource_code_re2 -iquote bazel-out/k8-opt/genfiles/external/com_googlesource_code_re2 -iquote bazel-out/k8-opt/bin/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/k8-opt/genfiles/external/farmhash_archive -iquote bazel-out/k8-opt/bin/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/k8-opt/genfiles/external/fft2d -iquote bazel-out/k8-opt/bin/external/fft2d -iquote external/highwayhash -iquote bazel-out/k8-opt/genfiles/external/highwayhash -iquote bazel-out/k8-opt/bin/external/highwayhash -iquote external/local_config_cuda -iquote bazel-out/k8-opt/genfiles/external/local_config_cuda -iquote bazel-out/k8-opt/bin/external/local_config_cuda -iquote external/double_conversion -iquote bazel-out/k8-opt/genfiles/external/double_conversion -iquote bazel-out/k8-opt/bin/external/double_conversion -iquote external/curl -iquote bazel-out/k8-opt/genfiles/external/curl -iquote bazel-out/k8-opt/bin/external/curl -iquote external/jsoncpp_git -iquote bazel-out/k8-opt/genfiles/external/jsoncpp_git -iquote bazel-out/k8-opt/bin/external/jsoncpp_git -iquote external/aws -iquote bazel-out/k8-opt/genfiles/external/aws -iquote bazel-out/k8-opt/bin/external/aws -isystem external/protobuf_archive/src -isystem bazel-out/k8-opt/genfiles/external/protobuf_archive/src -isystem bazel-out/k8-opt/bin/external/protobuf_archive/src -isystem external/grpc/include -isystem bazel-out/k8-opt/genfiles/external/grpc/include -isystem bazel-out/k8-opt/bin/external/grpc/include -isystem external/zlib_archive -isystem bazel-out/k8-opt/genfiles/external/zlib_archive -isystem bazel-out/k8-opt/bin/external/zlib_archive -isystem external/grpc/third_party/address_sorting/include -isystem bazel-out/k8-opt/genfiles/external/grpc/third_party/address_sorting/include -isystem bazel-out/k8-opt/bin/external/grpc/third_party/address_sorting/include -isystem external/boringssl/src/include -isystem bazel-out/k8-opt/genfiles/external/boringssl/src/include -isystem bazel-out/k8-opt/bin/external/boringssl/src/include -isystem external/nsync/public -isystem bazel-out/k8-opt/genfiles/external/nsync/public -isystem bazel-out/k8-opt/bin/external/nsync/public -isystem external/jemalloc/include -isystem bazel-out/k8-opt/genfiles/external/jemalloc/include -isystem bazel-out/k8-opt/bin/external/jemalloc/include -isystem external/eigen_archive -isystem bazel-out/k8-opt/genfiles/external/eigen_archive -isystem bazel-out/k8-opt/bin/external/eigen_archive -isystem external/gif_archive/lib -isystem bazel-out/k8-opt/genfiles/external/gif_archive/lib -isystem bazel-out/k8-opt/bin/external/gif_archive/lib -isystem external/farmhash_archive/src -isystem bazel-out/k8-opt/genfiles/external/farmhash_archive/src -isystem bazel-out/k8-opt/bin/external/farmhash_archive/src -isystem external/com_google_absl -isystem bazel-out/k8-opt/genfiles/external/com_google_absl -isystem bazel-out/k8-opt/bin/external/com_google_absl -isystem external/local_config_cuda/cuda -isystem bazel-out/k8-opt/genfiles/external/local_config_cuda/cuda -isystem bazel-out/k8-opt/bin/external/local_config_cuda/cuda -isystem external/local_config_cuda/cuda/cuda/include -isystem bazel-out/k8-opt/genfiles/external/local_config_cuda/cuda/cuda/include -isystem bazel-out/k8-opt/bin/external/local_config_cuda/cuda/cuda/include -isystem external/local_config_cuda/cuda/cuda/include/crt -isystem bazel-out/k8-opt/genfiles/external/local_config_cuda/cuda/cuda/include/crt -isystem bazel-out/k8-opt/bin/external/local_config_cuda/cuda/cuda/include/crt -isystem external/double_conversion -isystem bazel-out/k8-opt/genfiles/external/double_conversion -isystem bazel-out/k8-opt/bin/external/double_conversion -isystem external/curl/include -isystem bazel-out/k8-opt/genfiles/external/curl/include -isystem bazel-out/k8-opt/bin/external/curl/include -isystem external/jsoncpp_git/include -isystem bazel-out/k8-opt/genfiles/external/jsoncpp_git/include -isystem bazel-out/k8-opt/bin/external/jsoncpp_git/include -isystem external/aws/aws-cpp-sdk-core/include -isystem bazel-out/k8-opt/genfiles/external/aws/aws-cpp-sdk-core/include -isystem bazel-out/k8-opt/bin/external/aws/aws-cpp-sdk-core/include -isystem external/aws/aws-cpp-sdk-kinesis/include -isystem bazel-out/k8-opt/genfiles/external/aws/aws-cpp-sdk-kinesis/include -isystem bazel-out/k8-opt/bin/external/aws/aws-cpp-sdk-kinesis/include -isystem external/aws/aws-cpp-sdk-s3/include -isystem bazel-out/k8-opt/genfiles/external/aws/aws-cpp-sdk-s3/include -isystem bazel-out/k8-opt/bin/external/aws/aws-cpp-sdk-s3/include '-std=c++11' -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -fPIC -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -fno-omit-frame-pointer -no-canonical-prefixes -DNDEBUG -g0 -O2 -ffunction-sections -fdata-sections -mavx -mavx2 -mfma '-mfpmath=both' -msse4.2 -c tensorflow/contrib/verbs/rdma_rendezvous_mgr.cc -o bazel-out/k8-opt/bin/tensorflow/contrib/verbs/_objs/rdma_rendezvous_mgr/rdma_rendezvous_mgr.pic.o)
In file included from ./tensorflow/core/framework/common_shape_fns.h:22:0,
                 from ./tensorflow/core/framework/resource_mgr.h:24,
                 from ./tensorflow/core/common_runtime/device.h:43,
                 from ./tensorflow/core/common_runtime/device_mgr.h:24,
                 from ./tensorflow/core/distributed_runtime/worker_session.h:21,
                 from ./tensorflow/core/distributed_runtime/base_rendezvous_mgr.h:24,
                 from ./tensorflow/contrib/verbs/rdma_rendezvous_mgr.h:22,
                 from tensorflow/contrib/verbs/rdma_rendezvous_mgr.cc:18:
./tensorflow/core/util/tensor_format.h: In function 'tensorflow::TensorShape tensorflow::ShapeFromFormat(tensorflow::TensorFormat, tensorflow::int64, tensorflow::gtl::ArraySlice<long long int>, tensorflow::int64)':
./tensorflow/core/util/tensor_format.h:501:45: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]
     if (format == FORMAT_NHWC_VECT_W && dim == spatial.size() - 1) {
                                         ~~~~^~~~~~~~~~~~~~~~~~~~~
tensorflow/contrib/verbs/rdma_rendezvous_mgr.cc: In member function 'virtual void tensorflow::RdmaRemoteRendezvous::RecvFromRemoteAsync(const tensorflow::Rendezvous::ParsedKey&, const tensorflow::Rendezvous::Args&, tensorflow::Rendezvous::DoneCallback)':
tensorflow/contrib/verbs/rdma_rendezvous_mgr.cc:66:41: error: 'using StringPiece = class absl::string_view {aka class absl::string_view}' has no member named 'ToString'
   string key(std::move(parsed.FullKey().ToString()));
                                         ^~~~~~~~
In file included from ./tensorflow/core/platform/default/logging.h:24:0,
                 from ./tensorflow/core/platform/logging.h:25,
                 from ./tensorflow/core/lib/core/refcount.h:22,
                 from ./tensorflow/core/platform/tensor_coding.h:21,
                 from ./tensorflow/core/framework/resource_handle.h:19,
                 from ./tensorflow/core/framework/types.h:31,
                 from ./tensorflow/contrib/verbs/verbs_util.h:21,
                 from ./tensorflow/contrib/verbs/rdma.h:30,
                 from ./tensorflow/contrib/verbs/rdma_mgr.h:24,
                 from ./tensorflow/contrib/verbs/rdma_rendezvous_mgr.h:21,
                 from tensorflow/contrib/verbs/rdma_rendezvous_mgr.cc:18:
./tensorflow/core/util/tensor_format.h: In instantiation of 'T tensorflow::GetTensorDim(tensorflow::gtl::ArraySlice<T>, tensorflow::TensorFormat, char) [with T = long long int; tensorflow::gtl::ArraySlice<T> = absl::Span<const long long int>]':
./tensorflow/core/util/tensor_format.h:452:47:   required from here
./tensorflow/core/util/tensor_format.h:420:29: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]
   CHECK(index >= 0 && index < dimension_attributes.size())
./tensorflow/core/platform/macros.h:87:47: note: in definition of macro 'TF_PREDICT_FALSE'
 #define TF_PREDICT_FALSE(x) (__builtin_expect(x, 0))
                                               ^
./tensorflow/core/util/tensor_format.h:420:3: note: in expansion of macro 'CHECK'
   CHECK(index >= 0 && index < dimension_attributes.size())
   ^
./tensorflow/core/util/tensor_format.h: In instantiation of 'T tensorflow::GetFilterDim(tensorflow::gtl::ArraySlice<T>, tensorflow::FilterTensorFormat, char) [with T = long long int; tensorflow::gtl::ArraySlice<T> = absl::Span<const long long int>]':
./tensorflow/core/util/tensor_format.h:461:54:   required from here
./tensorflow/core/util/tensor_format.h:435:29: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]
   CHECK(index >= 0 && index < dimension_attribute.size())
./tensorflow/core/platform/macros.h:87:47: note: in definition of macro 'TF_PREDICT_FALSE'
 #define TF_PREDICT_FALSE(x) (__builtin_expect(x, 0))
                                               ^
./tensorflow/core/util/tensor_format.h:435:3: note: in expansion of macro 'CHECK'
   CHECK(index >= 0 && index < dimension_attribute.size())
   ^
Target //tensorflow/tools/pip_package:build_pip_package failed to build
INFO: Elapsed time: 7400.912s, Critical Path: 180.41s
INFO: 10108 processes: 10108 local.
FAILED: Build did NOT complete successfully
```",True
Tflite label_image resize bug comp:lite,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:
Linux
- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:
NA
- **TensorFlow installed from (source or binary)**:
Source
- **TensorFlow version (use command below)**:
1.10
- **Python version**:
3.5
- **Bazel version (if compiling from source)**:
0.15
- **GCC/Compiler version (if compiling from source)**:
NA
- **CUDA/cuDNN version**:
NA
- **GPU model and memory**:
NA
- **Exact command to reproduce**:
NA

### Describe the problem
In the `label_image.cc` example of TFlite, a resize function present in `bitmap_helpers_impl.h` is being called in line [171](https://github.com/tensorflow/tensorflow/blob/4dcfddc5d12018a5a0fdca652b9221ed95e9eb23/tensorflow/contrib/lite/examples/label_image/label_image.cc#L171) - 
`   resize<float>(interpreter->typed_tensor<float>(input), in.data(),`

In the implementation of the function in `bitmap_helpers_impl.h`, the following [line](https://github.com/tensorflow/tensorflow/blob/4dcfddc5d12018a5a0fdca652b9221ed95e9eb23/tensorflow/contrib/lite/examples/label_image/bitmap_helpers_impl.h#L90) 
```
  auto output_number_of_pixels =
      wanted_height * wanted_height * wanted_channels;
```
assumes that for the input image, the height and width must be the same. And this works for the mobilenet example since the input size is 224 x 224. But, this would cause issues for any network where the expected input size does not have the same width and height. It should instead be - 
```
   auto output_number_of_pixels =
      wanted_width * wanted_height * wanted_channels;
```

### Source code / logs
NA
",True
metrics=['accuracy'] seems to be calculated differently if one uses tf.data inputs instead of numpy arrays for keras model ,"Please go to Stack Overflow for help and support:

https://stackoverflow.com/questions/tagged/tensorflow

If you open a GitHub issue, here is our policy:

1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).
2. The form below must be filled out.
3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).

**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.

------------------------

### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: **YES**
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: **Windows 10**
- **Mobile device**:na
- **TensorFlow installed from (source or binary)**: **binary**
- **TensorFlow version (use command below)**:**1.11.0-dev20180907**
- **Python version**:**3.6.3**
- **Bazel version (if compiling from source)**:na
- **GCC/Compiler version (if compiling from source)**:na
- **CUDA/cuDNN version**:na
- **GPU model and memory**:na
- **Exact command to reproduce**:na

You can collect some of this information using our environment capture script:

https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh

You can obtain the TensorFlow version with

python -c ""import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)""

### Describe the problem
Describe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.

Given the same piece of code for loading mnist data and training a keras model in tensorflow, the metric ""accuracy"" given as argument to keras_model.compile(metrics=[...]) generates very different values (order of 0.10 versus order of 0.90) depending on if you use numpy arrays or tf.data datasets as training inputs. Note that the values of the loss in each case are very close. I suspect that ""accuracy"" is being calculated differently depending on the type of input (numpy or tf.data), or that it is being calculated wrong in one of the cases.
In particular, as an example, using numpy arrays as input, one can get the pair loss: 0.2086 - acc: 0.9389 in one of the steps, while the same loss in with tf.data gives the pair loss: 0.2086 - acc: 0.1024.

### Source code / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.

The code below as it is can be run and training with tf.data datasets will be performed. If you comment the block between `#Train with tf.data datasets` and `########################` and uncomment the block between `#Train with numpy arrays` and `########################`, training with numpy arrays as inputs will be performed.

```
import tensorflow as tf
import numpy as np

np.random.seed(1)
tf.set_random_seed(1)
BATCH_SIZE = 32

#Import mnist dataset as numpy arrays
(x_train, y_train), (_, _) = tf.keras.datasets.mnist.load_data()#Import
x_train = x_train / 255.0 #normalizing
y_train = y_train.astype(dtype='float32')
x_train = x_train.astype(dtype='float32')

x_train = np.reshape(x_train, (x_train.shape[0], x_train.shape[1]*x_train.shape[2]))#Reshaping the 2D picture

##############################################################################################
#THIS BLOCK CREATES A DATASET FROM THE NUMPY ARRAYS. IT WILL BE USED FOR THE CASE OF TF.DATA DATASET INPUTS
tfdata_dataset_train = tf.data.Dataset.from_tensor_slices((x_train, y_train))
tfdata_dataset_train = tfdata_dataset_train.batch(BATCH_SIZE).repeat()
##############################################################################################

#Create model
keras_model = tf.keras.models.Sequential([
    tf.keras.layers.Dense(512, activation=tf.nn.relu),
    tf.keras.layers.Dropout(0.2, seed=1),
    tf.keras.layers.Dense(10, activation=tf.nn.softmax)
])

#Compile the model
keras_model.compile(optimizer=tf.keras.optimizers.Adam(),
                    loss=tf.keras.losses.sparse_categorical_crossentropy,
                    metrics=['accuracy'])

#Train with numpy arrays
#keras_training_history = keras_model.fit(x_train,
#                y_train,
#                epochs=1
#                )
########################

#Train with tf.data datasets
keras_training_history = keras_model.fit(tfdata_dataset_train,
                epochs=1,
                steps_per_epoch=60000//BATCH_SIZE
                )
########################
```


",True
ps0 will be OOM using MonitoredTrainingSession when workers too many stat:awaiting response stale,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux
- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: No
- **TensorFlow installed from (source or binary)**: source
- **TensorFlow version (use command below)**: 1.4
- **Python version**: 2.7.5
- **Bazel version (if compiling from source)**: 1.9
- **GCC/Compiler version (if compiling from source)**: 4.9.2
- **CUDA/cuDNN version**: CPU
- **GPU model and memory**: CPU
- **Exact command to reproduce**: Using MonitoredTrainingSession and thousands of workers.


### Describe the problem
My model is large and complex. Thousands of worker&ps are needed and MonitoredTrainingSession is used. In the stage of initialization, the memory of ps0 will raise up to 100G and then OOM, but other ps work correctly. Op device placement is tf.train.replica_device_setter and no other special strategy.

I open the log_device_placement and found that all ops related with report_uninitialized_xxx are placed on ps0. I think this is the root cause.

I change the code as PR #22136 , and then it works correctly.
",True
[Bug] tf.nn.depthwise_conv2d fails with AttributeError ,"### System information
- **Have I written custom code**: yes
- **OS Platform and Distribution**: Linux Ubuntu 16.04
- **TensorFlow installed from**: binary
- **TensorFlow version**: v1.10.1-0-g4dcfddc5d1
- **Python version**: 2.7.12
- **CUDA/cuDNN version**: 9.0/7.1.4
- **GPU model and memory**: GTX 1070

### Describe the problem
`tf.nn.depthwise_conv2d` fails when the shape of the input is not known statically and the data format is 'NCHW' and the dilation rate is larger than 1.

### Source code / logs
Reproducible test case:
```
import tensorflow as tf
sh = tf.placeholder(dtype=tf.int32, shape=[4])
img = tf.ones(sh)
k = tf.ones([1, 1, 1, 1])
t = tf.nn.depthwise_conv2d(img, k, [1, 1, 1, 1], 'VALID', rate=[2, 1], data_format='NCHW')
```
Traceback:
```
Traceback (most recent call last):
  File ""<stdin>"", line 1, in <module>
  File ""/home/manu/.local/lib/python2.7/site-packages/tensorflow/python/ops/nn_impl.py"", line 461, in depthwise_conv2d
    op=op)
  File ""/home/manu/.local/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py"", line 364, in with_space_to_batch
    return new_op(input, None)
  File ""/home/manu/.local/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py"", line 520, in __call__
    return self.call(inp, filter)
  File ""/home/manu/.local/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.py"", line 514, in _with_space_to_batch_call
    output_shape[1] = filter.shape[-1]
AttributeError: 'NoneType' object has no attribute 'shape'
```",True
GDR Cannot register memory region ,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: NO
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:  Linux Ubuntu 16.04
- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: no
- **TensorFlow installed from (source or binary)**: source
- **TensorFlow version (use command below)**:1.10
- **Python version**: 2.7 
- **Bazel version (if compiling from source)**: 0.16.1
- **GCC/Compiler version (if compiling from source)**: 5.4
- **CUDA/cuDNN version**: 9.0
- **GPU model and memory**: K40c 12G
- **Exact command to reproduce**: 
**Worker :** python benchmarks/scripts/tf_cnn_benchmarks/tf_cnn_benchmarks.py --local_parameter_device=gpu --num_gpus=4 --batch_size=128 --num_epochs=10 --model=alexnet --variable_update=distributed_replicated --data_dir=imagenet-data --all_reduce_spec=pscpu --job_name=worker --ps_hosts=10.10.10.6:2222 --worker_hosts=10.10.10.5:3333 --task_index=0 --server_protocol=grpc+gdr
**PS :** CUDA_VISIBLE_DEVICES='' python benchmarks/scripts/tf_cnn_benchmarks/tf_cnn_benchmarks.py --local_parameter_device=cpu --num_gpus=0 --batch_size=128 --num_epochs=10 --model=alexnet --variable_update=distributed_replicated --data_dir=imagenet-data --all_reduce_spec=pscpu --job_name=ps --ps_hosts=10.10.10.6:2222 --worker_hosts=10.10.10.5:3333 --task_index=0 --server_protocol=grpc+gdr

## Describe the problem
I tried to use GDR, but it seems no performance improvement compared to native RDMA, and logs are the following:

```
$ python benchmarks/scripts/tf_cnn_benchmarks/tf_cnn_benchmarks.py --local_parameter_device=cpu --num_gpus=4 --batch_size=128 --num_epochs=10 --model=alexnet --variable_update=distributed_replicated --data_dir=/home/shuai/imagenet-data --all_reduce_spec=pscpu --job_name=worker --ps_hosts=10.10.10.6:2222 --worker_hosts=10.10.10.5:3333 --task_index=0 --server_protocol=grpc+gdr
2018-09-05 15:05:58.062100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 0 with properties:
name: Tesla K40c major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:02:00.0
totalMemory: 11.92GiB freeMemory: 11.84GiB
2018-09-05 15:05:58.211502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 1 with properties:
name: Tesla K40c major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:03:00.0
totalMemory: 11.92GiB freeMemory: 11.84GiB
2018-09-05 15:05:58.374791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 2 with properties:
name: Tesla K40c major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:83:00.0
totalMemory: 11.92GiB freeMemory: 11.84GiB
2018-09-05 15:05:58.553152: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1405] Found device 3 with properties:
name: Tesla K40c major: 3 minor: 5 memoryClockRate(GHz): 0.745
pciBusID: 0000:84:00.0
totalMemory: 11.92GiB freeMemory: 11.84GiB
2018-09-05 15:05:58.553735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1484] Adding visible gpu devices: 0, 1, 2, 3
2018-09-05 15:05:59.918282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:965] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-09-05 15:05:59.918335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971]      0 1 2 3
2018-09-05 15:05:59.918344: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 0:   N Y N N
2018-09-05 15:05:59.918349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 1:   Y N N N
2018-09-05 15:05:59.918354: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 2:   N N N Y
2018-09-05 15:05:59.918359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] 3:   N N Y N
2018-09-05 15:05:59.919609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:0 with 11473 MB memory) -> physical GPU (device: 0, name: Tesla K40c, pci bus id: 0000:02:00.0, compute capability: 3.5)
2018-09-05 15:06:00.088804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:1 with 11473 MB memory) -> physical GPU (device: 1, name: Tesla K40c, pci bus id: 0000:03:00.0, compute capability: 3.5)
2018-09-05 15:06:00.288448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:2 with 11473 MB memory) -> physical GPU (device: 2, name: Tesla K40c, pci bus id: 0000:83:00.0, compute capability: 3.5)
2018-09-05 15:06:00.487520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1097] Created TensorFlow device (/job:worker/replica:0/task:0/device:GPU:3 with 11473 MB memory) -> physical GPU (device: 3, name: Tesla K40c, pci bus id: 0000:84:00.0, compute capability: 3.5)
2018-09-05 15:06:00.688704: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job ps -> {0 -> 10.10.10.6:2222}
2018-09-05 15:06:00.688752: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:215] Initialize GrpcChannelCache for job worker -> {0 -> localhost:3333}
2018-09-05 15:06:00.697485: I tensorflow/contrib/gdr/gdr_memory_manager.cc:254] RDMA server is listening on 10.10.10.5:3333
2018-09-05 15:06:00.697568: I tensorflow/contrib/gdr/gdr_memory_manager.cc:302] Instrumenting CPU allocator cuda_host_bfc
2018-09-05 15:06:00.697588: I tensorflow/contrib/gdr/gdr_memory_manager.cc:302] Instrumenting CPU allocator cpu_pool
2018-09-05 15:06:00.697607: I tensorflow/contrib/gdr/gdr_memory_manager.cc:302] Instrumenting CPU allocator cpu_rdma_bfc
2018-09-05 15:06:00.697830: I tensorflow/contrib/gdr/gdr_memory_manager.cc:95] NUMA node for device: mlx4_0 is 1
2018-09-05 15:06:00.734616: W tensorflow/contrib/gdr/gdr_memory_manager.cc:705] Cannot register memory region
2018-09-05 15:06:00.771893: W tensorflow/contrib/gdr/gdr_memory_manager.cc:705] Cannot register memory region
2018-09-05 15:06:00.771954: I tensorflow/contrib/gdr/gdr_memory_manager.cc:314] Instrumenting GPU allocator with bus_id 2
2018-09-05 15:06:00.772783: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:375] Started server with target: grpc://localhost:3333
```
and here is GPU topology:

```
$ nvidia-smi topo -m
        GPU0    GPU1    GPU2    GPU3    mlx4_0  CPU Affinity
GPU0     X      PHB     SYS     SYS     SYS     0-7,16-23
GPU1    PHB      X      SYS     SYS     SYS     0-7,16-23
GPU2    SYS     SYS      X      PHB     PHB     8-15,24-31
GPU3    SYS     SYS     PHB      X      PHB     8-15,24-31
mlx4_0  SYS     SYS     PHB     PHB      X

Legend:

  X    = Self
  SYS  = Connection traversing PCIe as well as the SMP interconnect between NUMA nodes (e.g., QPI/UPI)
  NODE = Connection traversing PCIe as well as the interconnect between PCIe Host Bridges within a NUMA node
  PHB  = Connection traversing PCIe as well as a PCIe Host Bridge (typically the CPU)
  PXB  = Connection traversing multiple PCIe switches (without traversing the PCIe Host Bridge)
  PIX  = Connection traversing a single PCIe switch
  NV#  = Connection traversing a bonded set of # NVLinks
```

The logs said,"" cannot register memory region"" in GPU 2 and GPU 3. Is it a bug?",True
map_fn gives colocation errors with integer typed input tensors ,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:
yes
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:
CentOS Linux release 7.4.1708
- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:
- **TensorFlow installed from (source or binary)**:
binary (pip3 install tensorflow-gpu==1.9.0)
- **TensorFlow version (use command below)**:
v1.9.0-0-g25c197e023 1.9.0
- **Python version**:
3.6.4
- **Bazel version (if compiling from source)**:
- **GCC/Compiler version (if compiling from source)**:
- **CUDA/cuDNN version**:
9.0.176
- **GPU model and memory**:
 GeForce GTX-1080 - 8GB memory
- **Exact command to reproduce**:
`python3 map_fn_GPU_error.py`

### Describe the problem
The `tf.map_fn` function raises the following error if I provide two tensors of input one of which is `tf.float32` and the other `tf.int64`. This error doesn't appear if both of them are `tf.float32`.

```
tensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation 'map/TensorArray_1': Could not satisfy explicit device specification '' because the node was colocated with a group of nodes that required incompatible device '/device:GPU:0'
Colocation Debug Info:                                                                                                     
Colocation group had the following types and devices:
TensorArrayReadV3: CPU                                                                                                    
Enter: GPU CPU                                                                        
TensorArrayV3: CPU                         
TensorArrayScatterV3: CPU                                                                                                                                      
Placeholder: GPU CPU                                                                                   
                                                           
Colocation members and user-requested devices:                   
  RaggedLengths (Placeholder) /device:GPU:0
  map/TensorArray_1 (TensorArrayV3)                                                                                                                            
  map/TensorArrayUnstack_1/TensorArrayScatter/TensorArrayScatterV3 (TensorArrayScatterV3) /device:GPU:0
  map/while/TensorArrayReadV3_1/Enter (Enter) /device:GPU:0
  map/while/TensorArrayReadV3_1 (TensorArrayReadV3) /device:GPU:0
                                                  
         [[Node: map/TensorArray_1 = TensorArrayV3[clear_after_read=true, dtype=DT_INT64, dynamic_size=false, element_shape=<unknown>, identical_element_shapes=true, tensor_array_name=""""](map/strided_slice)]]
                                                                                                                            
Caused by op 'map/TensorArray_1', defined at:
  File ""map_fn_GPU_error.py"", line 33, in <module>                                                                              
    dtype=tf.float32)                                      
  File ""/my/python/package/path/tensorflow/python/ops/functional_ops.py"", line 420, in map_fn    
    for elem in elems_flat]                    
  File ""/my/python/package/path/tensorflow/python/ops/functional_ops.py"", line 420, in <listcomp>                               
    for elem in elems_flat]                      
  File ""/my/python/package/path/tensorflow/python/ops/tensor_array_ops.py"", line 754, in __init__
    name=name)                                                           
  File ""/my/python/package/path/tensorflow/python/ops/tensor_array_ops.py"", line 160, in __init__         
    self._handle, self._flow = create()            
  File ""/my/python/package/path/tensorflow/python/ops/tensor_array_ops.py"", line 157, in create                                 
    name=scope)   
  File ""/my/python/package/path/tensorflow/python/ops/gen_data_flow_ops.py"", line 7157, in tensor_array_v3
    tensor_array_name=tensor_array_name, name=name)                  
  File ""/my/python/package/path/tensorflow/python/framework/op_def_library.py"", line 787, in _apply_op_helper
    op_def=op_def)                                                                    
  File ""/my/python/package/path/tensorflow/python/framework/ops.py"", line 3414, in create_op
    op_def=op_def)                                                                                                                                             
  File ""/my/python/package/path/tensorflow/python/framework/ops.py"", line 1740, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access    

```
This is triggered by the line
`sess.run(tf.global_variables_initializer())` in the code below. This code works perfectly on CPU however, I cannot seem to force placement on the GPU.

### Source code / logs

This is a minimal example to reproduce the above error. (This is the file named `map_fn_GPU_error.py` used in the command above)

```python
import tensorflow as tf
import numpy as np

with_gpu = True
if with_gpu:
    device_name = '/device:GPU:0'
else:
    device_name = '/device:CPU:*'

batch_size = 32
max_ragged_dim = 10
embedding_dim = 20


def ragged_function(ragged_input, length_of_input):
    # length_of_input is not used here but is in the actual function
    # The error is caused whether or not it is used
    return tf.reduce_sum(ragged_input, axis=0)


def final_loss_function(ragged_function_outputs):
    weights = tf.get_variable('LossWeights', dtype=tf.float32,
                              shape=(ragged_function_outputs.shape[1], 1))
    return tf.reduce_sum(tf.matmul(ragged_function_outputs, weights))


with tf.device(device_name):
    input_ragged_mat = tf.placeholder(name='RaggedMatrix', dtype=tf.float32,
                                      shape=(None, max_ragged_dim, embedding_dim))
    input_ragged_lengths = tf.placeholder(name='RaggedLengths', dtype=tf.int64,
                                          shape=(None,))

    ragged_function_outputs = tf.map_fn(lambda x: ragged_function(*x),
                                        [input_ragged_mat, input_ragged_lengths], 
                                        # Note that input_ragged_lengths is of type int64
                                        # This leads to an error on GPU placement
                                        dtype=tf.float32)
    final_loss = final_loss_function(ragged_function_outputs)

    optimizer = tf.train.AdamOptimizer(learning_rate=1e-3)
    train_op = optimizer.minimize(final_loss)

# Create input ragged_matrices, with zeros beyond the actual length
ragged_input_mat = np.random.random(size=(batch_size, max_ragged_dim, embedding_dim))
ragged_input_length_mat = np.random.randint(max_ragged_dim, size=(batch_size,)) + 1
for i, rlen in enumerate(ragged_input_length_mat):
    ragged_input_mat[i, rlen:max_ragged_dim] = 0

with tf.Session() as sess:
    feed_dict = {input_ragged_mat: ragged_input_mat,
                 input_ragged_lengths: ragged_input_length_mat}

    sess.run(tf.global_variables_initializer())

    print(""Calculating Final Loss"")
    sess.run([final_loss],
             feed_dict=feed_dict)
    print(""Running Train operation"")
    sess.run([train_op],
             feed_dict=feed_dict)
```",True
"""not all arguments converted during string formatting"" in rnn_cell_impl stat:contribution welcome type:bug","I believe there's a mistake in the ```BasicLSTMCell.build``` method:

```python
raise ValueError(""Expected inputs.shape[-1] to be known, saw shape: %s""
                       % inputs_shape)
```
will be called with inputs_shape being a tuple and % formatting will interpret this tuple as multiple formatting arguments. Can we change it to

```python
raise ValueError(""Expected inputs.shape[-1] to be known, saw shape: %s""
                       % (inputs_shape,))
```
?",True
TensorFlow GDR RDMA verbs compilation failure on 1.10  stat:awaiting response,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No.
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: CentOS Linux 7.4.1708
- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:
- **TensorFlow installed from (source or binary)**: source
- **TensorFlow version (use command below)**: 1.10.0
- **Python version**: 3.6
- **Bazel version (if compiling from source)**: 0.16.1
- **GCC/Compiler version (if compiling from source)**: 7.2.0
- **CUDA/cuDNN version**: 9.2.1.88
- **GPU model and memory**: nVidia Volta V100 16GB
- **Exact command to reproduce**: bazel build --cxxopt=""-D_GLIBCXX_USE_CXX11_ABI=0"" --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package

You can collect some of this information using our environment capture script:

https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh

You can obtain the TensorFlow version with

python -c ""import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)""

### Describe the problem

I attempted to compile TensorFlow 1.10.0 using RDMA/VERBS options+GDR options as I'm using an all infiniband EDR network with my Volta V100 HPC environment. The same compile-time strings for Bazel build worked correctly without this error in RC 1.0.8rc1 and this error was not thrown. I am using mvpachi2 + GNU GCC 7.2.0, CUDA 9.2.8.11 + Basel 0.16.0 at compile time. NCCL is at v 2.2.13. The error basel throws after 16xxx objects is as follows:
                                                                                                                                      ^
```
At global scope:
cc1plus: warning: unrecognized command line option '-Wno-self-assign'
ERROR: /opt/ohpc/pub/apps/tensorflow_1.10/tensorflow/BUILD:576:1: Executing genrule //tensorflow:tensorflow_python_api_gen failed (Aborted): bash failed: error executing command /bin/bash -c ... (remaining 1 argument(s) skipped)
2018-08-18 16:25:22.109083: F tensorflow/core/framework/allocator_registry.cc:52] New registration for AllocatorFactory with name=BFCRdmaAllocator priority=101 at location tensorflow/contrib/gdr/gdr_memory_manager.cc:204 conflicts with previous registration at location tensorflow/contrib/verbs/rdma_mgr.cc:277

INFO: Elapsed time: 934.788s, Critical Path: 236.40s
INFO: 13405 processes: 13405 local.
FAILED: Build did NOT complete successfully

```

### Source code / logs
The above is about all I've gotten out of it, thus far. There is no obvious compile time log output from Basel-build that I can see of use. 
",True
_UnreadVariable name property fails in TF 1.10-rc1 ,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: MacOSX 10.13.6
- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: N/A
- **TensorFlow installed from (source or binary)**: binary
- **TensorFlow version (use command below)**: v1.10.0-rc0-18-ge5e9a8f4e9 1.10.0-rc1
- **Python version**: 3.6.5
- **Bazel version (if compiling from source)**: N/A
- **GCC/Compiler version (if compiling from source)**: N/A
- **CUDA/cuDNN version**: N/A
- **GPU model and memory**: N/A
- **Exact command to reproduce**: `tfe.Variable(1).assign(2).name` in eager mode.

### Describe the problem
In eager mode, the result of an assignment is an instance of the class `tensorflow.python.ops.resource_variable_ops._UnreadVariable`. When you call its `name` property, it tries to access `self._parent_op.name`, but its `_parent_op` attribute is `None`, so there is an exception. This is a regression in TF 1.10-rc1, since it worked fine in TF 1.9.0.

### Source code / logs

```python
import tensorflow as tf
import tensorflow.contrib.eager as tfe
tf.enable_eager_execution()

tfe.Variable(1).assign(2).name
```

Outputs the following exception:

```python
Traceback (most recent call last):
  File ""<stdin>"", line 1, in <module>
  File ""/Users/ageron/.virtualenvs/ml/lib/python3.6/site-packages/tensorflow/python/ops/resource_variable_ops.py"", line 1082, in name
    return self._parent_op.name
AttributeError: 'NoneType' object has no attribute 'name'
```

Since `str()` and `repr()` use the `name` property, they fail as well. This makes it impossible to call `assign()` in a Python shell, since the shell automatically tries to display the output:

```python
>>> import tensorflow as tf
>>> import tensorflow.contrib.eager as tfe
>>> tf.enable_eager_execution()
>>> tfe.Variable(1).assign(2)
Traceback (most recent call last):
  File ""<stdin>"", line 1, in <module>
  File ""/Users/ageron/.virtualenvs/ml/lib/python3.6/site-packages/tensorflow/python/ops/variables.py"", line 264, in __repr__
    self.name, self.get_shape(), self.dtype.name,
  File ""/Users/ageron/.virtualenvs/ml/lib/python3.6/site-packages/tensorflow/python/ops/resource_variable_ops.py"", line 1082, in name
    return self._parent_op.name
AttributeError: 'NoneType' object has no attribute 'name'
```",True
tf.GradientTape.gradient raise error with tf.nn.relu6 stat:contribution welcome,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: 
- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**:
- **TensorFlow installed from (source or binary)**:
- **TensorFlow version (use command below)**: 1.10.0-rc1
- **Python version**: 3.6
- **Bazel version (if compiling from source)**:
- **GCC/Compiler version (if compiling from source)**:
- **CUDA/cuDNN version**:
- **GPU model and memory**:
- **Exact command to reproduce**:

### Describe the problem
tf.GradientTape.gradient raise error with tf.nn.relu6

### Source code / logs

```python
import tensorflow as tf

tf.enable_eager_execution()
w = tf.contrib.eager.Variable([[1.0]])
with tf.GradientTape() as tape:
    loss = tf.nn.relu6(w * w)
grad = tape.gradient(loss, w)
```

```
Traceback (most recent call last):
  File ""<stdin>"", line 1, in <module>
  File ""/usr/local/lib/python3.6/site-packages/tensorflow/python/eager/backprop.py"", line 858, in gradient
    output_gradients=output_gradients)
  File ""/usr/local/lib/python3.6/site-packages/tensorflow/python/eager/imperative_grad.py"", line 63, in imperative_grad
    tape._tape, vspace, target, sources, output_gradients)  # pylint: disable=protected-access
  File ""/usr/local/lib/python3.6/site-packages/tensorflow/python/eager/backprop.py"", line 116, in _gradient_function
    return grad_fn(mock_op, *out_grads)
  File ""/usr/local/lib/python3.6/site-packages/tensorflow/python/ops/nn_grad.py"", line 387, in _Relu6Grad
    return gen_nn_ops.relu6_grad(grad, op.outputs[0])
TypeError: 'NoneType' object is not subscriptable
```
",True
Max pooling cause error on empty batch ,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: yes
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: 3.10.0-693.2.2.el7.x86_64
- **TensorFlow installed from (source or binary)**: binary
- **TensorFlow version (use command below)**: 1.8.0
- **Python version**: Python 2.7.14 :: Anaconda
- **Bazel version (if compiling from source)**: None
- **GCC/Compiler version (if compiling from source)**: None
- **CUDA/cuDNN version**: cuda==9.0, cudnn==7.0.4
- **GPU model and memory**: None
- **Exact command to reproduce**: See below

### Describe the problem
When batch_size is 0, max pooling operation seems to produce an unhandled cudaError_t status. It may cause subsequent operations fail with odd error message. That is extremely difficult to debug.

(This corner case bothers us, where we first extract some bounding boxes and then run traditional convolution operations on areas specified by them. The above error occurs in case that no bounding boxes are detected thus batch_size becomes 0. However, the python exception will be randomly thrown at following operation or following session run steps)

```python
import tensorflow as tf
import numpy as np

x = tf.placeholder(dtype=tf.float32, shape=[None, 4, 4, 1])
pool_op = tf.nn.pool(x, pooling_type=""MAX"", window_shape=[2, 2], strides=[1, 1], padding=""SAME"")

y = tf.placeholder(dtype=tf.float32, shape=[None])
other_op = tf.where(tf.equal(y, 1.0))

normal_data = np.zeros([1, 4, 4, 1], dtype=""float32"")
empty_data = np.zeros([0, 4, 4, 1], dtype=""float32"")

# cudaError is thread local, limit thread pool size to make it easy to reproduce
config = tf.ConfigProto()
config.inter_op_parallelism_threads = 1
with tf.Session(config=config) as sess:
    # run other_op success
    print sess.run(other_op, {y: [1.0, 2.0, 3.0, 4.0]})  # [[0]]

    # run pooling on datas success
    print sess.run(pool_op, {x: normal_data}).shape  # (1, 4, 4, 1)
    print sess.run(pool_op, {x: empty_data}).shape  # (0, 4, 4, 1)

    # run other_op now failed
    print sess.run(other_op, {y: [1.0, 2.0, 3.0, 4.0]})  # err
``` 

Above code report error:
tensorflow.python.framework.errors_impl.InternalError: WhereOp: Could not launch cub::DeviceReduce::Sum to count number of true / nonzero indices.  temp_storage_bytes: 1, status: invalid configuration argument

""invalid configuration argument"" seems to be message return by cudaGetError, which indicates a failed kernel launch due to zero or too large number of block threads.

### Source code / logs
![image](https://user-images.githubusercontent.com/7600935/43579974-6dd4967a-9686-11e8-9b22-8288159d155c.png)

",True
Default floating point values in single_image_random_dot_stereograms_ops.cc cause syntax error stat:contribution welcome,"Have I written custom code: yes
OS Platform and Distribution: Ubuntu 18.04
TensorFlow installed from: origin master
TensorFlow version: 1.9
Bazel version 0.15.2
CUDA/cuDNN version: 9.1/7.1
GPU model and memory:  NVIDIA-SMI 390.48
Exact command to reproduce: use code below in python3 script 
Mobile device: N/A
     
     import tensorflow as tf
      vol = tf.contrib.util.make_tensor_proto([256, 256])

Import of /localhome/local/projects/lme_custom_ops/tensorflow/contrib/image/__init__.py causes syntax error on my system (see issue https://github.com/tensorflow/serving/issues/421).

    Traceback (most recent call last):
    File ""main.py"", line 6, in <module>
        import geometry as geometry
    File ""/localhome/local/projects/deep-iterative-reco/geometry.py"", line 20, in <module>
        volume_origin = tf.contrib.util.make_tensor_proto([-((_volume_xy-1)/2 * _volume_spacing),-((_volume_xy-1)/2 * _volume_spacing)], tf.float32 )
    File ""/usr/local/lib/python3.6/dist-packages/tensorflow/python/util/lazy_loader.py"", line 53, in __getattr__
        module = self._load()
    File ""/usr/local/lib/python3.6/dist-packages/tensorflow/python/util/lazy_loader.py"", line 42, in _load
        module = importlib.import_module(self.__name__)
    File ""/usr/lib/python3.6/importlib/__init__.py"", line 126, in import_module
        return _bootstrap._gcd_import(name[level:], package, level)
    File ""/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/__init__.py"", line 48, in <module>
        from tensorflow.contrib import image
    File ""/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/image/__init__.py"", line 70, in <module>
        from tensorflow.contrib.image.python.ops.single_image_random_dot_stereograms import single_image_random_dot_stereograms
    File ""/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/image/python/ops/single_image_random_dot_stereograms.py"", line 27, in <module>
        ""_single_image_random_dot_stereograms.so""))
    File ""/usr/local/lib/python3.6/dist-packages/tensorflow/contrib/util/loader.py"", line 56, in load_op_library
        ret = load_library.load_op_library(path)
    File ""/usr/local/lib/python3.6/dist-packages/tensorflow/python/framework/load_library.py"", line 73, in load_op_library
        exec(wrappers, module.__dict__)
    File ""<string>"", line 28
        def single_image_random_dot_stereograms(depth_values, hidden_surface_removal=True, convergence_dots_size=8, dots_per_inch=72, eye_separation=3, mu=0,333299994, normalize=True, normalize_max=-100, normalize_min=100, border_level=0, number_colors=256, output_image_shape=[1024, 768, 1], output_data_window=[1022, 757], name=None):
                                                                                                                                                                    ^
    SyntaxError: invalid syntax

Works again if I change the default kwargs float arguments to integer values. Reason maybe localization option (I am from Germany which uses , to indicate decimal point. E.g. 1.2 == 1,2 in Germany). Though I think I am using the US standard.

Using this code in /tensorflow/contrib/image/ops/single_image_random_dot_stereograms_ops.cc solves the problem (not using floating values).

    REGISTER_OP( ""SingleImageRandomDotStereograms"" )
        .Attr( ""T: {double,float,int64,int32}"" )
        .Input( ""depth_values: T"" )
        .Output( ""image: uint8"" )
        .Attr( ""hidden_surface_removal: bool = true"" )
        .Attr( ""convergence_dots_size: int = 8"" )
        .Attr( ""dots_per_inch: int = 72"" )
        .Attr( ""eye_separation: float = 3"" )
        .Attr( ""mu: float = 3333"" )
        .Attr( ""normalize: bool = true"" )
        .Attr( ""normalize_max: float = -100.0"" )
        .Attr( ""normalize_min: float = 100.0"" )
        .Attr( ""border_level: float = 0.0"" )
        .Attr( ""number_colors: int = 256"" )


On python2 executing the following...  

      Python 2.7.15rc1 (default, Apr 15 2018, 21:51:34) 
      [GCC 7.3.0] on linux2
      Type ""help"", ""copyright"", ""credits"" or ""license"" for more information.
      >>> import locale
      >>> locale.setlocale(locale.LC_ALL, '')
            'LC_CTYPE=en_US.UTF-8;LC_NUMERIC=de_DE.UTF-8;LC_TIME=de_DE.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=de_DE.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=de_DE.UTF-8;LC_NAME=de_DE.UTF-8;LC_ADDRESS=de_DE.UTF-8;LC_TELEPHONE=de_DE.UTF-8;LC_MEASUREMENT=de_DE.UTF-8;LC_IDENTIFICATION=de_DE.UTF-8'

Though I compiled for python3:

    Python 3.6.5 (default, Apr  1 2018, 05:46:30) 
    Type ""copyright"", ""credits"" or ""license"" for more information.

    IPython 5.5.0 -- An enhanced Interactive Python.
    ?         -> Introduction and overview of IPython's features.
    %quickref -> Quick reference.
    help      -> Python's own help system.
    object?   -> Details about 'object', use 'object??' for extra details.

    In [1]: 
    ...: 
    ...: import locale

    In [2]: locale.localeconv()
    Out[2]: 
    {'currency_symbol': '',
    'decimal_point': '.',
    'frac_digits': 127,
    'grouping': [],
    'int_curr_symbol': '',
    'int_frac_digits': 127,
    'mon_decimal_point': '',
    'mon_grouping': [],
    'mon_thousands_sep': '',
    'n_cs_precedes': 127,
    'n_sep_by_space': 127,
    'n_sign_posn': 127,
    'negative_sign': '',
    'p_cs_precedes': 127,
    'p_sep_by_space': 127,
    'p_sign_posn': 127,
    'positive_sign': '',
    'thousands_sep': ''}

I am using tensorflow revision 6d71d3fc659b317a38586f71ae94410ad3261f55 on Ubuntu 18.08. cuDNN 7.1, CUDA 9.1

This seems to be related: https://github.com/tensorflow/tensorflow/issues/2974",True
[Bug] tf.py_func : Bad tensor -> np.array conversion in py_func (return [] with dtype=int64 is returned as dtype=float64)  stat:contribution welcome type:bug,"### Issue template:

- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes (minimal example attached inline)
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Mac OSX 10.12.6
- **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue happens on mobile device**: Probably
- **TensorFlow installed from (source or binary)**: Binary
- **TensorFlow version (use command below)**: ('v1.5.0-0-g37aa430d84', '1.5.0')
- **Python version**: 2.7
- **Bazel version (if compiling from source)**: N/A
- **GCC/Compiler version (if compiling from source)**: N/A
- **CUDA/cuDNN version**: N/A
- **GPU model and memory**: N/A
- **Exact command to reproduce**: `python py_func_failure.py`

### Describe the problem

This bug occurs when a `tf.py_func` returns an empty python list `[]` which is intended to be a tensor of type `tf.int64` (as defined in the `Tout=` of the `py_func`). 

In the `ops.script_ops.py` the `_convert` static method is unable to tell the `numpy dtype` of the incoming tensor when it is an empty list.  This causes the `_convert` method to execute a `np.asarray([], dtype=None, order=""C"")` which gives us a `array([], dtype=float64)` instead of a `array([], dtype=int64)` which then does not agree with the output tensor description in the py_func. 

### Source code / logs

See gist here for the example that reproduces this issue: https://gist.githubusercontent.com/sabhiram/3f5eaf7e566ef9aefb3ae6e5b8d2edb0/raw/182ab6bc72b5b7b13fd55964c72030cbc53f7cb3/py_func_failure.py

Inlined here:
```
import tensorflow as tf

def test_func(x):
    """""" Builds a list of ints with length `x`.
    """"""
    return [i for i in range(x)],


def main():
    t0 = tf.constant(0, dtype=tf.int64)
    t0 = tf.py_func(test_func, [t0], tf.int64)

    t1 = tf.constant(1, dtype=tf.int64)
    t1 = tf.py_func(test_func, [t1], tf.int64)

    with tf.Session() as sess:
        sess.run(t1)            # OK
        sess.run(t0)            # 0-th value is double, expects int64

if __name__ == ""__main__"":
    print(tf.GIT_VERSION, tf.VERSION)
    main()
```",True
bug about boosted_trees stat:awaiting response,"In tensorflow 1.9 , win10, python36,  I run the example ""tensorflow-master\tensorflow\contrib\boosted_trees\examples\boston.py"", report :

  File ""<ipython-input-1-0c2875deaba9>"", line 6, in <module>
    from tensorflow.contrib.boosted_trees.estimator_batch import custom_export_strategy

  File ""D:\ProgramFiles\Anaconda3\lib\site-packages\tensorflow\contrib\boosted_trees\estimator_batch\custom_export_strategy.py"", line 25, in <module>
    from tensorflow.contrib.boosted_trees.python.training.functions import gbdt_batch

  File ""D:\ProgramFiles\Anaconda3\lib\site-packages\tensorflow\contrib\boosted_trees\python\training\functions\gbdt_batch.py"", line 26, in <module>
    from tensorflow.contrib.boosted_trees.lib.learner.batch import categorical_split_handler

ModuleNotFoundError: No module named 'tensorflow.contrib.boosted_trees.lib'
++++++++++++++++++++++++++++++++++++++++++++++
And when use tensorflow 1.8 ,python 36 ,centos5 or win10, run the same example ""tensorflow-master\tensorflow\contrib\boosted_trees\examples\boston.py"", report :
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/learn_runner.py"", line 225, in run
    return _execute_schedule(experiment, schedule)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/learn_runner.py"", line 52, in _execute_schedule
    return task()
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py"", line 666, in train_and_evaluate
    self.train(delay_secs=0)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py"", line 389, in train
    saving_listeners=self._saving_listeners)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py"", line 879, in _call_train
    input_fn=input_fn, steps=steps, max_steps=max_steps, monitors=hooks)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py"", line 432, in new_func
    return func(*args, **kwargs)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py"", line 524, in fit
    loss = self._train_model(input_fn=input_fn, hooks=hooks)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py"", line 1080, in _train_model
    scaffold=scaffold)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/python/training/basic_session_run_hooks.py"", line 421, in __init__
    self._save_path = os.path.join(checkpoint_dir, checkpoint_basename)
  File ""/usr/local/python36/lib/python3.6/posixpath.py"", line 92, in join
    genericpath._check_arg_types('join', a, *p)
  File ""/usr/local/python36/lib/python3.6/genericpath.py"", line 151, in _check_arg_types
    raise TypeError(""Can't mix strings and bytes in path components"") from None
TypeError: Can't mix strings and bytes in path components
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++
and  I run other example again ,""tensorflow-master\tensorflow\contrib\boosted_trees\examples\mnist.py"" ,report:

  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/learn_runner.py"", line 225, in run
    return _execute_schedule(experiment, schedule)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/learn_runner.py"", line 52, in _execute_schedule
    return task()
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py"", line 666, in train_and_evaluate
    self.train(delay_secs=0)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py"", line 389, in train
    saving_listeners=self._saving_listeners)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/experiment.py"", line 879, in _call_train
    input_fn=input_fn, steps=steps, max_steps=max_steps, monitors=hooks)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py"", line 432, in new_func
    return func(*args, **kwargs)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py"", line 524, in fit
    loss = self._train_model(input_fn=input_fn, hooks=hooks)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py"", line 1041, in _train_model
    model_fn_ops = self._get_train_ops(features, labels)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py"", line 1264, in _get_train_ops
    return self._call_model_fn(features, labels, model_fn_lib.ModeKeys.TRAIN)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/estimators/estimator.py"", line 1227, in _call_model_fn
    model_fn_results = self._model_fn(features, labels, **kwargs)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/boosted_trees/estimator_batch/model.py"", line 116, in model_builder
    logits=logits)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/estimators/head.py"", line 1085, in create_model_fn_ops
    enable_centered_bias=self._enable_centered_bias)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/estimators/head.py"", line 669, in _create_model_fn_ops
    batch_size, loss_fn, weight_tensor)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/learn/python/learn/estimators/head.py"", line 1944, in _train_op
    train_op = train_op_fn(loss)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/boosted_trees/estimator_batch/model.py"", line 105, in _train_op_fn
    update_op = gbdt_model.train(loss, predictions_dict, labels)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/boosted_trees/python/training/functions/gbdt_batch.py"", line 696, in train
    control_flow_ops.no_op))
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py"", line 432, in new_func
    return func(*args, **kwargs)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py"", line 2063, in cond
    orig_res_t, res_t = context_t.BuildCondBranch(true_fn)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/python/ops/control_flow_ops.py"", line 1913, in BuildCondBranch
    original_result = fn()
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/boosted_trees/python/training/functions/gbdt_batch.py"", line 932, in _update_bias_stats
    ensemble_stamp, partition_ids, feature_ids, grads_sum, hess_sum)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/boosted_trees/python/ops/stats_accumulator_ops.py"", line 117, in add
    partition_ids, feature_ids, gradients, hessians))
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/boosted_trees/python/ops/stats_accumulator_ops.py"", line 154, in _make_summary
    partition_ids, feature_ids, gradients, hessians)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/contrib/boosted_trees/python/ops/gen_stats_accumulator_ops.py"", line 1232, in stats_accumulator_tensor_make_summary
    name=name)
  File ""/usr/local/python36/bin/tensor/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py"", line 533, in _apply_op_helper
    (prefix, dtypes.as_dtype(input_arg.type).name))
TypeError: Input 'partition_ids' of 'StatsAccumulatorTensorMakeSummary' Op has type int64 that does not match expected type of int32.
",True
bug in tf.Print summarized formatting ,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: YES
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: MacOS
- **TensorFlow installed from (source or binary)**: binary
- **TensorFlow version (use command below)**: 1.8
- **Python version**: 3.6
- **Bazel version (if compiling from source)**: N/A
- **GCC/Compiler version (if compiling from source)**: N/A
- **CUDA/cuDNN version**: N/A
- **GPU model and memory**: N/A
- **Exact command to reproduce**: N/A

If you print a tensor of shape [n, 4] with tf.Print, by default (summarize=3 is the default value), you get:

[[9 21 55]...]

which wrongly looks like your tensor is of shape [n, 3].

The correct output should be:

[[9 21 55...]...]

Here is what you get with tf.Print(summarize=10):

[[9 21 55 30][190 -42 236 4][89 -5]...]

Now the vectors of size 4 are visible although the last one is still wrong (looks like a vector of size 2
)",True
Character access is not supported in tf.contrib.autograph stat:contribution welcome,"For example this is not working and it returns an error
```
@autograph.convert()
def is_hashtag(x):
  if x[0] == ""#"":
    return True
  return False

with tf.Graph().as_default():  
  with tf.Session() as sess:
    print(sess.run(is_hashtag(tf.constant(""#asdf""))))
```",True
please change allocation.cc line 102 copied_buffer_ = std::move(buffer); stat:contribution welcome comp:lite,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:
CentOS 6.9 
- **TensorFlow installed from (source or binary)**:
source
- **TensorFlow version (use command below)**:
1.9.0-rc2
- **Python version**: 
3.6.2
- **Bazel version (if compiling from source)**:
0.14.1
- **GCC/Compiler version (if compiling from source)**:
gcc 6.2.0
- **CUDA/cuDNN version**:
cuda 9.0 and cudnn 7.1.1
- **GPU model and memory**:
NVIDIA K80 (12GB/GPU) and P100(16GB/GPU)
- **Exact command to reproduce**:
>   exec env - \
>     CUDA_TOOLKIT_PATH=/apps/cuda/9.0 \
>     CUDNN_INSTALL_PATH=/apps/cudnn/7.1.1-cuda9.0 \
>     GCC_HOST_COMPILER_PATH=/apps/gcc/6.2.0/wrapper/gcc \
>     LD_LIBRARY_PATH=/apps/gcc/6.2.0/lib/gcc/x86_64-pc-linux-gnu/6.2.0:/apps/gcc/6.2.0/lib64:/apps/nccl/2.2.13-cuda9.0/lib:/apps/openmpi/3.1.0/lib:/apps/openmpi/3.1.0/lib/profilers:/apps/intel-ct/17.0.1.132/mkl/lib/intel64:/apps/python3/3.6.2/lib:/apps/binutils/2.25/lib:/apps/java/jdk1.8.0_60/lib:/apps/cudnn/7.1.1-cuda9.0/lib64:/apps/cuda/9.0/extras/CUPTI/lib64:/apps/cuda/9.0/lib64 \
>     NCCL_INSTALL_PATH=/apps/nccl/2.2.13-cuda9.0 \
>     PATH=/apps/gcc/6.2.0/wrapper:/apps/gcc/6.2.0/bin:/apps/openmpi/wrapper/fortran:/apps/openmpi/3.1.0/bin:/apps/python3/3.6.2/bin:/apps/binutils/2.25/bin:/apps/bazel/0.14.1/bin:/apps/java/jdk1.8.0_60/bin:/apps/cuda/9.0/bin:/home/900/yxs900/.local/bin:/opt/bin:/bin:/usr/bin \
>     PWD=/proc/self/cwd \
>     PYTHON_BIN_PATH=/apps/python3/3.6.2/bin/python3 \
>     PYTHON_LIB_PATH=/apps/python3/3.6.2/lib/python3.6/site-packages \
>     TF_CUDA_CLANG=0 \
>     TF_CUDA_COMPUTE_CAPABILITIES=3.7,6.0 \
>     TF_CUDA_VERSION=9.0 \
>     TF_CUDNN_VERSION=7 \
>     TF_NCCL_VERSION=2 \
>     TF_NEED_CUDA=1 \
>     TF_NEED_OPENCL_SYCL=0 \
>   external/local_config_cuda/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -MD -MF bazel-out/k8-opt/bin/tensorflow/contrib/lite/_objs/framework/tensorflow/contrib/lite/allocation.pic.d '-frandom-seed=bazel-out/k8-opt/bin/tensorflow/contrib/lite/_objs/framework/tensorflow/contrib/lite/allocation.pic.o' -DEIGEN_MPL2_ONLY '-DEIGEN_MAX_ALIGN_BYTES=64' -iquote . -iquote bazel-out/k8-opt/genfiles -iquote external/bazel_tools -iquote bazel-out/k8-opt/genfiles/external/bazel_tools -iquote external/eigen_archive -iquote bazel-out/k8-opt/genfiles/external/eigen_archive -iquote external/local_config_sycl -iquote bazel-out/k8-opt/genfiles/external/local_config_sycl -iquote external/gemmlowp -iquote bazel-out/k8-opt/genfiles/external/gemmlowp -iquote external/flatbuffers -iquote bazel-out/k8-opt/genfiles/external/flatbuffers -isystem third_party/eigen3/mkl_include -isystem bazel-out/k8-opt/genfiles/third_party/eigen3/mkl_include -isystem bazel-out/k8-opt/bin/third_party/eigen3/mkl_include -isystem external/eigen_archive -isystem bazel-out/k8-opt/genfiles/external/eigen_archive -isystem bazel-out/k8-opt/bin/external/eigen_archive -isystem tensorflow/contrib/lite/schema -isystem bazel-out/k8-opt/genfiles/tensorflow/contrib/lite/schema -isystem bazel-out/k8-opt/bin/tensorflow/contrib/lite/schema -isystem external/flatbuffers/include -isystem bazel-out/k8-opt/genfiles/external/flatbuffers/include -isystem bazel-out/k8-opt/bin/external/flatbuffers/include '-std=c++11' -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -fPIC -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -fno-omit-frame-pointer -no-canonical-prefixes -DNDEBUG -g0 -O2 -ffunction-sections -fdata-sections '-D_GLIBCXX_USE_CXX11_ABI=0' '-march=native' -DFARMHASH_NO_CXX_STRING -c tensorflow/contrib/lite/allocation.cc -o bazel-out/k8-opt/bin/tensorflow/contrib/lite/_objs/framework/tensorflow/contrib/lite/allocation.pic.o


### Describe the problem
Describe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.

The build stops because the variables buffer and copied_buffer have different types,  char*& and const char*&, respectively, and std::swap expects identical types of their inputs and code found no candidate for std::swap, see details in the error message below. Simply change line 102 in tensorflow/contrib/lite/allocation.cc {{ copied_buffer_ = std::move(buffer); }} to {{copied_buffer_.reset(const_cast<char const *>(buffer.release()));}} fix the bug.

### Source code / logs
tensorflow/contrib/lite/allocation.cc:102:36:   required from here
/apps/gcc/6.2.0/include/c++/6.2.0/bits/unique_ptr.h:614:6: error: no matching function for call to 'swap(const char*&, char*&)'
  swap(std::get<0>(_M_t), __p);
  ~~~~^~~~~~~~~~~~~~~~~~~~~~~~
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_pair.h:59:0,
                 from /apps/gcc/6.2.0/include/c++/6.2.0/utility:70,
                 from tensorflow/contrib/lite/allocation.cc:27:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/move.h:179:5: note: candidate: template<class _Tp> typename std::enable_if<std::__and_<std::is_move_constructible<_Tp>, std::is_move_assignable<_Tp> >::value>::type std::swap(_Tp&, _Tp&)
     swap(_Tp& __a, _Tp& __b)
     ^~~~
/apps/gcc/6.2.0/include/c++/6.2.0/bits/move.h:179:5: note:   template argument deduction/substitution failed:
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/memory:81:0,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:19,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/unique_ptr.h:614:6: note:   deduced conflicting types for parameter '_Tp' ('const char*' and 'char*')
  swap(std::get<0>(_M_t), __p);
  ~~~~^~~~~~~~~~~~~~~~~~~~~~~~
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_pair.h:59:0,
                 from /apps/gcc/6.2.0/include/c++/6.2.0/utility:70,
                 from tensorflow/contrib/lite/allocation.cc:27:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/move.h:202:5: note: candidate: template<class _Tp, long unsigned int _Nm> typename std::enable_if<std::__is_swappable<_Tp>::value>::type std::swap(_Tp (&)[_Nm], _Tp (&)[_Nm])
     swap(_Tp (&__a)[_Nm], _Tp (&__b)[_Nm])
     ^~~~
/apps/gcc/6.2.0/include/c++/6.2.0/bits/move.h:202:5: note:   template argument deduction/substitution failed:
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/memory:81:0,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:19,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/unique_ptr.h:614:6: note:   mismatched types '_Tp [_Nm]' and 'std::__tuple_element_t<0ul, std::tuple<const char*, std::default_delete<const char []> > > {aka const char*}'
  swap(std::get<0>(_M_t), __p);
  ~~~~^~~~~~~~~~~~~~~~~~~~~~~~
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/utility:70:0,
                 from tensorflow/contrib/lite/allocation.cc:27:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_pair.h:403:5: note: candidate: template<class _T1, class _T2> void std::swap(std::pair<_T1, _T2>&, std::pair<_T1, _T2>&)
     swap(pair<_T1, _T2>& __x, pair<_T1, _T2>& __y)
     ^~~~
/apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_pair.h:403:5: note:   template argument deduction/substitution failed:
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/memory:81:0,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:19,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/unique_ptr.h:614:6: note:   mismatched types 'std::pair<_T1, _T2>' and 'std::__tuple_element_t<0ul, std::tuple<const char*, std::default_delete<const char []> > > {aka const char*}'
  swap(std::get<0>(_M_t), __p);
  ~~~~^~~~~~~~~~~~~~~~~~~~~~~~
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/vector:64:0,
                 from ./tensorflow/contrib/lite/allocation.h:22,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_vector.h:1557:5: note: candidate: template<class _Tp, class _Alloc> void std::swap(std::vector<_Tp, _Alloc>&, std::vector<_Tp, _Alloc>&)
     swap(vector<_Tp, _Alloc>& __x, vector<_Tp, _Alloc>& __y)
     ^~~~
/apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_vector.h:1557:5: note:   template argument deduction/substitution failed:
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/memory:81:0,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:19,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/unique_ptr.h:614:6: note:   mismatched types 'std::vector<_Tp, _Alloc>' and 'std::__tuple_element_t<0ul, std::tuple<const char*, std::default_delete<const char []> > > {aka const char*}'
  swap(std::get<0>(_M_t), __p);
  ~~~~^~~~~~~~~~~~~~~~~~~~~~~~
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/vector:65:0,
                 from ./tensorflow/contrib/lite/allocation.h:22,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_bvector.h:112:3: note: candidate: void std::swap(std::_Bit_reference, std::_Bit_reference)
   swap(_Bit_reference __x, _Bit_reference __y) noexcept
   ^~~~
/apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_bvector.h:112:3: note:   no known conversion for argument 1 from 'std::__tuple_element_t<0ul, std::tuple<const char*, std::default_delete<const char []> > > {aka const char*}' to 'std::_Bit_reference'
/apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_bvector.h:120:3: note: candidate: void std::swap(std::_Bit_reference, bool&)
   swap(_Bit_reference __x, bool& __y) noexcept
   ^~~~
/apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_bvector.h:120:3: note:   no known conversion for argument 1 from 'std::__tuple_element_t<0ul, std::tuple<const char*, std::default_delete<const char []> > > {aka const char*}' to 'std::_Bit_reference'
/apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_bvector.h:128:3: note: candidate: void std::swap(bool&, std::_Bit_reference)
   swap(bool& __x, _Bit_reference __y) noexcept
   ^~~~
/apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_bvector.h:128:3: note:   no known conversion for argument 2 from 'char*' to 'std::_Bit_reference'
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/list:63:0,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:18,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_list.h:1918:5: note: candidate: template<class _Tp, class _Alloc> void std::swap(std::list<_Tp, _Alloc>&, std::list<_Tp, _Alloc>&)
     swap(list<_Tp, _Alloc>& __x, list<_Tp, _Alloc>& __y)
     ^~~~
/apps/gcc/6.2.0/include/c++/6.2.0/bits/stl_list.h:1918:5: note:   template argument deduction/substitution failed:
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/memory:81:0,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:19,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/unique_ptr.h:614:6: note:   mismatched types 'std::list<_Tp, _Alloc>' and 'std::__tuple_element_t<0ul, std::tuple<const char*, std::default_delete<const char []> > > {aka const char*}'
  swap(std::get<0>(_M_t), __p);
  ~~~~^~~~~~~~~~~~~~~~~~~~~~~~
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/string:52:0,
                 from /apps/gcc/6.2.0/include/c++/6.2.0/stdexcept:39,
                 from /apps/gcc/6.2.0/include/c++/6.2.0/array:39,
                 from /apps/gcc/6.2.0/include/c++/6.2.0/tuple:39,
                 from /apps/gcc/6.2.0/include/c++/6.2.0/functional:55,
                 from /apps/gcc/6.2.0/include/c++/6.2.0/memory:79,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:19,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/basic_string.h:5287:5: note: candidate: template<class _CharT, class _Traits, class _Alloc> void std::swap(std::basic_string<_CharT, _Traits, _Alloc>&, std::basic_string<_CharT, _Traits, _Alloc>&)
     swap(basic_string<_CharT, _Traits, _Alloc>& __lhs,
     ^~~~
/apps/gcc/6.2.0/include/c++/6.2.0/bits/basic_string.h:5287:5: note:   template argument deduction/substitution failed:
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/memory:81:0,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:19,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/unique_ptr.h:614:6: note:   mismatched types 'std::basic_string<_CharT, _Traits, _Alloc>' and 'std::__tuple_element_t<0ul, std::tuple<const char*, std::default_delete<const char []> > > {aka const char*}'
  swap(std::get<0>(_M_t), __p);
  ~~~~^~~~~~~~~~~~~~~~~~~~~~~~
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/tuple:39:0,
                 from /apps/gcc/6.2.0/include/c++/6.2.0/functional:55,
                 from /apps/gcc/6.2.0/include/c++/6.2.0/memory:79,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:19,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/array:275:5: note: candidate: template<class _Tp, long unsigned int _Nm> void std::swap(std::array<_Tp, _Nm>&, std::array<_Tp, _Nm>&)
     swap(array<_Tp, _Nm>& __one, array<_Tp, _Nm>& __two)
     ^~~~
/apps/gcc/6.2.0/include/c++/6.2.0/array:275:5: note:   template argument deduction/substitution failed:
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/memory:81:0,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:19,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/unique_ptr.h:614:6: note:   mismatched types 'std::array<_Tp, _Nm>' and 'std::__tuple_element_t<0ul, std::tuple<const char*, std::default_delete<const char []> > > {aka const char*}'
  swap(std::get<0>(_M_t), __p);
  ~~~~^~~~~~~~~~~~~~~~~~~~~~~~
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/functional:55:0,
                 from /apps/gcc/6.2.0/include/c++/6.2.0/memory:79,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:19,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/tuple:1546:5: note: candidate: template<class ... _Elements> void std::swap(std::tuple<_Elements ...>&, std::tuple<_Elements ...>&)
     swap(tuple<_Elements...>& __x, tuple<_Elements...>& __y)
     ^~~~
/apps/gcc/6.2.0/include/c++/6.2.0/tuple:1546:5: note:   template argument deduction/substitution failed:
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/memory:81:0,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:19,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/unique_ptr.h:614:6: note:   mismatched types 'std::tuple<_Elements ...>' and 'std::__tuple_element_t<0ul, std::tuple<const char*, std::default_delete<const char []> > > {aka const char*}'
  swap(std::get<0>(_M_t), __p);
  ~~~~^~~~~~~~~~~~~~~~~~~~~~~~
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/memory:79:0,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:19,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/functional:2238:5: note: candidate: template<class _Res, class ... _Args> void std::swap(std::function<_Res(_ArgTypes ...)>&, std::function<_Res(_ArgTypes ...)>&)
     swap(function<_Res(_Args...)>& __x, function<_Res(_Args...)>& __y)
     ^~~~
/apps/gcc/6.2.0/include/c++/6.2.0/functional:2238:5: note:   template argument deduction/substitution failed:
In file included from /apps/gcc/6.2.0/include/c++/6.2.0/memory:81:0,
                 from ./tensorflow/contrib/lite/simple_memory_arena.h:19,
                 from ./tensorflow/contrib/lite/allocation.h:25,
                 from tensorflow/contrib/lite/allocation.cc:29:
/apps/gcc/6.2.0/include/c++/6.2.0/bits/unique_ptr.h:614:6: note:   mismatched types 'std::function<_Res(_ArgTypes ...)>' and 'std::__tuple_element_t<0ul, std::tuple<const char*, std::default_delete<const char []> > > {aka const char*}'
  swap(std::get<0>(_M_t), __p);
  ~~~~^~~~~~~~~~~~~~~~~~~~~~~~


",True
Validate variable dtype before restoring checkpoint stat:contribution welcome,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: [Yes](https://stackoverflow.com/questions/51137417/wrong-output-for-restored-variable-in-tensorflow-graph)
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu
- **TensorFlow installed from (source or binary)**: binary
- **TensorFlow version (use command below)**: 1.10.0-dev20180620
- **Python version**:  2.7
- **Bazel version (if compiling from source)**: N/A
- **GCC/Compiler version (if compiling from source)**: N/A
- **CUDA/cuDNN version**: 9.0 / 7
- **GPU model and memory**: GeForce GTX 1080 / 8 Gb
- **Exact command to reproduce**: Run the two scripts below in ""Source code/logs""

### Describe the problem
A warning/error should be raised when a variable is loaded with a different dtype as that which was saved. 

In the code below, the variable `global_step` is saved as a `tf.int32`, but treated as a `tf.float32` when restored. When this happens, the `global_step` variable appears to have a value of 7e-45 instead of the expected value of 5. 

### Source code / logs
 [Link to Stackoverflow Post with the code/question](https://stackoverflow.com/questions/51137417/wrong-output-for-restored-variable-in-tensorflow-graph)

[Original post copied here]
**Script that saves the checkpoints:**

    import tensorflow as tf

    a = tf.Variable(3.0, name='a')
    b = tf.Variable(5.0, name='b')
    
    b = tf.assign_add(b, a)
    
    n_steps = 5
    
    global_step = tf.Variable(0, name='global_step', trainable=False)
    
    saver = tf.train.Saver()
    
    with tf.Session() as sess:
    
        sess.run(tf.global_variables_initializer())
        
        for step in range(n_steps):
            print(sess.run(b))
    
            global_step.assign_add(1).eval()
            print(global_step.eval())
    
            saver.save(sess, './my_test_model', global_step=global_step)

**Script that restores checkpoint:**

    import tensorflow as tf
    
    from tensorflow.python.tools.inspect_checkpoint import print_tensors_in_checkpoint_file
    
    # List ALL tensors.
    print_tensors_in_checkpoint_file(tf.train.latest_checkpoint('./'), all_tensors=True, tensor_name='')
    
    tf.reset_default_graph()
    
    a = tf.get_variable('a', shape=[])
    b = tf.get_variable('b', shape=[])
    global_step = tf.get_variable('global_step', shape=[])
    
    saver = tf.train.Saver()
    
    with tf.Session() as sess:
            
        ckpt = tf.train.latest_checkpoint('./')
        if ckpt:
            print(ckpt)
        
            saver.restore(sess, ckpt)
        
        else:
            print('Nothing restored')
        
        print(a.eval())
        print(b.eval())
        print(global_step.eval())

**Output**
```
tensor_name:  a
3.0
tensor_name:  b
20.0
tensor_name:  global_step
5
./my_test_model-5
INFO:tensorflow:Restoring parameters from ./my_test_model-5
3.0
20.0
7e-45
```

",True
comparison between signed and unsigned integer stat:contribution welcome,"### System information
No need. It is about comparison warning happening in cc/framework/ops.h
ops.h:153:27: error: comparison between signed and unsigned integer expressions [-Werror=sign-compare]
       if (t.NumElements() != v.size()) {
                            
cc1plus: all warnings being treated as errors

Unfortunately, due to policy out of my control, 
I cannot change the compiler option to treat warning as an error. 
I hope this to be fixed so that I can compile.

### Describe the problem
Same as above.
### Source code / logs
tensorflow/cc/framework/ops.h
",True
ppc64le: //tensorflow/contrib/lite/kernels:resize_bilinear_test test fails CPU test stat:community support comp:lite,"Please assign this issue to me and add the tag: stat:community support

### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: ppc64le Ubuntu 16.04.4
- **TensorFlow installed from (source or binary)**: Source
- **TensorFlow version (use command below)**: master from June 27th
- **Python version**: 2.7.12
- **Bazel version (if compiling from source)**: 0.11.0
- **GCC/Compiler version (if compiling from source)**: N/A
- **CUDA/cuDNN version**: N/A
- **GPU model and memory**: N/A
- **Exact command to reproduce**:
bazel test -c opt --cache_test_results=no //tensorflow/contrib/lite/kernels:resize_bilinear_test


### Describe the problem
```
FAIL: //tensorflow/contrib/lite/kernels:resize_bilinear_test (see /root/.cache/bazel/_bazel_root/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/ppc-opt/testlogs/tensorflow/contrib/lite/kernels/resize_bilinear_test/test.log)
INFO: From Testing //tensorflow/contrib/lite/kernels:resize_bilinear_test:
==================== Test output for //tensorflow/contrib/lite/kernels:resize_bilinear_test:
[==========] Running 10 tests from 1 test case.
[----------] Global test environment set-up.
[----------] 10 tests from ResizeBilinearOpTest
[ RUN      ] ResizeBilinearOpTest.HorizontalResize
[       OK ] ResizeBilinearOpTest.HorizontalResize (0 ms)
[ RUN      ] ResizeBilinearOpTest.HorizontalResize8Bit
[       OK ] ResizeBilinearOpTest.HorizontalResize8Bit (0 ms)
[ RUN      ] ResizeBilinearOpTest.VerticalResize
[       OK ] ResizeBilinearOpTest.VerticalResize (0 ms)
[ RUN      ] ResizeBilinearOpTest.VerticalResize8Bit
[       OK ] ResizeBilinearOpTest.VerticalResize8Bit (0 ms)
[ RUN      ] ResizeBilinearOpTest.TwoDimensionalResize
[       OK ] ResizeBilinearOpTest.TwoDimensionalResize (0 ms)
[ RUN      ] ResizeBilinearOpTest.TwoDimensionalResize8Bit
[       OK ] ResizeBilinearOpTest.TwoDimensionalResize8Bit (1 ms)
[ RUN      ] ResizeBilinearOpTest.TwoDimensionalResizeWithTwoBatches
[       OK ] ResizeBilinearOpTest.TwoDimensionalResizeWithTwoBatches (0 ms)
[ RUN      ] ResizeBilinearOpTest.ThreeDimensionalResize
[       OK ] ResizeBilinearOpTest.ThreeDimensionalResize (0 ms)
[ RUN      ] ResizeBilinearOpTest.TwoDimensionalResizeWithTwoBatches8Bit
tensorflow/contrib/lite/kernels/resize_bilinear_test.cc:261: Failure
Value of: m.GetOutput<uint8>()
Expected: has 18 elements where
element #0 is approximately 3 (absolute error <= 9.9999997e-06),
element #1 is approximately 5 (absolute error <= 9.9999997e-06),
element #2 is approximately 6 (absolute error <= 9.9999997e-06),
element #3 is approximately 7 (absolute error <= 9.9999997e-06),
element #4 is approximately 9 (absolute error <= 9.9999997e-06),
element #5 is approximately 10 (absolute error <= 9.9999997e-06),
element #6 is approximately 9 (absolute error <= 9.9999997e-06),
element #7 is approximately 11 (absolute error <= 9.9999997e-06),
element #8 is approximately 12 (absolute error <= 9.9999997e-06),
element #9 is approximately 4 (absolute error <= 9.9999997e-06),
element #10 is approximately 8 (absolute error <= 9.9999997e-06),
element #11 is approximately 10 (absolute error <= 9.9999997e-06),
element #12 is approximately 8 (absolute error <= 9.9999997e-06),
element #13 is approximately 12 (absolute error <= 9.9999997e-06),
element #14 is approximately 14 (absolute error <= 9.9999997e-06),
element #15 is approximately 10 (absolute error <= 9.9999997e-06),
element #16 is approximately 13 (absolute error <= 9.9999997e-06),
element #17 is approximately 16 (absolute error <= 9.9999997e-06)
  Actual: { '\x3' (3), '\x5' (5), '\x6' (6), '\a' (7), '\t' (9), '\n' (10, 0xA), '\t' (9), '\v' (11, 0xB), '\f' (12, 0xC), '\x4' (4), '\b' (8), '\n' (10, 0xA), '\b' (8), '\f' (12, 0xC), '\xE' (14), '\n' (10, 0xA), '\xE' (14), '\x10' (16) }, whose element #16 doesn't match, which is 1 from 13
tensorflow/contrib/lite/kernels/resize_bilinear_test.cc:278: Failure
Value of: const_m.GetOutput<uint8>()
Expected: has 18 elements where
element #0 is approximately 3 (absolute error <= 9.9999997e-06),
element #1 is approximately 5 (absolute error <= 9.9999997e-06),
element #2 is approximately 6 (absolute error <= 9.9999997e-06),
element #3 is approximately 7 (absolute error <= 9.9999997e-06),
element #4 is approximately 9 (absolute error <= 9.9999997e-06),
element #5 is approximately 10 (absolute error <= 9.9999997e-06),
element #6 is approximately 9 (absolute error <= 9.9999997e-06),
element #7 is approximately 11 (absolute error <= 9.9999997e-06),
element #8 is approximately 12 (absolute error <= 9.9999997e-06),
element #9 is approximately 4 (absolute error <= 9.9999997e-06),
element #10 is approximately 8 (absolute error <= 9.9999997e-06),
element #11 is approximately 10 (absolute error <= 9.9999997e-06),
element #12 is approximately 8 (absolute error <= 9.9999997e-06),
element #13 is approximately 12 (absolute error <= 9.9999997e-06),
element #14 is approximately 14 (absolute error <= 9.9999997e-06),
element #15 is approximately 10 (absolute error <= 9.9999997e-06),
element #16 is approximately 13 (absolute error <= 9.9999997e-06),
element #17 is approximately 16 (absolute error <= 9.9999997e-06)
  Actual: { '\x3' (3), '\x5' (5), '\x6' (6), '\a' (7), '\t' (9), '\n' (10, 0xA), '\t' (9), '\v' (11, 0xB), '\f' (12, 0xC), '\x4' (4), '\b' (8), '\n' (10, 0xA), '\b' (8), '\f' (12, 0xC), '\xE' (14), '\n' (10, 0xA), '\xE' (14), '          \x10' (16) }, whose element #16 doesn't match, which is 1 from 13
[  FAILED  ] ResizeBilinearOpTest.TwoDimensionalResizeWithTwoBatches8Bit (0 ms)
[ RUN      ] ResizeBilinearOpTest.ThreeDimensionalResize8Bit
tensorflow/contrib/lite/kernels/resize_bilinear_test.cc:293: Failure
Value of: m.GetOutput<uint8>()
Expected: has 18 elements where
element #0 is approximately 3 (absolute error <= 9.9999997e-06),
element #1 is approximately 4 (absolute error <= 9.9999997e-06),
element #2 is approximately 5 (absolute error <= 9.9999997e-06),
element #3 is approximately 8 (absolute error <= 9.9999997e-06),
element #4 is approximately 6 (absolute error <= 9.9999997e-06),
element #5 is approximately 10 (absolute error <= 9.9999997e-06),
element #6 is approximately 7 (absolute error <= 9.9999997e-06),
element #7 is approximately 8 (absolute error <= 9.9999997e-06),
element #8 is approximately 9 (absolute error <= 9.9999997e-06),
element #9 is approximately 12 (absolute error <= 9.9999997e-06),
element #10 is approximately 10 (absolute error <= 9.9999997e-06),
element #11 is approximately 14 (absolute error <= 9.9999997e-06),
element #12 is approximately 9 (absolute error <= 9.9999997e-06),
element #13 is approximately 10 (absolute error <= 9.9999997e-06),
element #14 is approximately 11 (absolute error <= 9.9999997e-06),
element #15 is approximately 13 (absolute error <= 9.9999997e-06),
element #16 is approximately 12 (absolute error <= 9.9999997e-06),
element #17 is approximately 16 (absolute error <= 9.9999997e-06)
  Actual: { '\x3' (3), '\x4' (4), '\x5' (5), '\b' (8), '\x6' (6), '\n' (10, 0xA), '\a' (7), '\b' (8), '\t' (9), '\f' (12, 0xC), '\n' (10, 0xA), '\xE' (14), '\t' (9), '\n' (10, 0xA), '\v' (11, 0xB), '\xE' (14), '\f' (12, 0xC), '          \x10' (16) }, whose element #15 doesn't match, which is 1 from 13
tensorflow/contrib/lite/kernels/resize_bilinear_test.cc:305: Failure
Value of: const_m.GetOutput<uint8>()
Expected: has 18 elements where
element #0 is approximately 3 (absolute error <= 9.9999997e-06),
element #1 is approximately 4 (absolute error <= 9.9999997e-06),
element #2 is approximately 5 (absolute error <= 9.9999997e-06),
element #3 is approximately 8 (absolute error <= 9.9999997e-06),
element #4 is approximately 6 (absolute error <= 9.9999997e-06),
element #5 is approximately 10 (absolute error <= 9.9999997e-06),
element #6 is approximately 7 (absolute error <= 9.9999997e-06),
element #7 is approximately 8 (absolute error <= 9.9999997e-06),
element #8 is approximately 9 (absolute error <= 9.9999997e-06),
element #9 is approximately 12 (absolute error <= 9.9999997e-06),
element #10 is approximately 10 (absolute error <= 9.9999997e-06),
element #11 is approximately 14 (absolute error <= 9.9999997e-06),
element #12 is approximately 9 (absolute error <= 9.9999997e-06),
element #13 is approximately 10 (absolute error <= 9.9999997e-06),
element #14 is approximately 11 (absolute error <= 9.9999997e-06),
element #15 is approximately 13 (absolute error <= 9.9999997e-06),
element #16 is approximately 12 (absolute error <= 9.9999997e-06),
element #17 is approximately 16 (absolute error <= 9.9999997e-06)
  Actual: { '\x3' (3), '\x4' (4), '\x5' (5), '\b' (8), '\x6' (6), '\n' (10, 0xA), '\a' (7), '\b' (8), '\t' (9), '\f' (12, 0xC), '\n' (10, 0xA), '\xE' (14), '\t' (9), '\n' (10, 0xA), '\v' (11, 0xB), '\xE' (14), '\f' (12, 0xC), '          \x10' (16) }, whose element #15 doesn't match, which is 1 from 13
[  FAILED  ] ResizeBilinearOpTest.ThreeDimensionalResize8Bit (1 ms)
[----------] 10 tests from ResizeBilinearOpTest (2 ms total)

[----------] Global test environment tear-down
[==========] 10 tests from 1 test case ran. (2 ms total)
[  PASSED  ] 8 tests.
[  FAILED  ] 2 tests, listed below:
[  FAILED  ] ResizeBilinearOpTest.TwoDimensionalResizeWithTwoBatches8Bit
[  FAILED  ] ResizeBilinearOpTest.ThreeDimensionalResize8Bit

 2 FAILED TESTS
================================================================================
```

### Source code / logs
see above
",True
//tensorflow/contrib/distributions:matrix_inverse_tril_test fails on ppc64le stat:awaiting tensorflower,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:N/A
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:
      Ubuntu 16.04 (ppc64le)
- **TensorFlow installed from (source or binary)**:
      Installed from source
- **TensorFlow version (use command below)**:
      TF master
- **Python version**: 
     Python 2.7.5
- **Bazel version (if compiling from source)**:
     bazel-0.11.1
- **CUDA/cuDNN version**:
     NA
- **GPU model and memory**:
      NA
- **Exact command to reproduce**:
 `bazel test -c opt --jobs 1 -k --cache_test_results=no --test_output=errors  //tensorflow/contrib/distributions:matrix_inverse_tril_test`

### Describe the problem
Getting error `InvalidArgumentError: assertion failed: [Input must be lower triangular.] [Condition x == y did not hold element-wise:]`.
Not sure what exactly causing this issue, need to investigate.

### Source code / logs
```
E.......
======================================================================
ERROR: testBatch (__main__.MatrixInverseTriLBijectorTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/framework/test_util.py"", line 625, in decorated
    f(self, **kwargs)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/contrib/distributions/python/kernel_tests/bijectors/matrix_inverse_tril_test.py"", line 110, in testBatch
    y_, x_back_, fldj_, ildj_ = self.evaluate([y, x_back, fldj, ildj])
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/framework/test_util.py"", line 864, in evaluate
    return sess.run(tensors)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/client/session.py"", line 877, in run
    run_metadata_ptr)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/client/session.py"", line 1100, in _run
    feed_dict_tensor, options, run_metadata)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/client/session.py"", line 1272, in _do_run
    run_metadata)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/client/session.py"", line 1291, in _do_call
    raise type(e)(node_def, op, message)
InvalidArgumentError: assertion failed: [Input must be lower triangular.] [Condition x == y did not hold element-wise:] [x (matrix_inverse_tril_1/inverse/MatrixBandPart:0) = ] [[[[0 2.77555756e-17][0]]]...] [y (matrix_inverse_tril_1/inverse/zeros_like:0) = ] [[[[0 0][0]]]...]
         [[Node: matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert = Assert[T=[DT_STRING, DT_STRING, DT_STRING, DT_FLOAT, DT_STRING, DT_FLOAT], summarize=3, _device=""/job:localhost/replica:0/task:0/device:CPU:0""](matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/Switch, matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/data_0, matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/data_1, matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/data_2, matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/Switch_1, matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/data_4, matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/Switch_2)]]

Caused by op u'matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert', defined at:
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/contrib/distributions/python/kernel_tests/bijectors/matrix_inverse_tril_test.py"", line 190, in <module>
    test.main()
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/platform/test.py"", line 64, in main
    return _googletest.main(argv)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/platform/googletest.py"", line 100, in main
    benchmark.benchmarks_main(true_main=main_wrapper)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/platform/benchmark.py"", line 344, in benchmarks_main
    true_main()
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/platform/googletest.py"", line 99, in main_wrapper
    return app.run(main=g_main, argv=args)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/platform/app.py"", line 125, in run
    _sys.exit(main(argv))
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/platform/googletest.py"", line 70, in g_main
    return unittest_main(argv=argv)
  File ""/usr/lib/python2.7/unittest/main.py"", line 95, in __init__
    self.runTests()
  File ""/usr/lib/python2.7/unittest/main.py"", line 232, in runTests
    self.result = testRunner.run(self.test)
  File ""/usr/lib/python2.7/unittest/runner.py"", line 151, in run
    test(result)
  File ""/usr/lib/python2.7/unittest/suite.py"", line 70, in __call__
    return self.run(*args, **kwds)
  File ""/usr/lib/python2.7/unittest/suite.py"", line 108, in run
    test(result)
  File ""/usr/lib/python2.7/unittest/suite.py"", line 70, in __call__
    return self.run(*args, **kwds)
  File ""/usr/lib/python2.7/unittest/suite.py"", line 108, in run
    test(result)
  File ""/usr/lib/python2.7/unittest/case.py"", line 393, in __call__
    return self.run(*args, **kwds)
  File ""/usr/lib/python2.7/unittest/case.py"", line 329, in run
    testMethod()
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/framework/test_util.py"", line 625, in decorated
    f(self, **kwargs)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/contrib/distributions/python/kernel_tests/bijectors/matrix_inverse_tril_test.py"", line 106, in testBatch
    x_back = inv.inverse(x_inv_)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/ops/distributions/bijector_impl.py"", line 800, in inverse
    return self._call_inverse(y, name)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/ops/distributions/bijector_impl.py"", line 779, in _call_inverse
    mapping = mapping.merge(x=self._inverse(y, **kwargs))
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/contrib/distributions/python/ops/bijectors/matrix_inverse_tril.py"", line 80, in _inverse
    return self._forward(y)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/contrib/distributions/python/ops/bijectors/matrix_inverse_tril.py"", line 74, in _forward
    with ops.control_dependencies(self._assertions(x)):
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/contrib/distributions/python/ops/bijectors/matrix_inverse_tril.py"", line 138, in _assertions
    message=""Input must be lower triangular."")
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/ops/check_ops.py"", line 382, in assert_equal
    return control_flow_ops.Assert(condition, data, summarize=summarize)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/util/tf_should_use.py"", line 118, in wrapped
    return _add_should_use_warning(fn(*args, **kwargs))
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/ops/control_flow_ops.py"", line 151, in Assert
    guarded_assert = cond(condition, no_op, true_assert, name=""AssertGuard"")
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/util/deprecation.py"", line 432, in new_func
    return func(*args, **kwargs)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/ops/control_flow_ops.py"", line 2049, in cond
    orig_res_f, res_f = context_f.BuildCondBranch(false_fn)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/ops/control_flow_ops.py"", line 1890, in BuildCondBranch
    original_result = fn()
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/ops/control_flow_ops.py"", line 149, in true_assert
    condition, data, summarize, name=""Assert"")
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/ops/gen_logging_ops.py"", line 51, in _assert
    name=name)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/framework/op_def_library.py"", line 787, in _apply_op_helper
    op_def=op_def)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/util/deprecation.py"", line 432, in new_func
    return func(*args, **kwargs)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/framework/ops.py"", line 3206, in create_op
    op_def=op_def)
  File ""/root/.cache/bazel/_bazel_root/78afe71156c58ea89dc510bdb03ba2b0/execroot/org_tensorflow/bazel-out/ppc-opt/bin/tensorflow/contrib/distributions/matrix_inverse_tril_test.runfiles/org_tensorflow/tensorflow/python/framework/ops.py"", line 1701, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

InvalidArgumentError (see above for traceback): assertion failed: [Input must be lower triangular.] [Condition x == y did not hold element-wise:] [x (matrix_inverse_tril_1/inverse/MatrixBandPart:0) = ] [[[[0 2.77555756e-17][0]]]...] [y (matrix_inverse_tril_1/inverse/zeros_like:0) = ] [[[[0 0][0]]]...]
         [[Node: matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert = Assert[T=[DT_STRING, DT_STRING, DT_STRING, DT_FLOAT, DT_STRING, DT_FLOAT], summarize=3, _device=""/job:localhost/replica:0/task:0/device:CPU:0""](matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/Switch, matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/data_0, matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/data_1, matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/data_2, matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/Switch_1, matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/data_4, matrix_inverse_tril_1/inverse/assert_equal_1/Assert/AssertGuard/Assert/Switch_2)]]


----------------------------------------------------------------------
Ran 8 tests in 3.177s
```",True
Unable to reuse opaque_kernel variable in CudnnLSTM for FP16 ,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04
- **TensorFlow installed from (source or binary)**: Binary using GPUs
- **TensorFlow version (use command below)**: 1.7.0
- **Python version**: 2.7
- **Bazel version (if compiling from source)**: NA
- **GCC/Compiler version (if compiling from source)**: NA
- **CUDA/cuDNN version**:  Cuda 9.0/ CuDNN 7.0.5
- **GPU model and memory**:  Volta(V100), 16 GB
- **Exact command to reproduce**: Please see the code below

### Describe the problem
Unable to reuse opaque_kernel variables with FP16 data type. Works for FP32 data type. Here is the stack trace:

 File ""cudnn_lstm_example.py"", line 37, in <module>
    outputs_2, _ = lstm(inputs_2)
  File ""/usr/local/anaconda2/envs/tensorflow_1.7/lib/python2.7/site-packages/tensorflow/python/layers/base.py"", line 696, in __call__
    self.build(input_shapes)
  File ""/usr/local/anaconda2/envs/tensorflow_1.7/lib/python2.7/site-packages/tensorflow/contrib/cudnn_rnn/python/layers/cudnn_rnn.py"", line 358, in build
    ""opaque_kernel"", initializer=opaque_params_t, validate_shape=False)
  File ""/usr/local/anaconda2/envs/tensorflow_1.7/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py"", line 1297, in get_variable
    constraint=constraint)
  File ""/usr/local/anaconda2/envs/tensorflow_1.7/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py"", line 1093, in get_variable
    constraint=constraint)
  File ""/usr/local/anaconda2/envs/tensorflow_1.7/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py"", line 431, in get_variable
    return custom_getter(**custom_getter_kwargs)
  File ""/usr/local/anaconda2/envs/tensorflow_1.7/lib/python2.7/site-packages/tensorflow/contrib/cudnn_rnn/python/layers/cudnn_rnn.py"", line 291, in _update_trainable_weights
    variable = getter(*args, **kwargs)
  File ""/usr/local/anaconda2/envs/tensorflow_1.7/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py"", line 408, in _true_getter
    use_resource=use_resource, constraint=constraint)
  File ""/usr/local/anaconda2/envs/tensorflow_1.7/lib/python2.7/site-packages/tensorflow/python/ops/variable_scope.py"", line 758, in _get_single_variable
    found_type_str))
ValueError: Trying to share variable cudnn_rnn/cudnn_bi_lstm/opaque_kernel, but specified dtype float32 and found dtype float16_ref.

### Source code / logs

```
import tensorflow as tf

num_layers = 1
num_units = 40
batch_size = 60
dir_count = 2

inputDType= tf.float16 # Does not work
#inputDType = tf.float32 # Works

inputs_1 = tf.random_uniform([
    num_layers * dir_count, batch_size, num_units], dtype=inputDType)

inputs_2 = tf.random_uniform([
    num_layers * dir_count, batch_size, num_units], dtype=inputDType)

with tf.variable_scope(""cudnn_rnn"", reuse=False):
    lstm = tf.contrib.cudnn_rnn.CudnnLSTM(
        num_layers=num_layers,
        num_units=num_units,
        direction=""bidirectional"",
        dtype=inputDType,
        name=""cudnn_bi_lstm"")
                
    outputs_1, _ = lstm(inputs_1)

with tf.variable_scope(""cudnn_rnn"", reuse=True):
    lstm = tf.contrib.cudnn_rnn.CudnnLSTM(
        num_layers=num_layers,
        num_units=num_units,
        direction=""bidirectional"",
        dtype=inputDType,
        name=""cudnn_bi_lstm"")

    outputs_2, _ = lstm(inputs_2)

loss1 = tf.reduce_sum(outputs_1)
loss2 = tf.reduce_sum(outputs_2)
loss= loss1+loss2
var = lstm.trainable_variables[0]

grad = tf.gradients(loss, var)[0]
print('grad.shape: %s' % grad.shape)
print('var.shape: %s' % var.shape)

opt = tf.train.AdamOptimizer()
train_op = opt.apply_gradients([(grad, lstm.trainable_variables[0])])

with tf.Session() as sess:
    sess.run(tf.global_variables_initializer())
    print(sess.run(outputs_1))
    print(sess.run(outputs_2))
    sess.run(train_op)
    print(sess.run(outputs_1))
    print(sess.run(outputs_2))
```
",True
tensorflow-1.8.0rc0: tf.compat.as_str returns bytes for python3 since 20180409 type:bug,"The issue appeared first in `tf-nightly==1.8.0.dev20180409` but is now present in `tensorflow==1.8.0rc0`.

Reproduce steps:

```
$ python3 -c ""import tensorflow as tf; print(tf.VERSION, type(tf.compat.as_str('hello')) == str)
```

Is expected to always print ""True"".  But gets:

```
# tensorflow
1.6.0 True
1.7.0 True
1.8.0-rc0 False           <= Broken!

# tf-nightly
1.8.0-dev20180408 True
1.8.0-dev20180409 False   <= Broken!
```",True
Segfault on bad input to tf.constant. ,"One can get a segfault providing some wrong data into a `tf.constant`:

```python
>> tf.constant(tf.string, ""[,]"")
Segmentation fault (core dumped)
```

While `tf.constant(tf.string, ""[]"")` and `tf.constant(tf.string, "","")` both give the proper error (`dtype not understood`).

",True
tf.nn.conv3d_transpose operation with data_format='NCDHW' ,"### System information
Irrelevant.

### Describe the problem
In implementation of ""tf.nn.conv3d_transpose"" operation with ""data_format='NCDHW'"",
the shape compatibility of ""output shape"" and ""kernel size"" check is not carried out correctly. (However, the check is fine in tf.nn.conv2d_transpose)


### Source code / logs
`    if isinstance(output_shape, (list, np.ndarray)):
      # output_shape's shape should be == [5] if reached this point.
      if not filter.get_shape()[3].is_compatible_with(output_shape[4]):
        raise ValueError(
            ""output_shape does not match filter's output channels, ""
            ""{} != {}"".format(output_shape[4],
                              filter.get_shape()[3]))`

should be changed to 

`    if isinstance(output_shape, (list, np.ndarray)):
      # output_shape's shape should be == [5] if reached this point.
      if not filter.get_shape()[3].is_compatible_with(output_shape[axis]):
        raise ValueError(
            ""output_shape does not match filter's output channels, ""
            ""{} != {}"".format(output_shape[axis],
                              filter.get_shape()[3]))`

more specifically, output_shape[4] to output_shape[axis].",True
Luong attention fails when used with scale=True and dtype=tf.float16 ,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04
- **TensorFlow installed from (source or binary)**: source
- **TensorFlow version (use command below)**: b'v1.6.0-rc1-1857-g67e2efa' 1.6.0
- **Python version**: 3.5.2
- **Bazel version (if compiling from source)**: 0.10.0
- **GCC/Compiler version (if compiling from source)**: 5.4.0
- **CUDA/cuDNN version**: 9.0/7.0
- **GPU model and memory**: not relevant
- **Exact command to reproduce**:

```
import tensorflow as tf
dtype = tf.float16

with tf.variable_scope(""name"", dtype=dtype):
    cell = tf.nn.rnn_cell.LSTMCell(128)

    encoder_outputs = tf.placeholder(dtype, shape=[64, None, 256])
    input_lengths = tf.placeholder(tf.int32, shape=[64])
    tgt_lengths = tf.placeholder(tf.int32, shape=[64])
    input_vectors = tf.placeholder(dtype, shape=[64, None, 128])

    attention_mechanism = tf.contrib.seq2seq.LuongAttention(
        num_units=128,
        memory=encoder_outputs,
        scale=True,
        memory_sequence_length=input_lengths,
        probability_fn=tf.nn.softmax,
        dtype=dtype,
    )
    attn_cell = tf.contrib.seq2seq.AttentionWrapper(cell, attention_mechanism)

    helper = tf.contrib.seq2seq.TrainingHelper(
        inputs=input_vectors,
        sequence_length=tgt_lengths,
    )

    decoder = tf.contrib.seq2seq.BasicDecoder(
        cell=attn_cell,
        helper=helper,
        initial_state=attn_cell.zero_state(64, dtype),
    )

    tf.contrib.seq2seq.dynamic_decode(decoder=decoder)
```

### Describe the problem
Luong attention fails when using with scale=True and dtype=tf.float16. Changing lines 341-342 of attention_wrapper.py to:
```
g = variable_scope.get_variable(
    ""attention_g"", dtype=dtype, shape=(),
    initializer=init_ops.ones_initializer(),
)
```
seems to solve the problem.

### Source code / logs
Traceback:

```
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-1-4dec9cd8e3b2> in <module>()
     31     )
     32 
---> 33     tf.contrib.seq2seq.dynamic_decode(decoder=decoder)

~/Documents/venv/lib/python3.5/site-packages/tensorflow/contrib/seq2seq/python/ops/decoder.py in dynamic_decode(decoder, output_time_major, impute_finished, maximum_iterations, parallel_iterations, swap_memory, scope)
    307         ],
    308         parallel_iterations=parallel_iterations,
--> 309         swap_memory=swap_memory)
    310 
    311     final_outputs_ta = res[1]

~/Documents/venv/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py in while_loop(cond, body, loop_vars, shape_invariants, parallel_iterations, back_prop, swap_memory, name, maximum_iterations)
   3203     if loop_context.outer_context is None:
   3204       ops.add_to_collection(ops.GraphKeys.WHILE_CONTEXT, loop_context)
-> 3205     result = loop_context.BuildLoop(cond, body, loop_vars, shape_invariants)
   3206     if maximum_iterations is not None:
   3207       return result[1]

~/Documents/venv/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py in BuildLoop(self, pred, body, loop_vars, shape_invariants)
   2941       with ops.get_default_graph()._lock:  # pylint: disable=protected-access
   2942         original_body_result, exit_vars = self._BuildLoop(
-> 2943             pred, body, original_loop_vars, loop_vars, shape_invariants)
   2944     finally:
   2945       self.Exit()

~/Documents/venv/lib/python3.5/site-packages/tensorflow/python/ops/control_flow_ops.py in _BuildLoop(self, pred, body, original_loop_vars, loop_vars, shape_invariants)
   2878         flat_sequence=vars_for_body_with_tensor_arrays)
   2879     pre_summaries = ops.get_collection(ops.GraphKeys._SUMMARY_COLLECTION)  # pylint: disable=protected-access
-> 2880     body_result = body(*packed_vars_for_body)
   2881     post_summaries = ops.get_collection(ops.GraphKeys._SUMMARY_COLLECTION)  # pylint: disable=protected-access
   2882     if not nest.is_sequence(body_result):

~/Documents/venv/lib/python3.5/site-packages/tensorflow/contrib/seq2seq/python/ops/decoder.py in body(time, outputs_ta, state, inputs, finished, sequence_lengths)
    252       """"""
    253       (next_outputs, decoder_state, next_inputs,
--> 254        decoder_finished) = decoder.step(time, inputs, state)
    255       if decoder.tracks_own_finished:
    256         next_finished = decoder_finished

~/Documents/venv/lib/python3.5/site-packages/tensorflow/contrib/seq2seq/python/ops/basic_decoder.py in step(self, time, inputs, state, name)
    135     """"""
    136     with ops.name_scope(name, ""BasicDecoderStep"", (time, inputs, state)):
--> 137       cell_outputs, cell_state = self._cell(inputs, state)
    138       if self._output_layer is not None:
    139         cell_outputs = self._output_layer(cell_outputs)

~/Documents/venv/lib/python3.5/site-packages/tensorflow/python/ops/rnn_cell_impl.py in __call__(self, inputs, state, scope)
    230         setattr(self, scope_attrname, scope)
    231       with scope:
--> 232         return super(RNNCell, self).__call__(inputs, state)
    233 
    234   def _rnn_get_variable(self, getter, *args, **kwargs):

~/Documents/venv/lib/python3.5/site-packages/tensorflow/python/layers/base.py in __call__(self, inputs, *args, **kwargs)
    712 
    713         if not in_deferred_mode:
--> 714           outputs = self.call(inputs, *args, **kwargs)
    715           if outputs is None:
    716             raise ValueError('A layer\'s `call` method should return a Tensor '

~/Documents/venv/lib/python3.5/site-packages/tensorflow/contrib/seq2seq/python/ops/attention_wrapper.py in call(self, inputs, state)
   1409       attention, alignments, next_attention_state = _compute_attention(
   1410           attention_mechanism, cell_output, previous_attention_state[i],
-> 1411           self._attention_layers[i] if self._attention_layers else None)
   1412       alignment_history = previous_alignment_history[i].write(
   1413           state.time, alignments) if self._alignment_history else ()

~/Documents/venv/lib/python3.5/site-packages/tensorflow/contrib/seq2seq/python/ops/attention_wrapper.py in _compute_attention(attention_mechanism, cell_output, attention_state, attention_layer)
   1046   """"""Computes the attention and alignments for a given attention_mechanism.""""""
   1047   alignments, next_attention_state = attention_mechanism(
-> 1048       cell_output, state=attention_state)
   1049 
   1050   # Reshape from [batch_size, memory_time] to [batch_size, 1, memory_time]

~/Documents/venv/lib/python3.5/site-packages/tensorflow/contrib/seq2seq/python/ops/attention_wrapper.py in __call__(self, query, state)
    427     """"""
    428     with variable_scope.variable_scope(None, ""luong_attention"", [query]):
--> 429       score = _luong_score(query, self._keys, self._scale)
    430     alignments = self._probability_fn(score, state)
    431     next_state = alignments

~/Documents/venv/lib/python3.5/site-packages/tensorflow/contrib/seq2seq/python/ops/attention_wrapper.py in _luong_score(query, keys, scale)
    340     # Scalar used in weight scaling
    341     g = variable_scope.get_variable(
--> 342         ""attention_g"", dtype=dtype, initializer=1.)
    343     score = g * score
    344   return score

~/Documents/venv/lib/python3.5/site-packages/tensorflow/python/ops/variable_scope.py in get_variable(name, shape, dtype, initializer, regularizer, trainable, collections, caching_device, partitioner, validate_shape, use_resource, custom_getter, constraint)
   1315       partitioner=partitioner, validate_shape=validate_shape,
   1316       use_resource=use_resource, custom_getter=custom_getter,
-> 1317       constraint=constraint)
   1318 get_variable_or_local_docstring = (
   1319     """"""%s

~/Documents/venv/lib/python3.5/site-packages/tensorflow/python/ops/variable_scope.py in get_variable(self, var_store, name, shape, dtype, initializer, regularizer, reuse, trainable, collections, caching_device, partitioner, validate_shape, use_resource, custom_getter, constraint)
   1064         if init_dtype != dtype:
   1065           raise ValueError(""Initializer type '%s' and explicit dtype '%s' ""
-> 1066                            ""don't match."" % (init_dtype, dtype))
   1067       if initializer is None:
   1068         initializer = self._initializer

ValueError: Initializer type '<dtype: 'float32'>' and explicit dtype '<dtype: 'float16'>' don't match.
```",True
"`tf.keras.estimator._create_ordered_io` casts everything to floatx, which breaks non-floatx inputs type:bug","### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Debian 3.16.36
- **TensorFlow installed from (source or binary)**: Installed via pip
- **TensorFlow version (use command below)**: `('v1.6.0-0-gd2e24b6039', '1.6.0')`
- **Python version**: 2.7.9
- **Bazel version (if compiling from source)**:
- **GCC/Compiler version (if compiling from source)**:
- **CUDA/cuDNN version**: n/a
- **GPU model and memory**: n/a
- **Exact command to reproduce**: Requires significant code, let me know if necessary

### Describe the problem

This is kind of a simple issue with using `Keras` models as Tensorflow Estimators. I unfortunately need to do this awkward conversion in order to use SageMaker, which is even more awkwardly behind by two versions of Tensorflow. Which is fun.

Basically, I have a `Keras` model that expects a `tf.string` input `dtype`, which is then passed through to a Lookup layer for some text embeddings. This works fine as a Keras model and works fine if I extract the input layers myself and connect them into an Estimator. However, if I go to create an estimator from the model using `model_to_estimator` I run into this code path: https://github.com/tensorflow/tensorflow/blob/r1.6/tensorflow/python/keras/_impl/keras/estimator.py#L80

This conversion then causes the model to break further down the line. I'm not sure why this float cast occurs, but this commit https://github.com/tensorflow/tensorflow/commit/4c86ece040cb96ea689f5c0d084b6959274eab91#diff-69effda952f96b36c8015cc1a3462d65 seems to imply that Keras models are meant to only take floatx input, which doesn't really seem right.

Would not doing this cast break anything? If so, is there a way to use a non-float32 input with Keras models that need to be converted to Estimators?

Thanks!

### Source code / logs

Here's the exact traceback for the issue:

```
/home/u1/zach/proj/dataplayground2/local/lib/python2.7/site-packages/h5py/__init__.py:34: FutureWarning: Conversion of the second argument 
of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.          
  from ._conv import register_converters as _register_converters                                                                           
WARNING:tensorflow:Using temporary folder as model directory: /tmp/tmp6Wogzk                                                               
2018-03-29 14:12:41.586292: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow       
binary was not compiled to use: AVX2 FMA                                                                                                   
WARNING:tensorflow:Output ""final_representation"" missing from loss dictionary. We assume this was done on purpose, and we will not be      
expecting any data to be passed to ""final_representation"" during training.                                                                 
WARNING:tensorflow:Output ""oov_code"" missing from loss dictionary. We assume this was done on purpose, and we will not be expecting any    
data to be passed to ""oov_code"" during training.                                                                                           
Testing common_estimator_fns.py locally                                                                                                    
Making estimator                                                                                                                           
Model dir: /tmp/tmp6Wogzk                                                                                                                  
Training estimator                                                                                                                         
float64                                                                                                                                    
Tensor(""random_shuffle_queue_DequeueMany:1"", shape=(32, 1), dtype=string, device=/device:CPU:0)                                            
Traceback (most recent call last):                                                                                                         
  File ""common_estimator_fns.py"", line 423, in <module>                                                                                    
    hooks=[tf_debug.LocalCLIDebugHook()])                                                                                                  
  File ""/home/u1/zach/proj/dataplayground2/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py"", line 352, in train 
    loss = self._train_model(input_fn, hooks, saving_listeners)                                                                            
  File ""/home/u1/zach/proj/dataplayground2/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py"", line 812, in       
_train_model                                                                                                                               
    features, labels, model_fn_lib.ModeKeys.TRAIN, self.config)                                                                            
  File ""/home/u1/zach/proj/dataplayground2/local/lib/python2.7/site-packages/tensorflow/python/estimator/estimator.py"", line 793, in       
_call_model_fn                                                                                                                             
    model_fn_results = self._model_fn(features=features, **kwargs)                                                                         
  File ""common_estimator_fns.py"", line 381, in model_fn                                                                                    
    return keras_model_fn(features, labels, mode)                                                                                          
  File ""/home/u1/zach/proj/dataplayground2/local/lib/python2.7/site-packages/tensorflow/python/keras/_impl/keras/estimator.py"", line 160,  
in model_fn                                                                                                                                
    labels)                                                                                                                                
  File ""/home/u1/zach/proj/dataplayground2/local/lib/python2.7/site-packages/tensorflow/python/keras/_impl/keras/estimator.py"", line 109,  
in _clone_and_build_model                                                                                                                  
    model = models.clone_model(keras_model, input_tensors=input_tensors)                                                                   
  File ""/home/u1/zach/proj/dataplayground2/local/lib/python2.7/site-packages/tensorflow/python/keras/_impl/keras/models.py"", line 1557, in 
clone_model                                                                                                                                
    return _clone_functional_model(model, input_tensors=input_tensors)                                                                     
  File ""/home/u1/zach/proj/dataplayground2/local/lib/python2.7/site-packages/tensorflow/python/keras/_impl/keras/models.py"", line 1451, in 
_clone_functional_model                                                                                                                    
    output_tensors = topology._to_list(layer(computed_tensor, **kwargs))                                                                   
  File ""/home/u1/zach/proj/dataplayground2/local/lib/python2.7/site-packages/tensorflow/python/keras/_impl/keras/engine/topology.py"", line 
258, in __call__                                                                                                                           
    output = super(Layer, self).__call__(inputs, **kwargs)                                                                                 
  File ""/home/u1/zach/proj/dataplayground2/local/lib/python2.7/site-packages/tensorflow/python/layers/base.py"", line 673, in __call__      
    self._assert_input_compatibility(inputs)                                                                                               
  File ""/home/u1/zach/proj/dataplayground2/local/lib/python2.7/site-packages/tensorflow/python/layers/base.py"", line 1204, in              
_assert_input_compatibility                                                                                                                
    ', found dtype=' + str(x.dtype))                                                                                                       
ValueError: Input 0 of layer lookedup is incompatible with the layer: expected dtype=<dtype: 'string'>, found dtype=<dtype: 'float32'>     
```

I can provide code if absolutely necessary, but it'd take some work to get to a minimal reproduction.",True
tf.gfile doesn't understand NTFS Unicode filenames on Windows ,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: no
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Windows Server 2016 Datacenter, 64-bit, installed on a GCE VM
- **TensorFlow installed from (source or binary)**: binary pip package
- **TensorFlow version (use command below)**: 1.6.0
- **Python version**: 3.6
- **Bazel version (if compiling from source)**: N/A
- **GCC/Compiler version (if compiling from source)**: N/A
- **CUDA/cuDNN version**: N/A
- **GPU model and memory**: N/A
- **Exact command to reproduce**: `python -c ""dir = '/tmp/tftest/\u8c37\u6b4c'; import tensorflow as tf; import os; os.makedirs(dir); print(os.path.exists(dir), tf.gfile.Exists(dir))""`

### Describe the problem
The tf.gfile functions that involve file paths appear not to understand Windows with NTFS filenames that contain Unicode characters, such as 谷歌 (""Google"" in Chinese).  It seems like something about the name isn't translated in a way that actually results in successful lookups, so everything behaves as if those files didn't exist.

Command to repro:
```
python -c ""dir = '/tmp/tftest/\u8c37\u6b4c'; import tensorflow as tf; import os; os.makedirs(dir); print(os.path.exists(dir), tf.gfile.Exists(dir))""
```

This command run in Windows PowerShell prints ""True False"" i.e. `os.path.exists()` returns a different result than `tf.gfile.Exists()`.  This is true even for different ways of formulating that path -
 in addition to `/tmp/tftest/\u8c37\u6b4c` I tested `C:/tmp/tftest/\u8c37\u6b4c` and `C:\\tmp\\tftest\\\u8c37\u6b4c` (double backslashes for the path separators to escape within a python string) and they both produce the same result.  If you remove the unicode characters from the path, it prints ""True True"" as expected.

In contrast, on my gLinux workstation this prints ""True True"" all the time, i.e. the results are the same.

I tested this with Exists(), IsDirectory(), and ListDirectory() but I'm assuming it applies generally to all the tf.gfile functions that take a path argument.  Note however that ListDirectory() will *return* the Unicode name just fine if run in the parent directory, the same as `os.listdir()`.

We've gotten a report about this for TensorBoard: https://github.com/tensorflow/tensorboard/issues/861
",True
Keras plot_model() giving error 'Model' object has no attribute '_container_nodes' stat:contribution welcome,"Please go to Stack Overflow for help and support:

https://stackoverflow.com/questions/tagged/tensorflow

If you open a GitHub issue, here is our policy:

1. It must be a bug, a feature request, or a significant problem with documentation (for small docs fixes please send a PR instead).
2. The form below must be filled out.
3. It shouldn't be a TensorBoard issue. Those go [here](https://github.com/tensorflow/tensorboard/issues).

**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.

------------------------

### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:
     TensorFlow Keras code
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:
     Windows 10
- **TensorFlow installed from (source or binary)**:
     Binary
- **TensorFlow version (use command below)**:
     1.6, Keras version: 2.1.3-tf
- **Python version**: 
     3.5
- **Bazel version (if compiling from source)**:
- **GCC/Compiler version (if compiling from source)**:
- **CUDA/cuDNN version**:
     9/7
- **GPU model and memory**:
       GeForce 860M
- **Exact command to reproduce**:
     plot_model(model1, to_file='model1.png')
You can collect some of this information using our environment capture script:

https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh

You can obtain the TensorFlow version with

python -c ""import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)""

### Describe the problem
Describe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.
 I am getting the following error with the  Keras plot_model()  command. 
'Model' object has no attribute '_container_nodes'
This error was first reported in #14542 and fixed in #14553. But it seems to have not carried over.

### Source code / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.

```
input_X1 = Input(shape=(32,))
y1 = Dense(units=64, activation='relu')(input_X1)
y1 = Dense(units=32, activation='relu')(y1)
prediction1 = Dense(units=1, activation='relu',name='prediction_2')(y1) #
model1 = Model(inputs=input_X1,outputs=prediction1,name='model1')
plot_model(model1, to_file='mobilenet1.png')
```",True
tf1.6 error: tf.contrib.ffmpeg.decode_video ,"@yongtang  I use tensorflow 1.6on ubuntu and decodevideo.

`with tf.Session() as sess:
  movie_bin = tf.read_file('/home/xucl/app/data/bilibili/video/DongFangLieChe.mp4')
  movie = tf.contrib.ffmpeg.decode_video(movie_bin)
  movie_ev = movie.eval()
  print(""****"",len(movie_ev))`

but get an error

`2018-03-08 10:48:23.000491: F tensorflow/contrib/ffmpeg/default/ffmpeg_lib.cc:400] Non-OK-status: ReadInfoFile(stderr_filename, width, height, frames) status: Unknown: Not enough video info returned by FFmpeg [106, 0, 640, 3]Could not read FFmpeg stderr file: /tmp/tmp_file_tensorflow_3_cPNCGW.err
已放弃 (核心已转储)
`
",True
CI: TensorFlow build is failing on Windows ,"Before merging #16659, we should fix the TF build on Windows first.

Current failure:
```
subprocess.CalledProcessError: Command '['bazel', '--batch', 'version']' returned non-zero exit status 36
```
Culprit is https://github.com/tensorflow/tensorflow/commit/671baf080238025da9698ea980cd9504005f727c
because `f.write('import %s\n' % _TF_BAZELRC)` writes backslash into bazelrc file without escaping.
I'll send a fix.
FYI, @gunan @martinwicke @case540 
",True
NotFoundError: Op type not registered 'KafkaDataset' in binary. ,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: - 
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04
- **TensorFlow installed from (source or binary)**: source
- **TensorFlow version (use command below)**: ('unknown', '1.6.0-rc1')
- **Python version**: 2.7
- **Bazel version (if compiling from source)**: 0.8.0
- **GCC/Compiler version (if compiling from source)**: 5.4.0
- **CUDA/cuDNN version**: -
- **GPU model and memory**: -
- **Exact command to reproduce**:

~~~python
from tensorflow.contrib.kafka.python.ops import kafka_dataset_ops
from tensorflow.python.data.ops import iterator_ops
from tensorflow.python.framework import dtypes
from tensorflow.python.ops import array_ops

topics = array_ops.placeholder(dtypes.string, shape=[None])
num_epochs = array_ops.placeholder(dtypes.int64, shape=[])
batch_size = array_ops.placeholder(dtypes.int64, shape=[])

repeat_dataset = kafka_dataset_ops.KafkaDataset(
    topics, group=""test"", eof=True).repeat(num_epochs)
batch_dataset = repeat_dataset.batch(batch_size)

iterator = iterator_ops.Iterator.from_structure(batch_dataset.output_types)
init_op = iterator.make_initializer(repeat_dataset)
init_batch_op = iterator.make_initializer(batch_dataset)
get_next = iterator.get_next()
~~~

ENV: https://pastebin.com/89aihba7

### Describe the problem
Getting `NotFoundError` even with `TF_NEED_KAFKA=1` and `--define with_kafka_support=true`:
~~~
NotFoundError: Op type not registered 'KafkaDataset' in binary running on 68a9f992375e. Make sure the Op and Kernel are registered in the binary running in this process.
~~~
`KafkaDataset` was merged into master last month. Is there something missing that needs to be done in order to utilize the new op? 


### Source code / logs
https://pastebin.com/5Vy6b6kf",True
tf.einsum not replicating np.einsum; struggles to read input with whitespace ,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:  Linux Ubuntu 16.04
- **TensorFlow installed from (source or binary)**: Not sure
- **TensorFlow version (use command below)**: v1.5.0-0-g37aa430d84 1.5.0
- **Python version**:  3.5.2
- **Bazel version (if compiling from source)**: N/A
- **GCC/Compiler version (if compiling from source)**: N/A
- **CUDA/cuDNN version**: 8.0.61
- **GPU model and memory**:  NVIDIA Corporation GK210GL [Tesla K80] (rev a1)
- **Exact command to reproduce**: See below.


### Problem
Unlike `np.einsum`, I have found that `tf.einsum` struggles to parse input strings with spaces.
Either it throws an error, or it produces varying results for the same syntax (e.g. `ij,jk->ik` gives different results than `ij,jk-> ik`). 

I believe the problem traces to the regular expressions match in line 164 (carried to line 178) of this file: `tensorflow/tensorflow/python/ops/special_math_ops.py`.


### Source code
```
import tensorflow as tf
import numpy as np

import tensorflow.contrib.eager as tfe
tfe.enable_eager_execution()

x = tf.range(5,10,  dtype=tf.float64)
y = tf.ones(shape=(2,6), dtype=tf.float64)

# Each invocation of tf.einsum produces a different result
tf.einsum(""i,jk->ijk"", x, y)    # shape = (5,2,6)
tf.einsum(""i,jk-> ijk"", x, y)   # shape = ()
tf.einsum(""i, jk -> ijk"", x, y) # Error

x = np.arange(5,10,  dtype=np.float64)
y = np.ones(shape=(2,6), dtype=np.float64)

# In contrast, np.einsum produces consistent results
np.einsum(""i,jk->ijk"", x, y)    # Array 5x2x6
np.einsum(""i,jk-> ijk"", x, y)   # Array 5x2x6
np.einsum(""i, jk -> ijk"", x, y) # Array 5x2x6
```",True
"incorrect logging formatting used in tensorflow / examples / image_retraining / retrain.py, causes error ","In tensorflow -> examples -> image_retraining -> retrain.py, currently lines 347 / 348 look like this:

```
tf.logging.info('Successfully downloaded', filename, statinfo.st_size,
                    'bytes.')
```

This understandably causes an error since this function accepts strings and it is being fed an instance of statinfo.st_size which does not seem to be a string.  On my machine at least (TensorFlow 1.5, Windows 10) this causes the following error in function maybe_download_and_extract:

`TypeError: not all arguments converted during string formatting`

Here is a screenshot if that helps:

![error](https://user-images.githubusercontent.com/5672876/35772391-74f4433c-08f2-11e8-83d2-084605c14844.png)

The line numbers are slightly different in my screenshot because I moved a few lines around, but I can assure you the line above is causing the logging error.

I would suggest changing this line to the following, or similar:

`tf.logging.info('Successfully downloaded ' + str(filename) + ', statinfo.st_size = ' + str(statinfo.st_size) + ' bytes')`
",True
Feature deprecated in h5py is used in TF1.5 stat:awaiting response,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux, OS X
- **TensorFlow installed from (source or binary)**: source and binary
- **TensorFlow version (use command below)**: 1.5
- **Python version**: 3.6.4
- **Bazel version (if compiling from source)**: 0.9
- **GCC/Compiler version (if compiling from source)**: 
- **CUDA/cuDNN version**: 9.0 - 7.0
- **GPU model and memory**: GTX1060, GTX 1050Ti 
- **Exact command to reproduce**:
`sudo pip3 install h5py`
run python3, from there, type:
`import tensorflow as tf`


### Describe the problem
A feature of h5py used in TF 1.5 is deprecated, in particular: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated.

### Source code / logs
Warning message: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
",True
"Cannot opened include file ""tensorflow/contrib/tpu/proto/tpu_embedding_config.pb.h"": no such file or directory ","### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Windows 10
- **TensorFlow installed from (source or binary)**: source 
- **TensorFlow version (use command below)**: current git master branch, should be v1.4.1 or v1.5.0rc1?
- **Python version**: N/A
- **Bazel version (if compiling from source)**: N/A
- **GCC/Compiler version (if compiling from source)**: MSVC2015
- **CUDA/cuDNN version**: CPU build only, gpu function is off
- **GPU model and memory**: N/A
- **Exact command to reproduce**: Trying a minimal build with cmake, with only snappy support and optimize for native arch turned on

### Describe the problem
Build failing due to missing header files ""tensorflow/contrib/tpu/proto/tpu_embedding_config.pb.h"".

Everything build succesful except for tpu project. I don't really know how to generate the pb.h file from protoc manually. I trying to fix the problem by chaning .cmake files, but not sure which one is for tpu.

### Source code / logs
133>D:\MSVC-source\tensorflow\tensorflow\contrib\tpu\ops\tpu_embedding_ops.cc(16): fatal error C1083: Cannot open include file: 'tensorflow/contrib/tpu/proto/tpu_embedding_config.pb.h': No such file or directory

",True
Dataset from string generator raises Exception with python 2 stat:awaiting response,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: MacOS X 10.12.6
- **TensorFlow installed from (source or binary)**: binary cpu version from pypi
- **TensorFlow version (use command below)**: ('v1.5.0-rc0-9-gf9472619f6', '1.5.0-rc1')
- **Python version**: 2.7.14

### Describe the problem
I'm reading text data from file in generator. Encoding: UTF-8.
After some preprocessing i return it in generator manner.
Next, i'm trying to create Dataset from this generator.

Code below produce exception in both Python 2&3 for TensorFlow 1.4.
For TF 1.5.rc1 & Python 3 there is no errors.
For TF 1.5.rc1 & Python 2 error exist.

### Source code / logs
```python
# -*- coding: utf-8 -*-
from __future__ import absolute_import
from __future__ import division
from __future__ import print_function

import tensorflow as tf


def generator():
    data = [
        [u'Простой', u'тест', u'юникода'],
        [u'никогда', u'не', u'бывает', u'простым']
    ]

    for seq in data:
        yield seq, [0, 1, 2, 3]


def dataset():
    dataset = tf.data.Dataset.from_generator(
        generator,
        (tf.string, tf.int32),
        (tf.TensorShape([None]), tf.TensorShape([None]))
    )
    dataset = dataset.padded_batch(2, padded_shapes=([None], [None]), padding_values=('', 0))

    return dataset


iterator = dataset().make_one_shot_iterator()
next_element = iterator.get_next()

with tf.Session() as sess:
    value = sess.run(next_element)
    print(value)
```",True
Exception when not providing optional parameter frequency_skip in TimeFreqLSTMCell stat:contribution welcome type:bug,"### System information
- Have I written custom code (as opposed to using a stock example script provided in TensorFlow): Yes, see below
- OS Platform and Distribution: 
- TensorFlow installed from: `pip3 install --user tensorflow-gpu`
- TensorFlow version: 1.4.1
- Python version: 3.5.2
- CUDA: 8.0
- GPU: NVidia Titan X

### Describe the problem

Using a `TimeFreqLSTMCell` in a `dynamic_rnn` or `static_rcnn` without providing the optional parameter `frequency_skip` results in an exception:

```
TypeError: unsupported operand type(s) for /: 'int' and 'NoneType'
```

The line which throws this exception is https://github.com/tensorflow/tensorflow/blob/8b78c23c161c9d0bec462d5f4c73f0fca413bc8b/tensorflow/contrib/rnn/python/ops/rnn_cell.py#L474-L475
`frequency_skip` has it's default value `None` here.

Maybe the default should be changed to `1`?

### Source code / logs

Sadly I am not allowed to share my full source code. However, this is how I create the RNN layers:

```
lstmcell = tf.contrib.rnn.TimeFreqLSTMCell(lstm_input.shape.as_list()[2], forget_bias = self.lstm_forget_bias, feature_size = lstm_input_rev.shape.as_list()[2])
                
stacked_lstm = tf.nn.rnn_cell.MultiRNNCell([lstmcell] * self.layers_lstm)
                
lstm_output, lstm_state = tf.nn.dynamic_rnn(stacked_lstm, lstm_input_rev, dtype=""float32"", time_major=True)
```",True
Feature Request: clarify supported environments for official binaries. ,"As it stands now, binary release of TensorFlow 1.5 is set to drop compatibility with Ubuntu 14.04 ( https://github.com/tensorflow/tensorflow/issues/15777), and compatibility with Debian Linux distros, such as Amazon Linux AMI (`ImportError: /lib64/libm.so.6: version `GLIBC_2.23' not found`).

To avoid surprise, TensorFlow should either:
1. Follow other open-source projects like Ray/PyTorch and provide official binaries for these systems
or
2. Document that support is dropped, to encourage other players (ie, AWS) to take over the job of providing these binaries

@martinwicke",True
Imperfect implementation of tf.losses.mean_pairwise_squared_error stat:awaiting response,"### System information
- **TensorFlow version**: 1.4.0, 1.4.1, and 1.5.0-rc0 (checked)
- **Have I written custom code**: N/A
- **OS Platform and Distribution**: N/A
- **TensorFlow installed from**: N/A
- **Bazel version**: N/A
- **CUDA/cuDNN version**: N/A
- **GPU model and memory**: N/A
- **Exact command to reproduce**: N/A

### Describe the problem
The implementation of `tf.losses.mean_pairwise_squared_error` looks imperfect.
For example, as explained in [the API reference of the function](https://www.tensorflow.org/api_docs/python/tf/losses/mean_pairwise_squared_error)
> For example, if `labels`=[a, b, c] and `predictions`=[x, y, z], there are three pairs of differences are summed to compute the loss: loss = [ ((a-b) - (x-y)).^2 + ((a-c) - (x-z)).^2 + ((b-c) - (y-z)).^2 ] / 3

let me put the following data as `labels` and `predictions`:
```
labels = tf.constant([[0., 0.5, 1.]])
predictions = tf.constant([[1., 1., 1.]])
tf.losses.mean_pairwise_squared_error(labels, predictions)
```
In this case, the result should be `[(0-0.5)^2+(0-1)^2+(0.5-1)^2]/3=0.5`, but tensorflow returns different value 0.3333333134651184.

### Suggestion to fix the source code
[tensorflow/python/ops/losses/losses_impl.py](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/ops/losses/losses_impl.py)

If the loss function `mean_pairwise_squared_error` measures the differences between pairs of corresponding elements of `predictions` and `labels` as explained in [the API reference of the function](https://www.tensorflow.org/api_docs/python/tf/losses/mean_pairwise_squared_error), here is a simple patch:
> (lines 520-521 need to be changed as)
> `term1 = 2.0 * _safe_div(sum_squares_diff_per_batch, num_present_per_batch-1)`
and
> (lines 525-526 need to be changed as)
> `term2 = 2.0 * _safe_div(math_ops.square(sum_diff), math_ops.multiply(num_present_per_batch, num_present_per_batch-1))`
  ",True
Switching branch and run ./configure does not regenerate spec.json type:build/install,"When building from source with TensorFlow and switch to another branch, error returned even if I rerun `./configure`:

```
ubuntu@ubuntu:~/tensorflow$ bazel build --config=opt //tensorflow/tools/pip_package:build_pip_package
..........
ubuntu@ubuntu:~/tensorflow$ git checkout -b test
ubuntu@ubuntu:~/tensorflow$ ./configure
..........
ubuntu@ubuntu:~/tensorflow$ bazel build --config=opt //tensorflow/tools/pip_package:build_pip_package
..........
INFO: Analysed target //tensorflow/tools/pip_package:build_pip_package (252 packages loaded).
INFO: Found 1 target...
ERROR: /home/ubuntu/tensorflow/tensorflow/core/BUILD:1671:1: Executing genrule //tensorflow/core:version_info_gen failed (Exit 1)
Traceback (most recent call last):
  File ""tensorflow/tools/git/gen_git_source.py"", line 284, in <module>
    generate(args.generate)
  File ""tensorflow/tools/git/gen_git_source.py"", line 229, in generate
    (old_branch, new_branch))
RuntimeError: Run ./configure again, branch was 'refs/heads/master' but is now 'refs/heads/test'
Target //tensorflow/tools/pip_package:build_pip_package failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 9.025s, Critical Path: 0.30s
FAILED: Build did NOT complete successfully
```


I think the issue is that `spec.json` is not updated when running `./configure`


```
ubuntu@ubuntu:~/tensorflow$ cat /home/ubuntu/.cache/bazel/_bazel_ubuntu/ad1e09741bb4109fbc70ef8216b59ee2/external/local_config_git/gen/spec.json
{
  ""path"": ""/home/ubuntu/.cache/bazel/_bazel_ubuntu/ad1e09741bb4109fbc70ef8216b59ee2/external/org_tensorflow/"", 
  ""git"": true, 
  ""branch"": ""refs/heads/master""
}
ubuntu@ubuntu:~/tensorflow$ 
```

------------------------

### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04
- **TensorFlow installed from (source or binary)**: source
- **TensorFlow version (use command below)**: master
- **Python version**:  2.7.12
- **Bazel version (if compiling from source)**: 0.9.0
- **GCC/Compiler version (if compiling from source)**: gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.5) 
- **CUDA/cuDNN version**: N/A
- **GPU model and memory**: N/A
- **Exact command to reproduce**:

```sh
git checkout -b test
./configure
bazel build --config=opt //tensorflow/tools/pip_package:build_pip_package
```

You can collect some of this information using our environment capture script:

https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh

You can obtain the TensorFlow version with

python -c ""import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)""

### Describe the problem
Describe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.

### Source code / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.

  ",True
Sample Distorted Bounding Box Bug awaiting review stat:awaiting tensorflower,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**:
Stock Example
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:
16.04.3 LTS
- **TensorFlow installed from (source or binary)**:
Source
- **TensorFlow version (use command below)**:
1.4.0
- **Python version**: 
Python 3.5.2
- **Bazel version (if compiling from source)**:
0.7.0
- **GCC/Compiler version (if compiling from source)**:
5.4.0
- **CUDA/cuDNN version**:
cuda_9.0.176_384.81 / cudnn 7
- **GPU model and memory**:
GTX 755M 2gb Memory x2
- **Exact command to reproduce**:
begin, size, bbox_for_draw = tf.image.sample_distorted_bounding_box(
        tf.shape(image),
        bounding_boxes=bounding_boxes)


### Describe the problem
When using the tf.image.sample_distorted_bounding_box() function the parameter min_object_covered seems to default to value None which causes an error (ValueError: None values not supported.)  If you give an argument for min_object_covered it seems to work fine.

There seems to be two versions of this function in the source [v2 which takes min_object_covered](https://github.com/tensorflow/tensorflow/blob/fc49f43817e363e50df3ff2fd7a4870ace13ea13/tensorflow/core/ops/image_ops.cc#L930) as a argument and a [v1](https://github.com/tensorflow/tensorflow/blob/fc49f43817e363e50df3ff2fd7a4870ace13ea13/tensorflow/core/ops/image_ops.cc#L844) which has the default value of 0.1 as an attribute.  It appears v2 is the one [being used](https://github.com/tensorflow/tensorflow/blob/73658420db2498ad7f07363bfa72cba6e2d9fdd2/tensorflow/python/ops/image_ops_impl.py#L1536).  Not sure what approach is best to take for fixing this bug but believe the root of the issue is coming from tensorflow/core/ops/image_ops.cc

### Source code / logs
Attached
[boundingbox.txt](https://github.com/tensorflow/tensorflow/files/1576836/boundingbox.txt)

Examples of code being implemented [here](https://github.com/wagonhelm/image_augment/blob/master/DataAug.ipynb).

",True
XLA/AOT Windows support stat:awaiting response stat:community support stale,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Windows 10 x64
- **TensorFlow installed from (source or binary)**: source
- **TensorFlow version (use command below)**: master
- **Python version**: 3.6
- **Bazel version (if compiling from source)**: 0.8.0
- **GCC/Compiler version (if compiling from source)**: VS 2017 15.5
- **CUDA/cuDNN version**: N/A
- **GPU model and memory**: N/A
- **Exact command to reproduce**: N/A

Similar to #8310, but specifically about running `tfCompile` on Windows rather than Linux to produce `x86_64-windows-msvc` binaries.

XLA/AOT depends on LLVM which has excellent Windows support via CMake, but Bazel cannot interop with CMake. [llvm.BUILD](https://github.com/tensorflow/tensorflow/blob/master/third_party/llvm/llvm.BUILD) is auto-generated and the script to generate it is not open-sourced, this make it difficult for external contributor to make improvement. [tensorflow/compiler](https://github.com/tensorflow/tensorflow/tree/master/tensorflow/compiler) might not need too much changes as #9908 already addressed some of them.

One possible path is to let user to run CMake in host machine when invoking `configure.py`, then feed CMake generated files into custom script to generate `LLVM.BUILD`.

Note:

[Rumour has it](https://chromium-review.googlesource.com/c/chromium/src/+/753588) that there is a Google-internal tool called `tfNative` to generate `.h/.cpp` files instead of `.lib` binaries, though I suspect that even if the tool is open-sourced, it might not be immediately available for Windows developers.",True
CMake: If/else statement in CMAKE_CACHE_ARGS breaks CMake build on Ubuntu 17.10 stat:contribution welcome type:build/install,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No.
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 17.10.
- **TensorFlow installed from (source or binary)**: Source (CMake)
- **TensorFlow version (use command below)**: 2cfb088cf72b52c74a742d780cc5c4f93a74640e (tip of master at time of writing)
- **Python version**: 2.7
- **Bazel version (if compiling from source)**:
- **GCC/Compiler version (if compiling from source)**: 7.2.0
- **CUDA/cuDNN version**:
- **GPU model and memory**:
- **Exact command to reproduce**: cmake ../../tensorflow/contrib/cmake && make

### Source code / logs
    [  1%] Performing build step for 'zlib'
    [ 40%] Built target zlibstatic
    [ 42%] Linking C shared library libz.so
    /usr/bin/ld: CMakeFiles/zlib.dir/deflate.o: relocation R_X86_64_PC32 against symbol `deflate' can not be used when making a shared object; recompile with -fPIC
    /usr/bin/ld: final link failed: Bad value
    collect2: error: ld returned 1 exit status

### Cause
In v1.4.0, you will find the argument `-DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=ON` given to  CMAKE_CACHE_ARGS for several external projects (png, zlip, sqlite etc). In master, this has been changed to 

	CMAKE_CACHE_ARGS
		if(tensorflow_ENABLE_POSITION_INDEPENDENT_CODE)
			-DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=ON
		else()
			-DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=OFF
		endif()

which yields the following init cache entries on my machine: 

	set(CMAKE_POSITION_INDEPENDENT_CODE ""ON;if;(;tensorflow_ENABLE_POSITION_INDEPENDENT_CODE;);else;(;)"" CACHE BOOL ""Initial cache"" FORCE)
	set(CMAKE_POSITION_INDEPENDENT_CODE ""OFF;endif;(;)"" CACHE BOOL ""Initial cache"" FORCE)

and the build fails because `CMAKE_POSITION_INDEPENDENT_CODE` ends up not being set to `ON`. I could imagine this breaks a lot of builds. Perhaps CMake behaves differently on Windows and therefore this has not been caught? Is there a reason for this change I am not aware of? 

### Solution
A possible solution is to not inline the if/else statement and instead use the argument

    -DCMAKE_POSITION_INDEPENDENT_CODE:BOOL=${tensorflow_ENABLE_POSITION_INDEPENDENT_CODE}

Are you interested in a PR?
",True
"tf.nn.softmax(input, dim=-1, name=None), argument `dim` cannot take negative index other than -1? stat:contribution welcome type:bug","I expect that in the function `tf.nn.softmax(input, dim=-1, name=None)`, the argument `dim` can take dim either positive or negative. However, it seems the only negative index can be taken is -1?

```
import tensorflow as tf

tf.__version__
> '1.4.0'

xx = tf.constant(1, shape=[10, 28, 28, 3], dtype=tf.float32)

tf.nn.softmax(xx, dim=-1)
> <tf.Tensor 'Reshape_1:0' shape=(10, 28, 28, 3) dtype=float32>

tf.nn.softmax(xx, dim=3)
> <tf.Tensor 'Reshape_3:0' shape=(10, 28, 28, 3) dtype=float32>

tf.nn.softmax(xx, dim=-2)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-8-c0dec6c1fa17> in <module>()
----> 1 tf.nn.softmax(xx, dim=-2)

/home/jetadmin/anaconda2/envs/ygtf/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.pyc in softmax(logits, dim, name)
   1665       dimension of `logits`.
   1666   """"""
-> 1667   return _softmax(logits, gen_nn_ops._softmax, dim, name)
   1668 
   1669 

/home/jetadmin/anaconda2/envs/ygtf/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.pyc in _softmax(logits, compute_op, dim, name)
   1624   # Swap logits' dimension of dim and its last dimension.
   1625   input_rank = array_ops.rank(logits)
-> 1626   logits = _swap_axis(logits, dim, math_ops.subtract(input_rank, 1))
   1627   shape_after_swap = array_ops.shape(logits)
   1628 

/home/jetadmin/anaconda2/envs/ygtf/lib/python2.7/site-packages/tensorflow/python/ops/nn_ops.pyc in _swap_axis(logits, dim_index, last_index, name)
   1596     return array_ops.transpose(logits,
   1597                                array_ops.concat([
-> 1598                                    math_ops.range(dim_index), [last_index],
   1599                                    math_ops.range(dim_index + 1, last_index),
   1600                                    [dim_index]

/home/jetadmin/anaconda2/envs/ygtf/lib/python2.7/site-packages/tensorflow/python/ops/math_ops.pyc in range(start, limit, delta, dtype, name)
   1232       delta = cast(delta, inferred_dtype)
   1233 
-> 1234     return gen_math_ops._range(start, limit, delta, name=name)
   1235 
   1236 

/home/jetadmin/anaconda2/envs/ygtf/lib/python2.7/site-packages/tensorflow/python/ops/gen_math_ops.pyc in _range(start, limit, delta, name)
   3257   if _ctx.in_graph_mode():
   3258     _, _, _op = _op_def_lib._apply_op_helper(
-> 3259         ""Range"", start=start, limit=limit, delta=delta, name=name)
   3260     _result = _op.outputs[:]
   3261     _inputs_flat = _op.inputs

/home/jetadmin/anaconda2/envs/ygtf/lib/python2.7/site-packages/tensorflow/python/framework/op_def_library.pyc in _apply_op_helper(self, op_type_name, name, **keywords)
    785         op = g.create_op(op_type_name, inputs, output_types, name=scope,
    786                          input_types=input_types, attrs=attr_protos,
--> 787                          op_def=op_def)
    788       return output_structure, op_def.is_stateful, op
    789 

/home/jetadmin/anaconda2/envs/ygtf/lib/python2.7/site-packages/tensorflow/python/framework/ops.pyc in create_op(self, op_type, inputs, dtypes, input_types, name, attrs, op_def, compute_shapes, compute_device)
   2956         op_def=op_def)
   2957     if compute_shapes:
-> 2958       set_shapes_for_outputs(ret)
   2959     self._add_op(ret)
   2960     self._record_op_seen_by_control_dependencies(ret)

/home/jetadmin/anaconda2/envs/ygtf/lib/python2.7/site-packages/tensorflow/python/framework/ops.pyc in set_shapes_for_outputs(op)
   2207       shape_func = _call_cpp_shape_fn_and_require_op
   2208 
-> 2209   shapes = shape_func(op)
   2210   if shapes is None:
   2211     raise RuntimeError(

/home/jetadmin/anaconda2/envs/ygtf/lib/python2.7/site-packages/tensorflow/python/framework/ops.pyc in call_with_requiring(op)
   2157 
   2158   def call_with_requiring(op):
-> 2159     return call_cpp_shape_fn(op, require_shape_fn=True)
   2160 
   2161   _call_cpp_shape_fn_and_require_op = call_with_requiring

/home/jetadmin/anaconda2/envs/ygtf/lib/python2.7/site-packages/tensorflow/python/framework/common_shapes.pyc in call_cpp_shape_fn(op, require_shape_fn)
    625     res = _call_cpp_shape_fn_impl(op, input_tensors_needed,
    626                                   input_tensors_as_shapes_needed,
--> 627                                   require_shape_fn)
    628     if not isinstance(res, dict):
    629       # Handles the case where _call_cpp_shape_fn_impl calls unknown_shape(op).

/home/jetadmin/anaconda2/envs/ygtf/lib/python2.7/site-packages/tensorflow/python/framework/common_shapes.pyc in _call_cpp_shape_fn_impl(op, input_tensors_needed, input_tensors_as_shapes_needed, require_shape_fn)
    689       missing_shape_fn = True
    690     else:
--> 691       raise ValueError(err.message)
    692 
    693   if missing_shape_fn:

ValueError: Requires start <= limit when delta > 0: 0/-2 for 'range' (op: 'Range') with input shapes: [], [], [] and with computed input tensors: input[0] = <0>, input[1] = <-2>, input[2] = <1>.
```",True
cmake error on MacOS stat:community support,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: MacOS 10.12.6
- **TensorFlow installed from (source or binary)**: source
- **Python version**: python 3.6.2
- **TensorFlow version**: master
- **Bazel version**: 0.7.0-homebrew. Build timestamp: 1510456291
- **CUDA/cuDNN version**: N/A
- **GPU model and memory**: N/A
- **GCC/Compiler version (if compiling from source)**: Apple LLVM version 9.0.0 (clang-900.0.38)
- **Exact command to reproduce**:
```
# in tensorflow directory
cd tensorflow/contrib/cmake
mkdir build
cd build
cmake .. -DCMAKE_BUILD_TYPE=Release -DPYTHON_EXECUTABLE=/usr/local/bin/python3
make tf_tutorials_example_trainer
```

### Describe the problem
Describe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.

I'm following the instructions [here](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/cmake/README.md) to build using cmake on Mac. However during make, the following error is thrown.

### Source code / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.

```
# ...
Scanning dependencies of target tf_tutorials_example_trainer
[100%] Building CXX object CMakeFiles/tf_tutorials_example_trainer.dir/Users/kevenwang/VirtualBoxShared/another_tf/tensorflow/cc/tutorials/example_trainer.cc.o
[100%] Linking CXX executable tf_tutorials_example_trainer
Undefined symbols for architecture x86_64:
  ""_ares_cancel"", referenced from:
      on_readable_cb(grpc_exec_ctx*, void*, grpc_error*) in libgrpc_unsecure.a(grpc_ares_ev_driver_posix.cc.o)
      on_writable_cb(grpc_exec_ctx*, void*, grpc_error*) in libgrpc_unsecure.a(grpc_ares_ev_driver_posix.cc.o)
  ""_ares_destroy"", referenced from:
      grpc_ares_ev_driver_unref(grpc_ares_ev_driver*) in libgrpc_unsecure.a(grpc_ares_ev_driver_posix.cc.o)
  ""_ares_free_data"", referenced from:
      on_srv_query_done_cb(void*, int, int, unsigned char*, int) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
      on_txt_done_cb(void*, int, int, unsigned char*, int) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
  ""_ares_gethostbyname"", referenced from:
      grpc_dns_lookup_ares_impl(grpc_exec_ctx*, char const*, char const*, char const*, grpc_pollset_set*, grpc_closure*, grpc_lb_addresses**, bool, char**) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
      on_srv_query_done_cb(void*, int, int, unsigned char*, int) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
  ""_ares_getsock"", referenced from:
      grpc_ares_notify_on_event_locked(grpc_exec_ctx*, grpc_ares_ev_driver*) in libgrpc_unsecure.a(grpc_ares_ev_driver_posix.cc.o)
  ""_ares_inet_ntop"", referenced from:
      on_hostbyname_done_cb(void*, int, int, hostent*) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
  ""_ares_init"", referenced from:
      _grpc_ares_ev_driver_create in libgrpc_unsecure.a(grpc_ares_ev_driver_posix.cc.o)
     (maybe you meant: _grpc_ares_init, _grpc_resolver_dns_ares_init )
  ""_ares_library_cleanup"", referenced from:
      _grpc_ares_cleanup in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
  ""_ares_library_init"", referenced from:
      _grpc_ares_init in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
  ""_ares_parse_srv_reply"", referenced from:
      on_srv_query_done_cb(void*, int, int, unsigned char*, int) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
  ""_ares_parse_txt_reply_ext"", referenced from:
      on_txt_done_cb(void*, int, int, unsigned char*, int) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
  ""_ares_process_fd"", referenced from:
      on_readable_cb(grpc_exec_ctx*, void*, grpc_error*) in libgrpc_unsecure.a(grpc_ares_ev_driver_posix.cc.o)
      on_writable_cb(grpc_exec_ctx*, void*, grpc_error*) in libgrpc_unsecure.a(grpc_ares_ev_driver_posix.cc.o)
  ""_ares_query"", referenced from:
      grpc_dns_lookup_ares_impl(grpc_exec_ctx*, char const*, char const*, char const*, grpc_pollset_set*, grpc_closure*, grpc_lb_addresses**, bool, char**) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
  ""_ares_search"", referenced from:
      grpc_dns_lookup_ares_impl(grpc_exec_ctx*, char const*, char const*, char const*, grpc_pollset_set*, grpc_closure*, grpc_lb_addresses**, bool, char**) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
  ""_ares_set_servers_ports"", referenced from:
      grpc_dns_lookup_ares_impl(grpc_exec_ctx*, char const*, char const*, char const*, grpc_pollset_set*, grpc_closure*, grpc_lb_addresses**, bool, char**) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
  ""_ares_strerror"", referenced from:
      grpc_dns_lookup_ares_impl(grpc_exec_ctx*, char const*, char const*, char const*, grpc_pollset_set*, grpc_closure*, grpc_lb_addresses**, bool, char**) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
      _grpc_ares_init in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
      on_hostbyname_done_cb(void*, int, int, hostent*) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
      on_srv_query_done_cb(void*, int, int, unsigned char*, int) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
      on_txt_done_cb(void*, int, int, unsigned char*, int) in libgrpc_unsecure.a(grpc_ares_wrapper.cc.o)
      _grpc_ares_ev_driver_create in libgrpc_unsecure.a(grpc_ares_ev_driver_posix.cc.o)
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [tf_tutorials_example_trainer] Error 1
make[2]: *** [CMakeFiles/tf_tutorials_example_trainer.dir/all] Error 2
make[1]: *** [CMakeFiles/tf_tutorials_example_trainer.dir/rule] Error 2
```",True
TF 1.4 build_all_android.sh fails with nsync.a stat:awaiting response type:build/install stale,"Running

    NDK_ROOT=""$HOME/Library/Android/sdk/ndk-bundle"" bash $MAKEFILE_DIR/build_all_android.sh

results in this error

```
/Users/era/Library/Android/sdk/ndk-bundle/toolchains/arm-linux-androideabi-4.9/prebuilt/darwin-x86_64/bin/../lib/gcc/arm-linux-androideabi/4.9.x/../../../../arm-linux-androideabi/bin/ld: error: tensorflow/contrib/makefile/downloads/nsync/builds/armeabi-v7a.android.c++11/nsync.a: malformed archive header name at 8
/Users/era/Library/Android/sdk/ndk-bundle/toolchains/arm-linux-androideabi-4.9/prebuilt/darwin-x86_64/bin/../lib/gcc/arm-linux-androideabi/4.9.x/../../../../arm-linux-androideabi/bin/ld: error: tensorflow/contrib/makefile/downloads/nsync/builds/armeabi-v7a.android.c++11/nsync.a: malformed archive header name at 8
/Users/era/Library/Android/sdk/ndk-bundle/toolchains/arm-linux-androideabi-4.9/prebuilt/darwin-x86_64/bin/../lib/gcc/arm-linux-androideabi/4.9.x/../../../../arm-linux-androideabi/bin/ld: fatal error: tensorflow/contrib/makefile/downloads/nsync/builds/armeabi-v7a.android.c++11/nsync.a: attempt to map 60 bytes at offset 67800 exceeds size of file; the file may be corrupt
collect2: error: ld returned 1 exit status
make: *** [.../tensorflow/tensorflow/contrib/makefile/gen/bin/benchmark] Error 1
```

NDK version 15c, Android Studio 3.0, macOS High Sierra 10.13.1",True
Missing MPI collectives op symbols in TF build ,"Running into a build issue when trying to use MPI collectives. We are able to build a recent version of TF using NVIDIA's changes for CUDA 9/cuDNN 7. However, it appears that the build strips the MPI collectives library ops:

```
% python -c 'import tensorflow.contrib.mpi_collectives as mpi'
Traceback (most recent call last):
 File ""<string>"", line 1, in <module>
 File ""/mnt/home/lib/python3.6/site-packages/tensorflow/contrib/mpi_collectives/__init__.py"", line 126, in <module>
   from tensorflow.contrib.mpi_collectives.mpi_ops import size
 File ""/mnt/home/lib/python3.6/site-packages/tensorflow/contrib/mpi_collectives/mpi_ops.py"", line 59, in <module>
   'MPIAllreduce'])
 File ""/mnt/home/lib/python3.6/site-packages/tensorflow/contrib/mpi_collectives/mpi_ops.py"", line 51, in _load_library
   (expected_op, name))
NameError: Could not find operator MPISize in dynamic library mpi_collectives.so
```

It seems like the issue might be caused by commit 5c7f9e3, which changes linking behavior, but we're unable to bisect due to commit order dependencies.


Anyone have an idea how to fix the issue? We're willing to update the MPI collectives code and submit a PR fix.



### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: We've applied NVIDIA's CUDA 9/cuDNN 7 patches for mixed-precision per this page: http://docs.nvidia.com/deeplearning/sdk/mixed-precision-training/index.html#training_tensorflow
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: 14.04
- **TensorFlow version (use command below)**: ea94bbe9fa9f9b3d01fb057c02ef7873d76bf09c
- **Python version**: 3.6
- **Bazel version**: 0.5.4
- **CUDA/cuDNN version**: CUDA 9.0.103_rc/cuDNN 7.0-rc
- **Exact command to reproduce**: `python -c 'import tensorflow.contrib.mpi_collectives as mpi'`




",True
Name/variable scopes of tensorflow.python.layers.base.Layer stat:awaiting tensorflower,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: Yes
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 16.04
- **TensorFlow installed from (source or binary)**: binary
- **TensorFlow version (use command below)**: 1.3.0
- **Python version**: 3.6
- **Bazel version (if compiling from source)**: N/A
- **CUDA/cuDNN version**: N/A
- **GPU model and memory**: N/A
- **Exact command to reproduce**: N/A

### Describe the problem

This is a tiny code that creates layers and connects them in series.

```python
import tensorflow as tf
from tensorflow.python.layers.base import Layer


class A(Layer):
    def build(self, input_shape):
        self.v = self.add_variable('v', (), tf.float32)
        self.built = True
    
    def call(self, inputs):
        return self.v * inputs
    

# Case 1
with tf.Graph().as_default() as graph:
    x = tf.placeholder(tf.float32, (), 'x')
   
    out = x
    out = A()(out)
    out = A()(out)
    out = A()(out)
    
    tf.summary.FileWriter('/tmp/tensorboard/1', graph=graph).close()

# Case 2
with tf.Graph().as_default() as graph:
    x = tf.placeholder(tf.float32, (), 'x')
   
    out = x
    out = A(name='a')(out)
    out = A(name='a_1')(out)
    out = A(name='a_2')(out)
    
    tf.summary.FileWriter('/tmp/tensorboard/2', graph=graph).close()

# Case 3
with tf.Graph().as_default() as graph:
    x = tf.placeholder(tf.float32, (), 'x')
   
    out = x
    out = A(name='a_1')(out)
    out = A(name='a_2')(out)
    out = A(name='a_3')(out)
    
    tf.summary.FileWriter('/tmp/tensorboard/3', graph=graph).close()
```

#### Results

Other than case 3, an unexpected graph is generated.
Is this a bug?

- Case 1

<img alt=""result"" height=""450"" src=""https://user-images.githubusercontent.com/7009040/31054076-b290a772-a6e5-11e7-8e6a-2d97420b5e0e.png"">

- Case 2

<img alt=""result"" height=""450"" src=""https://user-images.githubusercontent.com/7009040/31054078-b2a7ca7e-a6e5-11e7-9a17-805fd56e6ea7.png"">

- Case 3

<img alt=""result"" height=""450"" src=""https://user-images.githubusercontent.com/7009040/31054077-b291b7c0-a6e5-11e7-9256-be7c986094ec.png"">",True
"make ""build_all_ios.sh""  occur error type:build/install","I try to build tensorflow support at Android and iOS by makefile [tutorial](https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/makefile
) in current master branch 04c318b69c5b565436cfeeaab1cb7fd5419dde27

When running the build_all_ios.sh script, the below error message show
```
Undefined symbols for architecture x86_64:
  ""nsync::nsync_mu_init(nsync::nsync_mu_s_*)"", referenced from:
      tensorflow::mutex::mutex() in env.o
      tensorflow::mutex::mutex() in random.o
  ""nsync::nsync_mu_lock(nsync::nsync_mu_s_*)"", referenced from:
      tensorflow::mutex::lock() in env.o
      tensorflow::mutex::lock() in random.o
      tensorflow::mutex::lock() in histogram.o
  ""nsync::nsync_mu_unlock(nsync::nsync_mu_s_*)"", referenced from:
      tensorflow::mutex::unlock() in env.o
      tensorflow::mutex::unlock() in random.o
      tensorflow::mutex::unlock() in histogram.o
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make: *** [/Users/CSL.Peter/tensorflow/tensorflow/tensorflow/contrib/makefile/gen/host_bin/proto_text] Error 1
+ '[' 2 -ne 0 ']'
+ echo 'armv7 compilation failed.'
armv7 compilation failed.
+ exit 1
```
The `download_dependencies.sh` and `compile_ios_protobuf.sh` run successfully but `compile_ios_tensorflow.sh` failed. I find same issues #3191 and #4252 and seem to be fixed at #4287, but this problem still happen.",True
tf.pow edge case failure type:docs-bug,"The tf.pow() function has an edge case which causes it to hang with no error message.

If you try to evaluate tf.pow(x,y), when x is an integer (and thus the output tensor is also an integer), while y is a negative value, tensorflow hangs trying to cast the fraction as an integer.

Examples;

sess.run(tf.pow([5,2],[-2,3]))
sess.run(tf.pow([5],[-2]))
sess.run(tf.pow(5, -2))
sess.run(tf.pow(tf.constant(5), tf.constant(-2)))",True
tf_cnn_benchmarks.py stuck when running with multiple GPUs and ImageNet data with protocol grpc+verbs stat:contribution welcome type:bug,"### System information
- **Have I written custom code (as opposed to using a stock example script provided in TensorFlow)**: No, running tf_cnn_benchmarks.py from benchmarks repo
- **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 16.04.2 LTS
- **TensorFlow installed from (source or binary)**: Unmodified source with RDMA Verbs enabled
- **TensorFlow version (use command below)**: 1.3.0-rc0
- **Python version**: 2.7.12
- **Bazel version (if compiling from source)**: 0.5.1
- **CUDA/cuDNN version**: 8.0/6
- **GPU model and memory**: NVIDIA Tesla P100 PCIe 16GB (8 per node)
- **Exact command to reproduce**: 

PS: CUDA_VISIBLE_DEVICES='' python tf_cnn_benchmarks.py --ps_hosts 12.12.12.43:20000 --worker_hosts 12.12.12.44:20000,12.12.12.41:20000 --batch_size=64 --model=inception3 --variable_update=parameter_server --local_parameter_device=cpu --job_name=ps --task_index=0 --server_protocol grpc+verbs

Worker0: CUDA_VISIBLE_DEVICES='0,1,2,3,4,5,6,7' python tf_cnn_benchmarks.py --ps_hosts 12.12.12.43:20000 --worker_hosts 12.12.12.44:20000,12.12.12.41:20000 --batch_size=64 --model=inception3 --variable_update=parameter_server --local_parameter_device=cpu --job_name=worker --task_index=0 --num_gpus=8 --data_dir=/data/imagenet_data/ --train_dir=/data/imagenet_train/ --server_protocol grpc+verbs

Worker1: CUDA_VISIBLE_DEVICES='0,1,2,3,4,5,6,7' python tf_cnn_benchmarks.py --ps_hosts 12.12.12.43:20000 --worker_hosts 12.12.12.44:20000,12.12.12.41:20000 --batch_size=64 --model=inception3 --variable_update=parameter_server --local_parameter_device=cpu --job_name=worker --task_index=1 --num_gpus=8 --data_dir=/data/imagenet_data/ --train_dir=/data/imagenet_train/ --server_protocol grpc+verbs

- **RDMA driver version**: MLNX_OFED_LINUX-4.1-1.0.2.0

### Describe the problem
When running the above commands (Inception V3 synchronized data parallelism training with 2 workers and 1 external ps), the tf_cnn_benchmarks application hangs forever after some iterations (usually in warm up).

It happens only when real data is involved (ImageNet), and with >4 GPUs. (More GPUs, less iterations before it hangs). Doesn't happen with grpc protocol, or when running with ""synthetic"" data.

The master_service in the workers is stuck [here](
https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/distributed_runtime/master_session.cc#L608), which I guess means some operations in the computation have not been completed.

The RDMA protocol looks valid and clean, all messages corresponds to the protocol (see below logs). 
There some tensors requested by the workers which they don't receive, but they are passed by the RDMA Verbs transport to the BaseRendezvoudMgr with RecvLocalAsync in a valid way, and for some reason the higher level worker service doesn't trigger the Send kernel on those tensors.

Any help is much appreciated!
If there are some debug mechanisms I can use to understand which tensors/operations have not been completed it can greatly help. I was mostly debugging this from the RDMA Verbs layer till now, without much success, and I feel I don't have enough information there to understand what's missing.
Also I feel we don't have enough knowledge on how the step_id acts (diving into this in the code now, but there's some higher level documentation it can greatly help).

My initial guess was an occurrence of a racy condition when loading the data, since it creates a gap in execution time (worker0 starts the first training step 30-60 seconds after worker1, since it does the preprocessing of the data twice for a reason I couldn't understand yet), but after the first iteration (which usually passes successfully) the time is synchronized between workers.

### Source code / logs
Those are the logs of the runtime after moving the logging in [rdma.cc](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/verbs/rdma.cc) to VLOG(0) (also adding Tensor name and step id for all cases, in some cases the step_id doesn't mean anything like BUFFER_REQUEST/RESPONSE for example), and also some VLOG in [master_session.cc](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/distributed_runtime/master_session.cc)

[worker0](https://gist.github.com/shamoya/15a42f421e088473b8f02bf00c16d0fc)
[worker1](https://gist.github.com/shamoya/dd3126c02c73990a6e28b534d9a9ddf6)
[ps](https://gist.github.com/shamoya/0c856365802ae4d42b38baf988149574)

Unfortunately they are fairly large, but it's better then to cut the log files IMO.
Example for analysis I did in the verbs layer, comparing the Sent Tensor requests to the actual received tensors writes in both workers:

worker 0:
 -  /job:ps/replica:0/task:0/cpu:0;f3c10d28b54074c0;/job:worker/replica:0/task:0/gpu:0;edge_116943_group_deps_2/NoOp_1;0:0 80661058974090965
-  /job:worker/replica:0/task:1/cpu:0;1a50d5c51cd9c5d1;/job:worker/replica:0/task:0/gpu:0;edge_116947_group_deps_3/NoOp_1;0:0 80661058974090965
- /job:worker/replica:0/task:1/gpu:2;7f00fadabfe781f5;/job:worker/replica:0/task:0/gpu:0;edge_111078_group_deps_1/NoOp_2;0:0 80661058974090965
- /job:worker/replica:0/task:1/gpu:4;b07185dd19f62088;/job:worker/replica:0/task:0/gpu:0;edge_111080_group_deps_1/NoOp_4;0:0 80661058974090965

worker 1:
- /job:ps/replica:0/task:0/cpu:0;f3c10d28b54074c0;/job:worker/replica:0/task:1/cpu:0;edge_155113_AssignAdd;0:0 80661058974090965
- /job:worker/replica:0/task:0/gpu:0;f3df8abf03739fe8;/job:worker/replica:0/task:1/cpu:0;edge_116948_group_deps_3;0:0 80661058974090965

The tensors requests received well by the other side and passed to RecvLocalAsync, but are not called later.

Thanks a lot.",True
"softmax_cross_entropy_with_logits aborts the process, if a tensor with zero first dimension is passed as an argument stat:awaiting tensorflower type:bug","### Environment info

Operating System: Ubuntu 16.04
Installed version of CUDA and cuDNN: CUDA-8.0, CUDNN 5.1.5 

Tensorflow version: 0.12.1 installed from
https://storage.googleapis.com/tensorflow/linux/gpu/tensorflow_gpu-0.12.1-cp35-cp35m-linux_x86_64.whl

Reproduced also using tf-0.11.0, CUDA-7.5, CUDNN-5.1.3

### Minimal reproducible example 

```
import tensorflow as tf
y = tf.placeholder(""int64"", [None], ""y"")
one_hot_y=tf.one_hot(y,10)
ce = tf.nn.softmax_cross_entropy_with_logits(one_hot_y, one_hot_y)
sess = tf.Session()
sess.run(ce, {y: []})
```
Result on GPU: 
```
E tensorflow/core/common_runtime/bfc_allocator.cc:244] tried to allocate 0 bytes
W tensorflow/core/common_runtime/allocator_retry.cc:32] Request to allocate 0 bytes
F tensorflow/core/common_runtime/gpu/gpu_device.cc:104] EigenAllocator for GPU ran out of memory when allocating 0. See error logs for more detailed info.
Aborted (core dumped)
```
Result on CPU: 
```
array([], dtype=float32)
```",True
tensorflow-0.7.1-cp35-none-linux_x86_64.whl ,"sudo pip3 install --upgrade http://storage.googleapis.com/tensorflow/linux/gpu/tensorflow-0.7.1-cp35-none-linux_x86_64.whl
tensorflow-0.7.1-cp35-none-linux_x86_64.whl is not a supported wheel on this platform.
Storing debug log for failure in /home/xxx/.pip/pip.log
",True
Can't recognize GPU in tensorflow. type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.14

### Custom code

Yes

### OS platform and distribution

Windows 10

### Mobile device

_No response_

### Python version

3.11.1

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11.2/8.1

### GPU model and memory

nvidia GTX 1060 6GB

### Current behavior?

I installed tensorflow and cuda/cudnn but cannot see GPU in tensorflow. 
print('GPU', tf.config.list_physical_devices('GPU'))
The output is:
GPU []
The output of 'print(tf.config.list_physical_devices())' is
[PhysicalDevice(name='/physical_device:CPU:0', device_type='CPU')]

### Standalone code to reproduce the issue

```shell
import tensorflow as tf
print(tf.config.list_physical_devices())
print('GPU', tf.config.list_physical_devices('GPU'))
```


### Relevant log output

_No response_",True
Callbacks - tf.keras.callbacks.ModelCheckpoint and tf.keras.callbacks.EarlyStopping -> set_params not working  type:bug comp:keras TF2.14,"```
Issue type                                           : Bug
Have you reproduced the bug with TensorFlow Nightly? : No
Source                                               : source
TensorFlow version                                   : v2.14.0-rc1-21-g4dacf3f368e 2.14.0
Custom code                                          : Yes
OS platform and distribution                         : Google colab 
Python version                                       : Python 3.10.12
```

`tf.keras.callbacks.ModelCheckpoint` and `tf.keras.callbacks.EarlyStopping`  -> set_params not working as assumed. 

```python 
import tensorflow as tf                                                         # load tensorflow 
ckpt=tf.keras.callbacks.ModelCheckpoint('/content/')                            # make check point 
ckpt_params=ckpt.__dict__                                                       # get all parameters 
print('Parameters:',ckpt_params)                                                # see parameters dictionary
ckpt_params['save_best_only']=True                                              # update parameter ""save_best_only"" to True (default False)
ckpt_params['save_weights_only']=True                                           # update parameter ""save_weights_only"" to True (default False)
ckpt.set_params(ckpt_params)                                                    # try to make update parameters
print('Is same as updated?',ckpt_params==ckpt.__dict__)                         # make check both are same or not 
# both look same but if you look carefully `ckpt_params` and `ckpt.__dict__` will contain copy of themself in new key `'params'`
print('Parameters:',ckpt_params)                                                # see parameters dictionary
```
```shell
Parameters: {'validation_data': None, 'model': None, '_chief_worker_only': False, '_supports_tf_logs': True, 'monitor': 'val_loss', 'verbose': 0, 'filepath': '/content/', 'save_best_only': False, 'save_weights_only': False, 'save_freq': 'epoch', 'epochs_since_last_save': 0, '_batches_seen_since_last_saving': 0, '_last_batch_seen': 0, 'best': inf, '_options': <tensorflow.python.saved_model.save_options.SaveOptions object at 0x7a5f5942f5e0>, 'load_weights_on_restart': False, 'period': 1, 'monitor_op': <ufunc 'less'>}
Is same as updated? True
Parameters: {'validation_data': None, 'model': None, '_chief_worker_only': False, '_supports_tf_logs': True, 'monitor': 'val_loss', 'verbose': 0, 'filepath': '/content/', 'save_best_only': True, 'save_weights_only': True, 'save_freq': 'epoch', 'epochs_since_last_save': 0, '_batches_seen_since_last_saving': 0, '_last_batch_seen': 0, 'best': inf, '_options': <tensorflow.python.saved_model.save_options.SaveOptions object at 0x7a5f5942f5e0>, 'load_weights_on_restart': False, 'period': 1, 'monitor_op': <ufunc 'less'>, 'params': {...}}
```

This change can be seen by making a copy of `ckpt_params`. 

```python 
import tensorflow as tf                                                         # load tensorflow 
ckpt=tf.keras.callbacks.ModelCheckpoint('/content/')                            # make check point 
ckpt_params=ckpt.__dict__.copy()                                                # get all parameters 
print('Parameters:',ckpt_params)                                                # see parameters dictionary
ckpt_params['save_best_only']=True                                              # update parameter ""save_best_only"" to True (default False)
ckpt_params['save_weights_only']=True                                           # update parameter ""save_weights_only"" to True (default False)
#ckpt_params_deep_copy={key:value for key,value in ckpt_params.items()}          # make deep copy of `ckpt_params`
ckpt.set_params(ckpt_params)                                                    # try to make update parameters
print('Is same as updated?',ckpt_params==ckpt.__dict__)                         # make check both are same or not 
# both look same but if you look carefully `ckpt_params` and `ckpt.__dict__` will contain copy of themself in new key `'params'`
print('Uncomman parameters:',[key for key in ckpt.__dict__ if key not in ckpt_params])# see parameters dictionary
print('Uncomman parameters:',ckpt.__dict__['params'])                           # which is copy of itself only 
```
```shell
Parameters: {'validation_data': None, 'model': None, '_chief_worker_only': False, '_supports_tf_logs': True, 'monitor': 'val_loss', 'verbose': 0, 'filepath': '/content/', 'save_best_only': False, 'save_weights_only': False, 'save_freq': 'epoch', 'epochs_since_last_save': 0, '_batches_seen_since_last_saving': 0, '_last_batch_seen': 0, 'best': inf, '_options': <tensorflow.python.saved_model.save_options.SaveOptions object at 0x7a5f5942e3e0>, 'load_weights_on_restart': False, 'period': 1, 'monitor_op': <ufunc 'less'>}
Is same as updated? False
Uncomman parameters: ['params']
Uncomman parameters: {'validation_data': None, 'model': None, '_chief_worker_only': False, '_supports_tf_logs': True, 'monitor': 'val_loss', 'verbose': 0, 'filepath': '/content/', 'save_best_only': True, 'save_weights_only': True, 'save_freq': 'epoch', 'epochs_since_last_save': 0, '_batches_seen_since_last_saving': 0, '_last_batch_seen': 0, 'best': inf, '_options': <tensorflow.python.saved_model.save_options.SaveOptions object at 0x7a5f5942e3e0>, 'load_weights_on_restart': False, 'period': 1, 'monitor_op': <ufunc 'less'>}
```
Worse is with `tf.keras.callbacks.EarlyStopping`. It not only make a copy but also don't update parameters. 
```python
import tensorflow as tf                                                         # load tensorflow 
lstp=tf.keras.callbacks.EarlyStopping()                                         # make check point 
lstp_params=lstp.__dict__.copy()                                                # get all parameters 
print('Parameters        :',lstp_params)                                        # see parameters dictionary
lstp_params['patience']=10                                                      # update parameter ""patience"" to 10 (default 0)
lstp_params['verbose']=1                                                        # update parameter ""verbose"" to 1 (default 0)
print('Updated parameters:',lstp_params)                                        # see updated parameters 
lstp.set_params(lstp_params.copy())                                             # try to make update parameters
print('Is same as updated?',lstp_params==lstp.__dict__)                         # make check both are same or not 
# Even values are not updated from `lstp_params` and `lstp.__dict__` will contain copy of themself in new key `'params'`
print('Object parameters :',lstp.__dict__)                                              # see parameters dictionary
```
```shell
Parameters        : {'validation_data': None, 'model': None, '_chief_worker_only': None, '_supports_tf_logs': False, 'monitor': 'val_loss', 'patience': 0, 'verbose': 0, 'baseline': None, 'min_delta': 0, 'wait': 0, 'stopped_epoch': 0, 'restore_best_weights': False, 'best_weights': None, 'start_from_epoch': 0, 'monitor_op': <ufunc 'less'>}
Updated parameters: {'validation_data': None, 'model': None, '_chief_worker_only': None, '_supports_tf_logs': False, 'monitor': 'val_loss', 'patience': 10, 'verbose': 1, 'baseline': None, 'min_delta': 0, 'wait': 0, 'stopped_epoch': 0, 'restore_best_weights': False, 'best_weights': None, 'start_from_epoch': 0, 'monitor_op': <ufunc 'less'>}
Is same as updated? False
Object parameters : {'validation_data': None, 'model': None, '_chief_worker_only': None, '_supports_tf_logs': False, 'monitor': 'val_loss', 'patience': 0, 'verbose': 0, 'baseline': None, 'min_delta': 0, 'wait': 0, 'stopped_epoch': 0, 'restore_best_weights': False, 'best_weights': None, 'start_from_epoch': 0, 'monitor_op': <ufunc 'less'>, 'params': {'validation_data': None, 'model': None, '_chief_worker_only': None, '_supports_tf_logs': False, 'monitor': 'val_loss', 'patience': 10, 'verbose': 1, 'baseline': None, 'min_delta': 0, 'wait': 0, 'stopped_epoch': 0, 'restore_best_weights': False, 'best_weights': None, 'start_from_epoch': 0, 'monitor_op': <ufunc 'less'>}}
```




",True
TensorFlow doesn't detect cuda drivers type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.13.1

### Custom code

No

### OS platform and distribution

Li

### Mobile device

Gentoo Linux 6.1.57-gentoo-x86_64

### Python version

3.11.5

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11.8/8.7.0.84

### GPU model and memory

NVIDIA GeForce GTX 1650 Mobile / Max-Q

### Current behavior?

Current behaviour: list of cuda-capable devices is empty

```sh
> python3 -c ""import tensorflow as tf; print(tf.config.list_physical_devices('GPU'))""
2023-11-06 01:01:39.145881: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2023-11-06 01:01:39.200934: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2023-11-06 01:01:39.201518: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-06 01:01:40.245608: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2023-11-06 01:01:41.021740: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-11-06 01:01:41.022476: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1960] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
[]
```

Expected behaviour: list of coda-capable devices contains one item.

I would be happy to reproduce the bug in `tf-nightly`, but I can't even install it due to broken dependencies with tensorrt:

```sh
> python3 -m pip install 'tf-nightly[and-cuda]'
Collecting tf-nightly[and-cuda]
  Using cached tf_nightly-2.16.0.dev20231103-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.5 kB)
Collecting absl-py>=1.0.0 (from tf-nightly[and-cuda])
  Using cached absl_py-2.0.0-py3-none-any.whl.metadata (2.3 kB)
Collecting astunparse>=1.6.0 (from tf-nightly[and-cuda])
  Using cached astunparse-1.6.3-py2.py3-none-any.whl (12 kB)
Collecting flatbuffers>=23.5.26 (from tf-nightly[and-cuda])
  Using cached flatbuffers-23.5.26-py2.py3-none-any.whl.metadata (850 bytes)
Collecting gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 (from tf-nightly[and-cuda])
  Using cached gast-0.5.4-py3-none-any.whl (19 kB)
Collecting google-pasta>=0.1.1 (from tf-nightly[and-cuda])
  Using cached google_pasta-0.2.0-py3-none-any.whl (57 kB)
Collecting h5py>=3.10.0 (from tf-nightly[and-cuda])
  Using cached h5py-3.10.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.5 kB)
Collecting libclang>=13.0.0 (from tf-nightly[and-cuda])
  Using cached libclang-16.0.6-py2.py3-none-manylinux2010_x86_64.whl.metadata (5.2 kB)
Collecting ml-dtypes~=0.3.1 (from tf-nightly[and-cuda])
  Using cached ml_dtypes-0.3.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (20 kB)
Collecting opt-einsum>=2.3.2 (from tf-nightly[and-cuda])
  Using cached opt_einsum-3.3.0-py3-none-any.whl (65 kB)
Collecting packaging (from tf-nightly[and-cuda])
  Using cached packaging-23.2-py3-none-any.whl.metadata (3.2 kB)
Collecting protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 (from tf-nightly[and-cuda])
  Using cached protobuf-4.25.0-cp37-abi3-manylinux2014_x86_64.whl.metadata (541 bytes)
Requirement already satisfied: setuptools in ./miniconda3/envs/tf-test/lib/python3.11/site-packages (from tf-nightly[and-cuda]) (68.0.0)
Collecting six>=1.12.0 (from tf-nightly[and-cuda])
  Using cached six-1.16.0-py2.py3-none-any.whl (11 kB)
Collecting termcolor>=1.1.0 (from tf-nightly[and-cuda])
  Using cached termcolor-2.3.0-py3-none-any.whl (6.9 kB)
Collecting typing-extensions>=3.6.6 (from tf-nightly[and-cuda])
  Using cached typing_extensions-4.8.0-py3-none-any.whl.metadata (3.0 kB)
Collecting wrapt<1.15,>=1.11.0 (from tf-nightly[and-cuda])
  Using cached wrapt-1.14.1-cp311-cp311-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.7 kB)
Collecting grpcio<2.0,>=1.24.3 (from tf-nightly[and-cuda])
  Using cached grpcio-1.59.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.0 kB)
Collecting tb-nightly~=2.16.0.a (from tf-nightly[and-cuda])
  Using cached tb_nightly-2.16.0a20231105-py3-none-any.whl.metadata (1.7 kB)
Collecting tf-estimator-nightly~=2.14.0.dev (from tf-nightly[and-cuda])
  Using cached tf_estimator_nightly-2.14.0.dev2023080308-py2.py3-none-any.whl.metadata (1.3 kB)
Collecting keras-nightly~=3.0.0.dev (from tf-nightly[and-cuda])
  Using cached keras_nightly-3.0.0.dev2023110403-py3-none-any.whl.metadata (5.3 kB)
Collecting tensorflow-io-gcs-filesystem>=0.23.1 (from tf-nightly[and-cuda])
  Using cached tensorflow_io_gcs_filesystem-0.34.0-cp311-cp311-manylinux_2_12_x86_64.manylinux2010_x86_64.whl.metadata (14 kB)
Collecting numpy<2.0.0,>=1.23.5 (from tf-nightly[and-cuda])
  Using cached numpy-1.26.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (61 kB)
Collecting nvidia-cublas-cu12==12.2.5.6 (from tf-nightly[and-cuda])
  Using cached nvidia_cublas_cu12-12.2.5.6-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cuda-cupti-cu12==12.2.142 (from tf-nightly[and-cuda])
  Using cached nvidia_cuda_cupti_cu12-12.2.142-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cuda-nvcc-cu12==12.2.140 (from tf-nightly[and-cuda])
  Using cached nvidia_cuda_nvcc_cu12-12.2.140-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cuda-nvrtc-cu12==12.2.140 (from tf-nightly[and-cuda])
  Using cached nvidia_cuda_nvrtc_cu12-12.2.140-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cuda-runtime-cu12==12.2.140 (from tf-nightly[and-cuda])
  Using cached nvidia_cuda_runtime_cu12-12.2.140-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cudnn-cu12==8.9.4.25 (from tf-nightly[and-cuda])
  Using cached nvidia_cudnn_cu12-8.9.4.25-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cufft-cu12==11.0.8.103 (from tf-nightly[and-cuda])
  Using cached nvidia_cufft_cu12-11.0.8.103-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-curand-cu12==10.3.3.141 (from tf-nightly[and-cuda])
  Using cached nvidia_curand_cu12-10.3.3.141-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cusolver-cu12==11.5.2.141 (from tf-nightly[and-cuda])
  Using cached nvidia_cusolver_cu12-11.5.2.141-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cusparse-cu12==12.1.2.141 (from tf-nightly[and-cuda])
  Using cached nvidia_cusparse_cu12-12.1.2.141-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-nccl-cu12==2.18.3 (from tf-nightly[and-cuda])
  Using cached nvidia_nccl_cu12-2.18.3-py3-none-manylinux1_x86_64.whl.metadata (1.8 kB)
Collecting nvidia-nvjitlink-cu12==12.2.140 (from tf-nightly[and-cuda])
  Using cached nvidia_nvjitlink_cu12-12.2.140-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting tensorrt==8.6.1.post1 (from tf-nightly[and-cuda])
  Using cached tensorrt-8.6.1.post1.tar.gz (18 kB)
  Preparing metadata (setup.py) ... done
Collecting tensorrt-bindings==8.6.1 (from tf-nightly[and-cuda])
  Using cached tensorrt_bindings-8.6.1-cp311-none-manylinux_2_17_x86_64.whl (980 kB)
INFO: pip is looking at multiple versions of tf-nightly[and-cuda] to determine which version is compatible with other requirements. This could take a while.
Collecting tf-nightly[and-cuda]
  Using cached tf_nightly-2.16.0.dev20231102-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.5 kB)
  Using cached tf_nightly-2.16.0.dev20231101-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.5 kB)
  Using cached tf_nightly-2.16.0.dev20231031-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.5 kB)
  Using cached tf_nightly-2.16.0.dev20231026-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.5 kB)
Collecting tb-nightly~=2.15.0.a (from tf-nightly[and-cuda])
  Using cached tb_nightly-2.15.0a20231023-py3-none-any.whl.metadata (1.7 kB)
Collecting tf-nightly[and-cuda]
  Using cached tf_nightly-2.16.0.dev20231025-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.5 kB)
Collecting nvidia-nccl-cu12==2.16.5 (from tf-nightly[and-cuda])
  Using cached nvidia_nccl_cu12-2.16.5-py3-none-manylinux1_x86_64.whl (188.7 MB)
Collecting tf-nightly[and-cuda]
  Using cached tf_nightly-2.16.0.dev20231024-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.5 kB)
  Using cached tf_nightly-2.16.0.dev20231022-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.5 kB)
INFO: pip is still looking at multiple versions of tf-nightly[and-cuda] to determine which version is compatible with other requirements. This could take a while.
  Using cached tf_nightly-2.16.0.dev20231021-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.5 kB)
  Using cached tf_nightly-2.16.0.dev20231020-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.5 kB)
  Using cached tf_nightly-2.16.0.dev20231013-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
Collecting ml-dtypes~=0.2.0 (from tf-nightly[and-cuda])
  Using cached ml_dtypes-0.2.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (20 kB)
Collecting keras-nightly~=2.15.0.dev (from tf-nightly[and-cuda])
  Using cached keras_nightly-2.15.0.dev2023092207-py3-none-any.whl.metadata (2.5 kB)
Collecting tf-nightly[and-cuda]
  Using cached tf_nightly-2.15.0.dev20231012-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20231011-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
INFO: This is taking longer than usual. You might need to provide the dependency resolver with stricter constraints to reduce runtime. See https://pip.pypa.io/warnings/backtracking for guidance. If you want to abort this run, press Ctrl + C.
  Using cached tf_nightly-2.15.0.dev20231010-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20231009-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20231006-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20231005-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20231004-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20231003-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20231002-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20231001-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20230930-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20230929-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20230928-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20230927-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20230926-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20230925-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20230924-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20230923-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20230922-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20230921-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20230920-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20230919-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.4 kB)
  Using cached tf_nightly-2.15.0.dev20230918-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)
Collecting nvidia-cuda-runtime-cu11==11.8.89 (from tf-nightly[and-cuda])
  Using cached nvidia_cuda_runtime_cu11-11.8.89-py3-none-manylinux1_x86_64.whl (875 kB)
Collecting nvidia-cublas-cu11==11.11.3.6 (from tf-nightly[and-cuda])
  Using cached nvidia_cublas_cu11-11.11.3.6-py3-none-manylinux1_x86_64.whl (417.9 MB)
Collecting nvidia-cufft-cu11==10.9.0.58 (from tf-nightly[and-cuda])
  Using cached nvidia_cufft_cu11-10.9.0.58-py3-none-manylinux1_x86_64.whl (168.4 MB)
Collecting nvidia-cudnn-cu11==8.7.0.84 (from tf-nightly[and-cuda])
  Using cached nvidia_cudnn_cu11-8.7.0.84-py3-none-manylinux1_x86_64.whl (728.5 MB)
Collecting nvidia-curand-cu11==10.3.0.86 (from tf-nightly[and-cuda])
  Using cached nvidia_curand_cu11-10.3.0.86-py3-none-manylinux1_x86_64.whl (58.1 MB)
Collecting nvidia-cusolver-cu11==11.4.1.48 (from tf-nightly[and-cuda])
  Using cached nvidia_cusolver_cu11-11.4.1.48-py3-none-manylinux1_x86_64.whl (128.2 MB)
Collecting nvidia-cusparse-cu11==11.7.5.86 (from tf-nightly[and-cuda])
  Using cached nvidia_cusparse_cu11-11.7.5.86-py3-none-manylinux1_x86_64.whl (204.1 MB)
Collecting nvidia-nccl-cu11==2.16.5 (from tf-nightly[and-cuda])
  Using cached nvidia_nccl_cu11-2.16.5-py3-none-manylinux1_x86_64.whl (210.3 MB)
Collecting nvidia-cuda-cupti-cu11==11.8.87 (from tf-nightly[and-cuda])
  Using cached nvidia_cuda_cupti_cu11-11.8.87-py3-none-manylinux1_x86_64.whl (13.1 MB)
Collecting nvidia-cuda-nvcc-cu11==11.8.89 (from tf-nightly[and-cuda])
  Using cached nvidia_cuda_nvcc_cu11-11.8.89-py3-none-manylinux1_x86_64.whl (19.5 MB)
Collecting tf-nightly[and-cuda]
  Using cached tf_nightly-2.15.0.dev20230917-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)
  Using cached tf_nightly-2.15.0.dev20230916-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)
  Using cached tf_nightly-2.15.0.dev20230915-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)
  Using cached tf_nightly-2.15.0.dev20230914-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)
  Using cached tf_nightly-2.15.0.dev20230913-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)
  Using cached tf_nightly-2.15.0.dev20230911-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)
  Using cached tf_nightly-2.15.0.dev20230910-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)
  Using cached tf_nightly-2.15.0.dev20230909-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)
  Using cached tf_nightly-2.15.0.dev20230908-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230907-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230906-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230904-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230903-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230902-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230901-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230831-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230830-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230829-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230828-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230827-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230826-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230825-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230824-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230817-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230816-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230815-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230814-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230813-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230812-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230811-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230810-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
Collecting tb-nightly~=2.14.0.a (from tf-nightly[and-cuda])
  Using cached tb_nightly-2.14.0a20230808-py3-none-any.whl.metadata (1.8 kB)
Collecting keras-nightly~=2.14.0.dev (from tf-nightly[and-cuda])
  Using cached keras_nightly-2.14.0.dev2023080207-py3-none-any.whl.metadata (2.5 kB)
Collecting tf-nightly[and-cuda]
  Using cached tf_nightly-2.15.0.dev20230809-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230808-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
  Using cached tf_nightly-2.15.0.dev20230807-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
ERROR: Cannot install tf-nightly[and-cuda]==2.15.0.dev20230807, tf-nightly[and-cuda]==2.15.0.dev20230808, tf-nightly[and-cuda]==2.15.0.dev20230809, tf-nightly[and-cuda]==2.15.0.dev20230810, tf-nightly[and-cuda]==2.15.0.dev20230811, tf-nightly[and-cuda]==2.15.0.dev20230812, tf-nightly[and-cuda]==2.15.0.dev20230813, tf-nightly[and-cuda]==2.15.0.dev20230814, tf-nightly[and-cuda]==2.15.0.dev20230815, tf-nightly[and-cuda]==2.15.0.dev20230816, tf-nightly[and-cuda]==2.15.0.dev20230817, tf-nightly[and-cuda]==2.15.0.dev20230824, tf-nightly[and-cuda]==2.15.0.dev20230825, tf-nightly[and-cuda]==2.15.0.dev20230826, tf-nightly[and-cuda]==2.15.0.dev20230827, tf-nightly[and-cuda]==2.15.0.dev20230828, tf-nightly[and-cuda]==2.15.0.dev20230829, tf-nightly[and-cuda]==2.15.0.dev20230830, tf-nightly[and-cuda]==2.15.0.dev20230831, tf-nightly[and-cuda]==2.15.0.dev20230901, tf-nightly[and-cuda]==2.15.0.dev20230902, tf-nightly[and-cuda]==2.15.0.dev20230903, tf-nightly[and-cuda]==2.15.0.dev20230904, tf-nightly[and-cuda]==2.15.0.dev20230906, tf-nightly[and-cuda]==2.15.0.dev20230907, tf-nightly[and-cuda]==2.15.0.dev20230908, tf-nightly[and-cuda]==2.15.0.dev20230909, tf-nightly[and-cuda]==2.15.0.dev20230910, tf-nightly[and-cuda]==2.15.0.dev20230911, tf-nightly[and-cuda]==2.15.0.dev20230913, tf-nightly[and-cuda]==2.15.0.dev20230914, tf-nightly[and-cuda]==2.15.0.dev20230915, tf-nightly[and-cuda]==2.15.0.dev20230916, tf-nightly[and-cuda]==2.15.0.dev20230917, tf-nightly[and-cuda]==2.15.0.dev20230918, tf-nightly[and-cuda]==2.15.0.dev20230919, tf-nightly[and-cuda]==2.15.0.dev20230920, tf-nightly[and-cuda]==2.15.0.dev20230921, tf-nightly[and-cuda]==2.15.0.dev20230922, tf-nightly[and-cuda]==2.15.0.dev20230923, tf-nightly[and-cuda]==2.15.0.dev20230924, tf-nightly[and-cuda]==2.15.0.dev20230925, tf-nightly[and-cuda]==2.15.0.dev20230926, tf-nightly[and-cuda]==2.15.0.dev20230927, tf-nightly[and-cuda]==2.15.0.dev20230928, tf-nightly[and-cuda]==2.15.0.dev20230929, tf-nightly[and-cuda]==2.15.0.dev20230930, tf-nightly[and-cuda]==2.15.0.dev20231001, tf-nightly[and-cuda]==2.15.0.dev20231002, tf-nightly[and-cuda]==2.15.0.dev20231003, tf-nightly[and-cuda]==2.15.0.dev20231004, tf-nightly[and-cuda]==2.15.0.dev20231005, tf-nightly[and-cuda]==2.15.0.dev20231006, tf-nightly[and-cuda]==2.15.0.dev20231009, tf-nightly[and-cuda]==2.15.0.dev20231010, tf-nightly[and-cuda]==2.15.0.dev20231011, tf-nightly[and-cuda]==2.15.0.dev20231012, tf-nightly[and-cuda]==2.16.0.dev20231013, tf-nightly[and-cuda]==2.16.0.dev20231020, tf-nightly[and-cuda]==2.16.0.dev20231021, tf-nightly[and-cuda]==2.16.0.dev20231022, tf-nightly[and-cuda]==2.16.0.dev20231024, tf-nightly[and-cuda]==2.16.0.dev20231025, tf-nightly[and-cuda]==2.16.0.dev20231026, tf-nightly[and-cuda]==2.16.0.dev20231031, tf-nightly[and-cuda]==2.16.0.dev20231101, tf-nightly[and-cuda]==2.16.0.dev20231102 and tf-nightly[and-cuda]==2.16.0.dev20231103 because these package versions have conflicting dependencies.

The conflict is caused by:
    tf-nightly[and-cuda] 2.16.0.dev20231103 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.16.0.dev20231102 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.16.0.dev20231101 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.16.0.dev20231031 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.16.0.dev20231026 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.16.0.dev20231025 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.16.0.dev20231024 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.16.0.dev20231022 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.16.0.dev20231021 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.16.0.dev20231020 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.16.0.dev20231013 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20231012 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20231011 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20231010 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20231009 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20231006 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20231005 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20231004 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20231003 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20231002 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20231001 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230930 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230929 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230928 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230927 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230926 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230925 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230924 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230923 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230922 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230921 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230920 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230919 depends on tensorrt-libs==8.6.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230918 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230917 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230916 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230915 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230914 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230913 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230911 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230910 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230909 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230908 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230907 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230906 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230904 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230903 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230902 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230901 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230831 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230830 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230829 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230828 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230827 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230826 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230825 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230824 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230817 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230816 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230815 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230814 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230813 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230812 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230811 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230810 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230809 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230808 depends on tensorrt==8.5.3.1; extra == ""and-cuda""
    tf-nightly[and-cuda] 2.15.0.dev20230807 depends on tensorrt==8.5.3.1; extra == ""and-cuda""

To fix this you could try to:
1. loosen the range of package versions you've specified
2. remove package versions to allow pip attempt to solve the dependency conflict

ERROR: ResolutionImpossible: for help visit https://pip.pypa.io/en/latest/topics/dependency-resolution/#dealing-with-dependency-conflicts
```

### Standalone code to reproduce the issue

I've just copied commands from the official website:

```shell
python3 -m pip install 'tensorflow[and-cuda]'
python3 -c ""import tensorflow as tf; print(tf.config.list_physical_devices('GPU'))""
```


### Relevant log output
Driver:

```sh
> nvidia-smi
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.113.01             Driver Version: 535.113.01   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA GeForce GTX 1650        Off | 00000000:01:00.0  On |                  N/A |
| N/A   43C    P8               3W /  50W |    119MiB /  4096MiB |      7%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+

+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|    0   N/A  N/A     15023    C+G   ...95206080,4704969098354582108,262144       36MiB |
|    0   N/A  N/A     26218      G   /usr/bin/X                                   81MiB |
+---------------------------------------------------------------------------------------+
```

Log of the `tensorflow[and-cuda]` installation:

```shell
Collecting tensorflow[and-cuda]
  Downloading tensorflow-2.14.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)
Collecting absl-py>=1.0.0 (from tensorflow[and-cuda])
  Using cached absl_py-2.0.0-py3-none-any.whl.metadata (2.3 kB)
Collecting astunparse>=1.6.0 (from tensorflow[and-cuda])
  Using cached astunparse-1.6.3-py2.py3-none-any.whl (12 kB)
Collecting flatbuffers>=23.5.26 (from tensorflow[and-cuda])
  Using cached flatbuffers-23.5.26-py2.py3-none-any.whl.metadata (850 bytes)
Collecting gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 (from tensorflow[and-cuda])
  Using cached gast-0.5.4-py3-none-any.whl (19 kB)
Collecting google-pasta>=0.1.1 (from tensorflow[and-cuda])
  Using cached google_pasta-0.2.0-py3-none-any.whl (57 kB)
Collecting h5py>=2.9.0 (from tensorflow[and-cuda])
  Using cached h5py-3.10.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.5 kB)
Collecting libclang>=13.0.0 (from tensorflow[and-cuda])
  Using cached libclang-16.0.6-py2.py3-none-manylinux2010_x86_64.whl.metadata (5.2 kB)
Collecting ml-dtypes==0.2.0 (from tensorflow[and-cuda])
  Using cached ml_dtypes-0.2.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (20 kB)
Collecting numpy>=1.23.5 (from tensorflow[and-cuda])
  Using cached numpy-1.26.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (61 kB)
Collecting opt-einsum>=2.3.2 (from tensorflow[and-cuda])
  Using cached opt_einsum-3.3.0-py3-none-any.whl (65 kB)
Collecting packaging (from tensorflow[and-cuda])
  Using cached packaging-23.2-py3-none-any.whl.metadata (3.2 kB)
Collecting protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 (from tensorflow[and-cuda])
  Using cached protobuf-4.25.0-cp37-abi3-manylinux2014_x86_64.whl.metadata (541 bytes)
Requirement already satisfied: setuptools in ./miniconda3/envs/tf-test/lib/python3.11/site-packages (from tensorflow[and-cuda]) (68.0.0)
Collecting six>=1.12.0 (from tensorflow[and-cuda])
  Using cached six-1.16.0-py2.py3-none-any.whl (11 kB)
Collecting termcolor>=1.1.0 (from tensorflow[and-cuda])
  Using cached termcolor-2.3.0-py3-none-any.whl (6.9 kB)
Collecting typing-extensions>=3.6.6 (from tensorflow[and-cuda])
  Using cached typing_extensions-4.8.0-py3-none-any.whl.metadata (3.0 kB)
Collecting wrapt<1.15,>=1.11.0 (from tensorflow[and-cuda])
  Using cached wrapt-1.14.1-cp311-cp311-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.7 kB)
Collecting tensorflow-io-gcs-filesystem>=0.23.1 (from tensorflow[and-cuda])
  Using cached tensorflow_io_gcs_filesystem-0.34.0-cp311-cp311-manylinux_2_12_x86_64.manylinux2010_x86_64.whl.metadata (14 kB)
Collecting grpcio<2.0,>=1.24.3 (from tensorflow[and-cuda])
  Using cached grpcio-1.59.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.0 kB)
Collecting tensorboard<2.15,>=2.14 (from tensorflow[and-cuda])
  Downloading tensorboard-2.14.1-py3-none-any.whl.metadata (1.7 kB)
Collecting tensorflow-estimator<2.15,>=2.14.0 (from tensorflow[and-cuda])
  Downloading tensorflow_estimator-2.14.0-py2.py3-none-any.whl.metadata (1.3 kB)
Collecting keras<2.15,>=2.14.0 (from tensorflow[and-cuda])
  Downloading keras-2.14.0-py3-none-any.whl.metadata (2.4 kB)
Collecting nvidia-cuda-runtime-cu11==11.8.89 (from tensorflow[and-cuda])
  Using cached nvidia_cuda_runtime_cu11-11.8.89-py3-none-manylinux1_x86_64.whl (875 kB)
Collecting nvidia-cublas-cu11==11.11.3.6 (from tensorflow[and-cuda])
  Using cached nvidia_cublas_cu11-11.11.3.6-py3-none-manylinux1_x86_64.whl (417.9 MB)
Collecting nvidia-cufft-cu11==10.9.0.58 (from tensorflow[and-cuda])
  Using cached nvidia_cufft_cu11-10.9.0.58-py3-none-manylinux1_x86_64.whl (168.4 MB)
Collecting nvidia-cudnn-cu11==8.7.0.84 (from tensorflow[and-cuda])
  Using cached nvidia_cudnn_cu11-8.7.0.84-py3-none-manylinux1_x86_64.whl (728.5 MB)
Collecting nvidia-curand-cu11==10.3.0.86 (from tensorflow[and-cuda])
  Using cached nvidia_curand_cu11-10.3.0.86-py3-none-manylinux1_x86_64.whl (58.1 MB)
Collecting nvidia-cusolver-cu11==11.4.1.48 (from tensorflow[and-cuda])
  Using cached nvidia_cusolver_cu11-11.4.1.48-py3-none-manylinux1_x86_64.whl (128.2 MB)
Collecting nvidia-cusparse-cu11==11.7.5.86 (from tensorflow[and-cuda])
  Using cached nvidia_cusparse_cu11-11.7.5.86-py3-none-manylinux1_x86_64.whl (204.1 MB)
Collecting nvidia-nccl-cu11==2.16.5 (from tensorflow[and-cuda])
  Using cached nvidia_nccl_cu11-2.16.5-py3-none-manylinux1_x86_64.whl (210.3 MB)
Collecting nvidia-cuda-cupti-cu11==11.8.87 (from tensorflow[and-cuda])
  Using cached nvidia_cuda_cupti_cu11-11.8.87-py3-none-manylinux1_x86_64.whl (13.1 MB)
Collecting nvidia-cuda-nvcc-cu11==11.8.89 (from tensorflow[and-cuda])
  Using cached nvidia_cuda_nvcc_cu11-11.8.89-py3-none-manylinux1_x86_64.whl (19.5 MB)
INFO: pip is looking at multiple versions of tensorflow[and-cuda] to determine which version is compatible with other requirements. This could take a while.
Collecting tensorflow[and-cuda]
  Downloading tensorflow-2.13.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.4 kB)
WARNING: tensorflow 2.13.1 does not provide the extra 'and-cuda'
Collecting gast<=0.4.0,>=0.2.1 (from tensorflow[and-cuda])
  Downloading gast-0.4.0-py3-none-any.whl (9.8 kB)
Collecting keras<2.14,>=2.13.1 (from tensorflow[and-cuda])
  Downloading keras-2.13.1-py3-none-any.whl.metadata (2.4 kB)
Collecting numpy<=1.24.3,>=1.22 (from tensorflow[and-cuda])
  Downloading numpy-1.24.3-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 17.3/17.3 MB 10.9 MB/s eta 0:00:00
Collecting tensorboard<2.14,>=2.13 (from tensorflow[and-cuda])
  Downloading tensorboard-2.13.0-py3-none-any.whl (5.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5.6/5.6 MB 11.1 MB/s eta 0:00:00
Collecting tensorflow-estimator<2.14,>=2.13.0 (from tensorflow[and-cuda])
  Downloading tensorflow_estimator-2.13.0-py2.py3-none-any.whl.metadata (1.3 kB)
Collecting typing-extensions<4.6.0,>=3.6.6 (from tensorflow[and-cuda])
  Downloading typing_extensions-4.5.0-py3-none-any.whl (27 kB)
Collecting wrapt>=1.11.0 (from tensorflow[and-cuda])
  Downloading wrapt-1.15.0-cp311-cp311-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (78 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 78.9/78.9 kB 7.1 MB/s eta 0:00:00
Requirement already satisfied: wheel<1.0,>=0.23.0 in ./miniconda3/envs/tf-test/lib/python3.11/site-packages (from astunparse>=1.6.0->tensorflow[and-cuda]) (0.41.2)
Collecting google-auth<3,>=1.6.3 (from tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading google_auth-2.23.4-py2.py3-none-any.whl.metadata (4.7 kB)
Collecting google-auth-oauthlib<1.1,>=0.5 (from tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading google_auth_oauthlib-1.0.0-py2.py3-none-any.whl (18 kB)
Collecting markdown>=2.6.8 (from tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading Markdown-3.5.1-py3-none-any.whl.metadata (7.1 kB)
Collecting requests<3,>=2.21.0 (from tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading requests-2.31.0-py3-none-any.whl.metadata (4.6 kB)
Collecting tensorboard-data-server<0.8.0,>=0.7.0 (from tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading tensorboard_data_server-0.7.2-py3-none-manylinux_2_31_x86_64.whl.metadata (1.1 kB)
Collecting werkzeug>=1.0.1 (from tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading werkzeug-3.0.1-py3-none-any.whl.metadata (4.1 kB)
Collecting cachetools<6.0,>=2.0.0 (from google-auth<3,>=1.6.3->tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading cachetools-5.3.2-py3-none-any.whl.metadata (5.2 kB)
Collecting pyasn1-modules>=0.2.1 (from google-auth<3,>=1.6.3->tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading pyasn1_modules-0.3.0-py2.py3-none-any.whl (181 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 181.3/181.3 kB 6.6 MB/s eta 0:00:00
Collecting rsa<5,>=3.1.4 (from google-auth<3,>=1.6.3->tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading rsa-4.9-py3-none-any.whl (34 kB)
Collecting requests-oauthlib>=0.7.0 (from google-auth-oauthlib<1.1,>=0.5->tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading requests_oauthlib-1.3.1-py2.py3-none-any.whl (23 kB)
Collecting charset-normalizer<4,>=2 (from requests<3,>=2.21.0->tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading charset_normalizer-3.3.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (33 kB)
Collecting idna<4,>=2.5 (from requests<3,>=2.21.0->tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading idna-3.4-py3-none-any.whl (61 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 61.5/61.5 kB 6.4 MB/s eta 0:00:00
Collecting urllib3<3,>=1.21.1 (from requests<3,>=2.21.0->tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading urllib3-2.0.7-py3-none-any.whl.metadata (6.6 kB)
Collecting certifi>=2017.4.17 (from requests<3,>=2.21.0->tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading certifi-2023.7.22-py3-none-any.whl.metadata (2.2 kB)
Collecting MarkupSafe>=2.1.1 (from werkzeug>=1.0.1->tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading MarkupSafe-2.1.3-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.0 kB)
Collecting pyasn1<0.6.0,>=0.4.6 (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading pyasn1-0.5.0-py2.py3-none-any.whl (83 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 83.9/83.9 kB 7.6 MB/s eta 0:00:00
Collecting oauthlib>=3.0.0 (from requests-oauthlib>=0.7.0->google-auth-oauthlib<1.1,>=0.5->tensorboard<2.14,>=2.13->tensorflow[and-cuda])
  Downloading oauthlib-3.2.2-py3-none-any.whl (151 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 151.7/151.7 kB 9.0 MB/s eta 0:00:00
Downloading absl_py-2.0.0-py3-none-any.whl (130 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 130.2/130.2 kB 5.7 MB/s eta 0:00:00
Downloading flatbuffers-23.5.26-py2.py3-none-any.whl (26 kB)
Downloading grpcio-1.59.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (5.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 5.3/5.3 MB 10.8 MB/s eta 0:00:00
Downloading h5py-3.10.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (4.8 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.8/4.8 MB 10.9 MB/s eta 0:00:00
Downloading keras-2.13.1-py3-none-any.whl (1.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.7/1.7 MB 10.2 MB/s eta 0:00:00
Downloading libclang-16.0.6-py2.py3-none-manylinux2010_x86_64.whl (22.9 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 22.9/22.9 MB 10.9 MB/s eta 0:00:00
Downloading protobuf-4.25.0-cp37-abi3-manylinux2014_x86_64.whl (294 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 294.4/294.4 kB 10.0 MB/s eta 0:00:00
Downloading tensorflow_estimator-2.13.0-py2.py3-none-any.whl (440 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 440.8/440.8 kB 8.7 MB/s eta 0:00:00
Downloading tensorflow_io_gcs_filesystem-0.34.0-cp311-cp311-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (2.4 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.4/2.4 MB 11.2 MB/s eta 0:00:00
Downloading packaging-23.2-py3-none-any.whl (53 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 53.0/53.0 kB 6.1 MB/s eta 0:00:00
Downloading tensorflow-2.13.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (479.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 479.7/479.7 MB 6.0 MB/s eta 0:00:00
Downloading google_auth-2.23.4-py2.py3-none-any.whl (183 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 183.3/183.3 kB 8.9 MB/s eta 0:00:00
Downloading Markdown-3.5.1-py3-none-any.whl (102 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 102.2/102.2 kB 8.1 MB/s eta 0:00:00
Downloading requests-2.31.0-py3-none-any.whl (62 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.6/62.6 kB 6.2 MB/s eta 0:00:00
Downloading tensorboard_data_server-0.7.2-py3-none-manylinux_2_31_x86_64.whl (6.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.6/6.6 MB 11.1 MB/s eta 0:00:00
Downloading werkzeug-3.0.1-py3-none-any.whl (226 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 226.7/226.7 kB 10.6 MB/s eta 0:00:00
Downloading cachetools-5.3.2-py3-none-any.whl (9.3 kB)
Downloading certifi-2023.7.22-py3-none-any.whl (158 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 158.3/158.3 kB 10.5 MB/s eta 0:00:00
Downloading charset_normalizer-3.3.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (140 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 140.3/140.3 kB 8.9 MB/s eta 0:00:00
Downloading MarkupSafe-2.1.3-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (28 kB)
Downloading urllib3-2.0.7-py3-none-any.whl (124 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 124.2/124.2 kB 9.0 MB/s eta 0:00:00
Installing collected packages: libclang, flatbuffers, wrapt, urllib3, typing-extensions, termcolor, tensorflow-io-gcs-filesystem, tensorflow-estimator, tensorboard-data-server, six, pyasn1, protobuf, packaging, oauthlib, numpy, MarkupSafe, markdown, keras, idna, grpcio, gast, charset-normalizer, certifi, cachetools, absl-py, werkzeug, rsa, requests, pyasn1-modules, opt-einsum, h5py, google-pasta, astunparse, requests-oauthlib, google-auth, google-auth-oauthlib, tensorboard, tensorflow
Successfully installed MarkupSafe-2.1.3 absl-py-2.0.0 astunparse-1.6.3 cachetools-5.3.2 certifi-2023.7.22 charset-normalizer-3.3.2 flatbuffers-23.5.26 gast-0.4.0 google-auth-2.23.4 google-auth-oauthlib-1.0.0 google-pasta-0.2.0 grpcio-1.59.2 h5py-3.10.0 idna-3.4 keras-2.13.1 libclang-16.0.6 markdown-3.5.1 numpy-1.24.3 oauthlib-3.2.2 opt-einsum-3.3.0 packaging-23.2 protobuf-4.25.0 pyasn1-0.5.0 pyasn1-modules-0.3.0 requests-2.31.0 requests-oauthlib-1.3.1 rsa-4.9 six-1.16.0 tensorboard-2.13.0 tensorboard-data-server-0.7.2 tensorflow-2.13.1 tensorflow-estimator-2.13.0 tensorflow-io-gcs-filesystem-0.34.0 termcolor-2.3.0 typing-extensions-4.5.0 urllib3-2.0.7 werkzeug-3.0.1 wrapt-1.15.0
```
",True
"How to solve ""DataType error: DataType 0 is not recognized in Java."" when using tensorflowlite in android stat:awaiting response type:bug comp:lite TF 2.7","I am trying to perform on device training in kotlin with tensorflowlite in Android Studio. I followed the tutorial from [text](https://tensorflow.google.cn/lite/examples/on_device_training/overview) and the github page on it, but I am trying to train a MLP instead of CNN, and the data is generated by hand. I learnt from the example code from github codes in that web and as long as the training process began, the error occured and the logcat is as follow:
```
FATAL EXCEPTION: pool-2-thread-1
Process: com.example.deeplearningforinfer, PID: 32094
java.lang.IllegalArgumentException: DataType error: DataType 0 is not recognized in Java.
at org.tensorflow.lite.DataTypeUtils.fromC(DataTypeUtils.java:69)
at org.tensorflow.lite.TensorImpl.<init>(TensorImpl.java:479)
at org.tensorflow.lite.TensorImpl.fromSignatureInput(TensorImpl.java:49)
at org.tensorflow.lite.NativeSignatureRunnerWrapper.getInputTensor(NativeSignatureRunnerWrapper.java:49)
at org.tensorflow.lite.NativeInterpreterWrapper.getInputTensor(NativeInterpreterWrapper.java:418)
at org.tensorflow.lite.NativeInterpreterWrapper.runSignature(NativeInterpreterWrapper.java:193)
at org.tensorflow.lite.Interpreter.runSignature(Interpreter.java:261)
at com.example.deeplearningforinfer.TransferLearningHelper.train(TransferLearningHelper.kt:64)
at com.example.deeplearningforinfer.TransferLearningHelper.startTraining$lambda$5(TransferLearningHelper.kt:146)
at com.example.deeplearningforinfer.TransferLearningHelper.$r8$lambda$7My04QIePTcHhSGX3SRRzpn0w1Y(Unknown Source:0)
```
The android device is Pixel 6(API level 30), and I also test it on my vivo neo5(API 33). The version of tensorflow for converting the model is 2.7.0 and on Ubuntu 20.04.

The full description is [stackoverflow](https://stackoverflow.com/questions/77332595/how-to-solve-datatype-error-datatype-0-is-not-recognized-in-java-when-using)
",True
@org_tensorflow//tensorflow/lite/schema components visibility stat:awaiting tensorflower type:bug comp:lite TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.13+

### Custom code

No

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

6.1.0

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Hi,

I am updating https://github.com/google-coral/pycoral to support Tensorflow 2.13+. This repo used to be able to reference and use the following bazel libs:

@org_tensorflow//tensorflow/lite/schema:schema_conversion_utils
@org_tensorflow//tensorflow/lite/schema:schema_utils

But the visibility of these components was changed from v2.2.0 and is now "":utils_friends""

Could these be reverted to public so we can continue to use them or else suggest how I might use them as they currently stand?

Many thanks

### Standalone code to reproduce the issue

```shell
.
```


### Relevant log output

```shell
ERROR: /workspace/coral/learn/BUILD:21:11: in cc_library rule //coral/learn:utils: target '@org_tensorflow//tensorflow/lite/schema:schema_conversion_utils' is not visible from target '//coral/learn:utils'. Check the visibility declaration of the former target if you think the dependency is legitimate
ERROR: /workspace/coral/learn/BUILD:21:11: in cc_library rule //coral/learn:utils: target '@org_tensorflow//tensorflow/lite/schema:schema_utils' is not visible from target '//coral/learn:utils'. Check the visibility declaration of the former target if you think the dependency is legitimate
ERROR: /workspace/coral/learn/BUILD:21:11: Analysis of target '//coral/learn:utils' failed
```
",True
Different Behavior of tf.raw_ops.Cos+tf.raw_ops.Erfc with jit_compile=True stat:awaiting tensorflower type:bug comp:ops TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.14.0

### Custom code

Yes

### OS platform and distribution

Ubuntu 22.04.3 LTS (x86_64)

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11.8

### GPU model and memory

GPU 0: NVIDIA GeForce RTX 2070 GPU 1: NVIDIA GeForce RTX 2070 GPU 2: NVIDIA GeForce RTX 2070 GPU 3: NVIDIA GeForce RTX 2070

### Current behavior?

When the **tf.raw_ops.Cos+tf.raw_ops.Erfc** operation is invoked within a tf.function with JIT compilation enabled (**jit_compile=True**), it produces different results compared to the same operation called without JIT compilation. This inconsistency is observed when the code is executed on a **CPU** device.
The problem occurs when input Tensors pass through **tf.raw_ops.Cos+tf.raw_ops.Erfc** and raw_ops.Sin. With individual Ops there is no issue.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf
import traceback

class Network(tf.Module):
    def __init__(self):
        super().__init__()

    @tf.function(jit_compile=True)
    def __call__(self, x):
      
      x = tf.raw_ops.Cos(x=x, )        
      x = tf.raw_ops.Erfc(x=x, )        
      return x

m = Network()
inp = {
    ""x"": tf.random.normal([10, 9, 8], dtype=tf.bfloat16),
    }

with tf.device('/CPU:0'):
    tf.config.run_functions_eagerly(True)
    no_op_res = m(**inp)
    tf.config.run_functions_eagerly(False)
    with tf.device('/CPU:0'):
        op_res = m(**inp)

    tf.debugging.assert_near(tf.cast(no_op_res, tf.float64), tf.cast(op_res, tf.float64), atol=0.001, rtol=0.001)
```


### Relevant log output

```shell
File ""/home/guihuan/LLM/results/tf-2/2023-10-22-20-21/test.py"", line 27, in <module>
    tf.debugging.assert_near(tf.cast(no_op_res, tf.float64), tf.cast(op_res, tf.float64), atol=0.001, rtol=0.001)
  File ""/home/guihuan/.conda/envs/night/lib/python3.9/site-packages/tensorflow/python/util/traceback_utils.py"", line 153, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File ""/home/guihuan/.conda/envs/night/lib/python3.9/site-packages/tensorflow/python/ops/control_flow_assert.py"", line 102, in Assert
    raise errors.InvalidArgumentError(
tensorflow.python.framework.errors_impl.InvalidArgumentError: Expected 'tf.Tensor(False, shape=(), dtype=bool)' to be true. Summarized data: b''
b'x and y not equal to tolerance rtol = tf.Tensor(0.001, shape=(), dtype=float64), atol = tf.Tensor(0.001, shape=(), dtype=float64)'
b'x (shape=(10, 9, 8) dtype=float64) = '
0.17578125, 1.1484375, 0.267578125, ...
b'y (shape=(10, 9, 8) dtype=float64) = '
0.1767578125, 1.1484375, 0.267578125, ...
```
",True
Different Behavior of tf.raw_ops.SqrtGrad with jit_compile=True type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.14.0

### Custom code

Yes

### OS platform and distribution

Ubuntu 22.04.3 LTS (x86_64)

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11.8

### GPU model and memory

GPU 0: NVIDIA GeForce RTX 2070 GPU 1: NVIDIA GeForce RTX 2070 GPU 2: NVIDIA GeForce RTX 2070 GPU 3: NVIDIA GeForce RTX 2070

### Current behavior?

When the **tf.raw_ops.SqrtGrad** operation is invoked within a tf.function with JIT compilation enabled (**jit_compile=True**), it produces different results compared to the same operation called without JIT compilation. This inconsistency is observed when the code is executed on a **CPU** device.



### Standalone code to reproduce the issue

```shell
import tensorflow as tf
import traceback

class Network(tf.Module):
    def __init__(self):
        super().__init__()

    @tf.function(jit_compile=True)
    def __call__(self, x):
      real_part = tf.random.normal([], dtype=tf.float64)
      imag_part = tf.random.normal([], dtype=tf.float64)
      tensor = tf.complex(real_part, imag_part)
      tensor = tf.cast(tensor,dtype=tf.complex128)
      x = tf.raw_ops.SqrtGrad(dy=x, y=tensor)        
      return x

m = Network()
real_part = tf.random.normal([], dtype=tf.float64)
imag_part = tf.random.normal([], dtype=tf.float64)
tensor = tf.complex(real_part, imag_part)
tensor = tf.cast(tensor,dtype=tf.complex128)
inp = {
    ""x"": tensor,
}

with tf.device('/CPU:0'):
    tf.config.run_functions_eagerly(True)
    no_op_res = m(**inp)
    tf.config.run_functions_eagerly(False)
    with tf.device('/CPU:0'):
        op_res = m(**inp)

    tf.debugging.assert_near(no_op_res, op_res, atol=0.001, rtol=0.001)
```


### Relevant log output

```shell
File ""/home/guihuan/LLM/results/tf-2/2023-10-22-20-21/test.py"", line 33, in <module>
    tf.debugging.assert_near(no_op_res, op_res, atol=0.001, rtol=0.001)
  File ""/home/guihuan/.conda/envs/night/lib/python3.9/site-packages/tensorflow/python/util/traceback_utils.py"", line 153, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File ""/home/guihuan/.conda/envs/night/lib/python3.9/site-packages/tensorflow/python/ops/control_flow_assert.py"", line 102, in Assert
    raise errors.InvalidArgumentError(
tensorflow.python.framework.errors_impl.InvalidArgumentError: Expected 'tf.Tensor(False, shape=(), dtype=bool)' to be true. Summarized data: b''
b'x and y not equal to tolerance rtol = tf.Tensor(0.001, shape=(), dtype=float64), atol = tf.Tensor(0.001, shape=(), dtype=float64)'
b'x (shape=() dtype=complex128) = '
(-0.20583126869122956-0.1606528338452279j)
b'y (shape=() dtype=complex128) = '
(0.2721269549260611+0.24474350338228776j)
```
",True
Different Behavior of tf.raw_ops.RightShift with jit_compile=True stat:awaiting response type:bug stale comp:ops TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.14.0

### Custom code

Yes

### OS platform and distribution

Ubuntu 22.04.3 LTS (x86_64)

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11.8

### GPU model and memory

GPU 0: NVIDIA GeForce RTX 2070 GPU 1: NVIDIA GeForce RTX 2070 GPU 2: NVIDIA GeForce RTX 2070 GPU 3: NVIDIA GeForce RTX 2070

### Current behavior?

When the tf.raw_ops.RightShift operation is invoked within a tf.function with JIT compilation enabled (jit_compile=True), it produces different results compared to the same operation called without JIT compilation. This inconsistency is observed when the code is executed on a GPU device.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf
import traceback

class Network(tf.Module):
    def __init__(self):
        super().__init__()

    @tf.function(jit_compile=True)
    def __call__(self, x):
      random_tensor = tf.random.uniform([],minval=0,maxval=255,dtype=tf.int32)
      int8_tensor = tf.dtypes.cast(random_tensor, tf.int8)
      x = tf.raw_ops.RightShift(y=x, x=int8_tensor)        
      return x


m = Network()
random_tensor = tf.random.uniform([4,1],minval=0,maxval=255,dtype=tf.int32)
int8_tensor = tf.dtypes.cast(random_tensor, tf.int8)
inp = {
    ""x"": int8_tensor,
}

with tf.device('/GPU:0'):
    tf.config.run_functions_eagerly(True)
    no_op_res = m(**inp)
    tf.config.run_functions_eagerly(False)
    with tf.device('/GPU:0'):
        op_res = m(**inp)

    tf.debugging.assert_near(tf.cast(no_op_res, tf.float64), tf.cast(op_res, tf.float64), atol=0.001, rtol=0.001)
```


### Relevant log output

```shell
File ""/home/guihuan/LLM/results/tf-2/2023-10-22-20-21/test.py"", line 30, in <module>
    tf.debugging.assert_near(tf.cast(no_op_res, tf.float64), tf.cast(op_res, tf.float64), atol=0.001, rtol=0.001)
  File ""/home/guihuan/.conda/envs/night/lib/python3.9/site-packages/tensorflow/python/util/traceback_utils.py"", line 153, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File ""/home/guihuan/.conda/envs/night/lib/python3.9/site-packages/tensorflow/python/ops/control_flow_assert.py"", line 102, in Assert
    raise errors.InvalidArgumentError(
tensorflow.python.framework.errors_impl.InvalidArgumentError: Expected 'tf.Tensor(False, shape=(), dtype=bool)' to be true. Summarized data: b''
b'x and y not equal to tolerance rtol = tf.Tensor(0.001, shape=(), dtype=float64), atol = tf.Tensor(0.001, shape=(), dtype=float64)'
b'x (shape=(4, 1) dtype=float64) = '
-24.0, -1.0, -1.0, ...
b'y (shape=(4, 1) dtype=float64) = '
9.0, 0.0, 0.0, ...
```
",True
TensorflowLite C API not linking with TensorflowLite_Flex delegate (Automatically or manually) stat:awaiting response type:bug stale comp:lite TF2.14,"### System information

-   **Have I written custom code (as opposed to using a stock example script
    provided in TensorFlow)**:
-   **OS Platform and Distribution**: Windows 11
-   **Mobile device**: Additionally happens on Android 14 Pixel 7a
-   **TensorFlowLite installed from (source or binary)**: C API build with CMake and Tensorflowlite_flex built with bazel
-   **TensorFlow version (use command below)**: 2.14
-   **Bazel version (if compiling from source)**: Bazelisk version: v1.18.0
-   **GCC/Compiler version (if compiling from source)**: Visual Studio 17.7.4
-   **CUDA/cuDNN version**: N/A
-   **GPU model and memory**: N/A
-   **Exact command to reproduce**: N/A

Using Cmake To build and link the TensorflowLite C API Works perfectly with any tflite model signature not using Flex operators. However, after linking the C API with tensorflowlite_flex, using the following as part of a CMakeLists.txt:
```cmake
if(${CMAKE_SYSTEM_NAME} STREQUAL ""Windows"")
  set_target_properties(tensorflowlite_c PROPERTIES 
    IMPORTED_LOCATION_DEBUG ""${TFLITE_ROOT}/lib/windows/Debug/tensorflowlite_c.dll""
    IMPORTED_IMPLIB_DEBUG ""${TFLITE_ROOT}/lib/windows/Debug/tensorflowlite_c.lib""

    IMPORTED_LOCATION_RELEASE ""${TFLITE_ROOT}/lib/windows/Release/tensorflowlite_c.dll""
    IMPORTED_IMPLIB_RELEASE ""${TFLITE_ROOT}/lib/windows/Release/tensorflowlite_c.lib""
    )

  set_target_properties(tensorflowlite_flex PROPERTIES 
    IMPORTED_LOCATION ""${TFLITE_ROOT}/lib/windows/tensorflowlite_flex.dll""
    IMPORTED_IMPLIB ""${TFLITE_ROOT}/lib/windows/tensorflowlite_flex.dll.if.lib""
    )
  target_link_libraries(tensorflowlite_c INTERFACE tensorflowlite_flex)
endif()
```  
, the running process outputs: ERROR: Select TensorFlow op(s), included in the given model, is(are) not supported by this interpreter. Make sure you apply/link the Flex delegate before inference.

My final approach was to use (what I guessed) was the auto linking code that exists in the C++ code (namely:
```cpp
auto hdll = LoadLibrary(""tensorflowlite_flex.dll"");

auto flex_fp = reinterpret_cast<TfLiteDelegatePtr(*)()>(
    GetProcAddress(hdll, ""TF_AcquireFlexDelegate""));
if (flex_fp == NULL) {
  throw std::runtime_error(""flex_fp couldn't be run"");
}

flex_ = flex_fp(); // flex_ is a member (not shown here) // This line gets the message: INFO: Created TensorFlow Lite delegate for select TF ops.

TfLiteInterpreterOptionsAddDelegate(options_.get(), flex_.get()); // *THIS* is the important line

```
). If the final line is commented out we get the nice INFO message that the delegate has been created but end up with the same warning message. Alternatively, if the last line is included we get an invalid memory access exception. 

I am going to switch to the C++ API for tensorflow lite and see if that works as I am under a tight deadline but any help would be much appreciated as the stable ABI for the C API is far better for my PhD.


Additionally, I built ""tensorflow/lite/delegates/flex:delegate"" with bazelisk (bazel v1.18.0) but (after waiting an extremely long time for it to compile) I cannot track down what it built and did not change anything.


(Note, some small changes to CMakeFiles were required to build tensorflowlite_c.dll and the exact binary I have used can be obtained from [here](https://github.com/SagaraBattousai/tflite-clib-builder/releases/download/v1.0.1/tensorflowlite_c-winx64-Android.zip) )



",True
tensorflow new(sz=18446744073709551615) got std::bad_alloc stat:awaiting response type:bug stale TF 1.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 1.14.0

### Custom code

No

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

3.7.2

### Bazel version

unknown

### GCC/compiler version

gcc (Ubuntu 5.4.0-6ubuntu1~16.04.12) 5.4.0 20160609

### CUDA/cuDNN version

no

### GPU model and memory

_No response_

### Current behavior?

throw std::bad_malloc

### Standalone code to reproduce the issue

```shell
no std::bad_malloc, no new(sz=18446744073709551615)
```


### Relevant log output

```shell
#0  __lll_lock_wait () at ../sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:135
#1  0x00007f7f6df7be42 in __GI___pthread_mutex_lock (mutex=0x7f7f6eb43970 <_rtld_global+2352>) at ../nptl/pthread_mutex_lock.c:115
#2  0x00007f7f6dceb0df in __GI___dl_iterate_phdr (callback=0x7f7f45dc4df0, data=0x7f7e28ff92a0) at dl-iteratephdr.c:41
#3  0x00007f7f45dc616e in _Unwind_Find_FDE () from /lib/x86_64-linux-gnu/libgcc_s.so.1
#4  0x00007f7f45dc2b63 in ?? () from /lib/x86_64-linux-gnu/libgcc_s.so.1
#5  0x00007f7f45dc3d80 in ?? () from /lib/x86_64-linux-gnu/libgcc_s.so.1
#6  0x00007f7f45dc422e in _Unwind_RaiseException () from /lib/x86_64-linux-gnu/libgcc_s.so.1
#7  0x00007f7f4605833c in __cxxabiv1::__cxa_throw (obj=0x7f7e258670a0, tinfo=0x7f7f4633c770 <typeinfo for std::bad_alloc>, dest=0x7f7f46056550 <std::bad_alloc::~bad_alloc()>)
    at ../../../../libstdc++-v3/libsupc++/eh_throw.cc:82
#8  0x00007f7f4605886c in operator new (sz=18446744073709551615) at ../../../../libstdc++-v3/libsupc++/new_op.cc:54
#9  0x00007f7f5170f2b9 in Eigen::internal::aligned_malloc(unsigned long) () from /usr/lib/python3.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#10 0x00007f7f526fa18e in void* Eigen::internal::TensorContractionBlockMemAllocator<float, float>::allocateSlices<Eigen::ThreadPoolDevice const>(Eigen::ThreadPoolDevice const&, long, long, long, long, long, long, std::vector<float*, std::allocator<float*> >*, std::vector<float*, std::allocator<float*> >*) () from /usr/lib/python3.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#11 0x00007f7f52911ec5 in void* Eigen::internal::TensorContractionKernel<float, float, float, long, Eigen::internal::blas_data_mapper<float, long, 0, 0>, Eigen::internal::TensorContractionInputMapper<float, long, 1, Eigen::TensorEvaluator<Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer> const, Eigen::ThreadPoolDevice>, Eigen::array<long, 1ul>, Eigen::array<long, 1ul>, 16, true, false, 0, Eigen::MakePointer>, Eigen::internal::TensorContractionInputMapper<float, long, 0, Eigen::TensorEvaluator<Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer> const, Eigen::ThreadPoolDevice>, Eigen::array<long, 1ul>, Eigen::array<long, 1ul>, 16, true, false, 0, Eigen::MakePointer> >::allocateSlices<Eigen::ThreadPoolDevice const>(Eigen::ThreadPoolDevice const&, int, int, int, std::vector<Eigen::internal::ColMajorBlock<float, long>, std::allocator<Eigen::internal::ColMajorBlock<float, long> > >*, std::vector<Eigen::internal::ColMajorBlock<float, long>, std::allocator<Eigen::internal::ColMajorBlock<float, long> > >*) () from /usr/lib/python3.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#12 0x00007f7f5293cf30 in void Eigen::TensorEvaluator<Eigen::TensorContractionOp<Eigen::array<Eigen::IndexPair<long>, 1ul> const, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer> const, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer> const, Eigen::NoOpOutputKernel const> const, Eigen::ThreadPoolDevice>::evalProduct<0>(float*) const ()
   from /usr/lib/python3.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#13 0x00007f7f5293f1cb in Eigen::internal::TensorExecutor<Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorContractionOp<Eigen::array<Eigen::IndexPair<long>, 1ul> const, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer> const, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer> const, Eigen::NoOpOutputKernel const> const> const, Eigen::ThreadPoolDevice, true, false>::run(Eigen::TensorAssignOp<Eigen::TensorMap<Eigen::Tensor<float, 2, 1, long>, 16, Eigen::MakePointer>, Eigen::TensorContractionOp<Eigen::array<Eigen::IndexPair<long>, 1ul> const, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer> const, Eigen::TensorMap<Eigen::Tensor<float const, 2, 1, long>, 16, Eigen::MakePointer> const, Eigen::NoOpOutputKernel const> const> const&, Eigen::ThreadPoolDevice const&) () from /usr/lib/python3.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#14 0x00007f7f529a2c7e in tensorflow::MatMulOp<Eigen::ThreadPoolDevice, float, false>::Compute(tensorflow::OpKernelContext*) ()
   from /usr/lib/python3.7/site-packages/tensorflow/python/_pywrap_tensorflow_internal.so
#15 0x00007f7f4dee0146 in tensorflow::(anonymous namespace)::ExecutorState::Process(tensorflow::(anonymous namespace)::ExecutorState::TaggedNode, long long) ()
   from /usr/lib/python3.7/site-packages/tensorflow/python/../libtensorflow_framework.so.1
#16 0x00007f7f4ded05a5 in std::_Function_handler<void (), std::_Bind<std::_Mem_fn<void (tensorflow::(anonymous namespace)::ExecutorState::*)(tensorflow::(anonymous namespace)::ExecutorState::TaggedNode, long long)> (tensorflow::(anonymous namespace)::ExecutorState*, tensorflow::(anonymous namespace)::ExecutorState::TaggedNode, long long)> >::_M_invoke(std::_Any_data const&) ()
   from /usr/lib/python3.7/site-packages/tensorflow/python/../libtensorflow_framework.so.1
#17 0x00007f7f4df76cfe in Eigen::ThreadPoolTempl<tensorflow::thread::EigenEnvironment>::WorkerLoop(int) () from /usr/lib/python3.7/site-packages/tensorflow/python/../libtensorflow_framework.so.1
#18 0x00007f7f4df73b98 in std::_Function_handler<void (), tensorflow::thread::EigenEnvironment::CreateThread(std::function<void ()>)::{lambda()#1}>::_M_invoke(std::_Any_data const&) ()
   from /usr/lib/python3.7/site-packages/tensorflow/python/../libtensorflow_framework.so.1
#19 0x00007f7f460828b3 in std::execute_native_thread_routine_compat (__p=<optimized out>) at ../../../../../libstdc++-v3/src/c++11/thread.cc:110
#20 0x00007f7f6df796ba in start_thread (arg=0x7f7e28ffb700) at pthread_create.c:333
#21 0x00007f7f6dcaf4dd in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:109
```
",True
Missing `'tensorflow.python.training.tracking'` in version 2.14.0; cannot load pickled model type:bug type:support TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.14.0

### Custom code

Yes

### OS platform and distribution

Google Colab

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

N/A

### GPU model and memory

_No response_

### Current behavior?

We used to load some pickled TF models using:

```
import pickle
pickle.load(open(""/content/cosmopower/cosmopower/trained_models/CP_paper/CMB/cmb_TT_NN.pkl"", 'rb'))
```

but as of version 2.14.0 we get:

```
---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
[<ipython-input-3-776b938106f2>](https://localhost:8080/#) in <cell line: 1>()
----> 1 pickle.load(open(""/content/cosmopower/cosmopower/trained_models/CP_paper/CMB/cmb_TT_NN.pkl"", 'rb'))

ModuleNotFoundError: No module named 'tensorflow.python.training.tracking'
```

We checked that there are no errors with TF `2.13.0`, and everything works as expected. The `tensorflow.python.training.tracking` module seems to have been removed since `2.14.0`, but we are unable to find it in the release notes. This error is observed on Colab as well as on other platforms and OSs.

### Standalone code to reproduce the issue

```shell
! git clone https://github.com/alessiospuriomancini/cosmopower.git # download folder with TF model

# this is intended for colab; change path if necessary
import pickle
pickle.load(open(""/content/cosmopower/cosmopower/trained_models/CP_paper/CMB/cmb_TT_NN.pkl"", 'rb'))
```


### Relevant log output

```shell
---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
<ipython-input-3-776b938106f2> in <cell line: 1>()
----> 1 pickle.load(open(""/content/cosmopower/cosmopower/trained_models/CP_paper/CMB/cmb_TT_NN.pkl"", 'rb'))

ModuleNotFoundError: No module named 'tensorflow.python.training.tracking'

---------------------------------------------------------------------------
NOTE: If your import is failing due to a missing package, you can
manually install dependencies using either !pip or !apt.

To view examples of installing some common dependencies, click the
""Open Examples"" button below.
---------------------------------------------------------------------------
```
",True
Deserialization issues with non-default dtypes stat:awaiting response type:bug comp:apis TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

tf v2.14.0-rc1-21-g4dacf3f368e

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

The following model cannot be deserialized:

```python
x = keras.Input(batch_shape=(4, 16), dtype=tf.float16)
output = 1.0 + x
keras_model = keras.Model(x, output)
```
It appears as if Keras fails to recognize the `dtype` of constants and always saves them as default type (`float32`/`int32`).
Setting `dtype` explicitly does not help:

```python
output = tf.convert_to_tensor(1, dtype=tf.float16) + x
```
The problem persists across various non-default data types (`float16`, `float64`, `int16`, `int64`), operations (`add`, `sub`, `mul`, `pow`) and model formats (`.h5`, `SavedModel`). Oddly enough, it goes away when the arguments are swapped:

```python
output = x + 1.0  # Works just fine!
```
In `v2.16-nightly`, which resolves to Keras 3, everything's alright.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf
from tensorflow import keras


x = keras.Input(batch_shape=(4, 16), dtype=tf.float16)
output = tf.convert_to_tensor(1, dtype=tf.float16) + x
keras_model = keras.Model(x, output)

model_path = 'model.h5'
keras_model.save(model_path)
print('Model saved')

keras_model_restored = keras.models.load_model(model_path)
print('Model loaded')
```


### Relevant log output

```shell
TypeError: Exception encountered when calling layer ""tf.__operators__.add"" (type TFOpLambda).

Input 'y' of 'AddV2' Op has type float16 that does not match type float32 of argument 'x'.

Call arguments received by layer ""tf.__operators__.add"" (type TFOpLambda):
  • x=tf.Tensor(shape=(), dtype=float32)
  • y=tf.Tensor(shape=(4, 16), dtype=float16)
  • name=None
```
",True
//tensorflow/python/eager:forwardprop_test test fails on AARCH64 type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

git HEAD

### Custom code

No

### OS platform and distribution

Ubuntu 20.04

### Mobile device

n/a

### Python version

3.9.17

### Bazel version

6.1.0

### GCC/compiler version

17.0.0

### CUDA/cuDNN version

n/a

### GPU model and memory

n/a

### Current behavior?

Since Eigen was updated, the unit test //tensorflow/python/eager:forwardprop_test now fails.
Eigen was updated by https://github.com/tensorflow/tensorflow/commit/57e6377cf9879e33f3612f1ffd3619b6513e5296
It looks like this commit in Eigen is the problem.
https://gitlab.com/libeigen/eigen/-/commit/81b48065ea673cd352d11ef9b6a3d86778ac962d

This seems to only affect AARCH64 and not x86.

### Standalone code to reproduce the issue

```shell
bazel test --cache_test_results=no --build_tests_only --config=mkl_aarch64_threadpool --test_env=TF_ENABLE_ONEDNN_OPTS=1 --copt=-flax-vector-conversions --test_env=TF2_BEHAVIOR=1 --test_env=PORTSERVER_ADDRESS=@unittest-portserver --test_size_filters=small,medium --test_output=errors --verbose_failures=true --test_keep_going --notest_verbose_timeout_warnings --test_tag_filters=--oss_serial,-no_oss,-oss_excluded,-v1only,-benchmark-test,-no_aarch64,-no_oss_py38,-no_oss_py39,-no_oss_py310 --jobs=75 -- //tensorflow/python/eager:forwardprop_test
```


### Relevant log output

```shell
======================================================================
FAIL: testNumericHigherOrder (__main__.ForwardpropTest)
ForwardpropTest.testNumericHigherOrder
Warms up, gets object counts, runs the test, checks for new objects.
----------------------------------------------------------------------
Traceback (most recent call last):
  File ""/home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/aarch64-opt/bin/tensorflow/python/eager/forwardprop_test_cpu.runfiles/org_tensorflow/tensorflow/python/framework/test_util.py"", line 713, in decorator
    f(self, *args, **kwargs)
  File ""/home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/aarch64-opt/bin/tensorflow/python/eager/forwardprop_test_cpu.runfiles/org_tensorflow/tensorflow/python/eager/forwardprop_test.py"", line 455, in testNumericHigherOrder
    _test_gradients(
  File ""/home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/aarch64-opt/bin/tensorflow/python/eager/forwardprop_test_cpu.runfiles/org_tensorflow/tensorflow/python/eager/forwardprop_test.py"", line 215, in _test_gradients
    _test_gradients(
  File ""/home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/aarch64-opt/bin/tensorflow/python/eager/forwardprop_test_cpu.runfiles/org_tensorflow/tensorflow/python/eager/forwardprop_test.py"", line 215, in _test_gradients
    _test_gradients(
  File ""/home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/aarch64-opt/bin/tensorflow/python/eager/forwardprop_test_cpu.runfiles/org_tensorflow/tensorflow/python/eager/forwardprop_test.py"", line 231, in _test_gradients
    testcase.assertAllClose(sym_jac_back, sym_jac_fwd, rtol=srtol, atol=satol)
  File ""/home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/aarch64-opt/bin/tensorflow/python/eager/forwardprop_test_cpu.runfiles/org_tensorflow/tensorflow/python/framework/test_util.py"", line 1657, in decorated
    return f(*args, **kwds)
           ^^^^^^^^^^^^^^^^
  File ""/home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/aarch64-opt/bin/tensorflow/python/eager/forwardprop_test_cpu.runfiles/org_tensorflow/tensorflow/python/framework/test_util.py"", line 3293, in assertAllClose
    self._assertAllCloseRecursive(a, b, rtol=rtol, atol=atol, msg=msg)
  File ""/home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/aarch64-opt/bin/tensorflow/python/eager/forwardprop_test_cpu.runfiles/org_tensorflow/tensorflow/python/framework/test_util.py"", line 3229, in _assertAllCloseRecursive
    self._assertArrayLikeAllClose(
  File ""/home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/aarch64-opt/bin/tensorflow/python/eager/forwardprop_test_cpu.runfiles/org_tensorflow/tensorflow/python/framework/test_util.py"", line 3186, in _assertArrayLikeAllClose
    np.testing.assert_allclose(
  File ""/home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/aarch64-opt/bin/tensorflow/python/eager/forwardprop_test_cpu.runfiles/pypi_numpy/site-packages/numpy/testing/_private/utils.py"", line 1527, in assert_allclose
    assert_array_compare(compare, actual, desired, err_msg=str(err_msg),
  File ""/home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/aarch64-opt/bin/tensorflow/python/eager/forwardprop_test_cpu.runfiles/pypi_numpy/site-packages/numpy/testing/_private/utils.py"", line 844, in assert_array_compare
    raise AssertionError(msg)
AssertionError: 
Not equal to tolerance rtol=1e-06, atol=1e-06
Mismatched value: a is different from b. 
not close where = (array([0]), array([0]), array([2]))
not close lhs = [-155.46957]
not close rhs = [-155.46982]
not close dif = [0.00024414]
not close tol = [0.00015647]
dtype = float32, shape = (1, 4, 4)
Mismatched elements: 1 / 16 (6.25%)
Max absolute difference: 0.00024414
Max relative difference: 1.5703409e-06
 x: array([[[-4755.0654  ,  -139.43396 ,  -155.46957 ,   158.52019 ],
        [ -139.43398 ,  -119.946   ,   -26.157635,    20.20992 ],
        [ -155.4697  ,   -26.15764 ,   428.02136 ,  -365.0485  ],...
 y: array([[[-4755.0654  ,  -139.43398 ,  -155.46982 ,   158.52022 ],
        [ -139.43399 ,  -119.946014,   -26.157648,    20.209923],
        [ -155.46967 ,   -26.157635,   428.02112 ,  -365.04846 ],...

----------------------------------------------------------------------
Ran 13 tests in 95.972s

FAILED (failures=1)
================================================================================
```
",True
"TensorShape is (None, None, None) on images type:bug","### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

An I/O pipeline for images using Dataset reads images into tensor but the shape is (None, None, None), preventing some applications that need the tensor shape further down in preprocessing (for example, resizing the image by a factor).

In the example below I can get by by recovering the image dimensions with a trick but it feels very *very* hacky. Is there a reason why the shape should be None?

### Standalone code to reproduce the issue

```shell
def preprocess(file_name):
    x = tf.io.read_file(file_name)
    x = tf.io.decode_jpeg(x)
    
    nrows, ncols,_ = x.shape
    
    x = tf.image.resize(x, (nrows//2, ncols//2))
    
    x = tf.image.random_crop(x, (32,32,3))
    
    return x, tf.zeros_like(x)

def preprocess_workaround(file_name):
    x = tf.io.read_file(file_name)
    x = tf.io.decode_jpeg(x)
    
    nrows = tf.math.reduce_sum(tf.ones_like(x[:,0], dtype=tf.int32))
    ncols = tf.math.reduce_sum(tf.ones_like(x[0,:], dtype=tf.int32))
    
    x = tf.image.resize(x, (nrows//2, ncols//2))
    
    x = tf.image.random_crop(x, (32,32,3))
    
    return x, tf.zeros_like(x)

model = tf.keras.models.Sequential()
model.add(tf.keras.Input(shape=(32,32,3)))
model.add(tf.keras.layers.Conv2D(3, (3,3), padding='same'))
model.summary()

files = glob.glob(""/mnt/ng/ncl/acquisition/stitches/20231019/row1/??/1/crop.jpg"")
print(len(files))

## crashes with the output below
ds = tf.data.Dataset.from_tensor_slices(files).map(preprocess).batch(1)


## the following works:
## ds = tf.data.Dataset.from_tensor_slices(files).map(preprocess_workaround).batch(1)

model.fit(ds)
```
```


### Relevant log output

```shell
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
/tmp/ipykernel_583425/761276435.py in <module>
      1 files = glob.glob(""/mnt/ng/ncl/acquisition/stitches/20231019/row1/??/1/crop.jpg"")
      2 print(len(files))
----> 3 ds = tf.data.Dataset.from_tensor_slices(files).map(preprocess).batch(1)
      4 model.fit(ds)

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/data/ops/dataset_ops.py in map(self, map_func, num_parallel_calls, deterministic, name)
   2292         warnings.warn(""The `deterministic` argument has no effect unless the ""
   2293                       ""`num_parallel_calls` argument is specified."")
-> 2294       return MapDataset(self, map_func, preserve_cardinality=True, name=name)
   2295     else:
   2296       return ParallelMapDataset(

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/data/ops/dataset_ops.py in __init__(self, input_dataset, map_func, use_inter_op_parallelism, preserve_cardinality, use_legacy_function, name)
   5497     self._use_inter_op_parallelism = use_inter_op_parallelism
   5498     self._preserve_cardinality = preserve_cardinality
-> 5499     self._map_func = structured_function.StructuredFunctionWrapper(
   5500         map_func,
   5501         self._transformation_name(),

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/data/ops/structured_function.py in __init__(self, func, transformation_name, dataset, input_classes, input_shapes, input_types, input_structure, add_to_graph, use_legacy_function, defun_kwargs)
    261         fn_factory = trace_tf_function(defun_kwargs)
    262 
--> 263     self._function = fn_factory()
    264     # There is no graph to add in eager mode.
    265     add_to_graph &= not context.executing_eagerly()

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/eager/polymorphic_function/tracing_compiler.py in get_concrete_function(self, *args, **kwargs)
    224         `tf.Tensor` or `tf.TensorSpec`.
    225     """"""
--> 226     concrete_function = self._get_concrete_function_garbage_collected(
    227         *args, **kwargs)
    228     concrete_function._garbage_collector.release()  # pylint: disable=protected-access

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/eager/polymorphic_function/tracing_compiler.py in _get_concrete_function_garbage_collected(self, *args, **kwargs)
    190 
    191     with self._lock:
--> 192       concrete_function, _ = self._maybe_define_concrete_function(args, kwargs)
    193       seen_names = set()
    194       captured = object_identity.ObjectIdentitySet(

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/eager/polymorphic_function/tracing_compiler.py in _maybe_define_concrete_function(self, args, kwargs)
    155       kwargs = {}
    156 
--> 157     return self._maybe_define_function(args, kwargs)
    158 
    159   def _get_concrete_function_internal_garbage_collected(self, *args, **kwargs):

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/eager/polymorphic_function/tracing_compiler.py in _maybe_define_function(self, args, kwargs)
    358             args, kwargs = generalized_func_key._placeholder_value()  # pylint: disable=protected-access
    359 
--> 360           concrete_function = self._create_concrete_function(args, kwargs)
    361 
    362           graph_capture_container = concrete_function.graph._capture_func_lib  # pylint: disable=protected-access

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/eager/polymorphic_function/tracing_compiler.py in _create_concrete_function(self, args, kwargs)
    282     arg_names = base_arg_names + missing_arg_names
    283     concrete_function = monomorphic_function.ConcreteFunction(
--> 284         func_graph_module.func_graph_from_py_func(
    285             self._name,
    286             self._python_function,

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/framework/func_graph.py in func_graph_from_py_func(name, python_func, args, kwargs, signature, func_graph, autograph, autograph_options, add_control_dependencies, arg_names, op_return_value, collections, capture_by_value, acd_record_initial_resource_uses)
   1281         _, original_func = tf_decorator.unwrap(python_func)
   1282 
-> 1283       func_outputs = python_func(*func_args, **func_kwargs)
   1284 
   1285       # invariant: `func_outputs` contains only Tensors, CompositeTensors,

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/data/ops/structured_function.py in wrapped_fn(*args)
    238           attributes=defun_kwargs)
    239       def wrapped_fn(*args):  # pylint: disable=missing-docstring
--> 240         ret = wrapper_helper(*args)
    241         ret = structure.to_tensor_list(self._output_structure, ret)
    242         return [ops.convert_to_tensor(t) for t in ret]

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/data/ops/structured_function.py in wrapper_helper(*args)
    169       if not _should_unpack(nested_args):
    170         nested_args = (nested_args,)
--> 171       ret = autograph.tf_convert(self._func, ag_ctx)(*nested_args)
    172       ret = variable_utils.convert_variables_to_tensors(ret)
    173       if _should_pack(ret):

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py in wrapper(*args, **kwargs)
    690       except Exception as e:  # pylint:disable=broad-except
    691         if hasattr(e, 'ag_error_metadata'):
--> 692           raise e.ag_error_metadata.to_exception(e)
    693         else:
    694           raise

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py in wrapper(*args, **kwargs)
    687       try:
    688         with conversion_ctx:
--> 689           return converted_call(f, args, kwargs, options=options)
    690       except Exception as e:  # pylint:disable=broad-except
    691         if hasattr(e, 'ag_error_metadata'):

~/anaconda3/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py in converted_call(f, args, kwargs, caller_fn_scope, options)
    437     try:
    438       if kwargs is not None:
--> 439         result = converted_f(*effective_args, **kwargs)
    440       else:
    441         result = converted_f(*effective_args)

/tmp/__autograph_generated_filecu6im70c.py in tf__preprocess(file_name)
     11                 x = ag__.converted_call(ag__.ld(tf).io.decode_jpeg, (ag__.ld(x),), None, fscope)
     12                 (nrows, ncols, _) = ag__.ld(x).shape
---> 13                 x = ag__.converted_call(ag__.ld(tf).image.resize, (ag__.ld(x), (ag__.ld(nrows) // 2, ag__.ld(ncols) // 2)), None, fscope)
     14                 x = ag__.converted_call(ag__.ld(tf).image.random_crop, (ag__.ld(x), (32, 32)), None, fscope)
     15                 try:

TypeError: in user code:

    File ""/tmp/ipykernel_583425/4207213119.py"", line 7, in preprocess  *
        x = tf.image.resize(x, (nrows//2, ncols//2))

    TypeError: unsupported operand type(s) for //: 'NoneType' and 'int'
```
",True
Trying to process RBG images and use RandomContrast: LookupError: gradient registry has no entry for: AdjustContrastv2 stat:awaiting response type:bug stale comp:ops TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

google collaboration

### Mobile device

_No response_

### Python version

3.10.12

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

T4

### Current behavior?

I see an error when I add RandomContrast layer into the model. Otherwise, it works fine.


### Standalone code to reproduce the issue

```shell
# Clean session
clear_session()

model_6 = Sequential()

model_6.add(Conv2D(filters = 16, kernel_size = (3, 3)
                   , padding = ""same"", input_shape = (img_height, img_wdith, 3)
                   , activation='relu'))


model_6.add(RandomRotation(factor=0.3))
model_6.add(layers.RandomFlip(""horizontal_and_vertical""))
model_6.add(MaxPooling2D(pool_size = (2, 2)))
model_6.add(Conv2D(filters = 16, kernel_size = (3, 3) , padding = ""same"" , activation='relu'))
model_6.add(MaxPooling2D(pool_size = (2, 2)))

# Add batch normalization
batch_normalization = BatchNormalization()
batch_normalization.trainable = True
model_6.add(batch_normalization)
model_6.add(layers.RandomContrast(factor=0.2, seed=11))

model_6.add(Flatten())

# Adding a fully connected dense layer with 256 neurons
model_6.add(Dense(256))

model_6.add(LeakyReLU(0.1))

model_6.add(Dense(num_classes, activation = 'softmax'))

# Printing the model summary
model_6.summary()
```


### Relevant log output

```shell
Epoch 1/20
---------------------------------------------------------------------------
StagingError                              Traceback (most recent call last)
[<ipython-input-72-d1c53732b3af>](https://39j3jgoo0eu-496ff2e9c6d22116-0-colab.googleusercontent.com/outputframe.html?vrz=colab_20231016-060118_RC00_573771261#) in <cell line: 7>()
      5 
      6 # Fit training dataset to model
----> 7 history_6 = model_6.fit(n_train_ds, validation_data=n_val_ds, epochs=num_epochs, verbose = 1 )

1 frames
[/usr/local/lib/python3.10/dist-packages/tensorflow/python/eager/polymorphic_function/autograph_util.py](https://39j3jgoo0eu-496ff2e9c6d22116-0-colab.googleusercontent.com/outputframe.html?vrz=colab_20231016-060118_RC00_573771261#) in autograph_handler(*args, **kwargs)
     50     except Exception as e:  # pylint:disable=broad-except
     51       if hasattr(e, ""ag_error_metadata""):
---> 52         raise e.ag_error_metadata.to_exception(e)
     53       else:
     54         raise

StagingError: in user code:

    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1338, in train_function  *
        return step_function(self, iterator)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1303, in run_step  **
        outputs = model.train_step(data)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1084, in train_step
        self.optimizer.minimize(loss, self.trainable_variables, tape=tape)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/optimizers/optimizer.py"", line 543, in minimize
        grads_and_vars = self.compute_gradients(loss, var_list, tape)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/optimizers/optimizer.py"", line 276, in compute_gradients
        grads = tape.gradient(loss, var_list)

    LookupError: gradient registry has no entry for: AdjustContrastv2
```
",True
Invalid classifier used for CUDA 12.2 type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

git HEAD

### Custom code

No

### OS platform and distribution

Ubuntu 20.04

### Mobile device

n/a

### Python version

3.9.17

### Bazel version

6.1.0

### GCC/compiler version

16.0.6

### CUDA/cuDNN version

n/a

### GPU model and memory

n/a

### Current behavior?

Uploads to PyPi fail with invalid classifier.

Introduced by https://github.com/tensorflow/tensorflow/commit/c3b98ea5a8387eec21e808caa6e999417494e09a

### Standalone code to reproduce the issue

```shell
python3 -m twine upload --verbose /home/ubuntu/actions-runner/_work/tensorflow/tensorflow/whl/* -u ""__token__"" -p ***
```


### Relevant log output

```shell
INFO     Response from https://upload.pypi.org/legacy/:                         
         400 Invalid value for classifiers. Error: Classifier 'Environment ::   
         GPU :: NVIDIA CUDA :: 12.2' is not a valid classifier.                 
INFO     <html>                                                                 
          <head>                                                                
           <title>400 Invalid value for classifiers. Error: Classifier          
         'Environment :: GPU :: NVIDIA CUDA :: 12.2' is not a valid             
         classifier.</title>                                                    
          </head>                                                               
          <body>                                                                
           <h1>400 Invalid value for classifiers. Error: Classifier 'Environment
         :: GPU :: NVIDIA CUDA :: 12.2' is not a valid classifier.</h1>         
           The server could not comply with the request since it is either      
         malformed or otherwise incorrect.<br/><br/>                            
         Invalid value for classifiers. Error: Classifier &#x27;Environment ::  
         GPU :: NVIDIA CUDA :: 12.2&#x27; is not a valid classifier.            
                                                                                
                                                                                
          </body>                                                               
         </html>                                                                
ERROR    HTTPError: 400 Bad Request from https://upload.pypi.org/legacy/        
         Invalid value for classifiers. Error: Classifier 'Environment :: GPU ::
         NVIDIA CUDA :: 12.2' is not a valid classifier.
```
",True
Internal Error for truncatediv when denominator is an integer zero. stat:awaiting response type:bug stale comp:ops TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.14.0

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

tf.truncatediv raises internal error when denominator is an integer zero. If the denominator is a float zero, this function works normally.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf
x = tf.constant(33, dtype=""int32"")
y = tf.constant(0, dtype=""int32"")
print(x, y)
print(tf.truncatediv(x,y))
```


### Relevant log output

_No response_",True
Errors when building v2.14 from source - ubuntu 20.04 / arm64 / GPU + CUDA (capabilities 8.7) / clang 16 stat:awaiting response type:bug type:build/install subtype: ubuntu/linux TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

v2.14.0

### Custom code

No

### OS platform and distribution

Ubuntu 20.04.6

### Mobile device

_No response_

### Python version

3.10.13

### Bazel version

6.1.0

### GCC/compiler version

clang 16.0.6

### CUDA/cuDNN version

11.4 / 8.6.0

### GPU model and memory

jetson orin agx  -> nvidia ampere

### Current behavior?

Attempting to build TF from source
- Jetson Orin w Ampere GPU, arm64
- TF 2.14.0
- bazel 6.1.0
- python 3.10

`./configure`
- no ROCm
- yes CUDA (capabilities = 8.7)
- no TensorRT
- using clang 16 as cuda compiler

`bazel build //tensorflow/tools/pip_package:build_pip_package`

Resultng behavior: build fails, with the following error:
```
.../tensorflow/core/kernels/BUILD:4996:18: Compiling tensorflow/core/kernels/sparse_reorder_op_gpu.cu.cc failed: (Exit 1): clang failed: error executing command (from target
 //tensorflow/core/kernels:sparse_reorder_op_gpu) /usr/lib/llvm-16/bin/clang -MD -MF bazel-out/aarch64-opt/bin/tensorflow/core/kernels/_objs/sparse_reorder_op_gpu/sparse_reorder_op_gpu.cu.pic.d ... (remaining 192 a
rguments skipped)
In file included from tensorflow/core/kernels/sparse_reorder_op_gpu.cu.cc:21:
In file included from ./tensorflow/core/kernels/gpu_prim.h:24:
In file included from bazel-out/aarch64-opt/bin/external/local_config_cuda/cuda/cuda/include/cub/device/device_radix_sort.cuh:40:
In file included from bazel-out/aarch64-opt/bin/external/local_config_cuda/cuda/cuda/include/cub/device/dispatch/dispatch_radix_sort.cuh:40:
In file included from bazel-out/aarch64-opt/bin/external/local_config_cuda/cuda/cuda/include/cub/device/dispatch/../../agent/agent_radix_sort_histogram.cuh:38:
bazel-out/aarch64-opt/bin/external/local_config_cuda/cuda/cuda/include/cub/device/dispatch/../../agent/../block/radix_rank_sort_operations.cuh:124:20: error: explicit qualification required to use member 'ProcessFl
oatMinusZero' from dependent base class
        return BFE(ProcessFloatMinusZero(key), bit_start, num_bits);
                   ^
 ...
 
 bazel-out/aarch64-opt/bin/external/local_config_cuda/cuda/cuda/include/cub/device/device_radix_sort.cuh:168:65: note: in instantiation of member function 'cub::DispatchRadixSort<false, long, long, int>::Dispatch' r
equested here
        return DispatchRadixSort<false, KeyT, ValueT, OffsetT>::Dispatch(
                                                                ^
./tensorflow/core/kernels/gpu_prim_helpers.h:117:37: note: in instantiation of function template specialization 'cub::DeviceRadixSort::SortPairs<long, long>' requested here
    err = gpuprim::DeviceRadixSort::SortPairs(
                                    ^
./tensorflow/core/kernels/gpu_prim_helpers.h:159:18: note: in instantiation of function template specialization 'tensorflow::detail::GpuRadixSortImpl<false, long, long>' requested here
  return detail::GpuRadixSortImpl</*Descending=*/false>(
                 ^
tensorflow/core/kernels/sparse_reorder_op_gpu.cu.cc:104:12: note: in instantiation of function template specialization 'tensorflow::GpuRadixSort<long, long>' requested here
        c, GpuRadixSort(c, num_elems, /*keys_in=*/flat_indices,
           ^
bazel-out/aarch64-opt/bin/external/local_config_cuda/cuda/cuda/include/cub/device/dispatch/../../agent/../block/radix_rank_sort_operations.cuh:98:52: note: member is declared here
    static __device__ __forceinline__ UnsignedBits ProcessFloatMinusZero(UnsignedBits key)
                                                   ^
2 errors generated when compiling for sm_87.
Target //tensorflow/tools/pip_package:build_pip_package failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 9646.040s, Critical Path: 487.26s
INFO: 17934 processes: 6479 internal, 11455 local.
FAILED: Build did NOT complete successfully
```

### Standalone code to reproduce the issue

```shell
see below
```


### Relevant log output

```shell
<someuser>:tensorflow ➜  git status
HEAD detached at v2.14.0
nothing to commit, working tree clean
<someuser>:tensorflow ➜  ./configure
You have bazel 6.1.0 installed.
Please specify the location of python. [Default is /home/someuser/.pyenv/versions/3.10.13/bin/python3]:


Found possible Python library paths:
  /home/someuser/.pyenv/versions/3.10.13/lib/python3.10/site-packages
Please input the desired Python library path to use.  Default is [/home/someuser/.pyenv/versions/3.10.13/lib/python3.10/site-packages]

Do you wish to build TensorFlow with ROCm support? [y/N]:
No ROCm support will be enabled for TensorFlow.

Do you wish to build TensorFlow with CUDA support? [y/N]: y
CUDA support will be enabled for TensorFlow.

Do you wish to build TensorFlow with TensorRT support? [y/N]:
No TensorRT support will be enabled for TensorFlow.

Found CUDA 11.4 in:
    /usr/local/cuda-11.4/targets/aarch64-linux/lib
    /usr/local/cuda-11.4/targets/aarch64-linux/include
Found cuDNN 8 in:
    /usr/lib/aarch64-linux-gnu
    /usr/include


Please specify a list of comma-separated CUDA compute capabilities you want to build with.
You can find the compute capability of your device at: https://developer.nvidia.com/cuda-gpus. Each capability can be specified as ""x.y"" or ""compute_xy"" to include both virtual and binary GPU code, or as ""sm_xy"" to only include the binary code.
Please note that each additional compute capability significantly increases your build time and binary size, and that TensorFlow only supports compute capabilities >= 3.5 [Default is: 3.5,7.0]: 8.7


Do you want to use clang as CUDA compiler? [Y/n]:
Clang will be used as CUDA compiler.

Please specify clang path that to be used as host compiler. [Default is /usr/lib/llvm-16/bin/clang]:


You have Clang 16.0.6 installed.

Please specify optimization flags to use during compilation when bazel option ""--config=opt"" is specified [Default is -Wno-sign-compare]:


Would you like to interactively configure ./WORKSPACE for Android builds? [y/N]: N
Not configuring the WORKSPACE for Android builds.

Preconfigured Bazel build configs. You can use any of the below by adding ""--config=<>"" to your build command. See .bazelrc for more details.
        --config=mkl            # Build with MKL support.
        --config=mkl_aarch64    # Build with oneDNN and Compute Library for the Arm Architecture (ACL).
        --config=monolithic     # Config for mostly static monolithic build.
        --config=numa           # Build with NUMA support.
        --config=dynamic_kernels        # (Experimental) Build kernels into separate shared objects.
        --config=v1             # Build with TensorFlow 1 API instead of TF 2 API.
Preconfigured Bazel build configs to DISABLE default on features:
        --config=nogcp          # Disable GCP support.
        --config=nonccl         # Disable NVIDIA NCCL support.
Configuration finished
<someuser>:tensorflow ➜  bazel build //tensorflow/tools/pip_package:build_pip_package
WARNING: while reading option defaults file '/home/someuser/projects/other/tensorflow/.bazelrc':
  invalid command name 'startup:windows'.
WARNING: The following configs were expanded more than once: [cuda_clang, cuda]. For repeatable flags, repeats are counted twice and may lead to unexpected behavior.
INFO: Options provided by the client:
  Inherited 'common' options: --isatty=1 --terminal_columns=214
INFO: Reading rc options for 'build' from /home/someuser/projects/other/tensorflow/.bazelrc:
  Inherited 'common' options: --experimental_repo_remote_exec
INFO: Reading rc options for 'build' from /home/someuser/projects/other/tensorflow/.bazelrc:
  'build' options: --define framework_shared_object=true --define tsl_protobuf_header_only=true --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone -c opt --announce_rc --define=grpc_no_ares=true --noincompatible_remove_legacy_whole_archive --features=-force_no_whole_archive --enable_platform_specific_config --define=with_xla_support=true --config=short_logs --config=v2 --define=no_aws_support=true --define=no_hdfs_support=true --experimental_cc_shared_library --experimental_link_static_libraries_once=false --incompatible_enforce_config_setting_visibility
INFO: Reading rc options for 'build' from /home/someuser/projects/other/tensorflow/.tf_configure.bazelrc:
  'build' options: --action_env PYTHON_BIN_PATH=/home/someuser/.pyenv/versions/3.10.13/bin/python3 --action_env PYTHON_LIB_PATH=/home/someuser/.pyenv/versions/3.10.13/lib/python3.10/site-packages --python_path=/home/someuser/.pyenv/versions/3.10.13/bin/python3 --action_env CUDA_TOOLKIT_PATH=/usr/local/cuda-11.4 --action_env TF_CUDA_COMPUTE_CAPABILITIES=8.7 --config=cuda_clang --action_env CLANG_CUDA_COMPILER_PATH=/usr/lib/llvm-16/bin/clang --copt=-Wno-gnu-offsetof-extensions --config=cuda_clang
INFO: Found applicable config definition build:short_logs in file /home/someuser/projects/other/tensorflow/.bazelrc: --output_filter=DONT_MATCH_ANYTHING
INFO: Found applicable config definition build:v2 in file /home/someuser/projects/other/tensorflow/.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1
INFO: Found applicable config definition build:cuda_clang in file /home/someuser/projects/other/tensorflow/.bazelrc: --config=cuda --repo_env TF_CUDA_CLANG=1 --@local_config_cuda//:cuda_compiler=clang
INFO: Found applicable config definition build:cuda in file /home/someuser/projects/other/tensorflow/.bazelrc: --repo_env TF_NEED_CUDA=1 --crosstool_top=@local_config_cuda//crosstool:toolchain --@local_config_cuda//:enable_cuda
INFO: Found applicable config definition build:cuda_clang in file /home/someuser/projects/other/tensorflow/.bazelrc: --config=cuda --repo_env TF_CUDA_CLANG=1 --@local_config_cuda//:cuda_compiler=clang
INFO: Found applicable config definition build:cuda in file /home/someuser/projects/other/tensorflow/.bazelrc: --repo_env TF_NEED_CUDA=1 --crosstool_top=@local_config_cuda//crosstool:toolchain --@local_config_cuda//:enable_cuda
INFO: Found applicable config definition build:linux in file /home/someuser/projects/other/tensorflow/.bazelrc: --host_copt=-w --copt=-Wno-all --copt=-Wno-extra --copt=-Wno-deprecated --copt=-Wno-deprecated-declarations --copt=-Wno-ignored-attributes --copt=-Wno-array-bounds --copt=-Wunused-result --copt=-Werror=unused-result --copt=-Wswitch --copt=-Werror=switch --copt=-Wno-error=unused-but-set-variable --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include --define=PROTOBUF_INCLUDE_PATH=$(PREFIX)/include --cxxopt=-std=c++17 --host_cxxopt=-std=c++17 --config=dynamic_kernels --experimental_guard_against_concurrent_changes
INFO: Found applicable config definition build:dynamic_kernels in file /home/someuser/projects/other/tensorflow/.bazelrc: --define=dynamic_loaded_kernels=true --copt=-DAUTOLOAD_DYNAMIC_KERNELS
WARNING: Download from https://storage.googleapis.com/mirror.tensorflow.org/github.com/llvm/llvm-project/archive/668e33c6401abe7844691fb7d47a3cf2d2012dbc.tar.gz failed: class java.io.FileNotFoundException GET returned 404 Not Found
WARNING: Download from https://storage.googleapis.com/mirror.tensorflow.org/github.com/tensorflow/runtime/archive/769f5cc9b8732933140b09e8808d13614182b496.tar.gz failed: class java.io.FileNotFoundException GET returned 404 Not Found
WARNING: while reading option defaults file '/home/someuser/projects/other/tensorflow/.bazelrc':
  invalid command name 'startup:windows'.
WARNING: The following configs were expanded more than once: [cuda_clang, cuda]. For repeatable flags, repeats are counted twice and may lead to unexpected behavior.
INFO: Build options --copt and --host_copt have changed, discarding analysis cache.
WARNING: Download from https://mirror.bazel.build/github.com/bazelbuild/rules_cc/archive/081771d4a0e9d7d3aa0eed2ef389fa4700dfb23e.tar.gz failed: class java.io.FileNotFoundException GET returned 404 Not Found
WARNING: Download from https://storage.googleapis.com/mirror.tensorflow.org/github.com/openxla/stablehlo/archive/9ae6c373a6e2941ff84a8831bb3724728cb2b49a.zip failed: class java.io.FileNotFoundException GET returned 404 Not Found
WARNING: Download from https://storage.googleapis.com/mirror.tensorflow.org/github.com/pytorch/cpuinfo/archive/87d8234510367db49a65535021af5e1838a65ac2.zip failed: class java.io.FileNotFoundException GET returned 404 Not Found
WARNING: Download from https://storage.googleapis.com/mirror.tensorflow.org/github.com/google/XNNPACK/archive/b9d4073a6913891ce9cbd8965c8d506075d2a45a.zip failed: class java.io.FileNotFoundException GET returned 404 Not Found
WARNING: Download from https://storage.googleapis.com/mirror.tensorflow.org/github.com/openxla/triton/archive/cl546794996.tar.gz failed: class java.io.FileNotFoundException GET returned 404 Not Found
INFO: Analyzed target //tensorflow/tools/pip_package:build_pip_package (1 packages loaded, 47122 targets configured).
INFO: Found 1 target...
[1,765 / 6,027] 8 actions running
[1,802 / 6,027] 8 actions running
    Compiling mlir/lib/Dialect/Arith/IR/ArithOps.cpp [for tool]; 41s local
    Compiling mlir/lib/Dialect/Arith/IR/ArithDialect.cpp [for tool]; 40s local
Target //tensorflow/tools/pip_package:build_pip_package failed to build
Use --verbose_failures to see the command lines of failed build steps.
ERROR: build interrupted
INFO: Elapsed time: 195.807s, Critical Path: 101.10s
INFO: 301 processes: 15 internal, 286 local.
FAILED: Build did NOT complete successfully

<someuser>:tensorflow ➜
<someuser>:tensorflow ➜

<someuser>:tensorflow ➜
<someuser>:tensorflow ➜  reset

<someuser>:tensorflow ➜  bazel clean
WARNING: while reading option defaults file '/home/someuser/projects/other/tensorflow/.bazelrc':
  invalid command name 'startup:windows'.
WARNING: The following configs were expanded more than once: [cuda_clang, cuda]. For repeatable flags, repeats are counted twice and may lead to unexpected behavior.
INFO: Options provided by the client:
  Inherited 'common' options: --isatty=1 --terminal_columns=214
INFO: Reading rc options for 'clean' from /home/someuser/projects/other/tensorflow/.bazelrc:
  Inherited 'common' options: --experimental_repo_remote_exec
INFO: Reading rc options for 'clean' from /home/someuser/projects/other/tensorflow/.bazelrc:
  Inherited 'build' options: --define framework_shared_object=true --define tsl_protobuf_header_only=true --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone -c opt --announce_rc --define=grpc_no_ares=true --noincompatible_remove_legacy_whole_archive --features=-force_no_whole_archive --enable_platform_specific_config --define=with_xla_support=true --config=short_logs --config=v2 --define=no_aws_support=true --define=no_hdfs_support=true --experimental_cc_shared_library --experimental_link_static_libraries_once=false --incompatible_enforce_config_setting_visibility
INFO: Reading rc options for 'clean' from /home/someuser/projects/other/tensorflow/.tf_configure.bazelrc:
  Inherited 'build' options: --action_env PYTHON_BIN_PATH=/home/someuser/.pyenv/versions/3.10.13/bin/python3 --action_env PYTHON_LIB_PATH=/home/someuser/.pyenv/versions/3.10.13/lib/python3.10/site-packages --python_path=/home/someuser/.pyenv/versions/3.10.13/bin/python3 --action_env CUDA_TOOLKIT_PATH=/usr/local/cuda-11.4 --action_env TF_CUDA_COMPUTE_CAPABILITIES=8.7 --config=cuda_clang --action_env CLANG_CUDA_COMPILER_PATH=/usr/lib/llvm-16/bin/clang --copt=-Wno-gnu-offsetof-extensions --config=cuda_clang
INFO: Found applicable config definition build:short_logs in file /home/someuser/projects/other/tensorflow/.bazelrc: --output_filter=DONT_MATCH_ANYTHING
INFO: Found applicable config definition build:v2 in file /home/someuser/projects/other/tensorflow/.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1
INFO: Found applicable config definition build:cuda_clang in file /home/someuser/projects/other/tensorflow/.bazelrc: --config=cuda --repo_env TF_CUDA_CLANG=1 --@local_config_cuda//:cuda_compiler=clang
INFO: Found applicable config definition build:cuda in file /home/someuser/projects/other/tensorflow/.bazelrc: --repo_env TF_NEED_CUDA=1 --crosstool_top=@local_config_cuda//crosstool:toolchain --@local_config_cuda//:enable_cuda
INFO: Found applicable config definition build:cuda_clang in file /home/someuser/projects/other/tensorflow/.bazelrc: --config=cuda --repo_env TF_CUDA_CLANG=1 --@local_config_cuda//:cuda_compiler=clang
INFO: Found applicable config definition build:cuda in file /home/someuser/projects/other/tensorflow/.bazelrc: --repo_env TF_NEED_CUDA=1 --crosstool_top=@local_config_cuda//crosstool:toolchain --@local_config_cuda//:enable_cuda
INFO: Found applicable config definition build:linux in file /home/someuser/projects/other/tensorflow/.bazelrc: --host_copt=-w --copt=-Wno-all --copt=-Wno-extra --copt=-Wno-deprecated --copt=-Wno-deprecated-declarations --copt=-Wno-ignored-attributes --copt=-Wno-array-bounds --copt=-Wunused-result --copt=-Werror=unused-result --copt=-Wswitch --copt=-Werror=switch --copt=-Wno-error=unused-but-set-variable --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include --define=PROTOBUF_INCLUDE_PATH=$(PREFIX)/include --cxxopt=-std=c++17 --host_cxxopt=-std=c++17 --config=dynamic_kernels --experimental_guard_against_concurrent_changes
INFO: Found applicable config definition build:dynamic_kernels in file /home/someuser/projects/other/tensorflow/.bazelrc: --define=dynamic_loaded_kernels=true --copt=-DAUTOLOAD_DYNAMIC_KERNELS
INFO: Starting clean (this may take a while). Consider using --async if the clean takes more than several minutes.
<someuser>:tensorflow ➜  reset
'





















<someuser>:tensorflow ➜  git status
HEAD detached at v2.14.0
nothing to commit, working tree clean
<someuser>:tensorflow ➜  bazel --version
bazel 6.1.0
<someuser>:tensorflow ➜  clang-16 --version
Ubuntu clang version 16.0.6 (++20230710042046+7cbf1a259152-1~exp1~20230710162136.105)
Target: aarch64-unknown-linux-gnu
Thread model: posix
InstalledDir: /usr/bin
<someuser>:tensorflow ➜  ./configure
You have bazel 6.1.0 installed.
Please specify the location of python. [Default is /home/someuser/.pyenv/versions/3.10.13/bin/python3]:


Found possible Python library paths:
  /home/someuser/.pyenv/versions/3.10.13/lib/python3.10/site-packages
Please input the desired Python library path to use.  Default is [/home/someuser/.pyenv/versions/3.10.13/lib/python3.10/site-packages]

Do you wish to build TensorFlow with ROCm support? [y/N]:
No ROCm support will be enabled for TensorFlow.

Do you wish to build TensorFlow with CUDA support? [y/N]: y
CUDA support will be enabled for TensorFlow.

Do you wish to build TensorFlow with TensorRT support? [y/N]:
No TensorRT support will be enabled for TensorFlow.

Found CUDA 11.4 in:
    /usr/local/cuda-11.4/targets/aarch64-linux/lib
    /usr/local/cuda-11.4/targets/aarch64-linux/include
Found cuDNN 8 in:
    /usr/lib/aarch64-linux-gnu
    /usr/include


Please specify a list of comma-separated CUDA compute capabilities you want to build with.
You can find the compute capability of your device at: https://developer.nvidia.com/cuda-gpus. Each capability can be specified as ""x.y"" or ""compute_xy"" to include both virtual and binary GPU code, or as ""sm_xy"" to only include the binary code.
Please note that each additional compute capability significantly increases your build time and binary size, and that TensorFlow only supports compute capabilities >= 3.5 [Default is: 3.5,7.0]: 8.7


Do you want to use clang as CUDA compiler? [Y/n]:
Clang will be used as CUDA compiler.

Please specify clang path that to be used as host compiler. [Default is /usr/lib/llvm-16/bin/clang]:


You have Clang 16.0.6 installed.

Please specify optimization flags to use during compilation when bazel option ""--config=opt"" is specified [Default is -Wno-sign-compare]:


Would you like to interactively configure ./WORKSPACE for Android builds? [y/N]:
Not configuring the WORKSPACE for Android builds.

Preconfigured Bazel build configs. You can use any of the below by adding ""--config=<>"" to your build command. See .bazelrc for more details.
        --config=mkl            # Build with MKL support.
        --config=mkl            # Build with MKL support.                                                                                                                                                    [12/7774]
        --config=mkl_aarch64    # Build with oneDNN and Compute Library for the Arm Architecture (ACL).
        --config=monolithic     # Config for mostly static monolithic build.
        --config=numa           # Build with NUMA support.
        --config=dynamic_kernels        # (Experimental) Build kernels into separate shared objects.
        --config=v1             # Build with TensorFlow 1 API instead of TF 2 API.
Preconfigured Bazel build configs to DISABLE default on features:
        --config=nogcp          # Disable GCP support.
        --config=nonccl         # Disable NVIDIA NCCL support.
Configuration finished
<someuser>:tensorflow ➜  bazel build --config=opt --config=cuda //tensorflow/tools/pip_package:build_pip_package



/////////////////////////
```
",True
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xce in position XX: invalid continuation byte stat:awaiting response type:bug stale comp:apis TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 2.14.0

### Custom code

Yes

### OS platform and distribution

Windows 11 Home 22H2

### Mobile device

_No response_

### Python version

3.9.13

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I've created a model in google colab: [here](https://colab.research.google.com/drive/1776CZxkKcetQsPkJfMACWnNel3Hj-hbA?usp=sharing). Then downloaded it and loaded few times on my computer. However after these times it stopped to load by the function `tf.keras.saving.load_model(model_name)` and started to drop this error: 

```
---------------------------------------------------------------------------
UnicodeDecodeError                        Traceback (most recent call last)
Cell In[3], line 9
      5 import time
      6 from random import sample
----> 9 model = tf.keras.saving.load_model('Верх сегментация')

File C:\Program Files\Python39\lib\site-packages\keras\src\saving\saving_api.py:262, in load_model(filepath, custom_objects, compile, safe_mode, **kwargs)
    254     return saving_lib.load_model(
    255         filepath,
    256         custom_objects=custom_objects,
    257         compile=compile,
    258         safe_mode=safe_mode,
    259     )
    261 # Legacy case.
--> 262 return legacy_sm_saving_lib.load_model(
    263     filepath, custom_objects=custom_objects, compile=compile, **kwargs
    264 )

File C:\Program Files\Python39\lib\site-packages\keras\src\utils\traceback_utils.py:70, in filter_traceback.<locals>.error_handler(*args, **kwargs)
     67     filtered_tb = _process_traceback_frames(e.__traceback__)
     68     # To get the full stack trace, call:
     69     # `tf.debugging.disable_traceback_filtering()`
---> 70     raise e.with_traceback(filtered_tb) from None
     71 finally:
     72     del filtered_tb

File C:\Program Files\Python39\lib\site-packages\h5py\_hl\files.py:562, in File.__init__(self, name, mode, driver, libver, userblock_size, swmr, rdcc_nslots, rdcc_nbytes, rdcc_w0, track_order, fs_strategy, fs_persist, fs_threshold, fs_page_size, page_buf_size, min_meta_keep, min_raw_keep, locking, alignment_threshold, alignment_interval, meta_block_size, **kwds)
    553     fapl = make_fapl(driver, libver, rdcc_nslots, rdcc_nbytes, rdcc_w0,
    554                      locking, page_buf_size, min_meta_keep, min_raw_keep,
    555                      alignment_threshold=alignment_threshold,
    556                      alignment_interval=alignment_interval,
    557                      meta_block_size=meta_block_size,
    558                      **kwds)
    559     fcpl = make_fcpl(track_order=track_order, fs_strategy=fs_strategy,
    560                      fs_persist=fs_persist, fs_threshold=fs_threshold,
    561                      fs_page_size=fs_page_size)
--> 562     fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
    564 if isinstance(libver, tuple):
    565     self._libver = libver

File C:\Program Files\Python39\lib\site-packages\h5py\_hl\files.py:235, in make_fid(name, mode, userblock_size, fapl, fcpl, swmr)
    233     if swmr and swmr_support:
    234         flags |= h5f.ACC_SWMR_READ
--> 235     fid = h5f.open(name, flags, fapl=fapl)
    236 elif mode == 'r+':
    237     fid = h5f.open(name, h5f.ACC_RDWR, fapl=fapl)

File h5py\_objects.pyx:54, in h5py._objects.with_phil.wrapper()

File h5py\_objects.pyx:55, in h5py._objects.with_phil.wrapper()

File h5py\h5f.pyx:102, in h5py.h5f.open()

File h5py\h5fd.pyx:155, in h5py.h5fd.H5FD_fileobj_get_eof()

File h5py\h5fd.pyx:155, in h5py.h5fd.H5FD_fileobj_get_eof()

File h5py\h5fd.pyx:155, in h5py.h5fd.H5FD_fileobj_get_eof()

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xce in position 77: invalid continuation byte
```

I haven't changed anything in the code, it just suddenly stopped to open. I've tried to recreate the model in colab and download it again, changed tf version on computer to tf 2.13.0 (colab has it). Also I've tried to open another models on my pc and all of them threw this error

[Model in google drive](https://drive.google.com/drive/folders/1QIYJklw1tW5WCBanlfkIFyKFLwMGzez3?usp=sharing)

### Standalone code to reproduce the issue

```shell
https://colab.research.google.com/drive/1776CZxkKcetQsPkJfMACWnNel3Hj-hbA?usp=sharing - colab code for the nn

https://gist.github.com/DemO-O-On/65d5f1114d8163ae234a57c7789d7039 - script for loading model
```


### Relevant log output

Output from jupyter when trying to load model:

`2023-10-13 16:33:40.479946: E tensorflow/tsl/platform/windows/windows_file_system.cc:363] ERROR: GetSymbolicLinkTarget cannot open file for \\?\C:\Users\termi\Desktop\stlsegm\╨Т╨╡╤А╤Е_╨▓╤Б╨╡\╨Т╨╡╤А╤Е_╨▒╨╡╨╖_╨┤╨╡╤Б╨╜╤Л ╤В╨╛╨╗╤М╨║╨╛ ╨▓╨╡╤А╤Е╨╜╨╕╨╡\╨Т╨╡╤А╤Е ╤Б╨╡╨│╨╝╨╡╨╜╤В╨░╤Ж╨╕╤П GetLastError: 5`",True
Error when convert dynamic axes ONNX to dynamic axes TFLite  stat:awaiting response type:bug comp:lite TFLiteConverter TF 2.11,"### 1. System information

- Ubuntu20.04
- Tensorflow: 2.11
- Python: 3.10.8
- Pytorch: 1.12.0

### 2. Code
#### The first convert Pytorch model to Onnx with dynamic input:
    network = 'rSfM120k-tl-resnet50-gem-w'
    state = load_url(PRETRAINED[network], model_dir=os.path.join(get_data_root(), 'networks'))
    net_params = {}
    net_params['architecture'] = state['meta']['architecture']
    net_params['pooling'] = state['meta']['pooling']
    net_params['local_whitening'] = state['meta'].get('local_whitening', False)
    net_params['regional'] = state['meta'].get('regional', False)
    net_params['whitening'] = state['meta'].get('whitening', True)
    net_params['mean'] = state['meta']['mean']
    net_params['std'] = state['meta']['std']
    net_params['pretrained'] = False
    
    net = init_network(net_params)
    net.load_state_dict(state['state_dict'])
    
    if useRmac:
        net.pool = RMAC(3)
    net.cuda()
    net.eval()
    dummy_input = torch.randn(1, 3, 400, 900)
    input_names = [ ""actual_input"" ]
    output_names = [ ""output"" ]
    dynamic_axes_dict = { 'actual_input': { 0: 'bs',  2: 'img_x',3: 'img_y'},'Output': { 0: 'bs'}} 
    torch.onnx.export(net,
                     dummy_input,
                     ""resnet50.onnx"",
                     verbose=False,
                     input_names=input_names,
                     output_names=output_names,
                    dynamic_axes=dynamic_axes_dict,
                     opset_version=12, 
                    )
#### The second convert Onnx model to Tf:
    onnx_path = 'resnet50.onnx'
    onnx_model = onnx.load( onnx_path)
    onnx.checker.check_model(onnx_model)
    tf_path = 'cirtorch_tf_0210_resnet50_withoutNor'
    tf_rep = prepare(onnx_model)  #Prepare TF representation
    tf_rep.export_graph(tf_path)  #Export the model
#### The third convert Tf model to TfLite:
    tf_lite_path = '0210_cirtorch_fl16_resnet50_withoutNor.tflite'
    converter = tf.lite.TFLiteConverter.from_saved_model(tf_path)
    tflite_model  = converter.convert()
    with open(tf_lite_path, 'wb') as f:
        f.write(tflite_model)
#### Test model TfLite with dynamic input:
    tflite_model_path = tf_lite_path
    interpreter = tf.lite.Interpreter(model_path=tflite_model_path,experimental_delegates=[])
    input_details = interpreter.get_input_details()
    output_details = interpreter.get_output_details()
    interpreter.resize_tensor_input(interpreter.get_input_details()[0]['index'],[1,3,200,200])
    input_details = interpreter.get_input_details()
    output_details = interpreter.get_output_details()
    interpreter.allocate_tensors()
    x1 = torch.ones(1,3,200, 200)
    input_data = np.array(x1, dtype=np.float32)
    print(input_data.shape)
    interpreter.set_tensor(input_details[0]['index'], input_data)
    interpreter.invoke()
    output_data = interpreter.get_tensor(output_details[0]['index'])
    print(output_data.shape)
### But I got error when invoke model TFLite:
Traceback (most recent call last):
  File ""convertCirtorchFreesizeTFlite.py"", line 143, in <module>
    interpreter.invoke()
  File ""/home/anlab/anaconda3/envs/bopw/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py"", line 917, in invoke
    self._interpreter.Invoke()
RuntimeError: tensorflow/lite/kernels/squeeze.cc:63 current >= 0 && current < input_num_dims && input_dims->data[current] == 1 was not true.Node number 0 (SQUEEZE) failed to prepare.Node number 144 (IF) failed to prepare.
#### Or
  File ""/home/anlab/anaconda3/envs/bopw/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py"", line 917, in invoke
    self._interpreter.Invoke()
RuntimeError: tensorflow/lite/kernels/reshape.cc:85 num_input_elements != num_output_elements (2048 != 4194304)Node number 2 (RESHAPE) failed to invoke.Node number 144 (IF) failed to invoke.
",True
"Unable to change validation dataset for ""model.fit()"" function after it raises an exception type:bug comp:apis comp:keras TF 2.13","### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

Google Colab

### Mobile device

_No response_

### Python version

3.10.12

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

When using model.fit() in TensorFlow, the validation data provided as an input parameter is initially used for model evaluation. However, if the initial evaluation fails, subsequent runs of model.fit() still use the previously provided validation data, even if new data is provided.

### Standalone code to reproduce the issue

```shell
The error is quite easy to reproduce. Check the ""compile and train section"" in the below provided colab.

https://colab.research.google.com/drive/1Es8mQd0FOoWea4SrJ2TDz4NRSx0ZxwEt#scrollTo=08WJXiheNxK7

I modified a tensorflow tutorial colab on CNNs to reproduce this error. In the section i first run the model with correct parameters, then with incorrect and then again with correct parameters but this time it fails.
```


### Relevant log output

_No response_",True
Internal definition breaks tensorflow-probability type:bug,"Tensorflow-probability's [test](https://github.com/tensorflow/probability/issues/1753#issuecomment-1753993699) is broken, and it appears to be due to a [bad definition in tensorflow](https://github.com/tensorflow/probability/issues/1753#issuecomment-1756359940).

This is preventing the tensorflow-probability team from updating `typing_extensions`, which then breaks upgrading to Python 3.12.
",True
NNAPI delegate crashes on kTfLiteBuiltinCos in TF Lite 2.14 stat:contribution welcome stat:awaiting tensorflower type:bug comp:lite TFLiteConverter TFLiteNNAPIDelegate TF2.14,"### Issue type

Bug (segfault!)

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.14

### Custom code

No

### OS platform and distribution

Android 13

### Mobile device

Pixel 4

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

In TF Lite 2.14, the NNAPI delegate was changed to support the cos operator. Unfortunately, it does not work as expected and causes a segfault.

The originating change is https://github.com/tensorflow/tensorflow/commit/4aac8c95b7d7827eedca82a76cb71db1525dafc9.

The repro is easy. Use the below network and run with NNAPI.

The error is in `TransformCosIntoSupportedOps`, which makes the assumption that `theta` is non-null. This causes a null-pointer dereference.

But the problem is bigger than this - the NNAPI delegate should _not_ be modifying static data. This is dangerous and will lead to problems if the node is not accepted by the delegate, or if the execution graph is modified again to use a different delegate.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf

class MyModel(tf.Module):
    @tf.function(input_signature=[tf.TensorSpec(shape=[None], dtype=tf.float32)])
    def my_operation(self, x):
        return tf.cos(x)

model = MyModel()

concrete_func = model.my_operation.get_concrete_function()
converter = tf.lite.TFLiteConverter.from_concrete_functions([concrete_func])
tflite_model = converter.convert()

with open(""nnapi_cos_bug.tflite"", ""wb"") as f:
    f.write(tflite_model)
```

Convert to tflite and load using NNAPI. The application will segfault.
```


### Relevant log output

_No response_",True
Shape inference for tf.gather is inconsistent with/without --tf_mlir_enable_mlir_bridge stat:awaiting response type:bug stale comp:ops TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.14

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

3.11

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Please refer to the ""Relevant log output"" section for detailed description of current behavior.

### Standalone code to reproduce the issue

```shell
# Run the code snippet with the following flags to reproduce the issue:
# TF_XLA_FLAGS=""--tf_mlir_enable_mlir_bridge --tf_xla_enable_xla_devices --tf_xla_auto_jit=2 --tf_xla_cpu_global_jit --tf_xla_min_cluster_size=1""

import tensorflow as tf

params = tf.constant([
    [0, 0, 1, 0, 2],
    [3, 0, 0, 0, 4],
    [0, 5, 0, 6, 0]])
indices = tf.constant([
    [2, 4],
    [0, 4]])

print(tf.gather(params, indices, axis=1, batch_dims=1))
```


### Relevant log output

```shell
When mlir bridge is disabled, the code snippet works without any error. The return value of tf.gather is [[1 2][3 4]]


when mlir bridge is enabled, the code snippet returned with error:

2023-10-11 11:43:24.846292: W tensorflow/core/framework/op_kernel.cc:1839] OP_REQUIRES failed at xla_ops.cc:841 : INVALID_ARGUMENT: Shape used to set computation result layout (s32[3,2]{1,0}) is not compatible with result shape (s32[2,2])
Traceback (most recent call last):
  File ""/tf/playground/test_gather.py"", line 37, in <module>
    print(tf.gather(params, indices, validate_indices=True, axis=1, batch_dims=1).numpy())
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tensorflow/python/util/traceback_utils.py"", line 153, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File ""/usr/local/lib/python3.11/dist-packages/tensorflow/python/framework/ops.py"", line 5888, in raise_from_not_ok_status
    raise core._status_to_exception(e) from None  # pylint: disable=protected-access
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: {{function_node __wrapped__GatherV2_device_/job:localhost/replica:0/task:0/device:CPU:0}} Shape used to set computation result layout (s32[3,2]{1,0}) is not compatible with result shape (s32[2,2])
         [[{{node cluster_1_1/xla_compile}}]] [Op:GatherV2] name:
```
",True
"TFRecordWriter stuck (or very slow) while serializing data, depending on feature transformation type type:bug","### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.13

### Custom code

Yes

### OS platform and distribution

ubuntu 22.4

### Mobile device

_No response_

### Python version

3.8.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11.8

### GPU model and memory

_No response_

### Current behavior?


**tf.io.TFRecordWriter** freeze when preprocessing features with **scikit-learn** (**Dask-ML**) **QuantileTranformer**, whereas its working (writing out few k samples within seconds) when using **StandardScaler**.

How might QuantileTransformer produce output data shaped in a way it breaks TFRecords serialization? Might dtype precision influence serialization performance in such criticality?

### Standalone code to reproduce the issue

```shell
(reduced pseudo code)

# fit scalers
#### NOTE Option 1: using this scaler breaks TF records writer!
feat_standardizer = dask_QuantileTransformer(output_distribution=standardizer_distribution, 
                                                n_quantiles=n_feat_standardizer_quantils, 
                                                subsample=n_fit_samples, copy=False)


# NOTE Option 2: Using this one works for TF records writer
feat_standardizer = dask_StandardScaler(copy=False)


## from here proceed the same way until TF data serialization as TFRecord files

x_train_future = dask_client.scatter(x_train_arr) 
feat_standardizer = dask_client.submit(feat_standardizer.fit, x_train_future).result()
x_train_preproc_future = dask_client.submit(feat_standardizer.transform, x_train_future)
x_train_dask_arr = dask_client.gather(x_train_preproc_future)

....

# Transform training data (in chuncks of subsets of the total training dataset)
X_train_future = dask_client.scatter(x_train_arr_transform_batch)
X_train_future = dask_client.submit(feat_standardizer.transform, X_train_future)
X_train_future = dask_client.submit(feat_normalizer.transform, X_train_future)
x_train_arr_transform_batch  = dask_client.gather(X_train_future)
    
# reshape features: (sample * time, feat) -> (sample, time, feat)
X_train = x_train_arr_transform_batch.reshape((n_train_samples, n_steps, n_feat))

# cast numpy default precision float64 -> TF float32                               
X_train = X_train.astype(np.float32)
y_train = y_train.astype(np.int64)

def array_to_tfrecords(X, y):
        feature_dict = {
            'X': tf.train.Feature(float_list=tf.train.FloatList(value=X.flatten())),
            'y': tf.train.Feature(int64_list=tf.train.Int64List(value=y.flatten()))
        }
        example = tf.train.Example(features=tf.train.Features(feature=feature_dict)) 
        return example.SerializeToString()

tf.io.TFRecordWriter(tfrecords_file_path, options=tf.io.TFRecordOptions(compression_type='ZLIB', compression_level=7)) as writer:
        for x, y in tqdm(zip(X_train, y_train)):         # <---- no progress visible here when using QuantileTransformer!
            serialized = array_to_tfrecords(x, y)
            writer.write(serialized)
```


### Relevant log output

```shell
No output visible. The script just never continues and freeze while pretending to serialize data
```
",True
ERROR: No matching distribution found for tensorflow-gpu==2.11 stat:awaiting response type:bug type:build/install stale TF 2.11,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.11.0

### Custom code

Yes

### OS platform and distribution

windows

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11 / 8

### GPU model and memory

3060

### Current behavior?

WARNING: Ignoring invalid distribution -pencv-python-headless (c:\users\rites\appdata\roaming\python\python39\site-packages)
WARNING: Ignoring invalid distribution -pencv-python-headless (c:\users\rites\appdata\roaming\python\python39\site-packages)
ERROR: Could not find a version that satisfies the requirement tensorflow-gpu==2.11 (from versions: 2.5.0, 2.5.1, 2.5.2, 2.5.3, 2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.7.0rc0, 2.7.0rc1, 2.7.0, 2.7.1, 2.7.2, 2.7.3, 2.7.4, 2.8.0rc0, 2.8.0rc1, 2.8.0, 2.8.1, 2.8.2, 2.8.3, 2.8.4, 2.9.0rc0, 2.9.0rc1, 2.9.0rc2, 2.9.0, 2.9.1, 2.9.2, 2.9.3, 2.10.0rc0, 2.10.0rc1, 2.10.0rc2, 2.10.0rc3, 2.10.0, 2.10.1, 2.12.0)

### Standalone code to reproduce the issue

```shell
WARNING: Ignoring invalid distribution -pencv-python-headless (c:\users\rites\appdata\roaming\python\python39\site-packages)
WARNING: Ignoring invalid distribution -pencv-python-headless (c:\users\rites\appdata\roaming\python\python39\site-packages)
ERROR: Could not find a version that satisfies the requirement tensorflow-gpu==2.11 (from versions: 2.5.0, 2.5.1, 2.5.2, 2.5.3, 2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.7.0rc0, 2.7.0rc1, 2.7.0, 2.7.1, 2.7.2, 2.7.3, 2.7.4, 2.8.0rc0, 2.8.0rc1, 2.8.0, 2.8.1, 2.8.2, 2.8.3, 2.8.4, 2.9.0rc0, 2.9.0rc1, 2.9.0rc2, 2.9.0, 2.9.1, 2.9.2, 2.9.3, 2.10.0rc0, 2.10.0rc1, 2.10.0rc2, 2.10.0rc3, 2.10.0, 2.10.1, 2.12.0)
```


### Relevant log output

_No response_",True
tf.math.is_non_decreasing outputs incorrect result when input is an uint tensor awaiting review type:bug comp:apis TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.14.0

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

When giving tf.math.is_non_decreasing a decreasing tensor with dtype=uint32. This API incorrectly output True instead of False.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf
x = tf.constant([10,9], dtype='uint32')
print(x)
out = tf.math.is_non_decreasing(x)
print(out)
```


### Relevant log output

_No response_",True
"Calculating Gradients for a graph containing tf.image.extract_patches, using TF 2.9.0 type:bug comp:ops TF 2.9","### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

v2.9.0-rc2-42-g8a20d54a3c1 2.9.0

### Custom code

Yes

### OS platform and distribution

Windows 10-64bit

### Mobile device

_No response_

### Python version

Python 3.7

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

cuda11.2

### GPU model and memory

_No response_

### Current behavior?

My codes extract patches from a batch of  images as an input and produces a batch of  image patches as an output.

The input (batch_size, rows, cols, 1) is split into patches (patches_num, batch_size, patch_row, patch_col) before being fed to next layer of the network.  This function was called by a custom layer (keras.layers.Layer), and it works well during extracts the patches, but when calculating gradients for a graph with `grads = tape.gradient(loss, model.variables)`, an error came:
```
UnimplementedError: Graph execution error:

Detected at node 'gradients/ExtractImagePatches_1_grad/SparseTensorDenseMatMul/SparseTensorDenseMatMul'

Node: 'gradients/ExtractImagePatches_1_grad/SparseTensorDenseMatMul/SparseTensorDenseMatMul'
2 root error(s) found.
  (0) UNIMPLEMENTED:  A deterministic GPU implementation of SparseTensorDenseMatmulOp is not currently available.
	 [[{{node gradients/ExtractImagePatches_1_grad/SparseTensorDenseMatMul/SparseTensorDenseMatMul}}]]
	 [[gradients/fan_weight_8/StatefulPartitionedCall_grad/PartitionedCall/gradients/ExtractImagePatches_grad/ExtractImagePatches/_63]]
  (1) UNIMPLEMENTED:  A deterministic GPU implementation of SparseTensorDenseMatmulOp is not currently available.
	 [[{{node gradients/ExtractImagePatches_1_grad/SparseTensorDenseMatMul/SparseTensorDenseMatMul}}]]
0 successful operations.
0 derived errors ignored. [Op:__inference___backward_call_20302_28692]
```
I found an issue about tf.extract_image_patches() opend on Feb 10, 2017 (https://github.com/tensorflow/tensorflow/issues/7414)
and added `tf.cast(input_batch, dtype=tf.float32, name=""castData"") ` in the function, but it wont work.

Here is my code of the function.

```
def spilt_patches(input_batch, 
                   blocks_num_cur, 
                   block_shape_cur):
   '''
    input_batch = np.tile(np.random.randint(0,2,(4,3,3)), (1,2,2))
    blocks_num_cur = 4,
    block_shape_cur = [6,6]
   '''
    shape = input_batch.shape
    input_batch = tf.reshape(input_batch,(shape[0],shape[1], shape[2], 1)) # [batch_size, rows, cols, 1]
    input_batch = tf.cast(input_batch, dtype=tf.float32, name=""castData"")  
    blocks_cur = tf.image.extract_patches(images = input_batch,
                                       sizes=[1, block_shape_cur[0], block_shape_cur[1], 1],
                                       strides=[1, block_shape_cur[0], block_shape_cur[1], 1],
                                       rates=[1, 1, 1, 1],
                                       padding='VALID') 
    blocks_cur = tf.cast(tf.reshape(blocks_cur,[shape[0], blocks_num_cur, block_shape_cur[0], block_shape_cur[1]]), tf.float32) # [batch_size, patch_num, patch_row, patch_col]
    blocks_cur = tf.transpose(blocks_cur,[1, 0, 2, 3]) 
    
    return blocks_cur
```

### Standalone code to reproduce the issue

```shell
https://gist.github.com/RaymondMarzas/7bec1a8099aded089a29d775caef880e
```


### Relevant log output

```shell
Traceback (most recent call last):

  File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\spyder_kernels\py3compat.py"", line 356, in compat_exec
    exec(code, globals, locals)

  File ""d:\codes\pycoode\ocnn2nd\fanoutmodel_train_ocnn.py"", line 112, in <module>
    grads = tape.gradient(loss, model.variables)

  File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\tensorflow\python\eager\backprop.py"", line 1106, in gradient
    unconnected_gradients=unconnected_gradients)

  File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\tensorflow\python\eager\imperative_grad.py"", line 73, in imperative_grad
    compat.as_str(unconnected_gradients.value))

  File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\tensorflow\python\eager\function.py"", line 1206, in _backward_function_wrapper
    processed_args, remapped_captures)

  File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\tensorflow\python\eager\function.py"", line 1861, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager))

  File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\tensorflow\python\eager\function.py"", line 502, in call
    ctx=ctx)

  File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\tensorflow\python\eager\execute.py"", line 55, in quick_execute
    inputs, attrs, num_outputs)

UnimplementedError: Graph execution error:

Detected at node 'gradients/ExtractImagePatches_1_grad/SparseTensorDenseMatMul/SparseTensorDenseMatMul' defined at (most recent call last):
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\runpy.py"", line 193, in _run_module_as_main
      ""__main__"", mod_spec)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\runpy.py"", line 85, in _run_code
      exec(code, run_globals)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\spyder_kernels\console\__main__.py"", line 24, in <module>
      start.main()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\spyder_kernels\console\start.py"", line 340, in main
      kernel.start()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\kernelapp.py"", line 712, in start
      self.io_loop.start()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\tornado\platform\asyncio.py"", line 215, in start
      self.asyncio_loop.run_forever()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\asyncio\base_events.py"", line 541, in run_forever
      self._run_once()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\asyncio\base_events.py"", line 1786, in _run_once
      handle._run()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\asyncio\events.py"", line 88, in _run
      self._context.run(self._callback, *self._args)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\kernelbase.py"", line 510, in dispatch_queue
      await self.process_one()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\kernelbase.py"", line 499, in process_one
      await dispatch(*args)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\kernelbase.py"", line 406, in dispatch_shell
      await result
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\kernelbase.py"", line 730, in execute_request
      reply_content = await reply_content
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\ipkernel.py"", line 387, in do_execute
      cell_id=cell_id,
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\zmqshell.py"", line 528, in run_cell
      return super().run_cell(*args, **kwargs)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\IPython\core\interactiveshell.py"", line 2975, in run_cell
      raw_cell, store_history, silent, shell_futures, cell_id
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\IPython\core\interactiveshell.py"", line 3029, in _run_cell
      return runner(coro)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\IPython\core\async_helpers.py"", line 78, in _pseudo_sync_runner
      coro.send(None)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\IPython\core\interactiveshell.py"", line 3257, in run_cell_async
      interactivity=interactivity, compiler=compiler, result=result)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\IPython\core\interactiveshell.py"", line 3472, in run_ast_nodes
      if (await self.run_code(code, result,  async_=asy)):
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\IPython\core\interactiveshell.py"", line 3552, in run_code
      exec(code_obj, self.user_global_ns, self.user_ns)
    File ""C:\Users\xxx\AppData\Local\Temp\ipykernel_29532\1338903705.py"", line 1, in <module>
      runfile('D:/CODES/pycoode/OCNN2nd/fanoutmodel_train_ocnn.py', wdir='D:/CODES/pycoode/OCNN2nd')
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\spyder_kernels\customize\spydercustomize.py"", line 526, in runfile
      post_mortem, current_namespace, stack_depth=1)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\spyder_kernels\customize\spydercustomize.py"", line 613, in _exec_file
      capture_last_expression=False)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\spyder_kernels\customize\spydercustomize.py"", line 469, in exec_code
      exec_fun(compile(ast_code, filename, 'exec'), ns_globals, ns_locals)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\spyder_kernels\py3compat.py"", line 356, in compat_exec
      exec(code, globals, locals)
    File ""d:\codes\pycoode\ocnn2nd\fanoutmodel_train_ocnn.py"", line 97, in <module>
      trn_pred = model(X_trn) # input[BATCH_SIZE,TARGET_ROWS*TARGET_COLS]], output[BATCH_SIZE,1]
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\keras\utils\traceback_utils.py"", line 64, in error_handler
      return fn(*args, **kwargs)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\keras\engine\training.py"", line 490, in __call__
      return super().__call__(*args, **kwargs)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\keras\utils\traceback_utils.py"", line 64, in error_handler
      return fn(*args, **kwargs)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\keras\engine\base_layer.py"", line 1014, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\keras\utils\traceback_utils.py"", line 92, in error_handler
      return fn(*args, **kwargs)
Node: 'gradients/ExtractImagePatches_1_grad/SparseTensorDenseMatMul/SparseTensorDenseMatMul'
Detected at node 'gradients/ExtractImagePatches_1_grad/SparseTensorDenseMatMul/SparseTensorDenseMatMul' defined at (most recent call last):
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\runpy.py"", line 193, in _run_module_as_main
      ""__main__"", mod_spec)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\runpy.py"", line 85, in _run_code
      exec(code, run_globals)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\spyder_kernels\console\__main__.py"", line 24, in <module>
      start.main()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\spyder_kernels\console\start.py"", line 340, in main
      kernel.start()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\kernelapp.py"", line 712, in start
      self.io_loop.start()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\tornado\platform\asyncio.py"", line 215, in start
      self.asyncio_loop.run_forever()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\asyncio\base_events.py"", line 541, in run_forever
      self._run_once()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\asyncio\base_events.py"", line 1786, in _run_once
      handle._run()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\asyncio\events.py"", line 88, in _run
      self._context.run(self._callback, *self._args)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\kernelbase.py"", line 510, in dispatch_queue
      await self.process_one()
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\kernelbase.py"", line 499, in process_one
      await dispatch(*args)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\kernelbase.py"", line 406, in dispatch_shell
      await result
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\kernelbase.py"", line 730, in execute_request
      reply_content = await reply_content
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\ipkernel.py"", line 387, in do_execute
      cell_id=cell_id,
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\ipykernel\zmqshell.py"", line 528, in run_cell
      return super().run_cell(*args, **kwargs)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\IPython\core\interactiveshell.py"", line 2975, in run_cell
      raw_cell, store_history, silent, shell_futures, cell_id
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\IPython\core\interactiveshell.py"", line 3029, in _run_cell
      return runner(coro)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\IPython\core\async_helpers.py"", line 78, in _pseudo_sync_runner
      coro.send(None)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\IPython\core\interactiveshell.py"", line 3257, in run_cell_async
      interactivity=interactivity, compiler=compiler, result=result)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\IPython\core\interactiveshell.py"", line 3472, in run_ast_nodes
      if (await self.run_code(code, result,  async_=asy)):
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\IPython\core\interactiveshell.py"", line 3552, in run_code
      exec(code_obj, self.user_global_ns, self.user_ns)
    File ""C:\Users\xxx\AppData\Local\Temp\ipykernel_29532\1338903705.py"", line 1, in <module>
      runfile('D:/CODES/pycoode/OCNN2nd/fanoutmodel_train_ocnn.py', wdir='D:/CODES/pycoode/OCNN2nd')
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\spyder_kernels\customize\spydercustomize.py"", line 526, in runfile
      post_mortem, current_namespace, stack_depth=1)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\spyder_kernels\customize\spydercustomize.py"", line 613, in _exec_file
      capture_last_expression=False)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\spyder_kernels\customize\spydercustomize.py"", line 469, in exec_code
      exec_fun(compile(ast_code, filename, 'exec'), ns_globals, ns_locals)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\spyder_kernels\py3compat.py"", line 356, in compat_exec
      exec(code, globals, locals)
    File ""d:\codes\pycoode\ocnn2nd\fanoutmodel_train_ocnn.py"", line 97, in <module>
      trn_pred = model(X_trn) # input[BATCH_SIZE,TARGET_ROWS*TARGET_COLS]], output[BATCH_SIZE,1]
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\keras\utils\traceback_utils.py"", line 64, in error_handler
      return fn(*args, **kwargs)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\keras\engine\training.py"", line 490, in __call__
      return super().__call__(*args, **kwargs)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\keras\utils\traceback_utils.py"", line 64, in error_handler
      return fn(*args, **kwargs)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\keras\engine\base_layer.py"", line 1014, in __call__
      outputs = call_fn(inputs, *args, **kwargs)
    File ""C:\ProgramData\Anaconda3\envs\TF2.9.0\lib\site-packages\keras\utils\traceback_utils.py"", line 92, in error_handler
      return fn(*args, **kwargs)
Node: 'gradients/ExtractImagePatches_1_grad/SparseTensorDenseMatMul/SparseTensorDenseMatMul'
2 root error(s) found.
  (0) UNIMPLEMENTED:  A deterministic GPU implementation of SparseTensorDenseMatmulOp is not currently available.
	 [[{{node gradients/ExtractImagePatches_1_grad/SparseTensorDenseMatMul/SparseTensorDenseMatMul}}]]
	 [[gradients/fan_weight_8/StatefulPartitionedCall_grad/PartitionedCall/gradients/ExtractImagePatches_grad/ExtractImagePatches/_63]]
  (1) UNIMPLEMENTED:  A deterministic GPU implementation of SparseTensorDenseMatmulOp is not currently available.
	 [[{{node gradients/ExtractImagePatches_1_grad/SparseTensorDenseMatMul/SparseTensorDenseMatMul}}]]
0 successful operations.
0 derived errors ignored. [Op:__inference___backward_call_20302_28692]
```
",True
"【in C++】No OpKernel was registered to support Op 'PyFunc' used by {{node PyFunc}}with these attrs: [Tin=[], Tout=[DT_FLOAT], token=""pyfunc_0""] Registered devices: [CPU, XLA_CPU] Registered kernels:   <no registered kernels>           [[PyFunc]] stat:awaiting response type:bug stale TF 1.15","### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

tf 1.15.0

### Custom code

Yes

### OS platform and distribution

Linux

### Mobile device

15001379103

### Python version

_No response_

### Bazel version

4.2.1

### GCC/compiler version

4.8.5

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

method: C API
version: 1.15.0
package link:https://storage.googleapis.com/tensorflow/libtensorflow/libtensorflow-cpu-linux-x86_64-1.15.0.tar.gz





### Standalone code to reproduce the issue

```shell
#include ""app/federal/model.hpp""
#include <iostream>
#include <fstream>

namespace xcxxx {
    /**
     * Print Tensorflow version
    */
  void Model::PrintTfVersion() {
    std::cout << ""Hello from TensorFlow C library version \n"" <<  TF_Version() << std::endl;
  }

  void NoOpDeallocator(void* data, size_t a, void* b) {
  }

  void DeallocateBuffer(void* data, size_t) {
    std::free(data);
  }

  TF_Buffer* ReadBufferFromFile(std::string file) {
    std::ifstream f(file, std::ios::binary);
    if (f.fail() || !f.is_open()) {
      return nullptr;
    }

    f.seekg(0, std::ios::end);
    const auto fsize = f.tellg();
    f.seekg(0, std::ios::beg);

    if (fsize < 1) {
      f.close();
      return nullptr;
    }

    char* data = static_cast<char*>(std::malloc(fsize));
    f.read(data, fsize);
    f.close();

    TF_Buffer* buf = TF_NewBuffer();
    buf->data = data;
    buf->length = fsize;
    buf->data_deallocator = DeallocateBuffer;
    return buf;
  }
    /**
     * Init Model Instance
    */
   bool Model::Init(std::string model_file) {
    try {

        // create new graph
        TF_Buffer* buffer = ReadBufferFromFile(model_file);
        if (buffer == nullptr) {
          std::cout << ""code:10000"" <<  "", msg: "" <<  ""Error creating the session from  the given model path!""<< std::endl;
          return false;
        }
        TF_ImportGraphDefOptions* opts = TF_NewImportGraphDefOptions();
        TF_Status* status = TF_NewStatus();

        m_graph_ = TF_NewGraph();
        TF_GraphImportGraphDef(m_graph_, buffer, opts, status);
        TF_DeleteImportGraphDefOptions(opts);
        TF_DeleteBuffer(buffer);
        if (TF_GetCode(status) != TF_OK) {
            std::cout << ""code:10001"" <<  "", msg: "" << TF_Message(status) << std::endl;
            TF_DeleteGraph(m_graph_);
            m_graph_ = nullptr;
            return false;
        }
        TF_DeleteStatus(status);

        // create new session
        status = TF_NewStatus();
        TF_SessionOptions* options = TF_NewSessionOptions();
        m_session_ = TF_NewSession(m_graph_, options, status);
        TF_DeleteSessionOptions(options);
        if (TF_GetCode(status) != TF_OK) {
            std::cout << ""code:10002"" <<  "", msg: "" << TF_Message(status) << std::endl;
            return false;
        }
        TF_DeleteStatus(status);
        std::cout << ""code:0"" <<  "", msg: load model suc!^_^"" << std::endl;
    
    } catch (std::exception& e) {
        std::cout << ""code:10003"" <<  "", msg: model init.Tf load fail!"" << std::endl;
        return false;
    }

    return true;
   }


  /**
     * Init Model Instance
    */
   bool Model::InitV2(std::string model_file) {
    try {
      TF_Buffer* buffer = ReadBufferFromFile(model_file);
      if (buffer == nullptr) {
        std::cout << ""code:10000"" <<  "", msg: model init.Tf load fail!"" << std::endl;
      }
      TF_Status* status = TF_NewStatus();
      TF_ImportGraphDefOptions* opts = TF_NewImportGraphDefOptions();

      m_graph_ = TF_NewGraph();
      TF_GraphImportGraphDef(m_graph_, buffer, opts, status);
      TF_DeleteImportGraphDefOptions(opts);
      TF_DeleteBuffer(buffer);
      if (TF_GetCode(status) != TF_OK) {
        TF_DeleteGraph(m_graph_);
        m_graph_ = nullptr;
      }
      TF_DeleteStatus(status);

      // create session from graph
      status = TF_NewStatus();
      TF_SessionOptions* options = TF_NewSessionOptions();
      m_session_ = TF_NewSession(m_graph_, options, status);
      TF_DeleteSessionOptions(options);
    } catch (std::exception& e) {
        std::cout << ""code:10003"" <<  "", msg: model init.Tf load fail!"" << std::endl;
        return false;
    }

    return true;
   }

   /**
    *  infer
   */
  std::vector<float> Model::Infer(std::vector<float> input_data) {
    std::vector<float> ret;

    //****** 1、Define graph inputs/outputs
    // std::string train_input_name = ""top_model/inputs:0"";
    std::string train_input_name = ""top_model/inputs"";
    // std::string train_output_name = ""top_model/outputs:0"";
    std::string train_output_name = ""top_model/outputs"";

    // Define graph inputs
    uint16_t gr_input_nums = 1;
    TF_Output* inputs = (TF_Output*)malloc(sizeof(TF_Output) * gr_input_nums);
    TF_Output input0 = {TF_GraphOperationByName(m_graph_, train_input_name.c_str()), 0};


    size_t pos = 0;
    uint16_t i = 0;
    TF_Operation* oper;
    
    while ((oper = TF_GraphNextOperation(m_graph_, &pos)) != nullptr) {
      std::cout << ""index:"" << i << "", graphname:"" << TF_OperationName(oper) << std::endl;
      i++;
    }

    if (nullptr == input0.oper) {
      std::cout << ""code:20000"" <<  "", msg: Define graph inputs failure"" << std::endl;
      return ret;
    }
    inputs[0] = input0;

    // Define graph outpus
    uint16_t gr_output_nums = 1;
    TF_Output* outputs = (TF_Output*)malloc(sizeof(TF_Output) * gr_output_nums);
    TF_Output output0 = {TF_GraphOperationByName(m_graph_, train_output_name.c_str()), 0};
    if (nullptr == output0.oper) {
      std::cout << ""code:20001"" <<  "", msg: Define graph outputs failure"" << std::endl;
      return ret;
    }
    outputs[0] = output0;


    //****** 2、Create input tensor(s) and populate with feature
    TF_Tensor** input_values = (TF_Tensor**)malloc(sizeof(TF_Tensor*) * gr_input_nums);
    int16_t num_dims = 1;
    int64_t dims[] = {1};
    float_t* data = &input_data[0];
    TF_Tensor* float_tensor = TF_NewTensor(TF_FLOAT, dims, num_dims, data, sizeof(TF_FLOAT), &NoOpDeallocator, 0);
    if (nullptr == float_tensor) {
      std::cout << ""code:20002"" <<  "", msg: allocate failure"" << std::endl;
      return ret;
    }
    input_values[0] = float_tensor;

    TF_Tensor** output_values = (TF_Tensor**)malloc(sizeof(TF_Tensor*) * gr_output_nums);

    //****** 3、Run the session
    TF_Status* status = TF_NewStatus();
    TF_SessionRun(
      m_session_, 
      nullptr, 
      // Input tensors
      inputs, input_values, gr_input_nums,
      // Output tensors
      outputs, output_values, gr_output_nums,
      // Target operations
      nullptr, 0,
      // RunMedata
      nullptr,
      // Output status
      status
    );

    if (TF_OK != TF_GetCode(status)) {
      std::cout << ""code:20003"" <<  "", msg: infer failure!\nstatus:"" << TF_Message(status) << std::endl;
      return ret;
    }
    std::cout << ""code:0"" <<  "", msg: infer suc!^_^"" << std::endl;

    //****** 4、Output the result
    void* buff = TF_TensorData(output_values[0]);
    float* offsets = (float*)buff;
    std::cout << ""infer result:"" << offsets[0] << std::endl;


    TF_DeleteStatus(status);
    return ret;
  }

}
```


### Relevant log output

```shell
No OpKernel was registered to support Op 'PyFunc' used by {{node PyFunc}}with these attrs: [Tin=[], Tout=[DT_FLOAT], token=""pyfunc_0""]
Registered devices: [CPU, XLA_CPU]
Registered kernels:
  <no registered kernels>

         [[PyFunc]]
```
",True
model_main_tf2.py issues with training object detection model stat:awaiting response type:bug stale comp:model TF 2.8,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.8

### Custom code

No

### OS platform and distribution

Google Colab

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

The tf_slim module class tfexample_decode.py at line 453 calls control_flow_ops.case 
There is no ""case"" attribute to control_flow_ops

### Standalone code to reproduce the issue

```shell
Google Colab, SSD Moblenet v2 graph, tfrecords
```


### Relevant log output

```shell
I1007 00:12:20.542787 134709293735936 dataset_builder.py:162] Reading unweighted datasets: ['.../train.record']
INFO:tensorflow:Reading record datasets for input file: ['.../train/train.record']
I1007 00:12:20.543272 134709293735936 dataset_builder.py:79] Reading record datasets for input file: ['.../train.record']
INFO:tensorflow:Number of filenames to read: 1
I1007 00:12:20.543381 134709293735936 dataset_builder.py:80] Number of filenames to read: 1
WARNING:tensorflow:num_readers has been reduced to 1 to match input file shards.
W1007 00:12:20.543440 134709293735936 dataset_builder.py:86] num_readers has been reduced to 1 to match input file shards.
WARNING:tensorflow:From /content/models/research/./object_detection/builders/dataset_builder.py:100: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.deterministic`.
W1007 00:12:20.550345 134709293735936 deprecation.py:50] From /content/models/research/./object_detection/builders/dataset_builder.py:100: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.deterministic`.
WARNING:tensorflow:From /content/models/research/./object_detection/builders/dataset_builder.py:235: DatasetV1.map_with_legacy_function (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.map()
W1007 00:12:20.572327 134709293735936 deprecation.py:50] From /content/models/research/./object_detection/builders/dataset_builder.py:235: DatasetV1.map_with_legacy_function (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.map()
Traceback (most recent call last):
  File ""/content/models/research/object_detection/model_main_tf2.py"", line 116, in <module>
    tf.compat.v1.app.run()
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/platform/app.py"", line 36, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File ""/usr/local/lib/python3.10/dist-packages/absl/app.py"", line 308, in run
    _run_main(main, args)
  File ""/usr/local/lib/python3.10/dist-packages/absl/app.py"", line 254, in _run_main
    sys.exit(main(argv))
  File ""/content/models/research/object_detection/model_main_tf2.py"", line 107, in main
    model_lib_v2.train_loop(
  File ""/content/models/research/./object_detection/model_lib_v2.py"", line 563, in train_loop
    train_input = strategy.experimental_distribute_datasets_from_function(
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/util/deprecation.py"", line 383, in new_func
    return func(*args, **kwargs)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/distribute/distribute_lib.py"", line 1563, in experimental_distribute_datasets_from_function
    return self.distribute_datasets_from_function(dataset_fn, options)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/distribute/distribute_lib.py"", line 1554, in distribute_datasets_from_function
    return self._extended._distribute_datasets_from_function(  # pylint: disable=protected-access
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/distribute/mirrored_strategy.py"", line 613, in _distribute_datasets_from_function
    return input_util.get_distributed_datasets_from_function(
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/distribute/input_util.py"", line 144, in get_distributed_datasets_from_function
    return input_lib.DistributedDatasetsFromFunction(
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/distribute/input_lib.py"", line 1143, in __init__
    self.build()
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/distribute/input_lib.py"", line 1165, in build
    _create_datasets_from_function_with_input_context(
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/distribute/input_lib.py"", line 1680, in _create_datasets_from_function_with_input_context
    dataset = dataset_fn(ctx)
  File ""/content/models/research/./object_detection/model_lib_v2.py"", line 554, in train_dataset_fn
    train_input = inputs.train_input(
  File ""/content/models/research/./object_detection/inputs.py"", line 908, in train_input
    dataset = INPUT_BUILDER_UTIL_MAP['dataset_build'](
  File ""/content/models/research/./object_detection/builders/dataset_builder.py"", line 250, in build
    dataset = dataset_map_fn(dataset, decoder.decode, batch_size,
  File ""/content/models/research/./object_detection/builders/dataset_builder.py"", line 235, in dataset_map_fn
    dataset = dataset.map_with_legacy_function(
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/util/deprecation.py"", line 383, in new_func
    return func(*args, **kwargs)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/data/ops/dataset_ops.py"", line 4128, in map_with_legacy_function
    return map_op._map_v1_with_legacy_function(
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/data/ops/map_op.py"", line 85, in _map_v1_with_legacy_function
    _ParallelMapDataset(
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/data/ops/map_op.py"", line 148, in __init__
    self._map_func = structured_function.StructuredFunctionWrapper(
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/data/ops/structured_function.py"", line 272, in __init__
    self._function.add_to_graph(ops.get_default_graph())
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/function.py"", line 579, in add_to_graph
    self._create_definition_if_needed()
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/function.py"", line 412, in _create_definition_if_needed
    self._create_definition_if_needed_impl()
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/function.py"", line 430, in _create_definition_if_needed_impl
    temp_graph = func_graph_from_py_func(
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/function.py"", line 1007, in func_graph_from_py_func
    outputs = func(*func_graph.inputs)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/data/ops/structured_function.py"", line 178, in wrapped_fn
    ret = wrapper_helper(*args)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/data/ops/structured_function.py"", line 161, in wrapper_helper
    ret = autograph.tf_convert(self._func, ag_ctx)(*nested_args)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/autograph/impl/api.py"", line 693, in wrapper
    raise e.ag_error_metadata.to_exception(e)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/autograph/impl/api.py"", line 690, in wrapper
    return converted_call(f, args, kwargs, options=options)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/autograph/impl/api.py"", line 439, in converted_call
    result = converted_f(*effective_args, **kwargs)
  File ""/tmp/__autograph_generated_fileqkyio7wq.py"", line 74, in tf__decode
    tensors = ag__.converted_call(ag__.ld(decoder).decode, (ag__.ld(serialized_example),), dict(items=ag__.ld(keys)), fscope)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/autograph/impl/api.py"", line 439, in converted_call
    result = converted_f(*effective_args, **kwargs)
  File ""/tmp/__autograph_generated_file1opxbxnu.py"", line 81, in tf__decode
    ag__.for_stmt(ag__.ld(items), None, loop_body_1, get_state_3, set_state_3, (), {'iterate_names': 'item'})
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/autograph/operators/control_flow.py"", line 449, in for_stmt
    for_fn(iter_, extra_test, body, get_state, set_state, symbol_names, opts)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/autograph/operators/control_flow.py"", line 500, in _py_for_stmt
    body(target)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/autograph/operators/control_flow.py"", line 466, in protected_body
    original_body(protected_iter)
  File ""/tmp/__autograph_generated_file1opxbxnu.py"", line 77, in loop_body_1
    ag__.converted_call(ag__.ld(outputs).append, (ag__.converted_call(ag__.ld(handler).tensors_to_item, (ag__.ld(keys_to_tensors),), None, fscope),), None, fscope)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/autograph/impl/api.py"", line 441, in converted_call
    result = converted_f(*effective_args)
  File ""/tmp/__autograph_generated_fileok5ldq7m.py"", line 39, in tf__tensors_to_item
    ag__.if_stmt(ag__.ld(self)._repeated, if_body, else_body, get_state, set_state, ('do_return', 'retval_'), 2)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/autograph/operators/control_flow.py"", line 1217, in if_stmt
    _py_if_stmt(cond, body, orelse)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/autograph/operators/control_flow.py"", line 1270, in _py_if_stmt
    return body() if cond else orelse()
  File ""/tmp/__autograph_generated_fileok5ldq7m.py"", line 35, in else_body
    retval_ = ag__.converted_call(ag__.ld(self)._decode, (ag__.ld(image_buffer), ag__.ld(image_format)), None, fscope)
  File ""/usr/local/lib/python3.10/dist-packages/tensorflow/python/autograph/impl/api.py"", line 441, in converted_call
    result = converted_f(*effective_args)
  File ""/tmp/__autograph_generated_fileubbeey9m.py"", line 80, in tf___decode
    image = ag__.converted_call(ag__.ld(control_flow_ops).case, (ag__.ld(pred_fn_pairs),), dict(default=ag__.ld(check_jpeg), exclusive=True), fscope)
AttributeError: in user code:

    File ""/content/models/research/./object_detection/data_decoders/tf_example_decoder.py"", line 556, in decode  *
        tensors = decoder.decode(serialized_example, items=keys)
    File ""/usr/local/lib/python3.10/dist-packages/tf_slim/data/tfexample_decoder.py"", line 723, in decode  *
        outputs.append(handler.tensors_to_item(keys_to_tensors))
    File ""/usr/local/lib/python3.10/dist-packages/tf_slim/data/tfexample_decoder.py"", line 406, in tensors_to_item  *
        return self._decode(image_buffer, image_format)
    File ""/usr/local/lib/python3.10/dist-packages/tf_slim/data/tfexample_decoder.py"", line 454, in _decode  *
        image = control_flow_ops.case(

    AttributeError: module 'tensorflow.python.ops.control_flow_ops' has no attribute 'case'
```
",True
Tensorflow 2.14 macOS wheel won't install for Python 3.11 type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.14

### Custom code

No

### OS platform and distribution

arm64 macOS

### Mobile device

n/a

### Python version

3.11

### Bazel version

n/a

### GCC/compiler version

n/a

### CUDA/cuDNN version

n/a

### GPU model and memory

n/a

### Current behavior?

When installing tensorflow 2.14 for Python 3.11 I see:

```
ERROR: Could not find a version that satisfies the requirement wrapt<1.15,>=1.11.0 (from tensorflow) (from versions: 1.15.0rc1, 1.15.0)
```

Looking at the metadata of the [2.14 whl for py3.11](https://files.pythonhosted.org/packages/d3/4b/ae9037ea22ba94eb2cf267e991384c3444f3e6142fa49923352b4ab73e14/tensorflow_macos-2.14.0-cp311-cp311-macosx_12_0_arm64.whl) I can see: 

```
Requires-Dist: wrapt (<1.15,>=1.11.0)
```

but wrapt has no packages for Python 3.11 for that version range.

Looking at the metadata for the [2.13.1 whl for py3.11](https://files.pythonhosted.org/packages/c0/d1/d309dea6e67e1b8037f607872486eb67a1ff64fb91a96149086dbdc46ca4/tensorflow_macos-2.13.1-cp311-cp311-macosx_12_0_arm64.whl) I can see:

```
Requires-Dist: wrapt (>=1.11.0)
```

which can be satisfied with wrapt 1.15.0

### Standalone code to reproduce the issue

```shell
n/a
```


### Relevant log output

_No response_",True
Using Lambda layers to take different slices of a prevous layer's output causes earlier Lambda layers to be overwritten stat:awaiting tensorflower type:bug comp:apis TF 2.10,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.10.0

### Custom code

No

### OS platform and distribution

Linux Ubuntu 22.04.3 LTS

### Mobile device

_No response_

### Python version

3.10.12 (main, Jun 11 2023, 05:26:28) [GCC 11.4.0]

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I used two Lambda layers to extract slices from the same input vector. The output of the first Lambda is somehow overwritten by the output of the second Lambda.

Note: I have confirmed this happens whether the Lambda layers take the model's input directly or the output of another layer. I have also confirmed that the problem is present whether or not the Lambda layers are the direct outputs of the model. But for the sample code below I've removed the extra layers.

### Standalone code to reproduce the issue

```shell
import sys

import tensorflow as tf

print(f""{tf.version.VERSION=} {tf.version.GIT_VERSION=} {tf.version.COMPILER_VERSION=}"")
print(f""{sys.version=}"")

dividers = [0, 2, 5]

assert all(divider >= 0 for divider in dividers)
sizes = [end - start for start, end in zip(dividers[:-1], dividers[1:])]
assert all(size > 0 for size in sizes)
channels = dividers[-1]

i = tf.keras.layers.Input((channels,), name='i')
o = [
    tf.keras.layers.Lambda(lambda x: x[..., start:end],
                           name=f'slice_{start}_{end}')(i)
    for start, end in zip(dividers[:-1], dividers[1:])
]
m = tf.keras.Model(i, o, name='m')
m.build((channels,))
m.summary()
print(f""{m.input_shape=}"")
print(f""{m.output_shape=}"")
print(f""{m.compute_output_shape(m.input_shape)=}"")
x = tf.zeros((1, channels))
print(f""{[y.shape for y in m(x)]=}"")
print(f""{[y.shape for y in m.predict(x)]=}"")
assert m.output_shape == m.compute_output_shape(m.input_shape)
```


### Relevant log output

```shell
tf.version.VERSION='2.10.0' tf.version.GIT_VERSION='v2.10.0-rc3-6-g359c3cdfc5f' tf.version.COMPILER_VERSION='9.3.1 20200408'
sys.version='3.10.12 (main, Jun 11 2023, 05:26:28) [GCC 11.4.0]'
Model: ""m""
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 i (InputLayer)                 [(None, 5)]          0           []                               
                                                                                                  
 slice_0_2 (Lambda)             (None, 2)            0           ['i[0][0]']                      
                                                                                                  
 slice_2_5 (Lambda)             (None, 3)            0           ['i[0][0]']                      
                                                                                                  
==================================================================================================
Total params: 0
Trainable params: 0
Non-trainable params: 0
__________________________________________________________________________________________________
m.input_shape=(None, 5)
m.output_shape=[(None, 2), (None, 3)]
m.compute_output_shape(m.input_shape)=[TensorShape([None, 3]), TensorShape([None, 3])]
[y.shape for y in m(x)]=[TensorShape([1, 3]), TensorShape([1, 3])]
1/1 [==============================] - 0s 286ms/step
[y.shape for y in m.predict(x)]=[(1, 3), (1, 3)]
Traceback (most recent call last):
  File ""/home/hosford42/PycharmProjects/LSLAM/tf_bug.py"", line 30, in <module>
    assert m.output_shape == m.compute_output_shape(m.input_shape)
AssertionError
```
",True
ValueError in tensorflow-probability type:bug TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tensorflow 2.15.0

### Custom code

Yes

### OS platform and distribution

Windows Subsystem for Linux

### Mobile device

_No response_

### Python version

3.9

### Bazel version

v1.18.0

### GCC/compiler version

11.3.0

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I am trying to run a program which uses tensorflow agents & tensorflow probability at the back end. When I try to run the train.py using .yaml input file, I am getting the following error:

### Standalone code to reproduce the issue

```shell
lib/python3.10/site-packages/tensorflow_probability/python/internal/prefer_static.py"", line 84, in _copy_docstring raise ValueError(

ValueError: Arg specs do not match: original=FullArgSpec(args=['input', 'dtype', 'name', 'layout'], varargs=None, varkw=None, defaults=(None, None, None), kwonlyargs=[], kwonlydefaults=None, annotations={}), new=FullArgSpec(args=['input', 'dtype', 'name'], varargs=None, varkw=None, defaults=(None, None), kwonlyargs=[], kwonlydefaults=None, annotations={}), fn=<function ones_like_v2 at 0x7f8287141480> Please help me understand the issue & any suggestions to resolve the error is greatly appreciated.
```


### Relevant log output

_No response_",True
avx512fp16 causing invalid static_cast with cuda12.2 python 3.12 stat:awaiting tensorflower type:bug type:build/install subtype: ubuntu/linux TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.15

### Custom code

No

### OS platform and distribution

Linux SuSE 15 SP4

### Mobile device

_No response_

### Python version

3.12.0

### Bazel version

3.6.0

### GCC/compiler version

gcc 12.3.0

### CUDA/cuDNN version

cuda 12.2.2 cudnn 8.9.5

### GPU model and memory

H100

### Current behavior?

I am aware this is an unsupported, non-working configuration - reporting early in case it's a real bug requiring fixing.
CPU is Sapphire Rapids; Compiling with --copt=-mavx512fp16
results in the following build error:

tensorflow/core/kernels/linalg/matrix_inverse_op.cc:113:31:   required from here
external/eigen_archive/Eigen/src/Core/MathFunctions.h:429:12: error: invalid ‘static_cast’ from type ‘const Eigen::internal::eigen_packet_wrapper<__vector(4) long long int, 1>’ to type ‘__vector(16) float’
  429 |     return static_cast<NewType>(x);
  
 Removing --copt=-mavx512fp16 allows the compile to finish. The following options resulted in a successfully build of a tensorflow whl file (although unusable until python 3.12 compatibility is available).
 --config=opt -c opt --copt=-mfpmath=sse --copt=-msse4.2 --copt=-mavx --copt=-mavx2
--copt=-mfma --copt=-mavx512f --copt=-mavx512vnni --copt=-mavx512f --copt=-mavx512bf16 --copt=-mavx512vl  


### Standalone code to reproduce the issue

```shell
TF_PYTHON_VERSION=3.11 CFLAGS=""-O3 -march=native -fPIC"" CXXFLAGS=$CFLAGS LIBRARY_PATH=$LD_RUN_PATH LD_LIBRARY_PATH=$LD_RUN_PATH \
LDFLAGS=""-fPIC  -Wl,--disable-new-dtags -Wl,--rpath -Wl,${LD_RUN_PATH}"" bazel build -j 24 --config=opt -c opt --copt=-mavx --copt=-mavx2 \
--copt=-mfma --copt=-mfpmath=sse --copt=-msse4.2 \
--copt=-mavx512f --copt=-mavx512vnni --copt=-mavx512f --copt=-mavx512fp16 --copt=-mavx512bf16 --copt=-mavx512vl \
--config=cuda --config=mkl --config=tensorrt  //tensorflow/tools/pip_package:build_pip_package --repo_env=TF_PYTHON_VERSION=3.11
```


### Relevant log output

```shell
external/eigen_archive/Eigen/src/Core/Matrix.h:227:24:   required from ‘Eigen::Matrix<Scalar_, Rows_, Cols_, Options_, MaxRows_, MaxCols_>& Eigen::Matrix<Scalar_, Rows_, Cols_, Options_, MaxRows_, MaxCols_>::operator=(const Eigen::DenseBase<OtherDerived>&) [with OtherDerived = Eigen::CwiseUnaryOp<Eigen::internal::core_cast_op<Eigen::half, float>, const Eigen::Map<const Eigen::Matrix<Eigen::half, -1, -1, 1, -1, -1>, 0, Eigen::Stride<0, 0> > >; Scalar_ = float; int Rows_ = -1; int Cols_ = -1; int Options_ = 1; int MaxRows_ = -1; int MaxCols_ = -1]’
external/eigen_archive/Eigen/src/LU/PartialPivLU.h:135:12:   required from ‘Eigen::PartialPivLU<MatrixType, PermutationIndex>& Eigen::PartialPivLU<MatrixType, PermutationIndex>::compute(const Eigen::EigenBase<OtherDerived>&) [with InputType = Eigen::CwiseUnaryOp<Eigen::internal::core_cast_op<Eigen::half, float>, const Eigen::Map<const Eigen::Matrix<Eigen::half, -1, -1, 1, -1, -1>, 0, Eigen::Stride<0, 0> > >; MatrixType_ = Eigen::Matrix<float, -1, -1, 1, -1, -1>; PermutationIndex_ = int]’
tensorflow/core/kernels/linalg/matrix_inverse_op.cc:113:31:   required from here
external/eigen_archive/Eigen/src/Core/MathFunctions.h:429:12: error: invalid ‘static_cast’ from type ‘const Eigen::internal::eigen_packet_wrapper<__vector(4) long long int, 1>’ to type ‘__vector(16) float’
  429 |     return static_cast<NewType>(x);
      |            ^~~~~~~~~~~~~~~~~~~~~~~
Target //tensorflow/tools/pip_package:build_pip_package failed to build
Use --verbose_failures to see the command lines of failed build steps.
```
",True
Illegal memory access when running tf.sparse_to_dense stat:awaiting response type:bug type:support stale TF 2.11,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.11

### Custom code

No

### OS platform and distribution

Linux

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

[This](https://github.com/tensorflow/tensorflow/issues/59126) issue seems to suggest that it was fixed in tf-nightly release. But I am somehow not able to find the commit where this was fixed. Can you please point me to the commit so that I can verify it has been fixed on my side

### Standalone code to reproduce the issue

```shell
-
```


### Relevant log output

_No response_",True
TF 2.14 minimum nvidia driver version type:docs-bug stat:awaiting response type:bug type:build/install stale TF2.14,"### Issue type

Documentation Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

tf 2.14

### Custom code

No

### OS platform and distribution

Tensorflow Docker image

### Mobile device

_No response_

### Python version

3.11

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

450.203.8

### GPU model and memory

_No response_

### Current behavior?

I have a question on if the minimum nvidia driver version has changed (I believe the current docs state `450.80.02` (https://www.tensorflow.org/install/pip)). The below script ran using the 2.13 docker image. Thank you.

When trying to run a test gpu benchmark, I get the following error:
```text
2023-10-02 16:01:32.433368: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:461] Possibly insufficient driver version: 450.203.8
```


### Standalone code to reproduce the issue

```shell
Below is the code being used:

import tensorflow as tf
from tensorflow import keras
import numpy as np
import matplotlib.pyplot as plt
import timeit

# Download data and scale
(X_train, y_train), (X_test, y_test) = keras.datasets.cifar10.load_data()

# scaling image values between 0-1
X_train_scaled = X_train/255
X_test_scaled = X_test/255

# one hot encoding labels
y_train_encoded = keras.utils.to_categorical(y_train, num_classes = 10, dtype = 'float32')
y_test_encoded = keras.utils.to_categorical(y_test, num_classes = 10, dtype = 'float32')

# Define the model
def get_model():
    model = keras.Sequential([
        keras.layers.Flatten(input_shape=(32,32,3)),
        keras.layers.Dense(3000, activation='relu'),
        keras.layers.Dense(1000, activation='relu'),
        keras.layers.Dense(10, activation='sigmoid')
    ])
    model.compile(optimizer='SGD',
              loss='categorical_crossentropy',
              metrics=['accuracy'])
    return model

# GPU Benchmark
def gpuBench():
    # GPU
    #strategy = tf.distribute.MirroredStrategy()
    #with strategy.scope():
    with tf.device('/GPU:0'):
        model_gpu = get_model()
        model_gpu.fit(X_train_scaled, y_train_encoded, epochs = 10)

gpuBench()
```


### Relevant log output

_No response_",True
Models that trained and saved on Tensorflow2.14 cant be loaded on Tensorflow2.12 stat:awaiting response type:bug stale comp:apis TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.14

### Custom code

Yes

### OS platform and distribution

Linux mint 21.2

### Mobile device

_No response_

### Python version

3.11

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

gtx 1060 6gb

### Current behavior?

I expected that when I load a keras model that I trained on my home computer on tensorflow 2.14 wil be loaded on kaggle notebook which has tensorflow 2.12

### Standalone code to reproduce the issue

```shell
import tensorflow as tf

#the test_model.keras was trained on tensorflow version 2.14
#the current tensorflow version in 2.12

model = tf.keras.models.load_model(""/home/sagi/Desktop/VsCode/Competiton/MODEL/test_model.keras"")
```


### Relevant log output

_No response_",True
TFlite memory allocation thrashing with FlexDelegates stat:awaiting response type:bug stale comp:lite TFLiteConverter TF 2.13,"### 1. System information

- OS Platform and Distribution macOS, iOS 16.6.1 iPhone 13 Pro:
- TensorFlow installation (pip package or built from source): 2.13.0
- TensorFlow library (version, if pip package or github SHA, if built from source): tflite built from 2.13.0 tag

### 2. Code

I have a model that converts correctly and flags the following flex delegates:

```python
  tf.AddV2(tensor<1x33xcomplex<f32>>, tensor<complex<f32>>) -> (tensor<1x33xcomplex<f32>>) : {device = """"}
  tf.AddV2(tensor<complex<f32>>, tensor<complex<f32>>) -> (tensor<complex<f32>>) : {device = """"}
  tf.Complex(tensor<1x33xf32>, tensor<1x33xf32>) -> (tensor<1x33xcomplex<f32>>) : {device = """"}
  tf.Complex(tensor<f32>, tensor<f32>) -> (tensor<complex<f32>>) : {device = """"}
  tf.ConcatV2(tensor<1x1x1xcomplex<f32>>, tensor<1x1x64xcomplex<f32>>, tensor<i32>) -> (tensor<1x1x33xcomplex<f32>>) : {device = """"}
  tf.GatherV2(tensor<1x1x33xcomplex<f32>>, tensor<i32>, tensor<i32>) -> (tensor<1x33xcomplex<f32>>) : {batch_dims = 0 : i64}
  tf.Pow(tensor<complex<f32>>, tensor<complex<f32>>) -> (tensor<complex<f32>>) : {device = """"}
  tf.RealDiv(tensor<1x33xcomplex<f32>>, tensor<1x33xcomplex<f32>>) -> (tensor<1x33xcomplex<f32>>) : {device = """"}
  tf.SelectV2(tensor<1x1x1xi1>, tensor<1x1x33xcomplex<f32>>, tensor<1x1x33xcomplex<f32>>) -> (tensor<1x1x33xcomplex<f32>>) : {device = """"}
  tf.StridedSlice(tensor<1x1x33xcomplex<f32>>, tensor<3xi32>, tensor<3xi32>, tensor<3xi32>) -> (tensor<1x1x1xcomplex<f32>>) : {begin_mask = 7 : i64, ellipsis_mask = 0 : i64, end_mask = 3 : i64, new_axis_mask = 0 : i64, shrink_axis_mask = 0 : i64}
  tf.StridedSlice(tensor<1x1x33xcomplex<f32>>, tensor<3xi32>, tensor<3xi32>, tensor<3xi32>) -> (tensor<1x1x64xcomplex<f32>>) : {begin_mask = 3 : i64, ellipsis_mask = 0 : i64, end_mask = 7 : i64, new_axis_mask = 0 : i64, shrink_axis_mask = 0 : i64}
  tf.Sub(tensor<complex<f32>>, tensor<complex<f32>>) -> (tensor<complex<f32>>) : {device = """"}
  tf.Transpose(tensor<1x1x33xcomplex<f32>>, tensor<3xi32>) -> (tensor<1x1x33xcomplex<f32>>) : {device = """"}
```

### 3. Failure after conversion
When running this model on iOS, and profiling the model, I can see the application spending a lot of time (30%) in `posix_memalign` that are emitted from the flex library which leads to poor performance of the model executing (highlighted in following image):

![image](https://github.com/tensorflow/tensorflow/assets/192171/f4950106-1b7f-47cc-8025-d3fc9818e643)

Is there a way to:
- figure out which flex delegate is causing this? (If I compile the flex library with symbols, I can't seem to turn on optimization which results in an unusable library for me)
- modify the memory allocation/de-allocation strategy to re-ruse existing memory? I suspect this issue is a side-effect of tflite <-> tensorflow interop but that is only a suspicion
- set something like max allowed persistent memory to prevent de-allocation? I also have a suspicion that it might not be tied to a single delegate but by the allocator itself",True
"Checkpoint callback error ""save best only""  in .keras format. stat:awaiting response type:bug stale comp:keras regression issue TF 2.13","### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.13

### Custom code

Yes

### OS platform and distribution

Ubuntu 22.02

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Saving best model only with callback with .keras format as the whole model which works well when saving every epoch.

Locally I fixed this adding elif option to save best only as in the version with this parameter is False.

```python
 elif filepath.endswith("".keras""):
    self.model.save(filepath, overwrite=True)
```

### Standalone code to reproduce the issue

```shell
https://colab.research.google.com/drive/1e_imdDFEm-5qARqSbXm8-5JxZP43V_wg?usp=sharing
```


### Relevant log output

```shell
Traceback (most recent call last):
  File ""/home/r.kaczmarek/repos/diarization-poc/tmp_train.py"", line 67, in <module>
    model.fit(
  File ""/home/r.kaczmarek/miniconda3/envs/tf-diarization/lib/python3.10/site-packages/keras/src/utils/traceback_utils.py"", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File ""/home/r.kaczmarek/miniconda3/envs/tf-diarization/lib/python3.10/site-packages/keras/src/saving/saving_api.py"", line 142, in save_model
    raise ValueError(
ValueError: The following argument(s) are not supported with the native Keras format: ['options']
```
",True
TFLite model produces wrong output for constant addition type:bug stale comp:lite TFLiteConverter,"### 1. System information

- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Linux Ubuntu 20.04
- TensorFlow installation (pip package or built from source): pip
- TensorFlow library (version, if pip package or github SHA, if built from source): 2.15.0-dev20230926

### 2. Code

The TensorFlow Lite model in the example below should output `x1+x2+x2=7+1+1=9`. However, it produces a wrong output `x1+x1+x2=7+7+1=15`. This indicates that it confuses the order of the two inputs.

```
import tensorflow as tf
import numpy as np

a = tf.constant(7.0, shape=[1])
b = tf.constant(1.0, shape=[1])
input_data = [a, b]


def _evaluateTFLiteModel(tflite_model, input_data):
    interpreter = tf.lite.Interpreter(model_content=tflite_model)
    interpreter.allocate_tensors()

    # Get input and output tensors.
    input_details = interpreter.get_input_details()
    output_details = interpreter.get_output_details()

    # Test model on random input data.
    for i in range(len(input_details)):
        # input_shape = input_details[i]['shape']
        # input_data_i = np.array(np.random.random_sample(input_shape), dtype=np.float32)
        interpreter.set_tensor(input_details[i]['index'], input_data[i])

    interpreter.invoke()

    # The function `get_tensor()` returns a copy of the tensor data.
    # Use `tensor()` in order to get a pointer to the tensor.
    output_data = [interpreter.get_tensor(output_details[i]['index'])
                   for i in range(len(output_details))]
    return output_data


class Model(tf.keras.Model):

    def __init__(self):
        super(Model, self).__init__()

    @tf.function(input_signature=[tf.TensorSpec(shape=x.shape, dtype=x.dtype) for x in input_data])
    def call(self, x1, x2):
        return ((x1 + x2) + x2)

m = Model()

converter = tf.lite.TFLiteConverter.from_keras_model(m)
tflite_model = converter.convert()

print(_evaluateTFLiteModel(tflite_model, input_data))
```
Output:
```
[array([15.], dtype=float32)]
```
Keras model:
```
import tensorflow as tf
print(tf.__version__)

import tensorflow as tf
import numpy as np


class Model(tf.keras.Model):

    def __init__(self):
        super(Model, self).__init__()

    def call(self, x1, x2):
        return ((x1 + x2) + x2)



m = Model()

a = tf.constant(7.0, shape=[1])
b = tf.constant(1.0, shape=[1])
input_data = [a, b]
print(m(a, b))
```
Output:
```
tf.Tensor([9.], shape=(1,), dtype=float32)
```

### 3. Failure after conversion
Wrong results.
",True
ModuleNotFoundError: No module named 'resource' stat:awaiting response type:bug TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

v2.13.0-rc2-7-g1cb1a030a62 2.13.0

### Custom code

No

### OS platform and distribution

Windows 11

### Mobile device

_No response_

### Python version

3.11.5

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Python test code
`import tensorflow_datasets as tfds`

Produces
ModuleNotFoundError: No module named 'resource'

### Standalone code to reproduce the issue

```shell
Python test code
import tensorflow_datasets as tfds
```


### Relevant log output

```shell
c:\xxxx\Devel Files\Other\Work\Python\image_class_transferlearning>python64.bat test.py
Traceback (most recent call last):
  File ""c:\xxxx\Devel Files\Other\Work\Python\image_class_transferlearning\test.py"", line 1, in <module>
    import tensorflow_datasets as tfds
  File ""C:\Users\xxxx\AppData\Local\Programs\Python\Python311\Lib\site-packages\tensorflow_datasets\__init__.py"", line 43, in <module>
    import tensorflow_datasets.core.logging as _tfds_logging
  File ""C:\Users\xxxx\AppData\Local\Programs\Python\Python311\Lib\site-packages\tensorflow_datasets\core\__init__.py"", line 22, in <module>
    from tensorflow_datasets.core import community
  File ""C:\Users\xxxx\AppData\Local\Programs\Python\Python311\Lib\site-packages\tensorflow_datasets\core\community\__init__.py"", line 18, in <module>
    from tensorflow_datasets.core.community.huggingface_wrapper import mock_builtin_to_use_gfile
  File ""C:\Users\xxxx\AppData\Local\Programs\Python\Python311\Lib\site-packages\tensorflow_datasets\core\community\huggingface_wrapper.py"", line 31, in <module>
    from tensorflow_datasets.core import dataset_builder
  File ""C:\Users\xxxx\AppData\Local\Programs\Python\Python311\Lib\site-packages\tensorflow_datasets\core\dataset_builder.py"", line 44, in <module>
    from tensorflow_datasets.core import split_builder as split_builder_lib
  File ""C:\Users\xxxx\AppData\Local\Programs\Python\Python311\Lib\site-packages\tensorflow_datasets\core\split_builder.py"", line 37, in <module>
    from tensorflow_datasets.core import writer as writer_lib
  File ""C:\Users\xxxx\AppData\Local\Programs\Python\Python311\Lib\site-packages\tensorflow_datasets\core\writer.py"", line 33, in <module>
    from tensorflow_datasets.core import shuffle
  File ""C:\Users\xxxx\AppData\Local\Programs\Python\Python311\Lib\site-packages\tensorflow_datasets\core\shuffle.py"", line 20, in <module>
    import resource
ModuleNotFoundError: No module named 'resource'
```
",True
tf.math.cumsum weird behaviour  stat:awaiting response type:bug stale comp:ops TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13

### Custom code

Yes

### OS platform and distribution

Ubuntu 22.04.2 LTS

### Mobile device

_No response_

### Python version

ython 3.10.12

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

12.0

### GPU model and memory

T4

### Current behavior?

tf.math.cumsum produce weird results on float32 and float64 when device is GPU:
- results are different than on CPU
- results do not match manual cumsum calculation 
- cumsum value can change when adding 0 (last two values in log output). 
- float64 has similar problems as well
- tested on multiple GPUs: T4, GTX1080Ti and tensorflow versions: 2.13, 2.8.4

### Standalone code to reproduce the issue

```shell
with tf.device('/GPU'):
  arr = tf.constant(
        [  0.  ,     0.  ,     0.  ,     0.  ,  9759.35,  9759.35,
          9759.35,  9759.35,  9759.35,  9759.35,  9762.03,  9700.78,
          9700.78,  9700.78,  9700.78,  9700.78,  9700.78,  9660.83,
          9600.46,  9600.46,  9600.46,  9600.46,  9600.46,  9600.46,
          9715.65,  9742.31,  9742.31,  9742.31,  9742.31,  9742.31,
          9742.31,  9774.32,  9750.2 ,  9750.2 ,  9750.2 ,  9750.2 ,
          9750.2 ,  9750.2 ,  9796.23,  9824.72,  9824.72,  9824.72,
          9824.72,  9824.72,  9824.72, 11737.25,  9759.23,  9759.23,
          9759.23,  9759.23,  9759.23,  9759.23,  9551.41,  9551.47,
          9551.47,  9551.47,  9551.47,  9551.47,  9551.47,  9723.25,
          9693.61,  9693.61,  9693.61,  9693.61,  9693.61,  9693.61,
          9629.34,  9658.78,  9658.78,  9658.78,  9658.78,  9658.78,
          9658.78,  9986.66, 10005.04, 10005.04, 10005.04, 10005.04,
          10005.04, 10005.04,  9977.68,  9955.32,  9955.32,  9955.32,
          9955.32,  9955.32,  9955.32,  9875.19,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.  ,
              0.  ,     0.  ,     0.  ,     0.  ,     0.  ,     0.], dtype=tf.float32)

  manual_cumsum = []
  for val in arr:
    if len(manual_cumsum) == 0:
      manual_cumsum.append(val)
    else:
       manual_cumsum.append(manual_cumsum[-1] + val)

  tf_cumsum = tf.math.cumsum(arr)

  for index in range(arr.shape[0]):
    print(""arr_value:"", arr[index].numpy(), ""tensor - manual cumsum diff:"", (tf_cumsum[index] - manual_cumsum[index]).numpy())
```
```


### Relevant log output

```shell
arr_value: 0.0 tensor - manual cumsum diff: 0.0
arr_value: 0.0 tensor - manual cumsum diff: 0.0
arr_value: 0.0 tensor - manual cumsum diff: 0.0
arr_value: 0.0 tensor - manual cumsum diff: 0.0
arr_value: 9759.35 tensor - manual cumsum diff: 0.0
arr_value: 9759.35 tensor - manual cumsum diff: 0.0
arr_value: 9759.35 tensor - manual cumsum diff: 0.0
arr_value: 9759.35 tensor - manual cumsum diff: 0.0
arr_value: 9759.35 tensor - manual cumsum diff: 0.0
arr_value: 9759.35 tensor - manual cumsum diff: 0.0
arr_value: 9762.03 tensor - manual cumsum diff: 0.0
arr_value: 9700.78 tensor - manual cumsum diff: 0.0
arr_value: 9700.78 tensor - manual cumsum diff: -0.0078125
arr_value: 9700.78 tensor - manual cumsum diff: -0.0078125
arr_value: 9700.78 tensor - manual cumsum diff: -0.0078125
arr_value: 9700.78 tensor - manual cumsum diff: -0.0078125
arr_value: 9700.78 tensor - manual cumsum diff: -0.0078125
arr_value: 9660.83 tensor - manual cumsum diff: -0.015625
arr_value: 9600.46 tensor - manual cumsum diff: -0.015625
arr_value: 9600.46 tensor - manual cumsum diff: -0.015625
arr_value: 9600.46 tensor - manual cumsum diff: 0.0
arr_value: 9600.46 tensor - manual cumsum diff: 0.0
arr_value: 9600.46 tensor - manual cumsum diff: 0.0
arr_value: 9600.46 tensor - manual cumsum diff: 0.0
arr_value: 9715.65 tensor - manual cumsum diff: 0.03125
arr_value: 9742.31 tensor - manual cumsum diff: 0.03125
arr_value: 9742.31 tensor - manual cumsum diff: 0.03125
arr_value: 9742.31 tensor - manual cumsum diff: 0.03125
arr_value: 9742.31 tensor - manual cumsum diff: 0.015625
arr_value: 9742.31 tensor - manual cumsum diff: 0.015625
arr_value: 9742.31 tensor - manual cumsum diff: 0.015625
arr_value: 9774.32 tensor - manual cumsum diff: 0.03125
arr_value: 9750.2 tensor - manual cumsum diff: 0.03125
arr_value: 9750.2 tensor - manual cumsum diff: 0.03125
arr_value: 9750.2 tensor - manual cumsum diff: 0.03125
arr_value: 9750.2 tensor - manual cumsum diff: 0.03125
arr_value: 9750.2 tensor - manual cumsum diff: 0.09375
arr_value: 9750.2 tensor - manual cumsum diff: 0.09375
arr_value: 9796.23 tensor - manual cumsum diff: 0.09375
arr_value: 9824.72 tensor - manual cumsum diff: 0.09375
arr_value: 9824.72 tensor - manual cumsum diff: 0.125
arr_value: 9824.72 tensor - manual cumsum diff: 0.125
arr_value: 9824.72 tensor - manual cumsum diff: 0.125
arr_value: 9824.72 tensor - manual cumsum diff: 0.125
arr_value: 9824.72 tensor - manual cumsum diff: 0.125
arr_value: 11737.25 tensor - manual cumsum diff: 0.125
arr_value: 9759.23 tensor - manual cumsum diff: 0.125
arr_value: 9759.23 tensor - manual cumsum diff: 0.125
arr_value: 9759.23 tensor - manual cumsum diff: 0.15625
arr_value: 9759.23 tensor - manual cumsum diff: 0.15625
arr_value: 9759.23 tensor - manual cumsum diff: 0.15625
arr_value: 9759.23 tensor - manual cumsum diff: 0.15625
arr_value: 9551.41 tensor - manual cumsum diff: 0.1875
arr_value: 9551.47 tensor - manual cumsum diff: 0.1875
arr_value: 9551.47 tensor - manual cumsum diff: 0.1875
arr_value: 9551.47 tensor - manual cumsum diff: 0.1875
arr_value: 9551.47 tensor - manual cumsum diff: 0.1875
arr_value: 9551.47 tensor - manual cumsum diff: 0.1875
arr_value: 9551.47 tensor - manual cumsum diff: 0.1875
arr_value: 9723.25 tensor - manual cumsum diff: 0.1875
arr_value: 9693.61 tensor - manual cumsum diff: 0.1875
arr_value: 9693.61 tensor - manual cumsum diff: 0.1875
arr_value: 9693.61 tensor - manual cumsum diff: 0.1875
arr_value: 9693.61 tensor - manual cumsum diff: 0.1875
arr_value: 9693.61 tensor - manual cumsum diff: 0.125
arr_value: 9693.61 tensor - manual cumsum diff: 0.125
arr_value: 9629.34 tensor - manual cumsum diff: 0.125
arr_value: 9658.78 tensor - manual cumsum diff: 0.125
arr_value: 9658.78 tensor - manual cumsum diff: 0.125
arr_value: 9658.78 tensor - manual cumsum diff: 0.125
arr_value: 9658.78 tensor - manual cumsum diff: 0.125
arr_value: 9658.78 tensor - manual cumsum diff: 0.125
arr_value: 9658.78 tensor - manual cumsum diff: 0.25
arr_value: 9986.66 tensor - manual cumsum diff: 0.25
arr_value: 10005.04 tensor - manual cumsum diff: 0.25
arr_value: 10005.04 tensor - manual cumsum diff: 0.25
arr_value: 10005.04 tensor - manual cumsum diff: 0.1875
arr_value: 10005.04 tensor - manual cumsum diff: 0.1875
arr_value: 10005.04 tensor - manual cumsum diff: 0.1875
arr_value: 10005.04 tensor - manual cumsum diff: 0.1875
arr_value: 9977.68 tensor - manual cumsum diff: 0.1875
arr_value: 9955.32 tensor - manual cumsum diff: 0.1875
arr_value: 9955.32 tensor - manual cumsum diff: 0.1875
arr_value: 9955.32 tensor - manual cumsum diff: 0.1875
arr_value: 9955.32 tensor - manual cumsum diff: 0.1875
arr_value: 9955.32 tensor - manual cumsum diff: 0.1875
arr_value: 9955.32 tensor - manual cumsum diff: 0.1875
arr_value: 9875.19 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.1875
arr_value: 0.0 tensor - manual cumsum diff: 0.25
arr_value: 0.0 tensor - manual cumsum diff: 0.25
```
```
",True
AttributeError: module 'tensorflow.python.distribute.input_lib' has no attribute 'DistributedDatasetInterface' stat:awaiting response type:bug stale comp:core TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 22.04.3

### Mobile device

_No response_

### Python version

2.13.0

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

OS : Ubuntu 22.04.3
Software: Pycharm
files: LogisticRegression_withTensorflow.ipynb

I dont know what happen, it just work yesterday
when I run this code:
`model.fit(X_train, y_train, epochs=150)`


### Standalone code to reproduce the issue

```shell
# import library
import numpy as np
import tensorflow as tf
from tensorflow.python.keras import Sequential
from tensorflow.python.keras.layers import Dense
from tensorflow.python.keras.losses import BinaryCrossentropy
print(tf.__version__)
# 2.13.0
# import data
X = []
y = []
with open('../../Part1/Week2/data/ex2data1.txt') as file:
# with open('/home/wisdom/vs_code_repository/Python/AndrewNG_ML/Part1/Week2/data/ex2data1.txt', 'r') as file:
    for lines in file:
        colums = lines.strip().split(',')
        X.append([float(colums[0]), float(colums[1])])
        y.append(float(colums[2]))
X = np.array(X)
y = np.array(y)
# normalization
X_mean = np.mean(X, axis=0)
X_max = np.max(X, axis=0)
X_min = np.min(X, axis=0)
X = (X - X_mean) / (X_max - X_min)

# split data into training_set and testing_set
X_train = X[:80]
y_train = y[:80]
X_test = X[80:]
y_test = y[80:]
model = Sequential([Dense(units=32, activation='sigmoid'),
                    Dense(units=16, activation='sigmoid'),
                    Dense(units=1, activation='sigmoid')])
model.compile(loss=BinaryCrossentropy())
model.fit(X_train, y_train, epochs=150) # bug appears this line
```


### Relevant log output

```shell
AttributeError                            Traceback (most recent call last)
Cell In[13], line 1
----> 1 model.fit(X_train, y_train, epochs=150)

File /usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/training.py:1138, in Model.fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)
   1132   self._cluster_coordinator = cluster_coordinator.ClusterCoordinator(
   1133       self.distribute_strategy)
   1135 with self.distribute_strategy.scope(), \
   1136      training_utils.RespectCompiledTrainableState(self):
   1137   # Creates a `tf.data.Dataset` and handles batch and epoch iteration.
-> 1138   data_handler = data_adapter.get_data_handler(
   1139       x=x,
   1140       y=y,
   1141       sample_weight=sample_weight,
   1142       batch_size=batch_size,
   1143       steps_per_epoch=steps_per_epoch,
   1144       initial_epoch=initial_epoch,
   1145       epochs=epochs,
   1146       shuffle=shuffle,
   1147       class_weight=class_weight,
   1148       max_queue_size=max_queue_size,
   1149       workers=workers,
   1150       use_multiprocessing=use_multiprocessing,
   1151       model=self,
   1152       steps_per_execution=self._steps_per_execution)
   1154   # Container that configures and calls `tf.keras.Callback`s.
   1155   if not isinstance(callbacks, callbacks_module.CallbackList):

File /usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/data_adapter.py:1398, in get_data_handler(*args, **kwargs)
   1396 if getattr(kwargs[""model""], ""_cluster_coordinator"", None):
   1397   return _ClusterCoordinatorDataHandler(*args, **kwargs)
-> 1398 return DataHandler(*args, **kwargs)

File /usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/data_adapter.py:1152, in DataHandler.__init__(self, x, y, sample_weight, batch_size, steps_per_epoch, initial_epoch, epochs, shuffle, class_weight, max_queue_size, workers, use_multiprocessing, model, steps_per_execution, distribute)
   1149   self._steps_per_execution = steps_per_execution
   1150   self._steps_per_execution_value = steps_per_execution.numpy().item()
-> 1152 adapter_cls = select_data_adapter(x, y)
   1153 self._adapter = adapter_cls(
   1154     x,
   1155     y,
   (...)
   1164     distribution_strategy=distribute_lib.get_strategy(),
   1165     model=model)
   1167 strategy = distribute_lib.get_strategy()

File /usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/data_adapter.py:988, in select_data_adapter(x, y)
    986 def select_data_adapter(x, y):
    987   """"""Selects a data adapter than can handle a given x and y.""""""
--> 988   adapter_cls = [cls for cls in ALL_ADAPTER_CLS if cls.can_handle(x, y)]
    989   if not adapter_cls:
    990     # TODO(scottzhu): This should be a less implementation-specific error.
    991     raise ValueError(
    992         ""Failed to find data adapter that can handle ""
    993         ""input: {}, {}"".format(
    994             _type_name(x), _type_name(y)))

File /usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/data_adapter.py:988, in <listcomp>(.0)
    986 def select_data_adapter(x, y):
    987   """"""Selects a data adapter than can handle a given x and y.""""""
--> 988   adapter_cls = [cls for cls in ALL_ADAPTER_CLS if cls.can_handle(x, y)]
    989   if not adapter_cls:
    990     # TODO(scottzhu): This should be a less implementation-specific error.
    991     raise ValueError(
    992         ""Failed to find data adapter that can handle ""
    993         ""input: {}, {}"".format(
    994             _type_name(x), _type_name(y)))

File /usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/data_adapter.py:707, in DatasetAdapter.can_handle(x, y)
    704 @staticmethod
    705 def can_handle(x, y=None):
    706   return (isinstance(x, (data_types.DatasetV1, data_types.DatasetV2)) or
--> 707           _is_distributed_dataset(x))

File /usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/data_adapter.py:1699, in _is_distributed_dataset(ds)
   1698 def _is_distributed_dataset(ds):
-> 1699   return isinstance(ds, input_lib.DistributedDatasetInterface)

AttributeError: module 'tensorflow.python.distribute.input_lib' has no attribute 'DistributedDatasetInterface'
```
",True
Unable to load TensorFlow saved model (AttributeError: '_UserObject' object has no attribute 'add_slot') stat:awaiting response type:bug comp:apis TF 2.7,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.7.0

### Custom code

Yes

### OS platform and distribution

Windows 10 Enterprise LTSC

### Mobile device

_No response_

### Python version

3.9.12

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11.2/8

### GPU model and memory

Nvidia Geforce RTX 3090 24 GB

### Current behavior?

I have several trained TensorFlow models stored on my device in saved_model format. All the models have the same architecture and serve the same purpose, but they were created at different points in time. While I have no problems to load the newest models (created from 5th September 2022 onward) with the command `tensorflow.keras.models.load_model(filepath)`, older models that were created before this date raise the following exception when this method is called:

> AttributeError: '_UserObject' object has no attribute 'add_slot'

The same exception is also raised when trying to load these models with: `tensorflow.saved_model.load(filepath)`, which was one of the suggestions I found to solve the issue. Another possible solution that I took from the related issue #52091 was to use another TF version, I tried it with the older v2.6 and the newest Windows native version v.2.10, but the result was the same.

### Standalone code to reproduce the issue

[EDIT] I could reproduce the exception on Google Colab using the newest TF version. Please find the notebook here: [Model_Load_Problem.ipynb](https://colab.research.google.com/drive/1YyyU6kyn947JCuTHOrjRiDGQb2XBOueu?usp=sharing)


### Relevant log output

```shell
2023-09-25 11:36:20.048929: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-09-25 11:36:21.096591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 18788 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:1a:00.0, compute capability: 8.6
Traceback (most recent call last):
  File ""C:\Users\icon\Desktop\Testing_Models\iCoNet\source\model.py"", line 699, in load_trained_model
    model = tf.keras.models.load_model(model_path)
  File ""C:\Users\icon\.conda\envs\iConNet\lib\site-packages\keras\utils\traceback_utils.py"", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File ""C:\Users\icon\.conda\envs\iConNet\lib\site-packages\tensorflow\python\saved_model\load.py"", line 466, in _load_nodes
    slot_variable = optimizer_object.add_slot(
AttributeError: '_UserObject' object has no attribute 'add_slot'
```
",True
KeyError: 'min' type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

tf 2.13

### Custom code

Yes

### OS platform and distribution

5.15.90.1-microsoft-standard-WSL2

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

12.2

### GPU model and memory

_No response_

### Current behavior?

Traceback (most recent call last):
  File ""o2k.py"", line 11, in <module>
    k_model = onnx_to_keras(onnx_model, ['input.1'], name_policy='renumerate', verbose=True)
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/converter.py"", line 175, in onnx_to_keras
    AVAILABLE_CONVERTERS[node_type](
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/operation_layers.py"", line 31, in convert_clip
    if params['min'] == 0:
KeyError: 'min'

### Standalone code to reproduce the issue

```shell
from onnx2keras import onnx_to_keras
import keras
import onnx
import sys
# sys.path.append(""/root/MR"")
onnx_model = onnx.load('ssd_bmv1_torch.onnx')
onnx_inputs = onnx_model.graph.input
print(""==========================="")
print(onnx_inputs)
# onnx_model = onnx.load('vgg11.onnx')
k_model = onnx_to_keras(onnx_model, ['input.1'], name_policy='renumerate', verbose=True)
keras.models.save_model(k_model, 'ssd_bmv1_torch.h5', overwrite=True, save_format=""h5"")

onnx file can be downloaded at https://pan.xunlei.com/s/VNf1O2DqsdqdbTYYpyemSqveA1?pwd=by77#
```


### Relevant log output

```shell
Traceback (most recent call last):
  File ""o2k.py"", line 11, in <module>
    k_model = onnx_to_keras(onnx_model, ['input.1'], name_policy='renumerate', verbose=True)
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/converter.py"", line 175, in onnx_to_keras
    AVAILABLE_CONVERTERS[node_type](
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/operation_layers.py"", line 31, in convert_clip
    if params['min'] == 0:
KeyError: 'min'
```
",True
KeyError: 'ConstantOfShape' type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

tf 2.13

### Custom code

Yes

### OS platform and distribution

5.15.90.1-microsoft-standard-WSL2

### Mobile device

_No response_

### Python version

3.8.17

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

12.2

### GPU model and memory

_No response_

### Current behavior?

Traceback (most recent call last):
  File ""o2k.py"", line 11, in <module>
    k_model = onnx_to_keras(onnx_model, ['input.1'], name_policy='renumerate', verbose=True)
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/converter.py"", line 175, in onnx_to_keras
    AVAILABLE_CONVERTERS[node_type](
KeyError: 'ConstantOfShape'

### Standalone code to reproduce the issue

```shell
from onnx2keras import onnx_to_keras
import keras
import onnx
import sys
# sys.path.append(""/root/MR"")
onnx_model = onnx.load('patchcore_torch.onnx')
onnx_inputs = onnx_model.graph.input
print(""==========================="")
print(onnx_inputs)
# onnx_model = onnx.load('vgg11.onnx')
k_model = onnx_to_keras(onnx_model, ['input.1'], name_policy='renumerate', verbose=True)
keras.models.save_model(k_model, 'patchcore_torch.h5', overwrite=True, save_format=""h5"")

onnx file can be downloaded at https://pan.xunlei.com/s/VNf1NLiBYfIh_GKpSvMjqJQAA1?pwd=3wzb#
```


### Relevant log output

```shell
Traceback (most recent call last):
  File ""o2k.py"", line 11, in <module>
    k_model = onnx_to_keras(onnx_model, ['input.1'], name_policy='renumerate', verbose=True)
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/converter.py"", line 175, in onnx_to_keras
    AVAILABLE_CONVERTERS[node_type](
KeyError: 'ConstantOfShape'
```
",True
AttributeError: Number of inputs is not equal 1 for unsqueeze layer type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

tf 2.13

### Custom code

Yes

### OS platform and distribution

5.15.90.1-microsoft-standard-WSL2

### Mobile device

_No response_

### Python version

3.8.17

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

12.2

### GPU model and memory

_No response_

### Current behavior?

Traceback (most recent call last):
  File ""o2k.py"", line 11, in <module>
    k_model = onnx_to_keras(onnx_model, ['onnx::Unsqueeze_0'], name_policy='renumerate', verbose=True)
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/converter.py"", line 175, in onnx_to_keras
    AVAILABLE_CONVERTERS[node_type](
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/reshape_layers.py"", line 210, in convert_unsqueeze
    raise AttributeError('Number of inputs is not equal 1 for unsqueeze layer')
AttributeError: Number of inputs is not equal 1 for unsqueeze layer

### Standalone code to reproduce the issue

```shell
please run the below codes to reproduce:

from onnx2keras import onnx_to_keras
import keras
import onnx
import sys
# sys.path.append(""/root/MR"")
onnx_model = onnx.load('textcnn_torch.onnx')
onnx_inputs = onnx_model.graph.input
print(""==========================="")
print(onnx_inputs)
# onnx_model = onnx.load('vgg11.onnx')
k_model = onnx_to_keras(onnx_model, ['onnx::Unsqueeze_0'], name_policy='renumerate', verbose=True)
keras.models.save_model(k_model, 'textcnn_torch.h5', overwrite=True, save_format=""h5"")
```
onnx file can be downloaded at https://pan.xunlei.com/s/VNf1M2KIkqx6PBbrBdTiuTkMA1?pwd=wxqf#
```


### Relevant log output

```shell
Traceback (most recent call last):
  File ""o2k.py"", line 11, in <module>
    k_model = onnx_to_keras(onnx_model, ['onnx::Unsqueeze_0'], name_policy='renumerate', verbose=True)
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/converter.py"", line 175, in onnx_to_keras
    AVAILABLE_CONVERTERS[node_type](
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/reshape_layers.py"", line 210, in convert_unsqueeze
    raise AttributeError('Number of inputs is not equal 1 for unsqueeze layer')
AttributeError: Number of inputs is not equal 1 for unsqueeze layer
```
",True
AttributeError: Can't gather from tf tensor. type:bug wsl2 TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

tf 2.13

### Custom code

Yes

### OS platform and distribution

5.15.90.1-microsoft-standard-WSL2

### Mobile device

_No response_

### Python version

3.8.17

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

12.2

### GPU model and memory

_No response_

### Current behavior?

Traceback (most recent call last):
  File ""o2k.py"", line 11, in <module>
    k_model = onnx_to_keras(onnx_model, ['onnx::Cast_0', 'onnx::Cast_1'], name_policy='renumerate', verbose=True)
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/converter.py"", line 175, in onnx_to_keras
    AVAILABLE_CONVERTERS[node_type](
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/reshape_layers.py"", line 87, in convert_gather
    raise AttributeError('Can\'t gather from tf tensor.')
AttributeError: Can't gather from tf tensor.

### Standalone code to reproduce the issue

```shell
please run the codes below to reproduce:

from onnx2keras import onnx_to_keras
import keras
import onnx
import sys
# sys.path.append(""/root/MR"")
onnx_model = onnx.load('fasttext_torch.onnx')
onnx_inputs = onnx_model.graph.input
print(""==========================="")
print(onnx_inputs)
# onnx_model = onnx.load('vgg11.onnx')
k_model = onnx_to_keras(onnx_model, ['onnx::Cast_0', 'onnx::Cast_1'], name_policy='renumerate', verbose=True)
keras.models.save_model(k_model, 'fasttext_torch.h5', overwrite=True, save_format=""h5"")
```
onnx file can be downloaded at https://pan.xunlei.com/s/VNf1LHoMqVe2TuzMTA8uhjO5A1?pwd=ibm3#
```


### Relevant log output

```shell
Traceback (most recent call last):
  File ""o2k.py"", line 11, in <module>
    k_model = onnx_to_keras(onnx_model, ['onnx::Cast_0', 'onnx::Cast_1'], name_policy='renumerate', verbose=True)
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/converter.py"", line 175, in onnx_to_keras
    AVAILABLE_CONVERTERS[node_type](
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/reshape_layers.py"", line 87, in convert_gather
    raise AttributeError('Can\'t gather from tf tensor.')
AttributeError: Can't gather from tf tensor.
```
",True
AttributeError: Not implemented type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

tf 2.13

### Custom code

Yes

### OS platform and distribution

5.15.90.1-microsoft-standard-WSL2

### Mobile device

_No response_

### Python version

3.8.17

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

12.2

### GPU model and memory

_No response_

### Current behavior?

Traceback (most recent call last):
  File ""o2k.py"", line 11, in <module>
    k_model = onnx_to_keras(onnx_model, ['input.1'], name_policy='renumerate', verbose=True)
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/converter.py"", line 175, in onnx_to_keras
    AVAILABLE_CONVERTERS[node_type](
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/reshape_layers.py"", line 294, in convert_slice
    raise AttributeError('Not implemented')
AttributeError: Not implemented

### Standalone code to reproduce the issue

```shell
reproduce by running the following code:

from onnx2keras import onnx_to_keras
import keras
import onnx
import sys
# sys.path.append(""/root/MR"")
onnx_model = onnx.load('deeplabv3_torch.onnx')
onnx_inputs = onnx_model.graph.input
print(""==========================="")
print(onnx_inputs)
# onnx_model = onnx.load('vgg11.onnx')
k_model = onnx_to_keras(onnx_model, ['input.1'], name_policy='renumerate', verbose=True)
keras.models.save_model(k_model, 'deeplabv3_torch.h5', overwrite=True, save_format=""h5"")
```

onnx file can be downloaded at https://pan.xunlei.com/s/VNf1JfHu9m6WG6yE2IuzWtKpA1?pwd=ux7b#
```


### Relevant log output

```shell
Traceback (most recent call last):
  File ""o2k.py"", line 11, in <module>
    k_model = onnx_to_keras(onnx_model, ['input.1'], name_policy='renumerate', verbose=True)
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/converter.py"", line 175, in onnx_to_keras
    AVAILABLE_CONVERTERS[node_type](
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/reshape_layers.py"", line 294, in convert_slice
    raise AttributeError('Not implemented')
AttributeError: Not implemented
```
",True
"ValueError: Exception encountered when calling layer ""13"" (type Lambda). type:bug","### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.13

### Custom code

Yes

### OS platform and distribution

5.15.90.1-microsoft-standard-WSL2

### Mobile device

_No response_

### Python version

3.8.17

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

12.2

### GPU model and memory

_No response_

### Current behavior?

<html xmlns:v=""urn:schemas-microsoft-com:vml""
xmlns:o=""urn:schemas-microsoft-com:office:office""
xmlns:x=""urn:schemas-microsoft-com:office:excel""
xmlns=""http://www.w3.org/TR/REC-html40"">

<head>

<meta name=ProgId content=Excel.Sheet>
<meta name=Generator content=""Microsoft Excel 15"">
<link id=Main-File rel=Main-File
href=""file:///C:/Users/pengg/AppData/Local/Temp/msohtmlclip1/01/clip.htm"">
<link rel=File-List
href=""file:///C:/Users/pengg/AppData/Local/Temp/msohtmlclip1/01/clip_filelist.xml"">
<style>
<!--table
	{mso-displayed-decimal-separator:""\."";
	mso-displayed-thousand-separator:""\,"";}
@page
	{margin:.75in .7in .75in .7in;
	mso-header-margin:.3in;
	mso-footer-margin:.3in;}
.font5
	{color:windowtext;
	font-size:9.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:等线;
	mso-generic-font-family:auto;
	mso-font-charset:134;}
tr
	{mso-height-source:auto;
	mso-ruby-visibility:none;}
col
	{mso-width-source:auto;
	mso-ruby-visibility:none;}
br
	{mso-data-placement:same-cell;}
td
	{padding-top:1px;
	padding-right:1px;
	padding-left:1px;
	mso-ignore:padding;
	color:black;
	font-size:11.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:等线;
	mso-generic-font-family:auto;
	mso-font-charset:134;
	mso-number-format:General;
	text-align:general;
	vertical-align:middle;
	border:none;
	mso-background-source:auto;
	mso-pattern:auto;
	mso-protection:locked visible;
	white-space:nowrap;
	mso-rotate:0;}
.xl65
	{text-align:center;}
.xl66
	{text-align:center;
	white-space:normal;}
ruby
	{ruby-align:left;}
rt
	{color:windowtext;
	font-size:9.0pt;
	font-weight:400;
	font-style:normal;
	text-decoration:none;
	font-family:等线;
	mso-generic-font-family:auto;
	mso-font-charset:134;
	mso-char-type:none;
	display:none;}
-->
</style>
</head>

<body link=""#0563C1"" vlink=""#954F72"">



ValueError:   Exception encountered when calling layer ""13"" (type Lambda).          Dimensions must be equal, but are 204 and 206 for '{{node 13/Add}} =   AddV2[T=DT_FLOAT](Placeholder, Placeholder_1)' with input shapes:   [?,64,204,204], [?,64,206,206].          Call arguments received by layer ""13"" (type Lambda):       • inputs=['tf.Tensor(shape=(None,   64, 204, 204), dtype=float32)', 'tf.Tensor(shape=(None, 64, 206, 206),   dtype=float32)']       • mask=None       • training=None
--




</body>

</html>


### Standalone code to reproduce the issue

```shell
just run the following code to reproduce:

from onnx2keras import onnx_to_keras
import keras
import onnx
import sys
# sys.path.append(""/root/MR"")
onnx_model = onnx.load('yolov3_darknet53.onnx')
onnx_inputs = onnx_model.graph.input
print(""==========================="")
print(onnx_inputs)
# onnx_model = onnx.load('vgg11.onnx')
k_model = onnx_to_keras(onnx_model, ['x'], name_policy='renumerate', verbose=True)
keras.models.save_model(k_model, 'ssd_resnet50fpn_torch.h5', overwrite=True, save_format=""h5"")
```
the onnx file can be downloaded at https://pan.xunlei.com/s/VNf1FtBh2v6mP_QXJWVailBmA1?pwd=g43e#
```


### Relevant log output

```shell
Traceback (most recent call last):
  File ""o2k.py"", line 11, in <module>
    k_model = onnx_to_keras(onnx_model, ['x'], name_policy='renumerate', verbose=True)
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/converter.py"", line 175, in onnx_to_keras
    AVAILABLE_CONVERTERS[node_type](
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/elementwise_layers.py"", line 83, in convert_elementwise_add
    layers[node_name] = lambda_layer([input_0, input_1])
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/keras/src/utils/traceback_utils.py"", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File ""/root/miniconda3/envs/onnx/lib/python3.8/site-packages/onnx2keras/elementwise_layers.py"", line 76, in target_layer
    layer = tf.add(
ValueError: Exception encountered when calling layer ""LAYER_12"" (type Lambda).

Dimensions must be equal, but are 204 and 206 for '{{node LAYER_12/Add}} = AddV2[T=DT_FLOAT](Placeholder, Placeholder_1)' with input shapes: [?,64,204,204], [?,64,206,206].

Call arguments received by layer ""LAYER_12"" (type Lambda):
  • inputs=['tf.Tensor(shape=(None, 64, 204, 204), dtype=float32)', 'tf.Tensor(shape=(None, 64, 206, 206), dtype=float32)']
  • mask=None
  • training=None
```
",True
ValueError: Tried to convert 'shape' to a tensor and failed. Error: None values not supported. stat:awaiting response type:bug stale comp:keras TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

Window 10

### Mobile device

_No response_

### Python version

3.9.12

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I am trying to implement [this](https://keras.io/examples/vision/image_classification_with_vision_transformer/) in tensorflow 2.13 but getting this error ""**ValueError: Tried to convert 'shape' to a tensor and failed. Error: None values not supported**"" after searching a lot I got to know we have to use -1 in case of None but even after trying that it was not working  I am getting this error in custom Patches layer 

patches = tf.reshape(patches, [batch_size, -1, patch_dims])


can anybody please help?

### Standalone code to reproduce the issue

```shell
class Patches(layers.Layer):

    def __init__(self, patch_size, **kwargs):
        super(Patches, self).__init__()
        self.patch_size = patch_size

    def call(self, images):
        batch_size = tf.shape(images)[0] # Get the Batch Size
        patches = tf.image.extract_patches(
            images=images,
            sizes=[1, self.patch_size, self.patch_size, 1], # only along the Height and Width Dimension
            strides=[1, self.patch_size, self.patch_size, 1], # The next patch should not overlap the previus patch
            rates=[1,1,1,1],
            padding='VALID'
        )
        patch_dims = patches.shape[-1]
        patches = tf.reshape(patches, [batch_size, -1, patch_dims])
        
        return patches
    
    def get_config(self):
        config = super().get_config()
        config.update({
            ""path-size"": self.patch_size,
        })
        return config
```


### Relevant log output

```shell
history = model.fit(
     27     train_generator,
     28     validation_data=valid_generator,
     29     batch_size=BATCH_SIZE,
     30     epochs=NUM_EPOCHS,
     31     callbacks=[
     32         checkpoint_callback, 
     33         tf.keras.callbacks.EarlyStopping(patience=5, monitor='val_Accuracy', mode='max' ,restore_best_weights=True)
     34     ],
     35 )
     37 model.load_weights(checkpoint_filepath)
     38 _, accuracy, top_5_accuracy = model.evaluate(x_test, y_test)

File ~\AppData\Roaming\Python\Python39\site-packages\keras\src\utils\traceback_utils.py:70, in filter_traceback.<locals>.error_handler(*args, **kwargs)
     67     filtered_tb = _process_traceback_frames(e.__traceback__)
     68     # To get the full stack trace, call:
     69     # `tf.debugging.disable_traceback_filtering()`
---> 70     raise e.with_traceback(filtered_tb) from None
     71 finally:
     72     del filtered_tb

File ~\AppData\Local\Temp\__autograph_generated_filelwsbm473.py:15, in outer_factory.<locals>.inner_factory.<locals>.tf__train_function(iterator)
     13 try:
     14     do_return = True
---> 15     retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
     16 except:
     17     do_return = False

File ~\AppData\Local\Temp\__autograph_generated_filewl0d9m3r.py:13, in outer_factory.<locals>.inner_factory.<locals>.tf__call(self, images)
     11 patches = ag__.converted_call(ag__.ld(tf).image.extract_patches, (), dict(images=ag__.ld(images), sizes=[1, ag__.ld(self).patch_size, ag__.ld(self).patch_size, 1], strides=[1, ag__.ld(self).patch_size, ag__.ld(self).patch_size, 1], rates=[1, 1, 1, 1], padding='VALID'), fscope)
     12 patch_dims = ag__.ld(patches).shape[-1]
---> 13 patches = ag__.converted_call(ag__.ld(tf).reshape, (ag__.ld(patches), [ag__.ld(batch_size), -1, ag__.ld(patch_dims)]), None, fscope)
     14 try:
     15     do_return = True

ValueError: in user code:

    File ""C:\Users\aksh1\AppData\Roaming\Python\Python39\site-packages\keras\src\engine\training.py"", line 1338, in train_function  *
        return step_function(self, iterator)
    File ""C:\Users\aksh1\AppData\Roaming\Python\Python39\site-packages\keras\src\engine\training.py"", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File ""C:\Users\aksh1\AppData\Roaming\Python\Python39\site-packages\keras\src\engine\training.py"", line 1303, in run_step  **
        outputs = model.train_step(data)
    File ""C:\Users\aksh1\AppData\Roaming\Python\Python39\site-packages\keras\src\engine\training.py"", line 1080, in train_step
        y_pred = self(x, training=True)
    File ""C:\Users\aksh1\AppData\Roaming\Python\Python39\site-packages\keras\src\utils\traceback_utils.py"", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None
    File ""C:\Users\aksh1\AppData\Local\Temp\__autograph_generated_filewl0d9m3r.py"", line 13, in tf__call
        patches = ag__.converted_call(ag__.ld(tf).reshape, (ag__.ld(patches), [ag__.ld(batch_size), -1, ag__.ld(patch_dims)]), None, fscope)

    ValueError: Exception encountered when calling layer 'patches_3' (type Patches).
    
    in user code:
    
        File ""C:\Users\aksh1\AppData\Local\Temp\ipykernel_11744\2749589268.py"", line 17, in call  *
            patches = tf.reshape(patches, [batch_size, -1, patch_dims])
    
        ValueError: Tried to convert 'shape' to a tensor and failed. Error: None values not supported.
    
    
    Call arguments received by layer 'patches_3' (type Patches):
      • images=tf.Tensor(shape=(None, None, None, None), dtype=float32)
```
",True
SpectralNormalization layer is not trainable. Please help (OperatorNotAllowedInGraphError: Exception encountered when calling layer 'spectral_normalization' (type SpectralNormalization).) type:bug comp:keras TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13.0

### Custom code

No

### OS platform and distribution

Ubuntu 22.04.3 LTS and Google Colab

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

cudatoolkit=11.8.0, nvidia-cudnn-cu11==8.6.0.163

### GPU model and memory

_No response_

### Current behavior?

SpectralNormalization layer is not trainable. Whenever I try to use the ""model.fit"" method, TF outputs the error ""Using a symbolic `tf.Tensor` as a Python `bool` is not allowed: AutoGraph did convert this function. This might indicate you are trying to use an unsupported feature.""

Please help

Best

Kav

### Standalone code to reproduce the issue

```shell
LINK TO COLAB NOTEBOOK:
https://colab.research.google.com/drive/1TYoNIrrpk-bLBqpzNJXq5VOI6Mpln5Ty?usp=sharing


STANDALONE CODE:
batch = 1
height = 10
width = 10
channels = 1
filters = 4
kernel_size = 3

x_input = Input(shape=(height, width, channels))
conv2d = SpectralNormalization(Conv2D(filters, kernel_size))
x_output = conv2d(x_input)
model = Model(x_input, x_output)
model.compile(loss='mse')

x = np.random.rand(batch, height, width, channels)
y = np.random.rand(batch, height, width, filters)

model.fit(x, y)
```


### Relevant log output

```shell
---------------------------------------------------------------------------

OperatorNotAllowedInGraphError            Traceback (most recent call last)

<ipython-input-6-d3dc977168f5> in <cell line: 1>()
----> 1 model.fit(x, y)

1 frames

/usr/local/lib/python3.10/dist-packages/tensorflow/python/eager/polymorphic_function/autograph_util.py in autograph_handler(*args, **kwargs)
     50     except Exception as e:  # pylint:disable=broad-except
     51       if hasattr(e, ""ag_error_metadata""):
---> 52         raise e.ag_error_metadata.to_exception(e)
     53       else:
     54         raise

OperatorNotAllowedInGraphError: in user code:

    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1338, in train_function  *
        return step_function(self, iterator)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1322, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1303, in run_step  **
        outputs = model.train_step(data)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1080, in train_step
        y_pred = self(x, training=True)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/utils/traceback_utils.py"", line 70, in error_handler
        raise e.with_traceback(filtered_tb) from None

    OperatorNotAllowedInGraphError: Exception encountered when calling layer 'spectral_normalization' (type SpectralNormalization).
    
    Using a symbolic `tf.Tensor` as a Python `bool` is not allowed: AutoGraph did convert this function. This might indicate you are trying to use an unsupported feature.
    
    Call arguments received by layer 'spectral_normalization' (type SpectralNormalization):
      • inputs=tf.Tensor(shape=(None, 10, 10, 1), dtype=float32)
      • training=True
```
",True
TFLite benchmark tool with default cmake build shows weird time duration on DEPTHWISE_CONV_2D  stat:awaiting response type:bug stale comp:lite TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 2.9.3, tf 2.13.0

### Custom code

No

### OS platform and distribution

Linux Ubuntu 20.04

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

5.0

### GCC/compiler version

gcc 9.4.0

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Following the guide for [build_cmake](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/lite/g3doc/guide/build_cmake.md)
`cmake ../tensorflow_src/tensorflow/lite`
then build the benchmark tool & label_image:
```
cmake --build . -j -t benchmark_model
cmake --build . -j -t label_image
```
I tested using the model [here](https://storage.googleapis.com/download.tensorflow.org/models/tflite/mobilenet_v1_1.0_224_quant_and_labels.zip).

The results shows:
============================== Summary by node type ==============================
	             [Node type]	  [count]	  [avg ms]	    [avg %]	    [cdf %]	  [mem KB]	[times called]
	                 CONV_2D	       15	    38.265	    58.415%	    58.415%	     0.000	       15
	       DEPTHWISE_CONV_2D	       13	    27.230	    41.569%	    99.985%	     0.000	       13
	         AVERAGE_POOL_2D	        1	     0.007	     0.011%	    99.995%	     0.000	        1
	                 SOFTMAX	        1	     0.003	     0.005%	   100.000%	     0.000	        1
	                 RESHAPE	        1	     0.000	     0.000%	   100.000%	     0.000	        1

In theory, 13 x DEPTHWISE_CONV_2D should consume MUCH less time than 15 CONV_2, but it is not the case here.

However, if I use the pre-built binary from [here](https://storage.googleapis.com/tensorflow-nightly-public/prod/tensorflow/release/lite/tools/nightly/latest/linux_x86-64_benchmark_model), the result is correct.


### Standalone code to reproduce the issue

```shell
benchmark_model --graph=./mobilenet_quant_v1_224.tflite --enable_op_profiling=true
```


### Relevant log output

```shell
============================== Summary by node type ==============================
	             [Node type]	  [count]	  [avg ms]	    [avg %]	    [cdf %]	  [mem KB]	[times called]
	                 CONV_2D	       15	    38.265	    58.415%	    58.415%	     0.000	       15
	       DEPTHWISE_CONV_2D	       13	    27.230	    41.569%	    99.985%	     0.000	       13
	         AVERAGE_POOL_2D	        1	     0.007	     0.011%	    99.995%	     0.000	        1
	                 SOFTMAX	        1	     0.003	     0.005%	   100.000%	     0.000	        1
	                 RESHAPE	        1	     0.000	     0.000%	   100.000%	     0.000	        1
```
",True
A call of the model which is reloaded from SavedModel format produces a TypeError stat:awaiting response type:bug stale TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.13

### Custom code

No

### OS platform and distribution

Linux Ubuntu 20.04

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

12.2

### GPU model and memory

_No response_

### Current behavior?

A call of the model which is reloaded from SavedModel format produces a `TypeError: '_UserObject' object is not callable`.
All necessary code is in [this tutorial](https://www.tensorflow.org/text/tutorials/transformer). Below I show code lines from there, where the error occurs.

### Standalone code to reproduce the issue

```shell
reloaded = tf.saved_model.load('translator')
reloaded('este é o primeiro livro que eu fiz.').numpy()
```


### Relevant log output

```shell
Traceback (most recent call last):
  File ""/home/molokanov/tensorflow/check.py"", line 13, in <module>
    reloaded('este é o primeiro livro que eu fiz.').numpy()
TypeError: '_UserObject' object is not callable
```
",True
XLA compiled `Embedding` could work for out-of-bound input stat:awaiting response type:bug stale comp:keras comp:xla TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.15.0-dev20230921

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

XLA compiled `Embedding` could work for out-of-bound input. In the following code, the model has an embedding layer using `tf.keras.layers.Embedding(64, 128)`, which means it has 64 possible tokens (usually representing words or items, indexed from 0 to 63).

The input to it is `tf.constant([64], dtype=tf.int32)`, which is out of range because 64 exceeds the highest valid token index 63.

If we run the model without XLA compilation, it will raise an error as expected. However, after XLA compilation, the model could process such invalid input.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf
""""""
XLA compiled
""""""
class Model(tf.keras.Model):

    def __init__(self):
        super(Model, self).__init__()
        self.embedding = tf.keras.layers.Embedding(64, 128)

    @tf.function(jit_compile=True)
    def call(self, x1, x2):
        x3 = self.embedding(x1)
        return (x3 * x2)

tf.random.set_seed(42)
m = Model()
input_1 = tf.constant([64], dtype=tf.int32)
input_2 = tf.constant([[[[10.0]]]], dtype=tf.float32)
print(m(input_1, input_2))

""""""
Without XLA
""""""
class Model(tf.keras.Model):

    def __init__(self):
        super(Model, self).__init__()
        self.embedding = tf.keras.layers.Embedding(64, 128)

    def call(self, x1, x2):
        x3 = self.embedding(x1)
        return (x3 * x2)

tf.random.set_seed(42)
m = Model()
input_1 = tf.constant([64], dtype=tf.int32)
input_2 = tf.constant([[[[10.0]]]], dtype=tf.float32)
print(m(input_1, input_2))

""""""
InvalidArgumentError: Exception encountered when calling layer 'embedding_4' (type Embedding).

{{function_node __wrapped__ResourceGather_device_/job:localhost/replica:0/task:0/device:CPU:0}} indices[0] = 64 is not in [0, 64) [Op:ResourceGather] name: 
""""""
```


### Relevant log output

_No response_",True
The Depthwise Convolution operation result is incorrect from interpreter stat:awaiting response type:bug comp:lite TFLiteConverter TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 18.04

### Mobile device

_No response_

### Python version

3.8

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I am testing network inference using Interpreter for the '.tflite'  that supports dynamic input shape.

However, the operational results of Depthwise Convolution are different from what was expected.

I simply reproduced the issue.

### Standalone code to reproduce the issue

```shell
https://colab.research.google.com/drive/1WCOZBuWTYU7kn4EcjHHrG_fZm7mZcojN?usp=drive_link
```


### Relevant log output

```shell
# input : Inputs corresponding to output [0, 31, 33, 24] 
0) input[0, 61:64, 65:68, 24] 
[[0.978893   0.03620292 0.9301994 ]
 [0.34403667 0.4492776  0.8247143 ]
 [0.8075199  0.77361435 0.1642472 ]]

# weight: corresponding to output [0, 31, 33, 24]
1) weight[..., :24]
[[[ 0.09494528 -0.0925059   0.07752301]
  [-0.07614094  0.06238136 -0.03187032]
  [ 0.06566823  0.09477414 -0.05954333]]]

# bias: corresponding to output [0, 31, 33, 24]
2) bias[24]
0.024211471900343895

# tflite output: Interpreter result
# test output: Formula result of Depthwise Convolution
3) Deptwise Convoultion output
tflite output[0, 31, 33, 24] : 0.0
test output[0, 31, 33, 24]: 0.2780301570892334
```
",True
Training Vanilla Transformer on TPU gives InternalError type:bug comp:tpus TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 22.04.2 (Google Colab)

### Mobile device

Colab

### Python version

3.10.12

### Bazel version

Colab

### GCC/compiler version

Colab

### CUDA/cuDNN version

Colab

### GPU model and memory

Colab

### Current behavior?

Training Transformer model on TPU gives Internal Error 

I have some idea on the error that there's a incompatible tensor ops thats causing the problem but i can't pinpoint it.

I had already done a bigger model which is using pretrained embeddings and it went off without a hitch i tried to replicate the same but with different tfds dataset

If this is already solved please direct me to the relevant links

### Standalone code to reproduce the issue

```
[This is the notebook](https://colab.research.google.com/drive/1y3VEuaYXnsoB42TaVd8UBB-18U8UHFBt#scrollTo=Y0hKZ9yRC3FU)

[This notebook worked fine](https://colab.research.google.com/drive/1DJU058LhhyCfNsuHZ74kZ0E2ziHw-VYo)

Thankyou in advance. I will respond asap
```


### Relevant log output

```shell
---------------------------------------------------------------------------
InternalError                             Traceback (most recent call last)
[<ipython-input-12-013fa12d9e3a>](https://localhost:8080/#) in <cell line: 1>()
----> 1 model.fit(
      2     train_ds,
      3     validation_data=valid_ds,
      4     epochs=EPOCHS,
      5     steps_per_epoch=train_steps,

1 frames
[/usr/local/lib/python3.10/dist-packages/keras/src/utils/traceback_utils.py](https://localhost:8080/#) in error_handler(*args, **kwargs)
     68             # To get the full stack trace, call:
     69             # `tf.debugging.disable_traceback_filtering()`
---> 70             raise e.with_traceback(filtered_tb) from None
     71         finally:
     72             del filtered_tb

[/usr/local/lib/python3.10/dist-packages/tensorflow/core/function/capture/capture_container.py](https://localhost:8080/#) in capture_by_value(self, graph, tensor, name)
    120         graph_const = self.by_val_internal.get(id(tensor))
    121         if graph_const is None:
--> 122           graph_const = tensor._capture_as_const(name)  # pylint: disable=protected-access
    123           if graph_const is None:
    124             # Some eager tensors, e.g. parallel tensors, are not convertible to

InternalError: failed to connect to all addresses; last error: UNKNOWN: ipv4:127.0.0.1:35437: Failed to connect to remote host: Connection refused
Additional GRPC error information from remote target /job:localhost/replica:0/task:0/device:CPU:0:
:UNKNOWN:failed to connect to all addresses; last error: UNKNOWN: ipv4:127.0.0.1:35437: Failed to connect to remote host: Connection refused {created_time:""2023-09-19T08:56:09.694479753+00:00"", grpc_status:14}
Executing non-communication op <MultiDeviceIteratorInit> originally returned UnavailableError, and was replaced by InternalError to avoid invoking TF network error handling logic.
```
",True
How to compile tflite-runtime to include gpu part? type:bug comp:lite TF 2.13,"**System information**
- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 22.04.2 LTS
- TensorFlow installed from (source or binary): source
- TensorFlow version (or github SHA if from source): 2.13


**Provide the text output from tflite_convert**

```
SUBCOMMAND: # @XNNPACK//:operators [action 'Compiling src/operators/convolution-nchw.c', configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2, execution platform: @local_execution_config_platform//:platform]
(cd /root/.cache/bazel/_bazel_root/44af44c54090ffd8c730879fc5d7b491/execroot/org_tensorflow && \
  exec env - \
    LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/local/cuda/lib:/usr/local/lib/x86_64-linux-gnu:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/opt/conda/lib \
    PATH=/opt/bin:/opt/conda/bin:/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin \
    PWD=/proc/self/cwd \
    TF2_BEHAVIOR=1 \
  /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections -MD -MF bazel-out/k8-opt/bin/external/XNNPACK/_objs/operators/convolution-nchw.pic.d '-frandom-seed=bazel-out/k8-opt/bin/external/XNNPACK/_objs/operators/convolution-nchw.pic.o' -fPIC '-DXNN_IGNORED_PLATFORM_JIT=0' '-DXNN_LOG_LEVEL=0' -DPTHREADPOOL_NO_DEPRECATED_API '-DXNN_ENABLE_GEMM_M_SPECIALIZATION=1' '-DXNN_ENABLE_JIT=0' '-DXNN_ENABLE_ARM_FP16_SCALAR=0' '-DXNN_ENABLE_ARM_FP16_VECTOR=0' '-DXNN_ENABLE_ARM_BF16=0' '-DXNN_ENABLE_ARM_DOTPROD=0' '-DXNN_ENABLE_ASSEMBLY=1' '-DXNN_ENABLE_DWCONV_MULTIPASS=0' -iquote external/XNNPACK -iquote bazel-out/k8-opt/bin/external/XNNPACK -iquote external/pthreadpool -iquote bazel-out/k8-opt/bin/external/pthreadpool -iquote external/FXdiv -iquote bazel-out/k8-opt/bin/external/FXdiv -iquote external/FP16 -iquote bazel-out/k8-opt/bin/external/FP16 -iquote external/cpuinfo -iquote bazel-out/k8-opt/bin/external/cpuinfo -Ibazel-out/k8-opt/bin/external/pthreadpool/_virtual_includes/pthreadpool -Ibazel-out/k8-opt/bin/external/FXdiv/_virtual_includes/FXdiv -Ibazel-out/k8-opt/bin/external/FP16/_virtual_includes/FP16 -Ibazel-out/k8-opt/bin/external/cpuinfo/_virtual_includes/cpuinfo -isystem external/XNNPACK/include -isystem bazel-out/k8-opt/bin/external/XNNPACK/include -isystem external/XNNPACK/src -isystem bazel-out/k8-opt/bin/external/XNNPACK/src -isystem external/pthreadpool/include -isystem bazel-out/k8-opt/bin/external/pthreadpool/include -isystem external/FXdiv/include -isystem bazel-out/k8-opt/bin/external/FXdiv/include -isystem external/FP16/include -isystem bazel-out/k8-opt/bin/external/FP16/include -isystem external/cpuinfo/include -isystem bazel-out/k8-opt/bin/external/cpuinfo/include -isystem external/cpuinfo/src -isystem bazel-out/k8-opt/bin/external/cpuinfo/src -Wno-all -Wno-extra -Wno-deprecated -Wno-deprecated-declarations -Wno-ignored-attributes -Wno-array-bounds -Wunused-result '-Werror=unused-result' -Wswitch '-Werror=switch' '-Wno-error=unused-but-set-variable' -DAUTOLOAD_DYNAMIC_KERNELS -O3 '-march=native' -Iinclude -Isrc -Os '-std=c99' -O2 -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -c external/XNNPACK/src/operators/convolution-nchw.c -o bazel-out/k8-opt/bin/external/XNNPACK/_objs/operators/convolution-nchw.pic.o)
# Configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2
# Execution platform: @local_execution_config_platform//:platform
[1,222 / 1,232] 2 actions, 1 running
    Compiling absl/strings/internal/charconv_bigint.cc; 0s local
    [Prepa] Compiling src/operators/convolution-nchw.c
[1,222 / 1,232] 2 actions running
    Compiling absl/strings/internal/charconv_bigint.cc; 0s local
    Compiling src/operators/convolution-nchw.c; 0s local
SUBCOMMAND: # @com_google_absl//absl/time:time [action 'Compiling absl/time/format.cc', configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2, execution platform: @local_execution_config_platform//:platform]
(cd /root/.cache/bazel/_bazel_root/44af44c54090ffd8c730879fc5d7b491/execroot/org_tensorflow && \
  exec env - \
    LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/local/cuda/lib:/usr/local/lib/x86_64-linux-gnu:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/opt/conda/lib \
    PATH=/opt/bin:/opt/conda/bin:/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin \
    PWD=/proc/self/cwd \
    TF2_BEHAVIOR=1 \
  /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections '-std=c++0x' -MD -MF bazel-out/k8-opt/bin/external/com_google_absl/absl/time/_objs/time/format.pic.d '-frandom-seed=bazel-out/k8-opt/bin/external/com_google_absl/absl/time/_objs/time/format.pic.o' -fPIC -iquote external/com_google_absl -iquote bazel-out/k8-opt/bin/external/com_google_absl -Wno-all -Wno-extra -Wno-deprecated -Wno-deprecated-declarations -Wno-ignored-attributes -Wno-array-bounds -Wunused-result '-Werror=unused-result' -Wswitch '-Werror=switch' '-Wno-error=unused-but-set-variable' -DAUTOLOAD_DYNAMIC_KERNELS -O3 '-march=native' '-std=c++17' -Wall -Wextra -Wcast-qual -Wconversion-null -Wformat-security -Wmissing-declarations -Woverlength-strings -Wpointer-arith -Wundef -Wunused-local-typedefs -Wunused-result -Wvarargs -Wvla -Wwrite-strings -DNOMINMAX -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -c external/com_google_absl/absl/time/format.cc -o bazel-out/k8-opt/bin/external/com_google_absl/absl/time/_objs/time/format.pic.o)
# Configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2
# Execution platform: @local_execution_config_platform//:platform
[1,223 / 1,232] 2 actions, 1 running
    Compiling absl/strings/internal/charconv_bigint.cc; 0s local
    [Prepa] Compiling absl/time/format.cc
[1,223 / 1,232] 2 actions running
    Compiling absl/strings/internal/charconv_bigint.cc; 1s local
    Compiling absl/time/format.cc; 0s local
[1,224 / 1,232] 2 actions, 1 running
    Compiling absl/strings/internal/charconv_bigint.cc; 2s local
    [Scann] Compiling src/unpool-config.c
SUBCOMMAND: # @XNNPACK//:microkernel_configs [action 'Compiling src/unpool-config.c', configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2, execution platform: @local_execution_config_platform//:platform]
(cd /root/.cache/bazel/_bazel_root/44af44c54090ffd8c730879fc5d7b491/execroot/org_tensorflow && \
  exec env - \
    LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/local/cuda/lib:/usr/local/lib/x86_64-linux-gnu:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/opt/conda/lib \
    PATH=/opt/bin:/opt/conda/bin:/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin \
    PWD=/proc/self/cwd \
    TF2_BEHAVIOR=1 \
  /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections -MD -MF bazel-out/k8-opt/bin/external/XNNPACK/_objs/microkernel_configs/unpool-config.pic.d '-frandom-seed=bazel-out/k8-opt/bin/external/XNNPACK/_objs/microkernel_configs/unpool-config.pic.o' -fPIC '-DXNN_IGNORED_PLATFORM_JIT=0' '-DXNN_ENABLE_ARM_FP16_SCALAR=0' '-DXNN_ENABLE_ARM_FP16_VECTOR=0' '-DXNN_ENABLE_ARM_BF16=0' '-DXNN_ENABLE_ARM_DOTPROD=0' '-DXNN_ENABLE_ASSEMBLY=1' '-DXNN_ENABLE_DWCONV_MULTIPASS=0' '-DXNN_ENABLE_GEMM_M_SPECIALIZATION=1' '-DXNN_ENABLE_JIT=0' '-DXNN_LOG_LEVEL=0' -DPTHREADPOOL_NO_DEPRECATED_API -iquote external/XNNPACK -iquote bazel-out/k8-opt/bin/external/XNNPACK -iquote external/FXdiv -iquote bazel-out/k8-opt/bin/external/FXdiv -iquote external/pthreadpool -iquote bazel-out/k8-opt/bin/external/pthreadpool -iquote external/cpuinfo -iquote bazel-out/k8-opt/bin/external/cpuinfo -iquote external/FP16 -iquote bazel-out/k8-opt/bin/external/FP16 -Ibazel-out/k8-opt/bin/external/FXdiv/_virtual_includes/FXdiv -Ibazel-out/k8-opt/bin/external/pthreadpool/_virtual_includes/pthreadpool -Ibazel-out/k8-opt/bin/external/cpuinfo/_virtual_includes/cpuinfo -Ibazel-out/k8-opt/bin/external/FP16/_virtual_includes/FP16 -isystem external/XNNPACK/include -isystem bazel-out/k8-opt/bin/external/XNNPACK/include -isystem external/XNNPACK/src -isystem bazel-out/k8-opt/bin/external/XNNPACK/src -isystem external/FXdiv/include -isystem bazel-out/k8-opt/bin/external/FXdiv/include -isystem external/pthreadpool/include -isystem bazel-out/k8-opt/bin/external/pthreadpool/include -isystem external/cpuinfo/include -isystem bazel-out/k8-opt/bin/external/cpuinfo/include -isystem external/cpuinfo/src -isystem bazel-out/k8-opt/bin/external/cpuinfo/src -isystem external/FP16/include -isystem bazel-out/k8-opt/bin/external/FP16/include -Wno-all -Wno-extra -Wno-deprecated -Wno-deprecated-declarations -Wno-ignored-attributes -Wno-array-bounds -Wunused-result '-Werror=unused-result' -Wswitch '-Werror=switch' '-Wno-error=unused-but-set-variable' -DAUTOLOAD_DYNAMIC_KERNELS -O3 '-march=native' -Iinclude -Isrc '-std=c99' -O2 -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -c external/XNNPACK/src/unpool-config.c -o bazel-out/k8-opt/bin/external/XNNPACK/_objs/microkernel_configs/unpool-config.pic.o)
# Configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2
# Execution platform: @local_execution_config_platform//:platform
[1,224 / 1,232] 2 actions, 1 running
    Compiling absl/strings/internal/charconv_bigint.cc; 2s local
    [Prepa] Compiling src/unpool-config.c
SUBCOMMAND: # //tensorflow/lite/kernels:builtin_op_kernels [action 'Compiling tensorflow/lite/kernels/add.cc', configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2, execution platform: @local_execution_config_platform//:platform]
(cd /root/.cache/bazel/_bazel_root/44af44c54090ffd8c730879fc5d7b491/execroot/org_tensorflow && \
  exec env - \
    LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/local/cuda/lib:/usr/local/lib/x86_64-linux-gnu:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/opt/conda/lib \
    PATH=/opt/bin:/opt/conda/bin:/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin \
    PWD=/proc/self/cwd \
    TF2_BEHAVIOR=1 \
  /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections '-std=c++0x' -MD -MF bazel-out/k8-opt/bin/tensorflow/lite/kernels/_objs/builtin_op_kernels/add.pic.d '-frandom-seed=bazel-out/k8-opt/bin/tensorflow/lite/kernels/_objs/builtin_op_kernels/add.pic.o' -fPIC -DTFLITE_KERNEL_USE_XNNPACK -DPTHREADPOOL_NO_DEPRECATED_API '-DEIGEN_NEON_GEBP_NR=4' -DEIGEN_MPL2_ONLY '-DEIGEN_MAX_ALIGN_BYTES=64' '-DXNNPACK_DELEGATE_ENABLE_QS8=1' '-DXNNPACK_DELEGATE_ENABLE_QU8=1' '-DEIGEN_ALTIVEC_USE_CUSTOM_PACK=0' '-DEIGEN_USE_AVX512_GEMM_KERNELS=0' '-DXNN_IGNORED_PLATFORM_JIT=0' '-DXNN_LOG_LEVEL=0' '-DXNN_ENABLE_ARM_FP16_SCALAR=0' '-DXNN_ENABLE_ARM_FP16_VECTOR=0' '-DXNN_ENABLE_ARM_BF16=0' '-DXNN_ENABLE_ARM_DOTPROD=0' '-DXNN_ENABLE_GEMM_M_SPECIALIZATION=1' '-DXNN_ENABLE_JIT=0' '-DXNN_ENABLE_ASSEMBLY=1' '-DXNN_ENABLE_DWCONV_MULTIPASS=0' '-DXNN_ENABLE_SPARSE=1' '-DXNN_ENABLE_MEMOPT=1' -iquote . -iquote bazel-out/k8-opt/bin -iquote external/ruy -iquote bazel-out/k8-opt/bin/external/ruy -iquote external/cpuinfo -iquote bazel-out/k8-opt/bin/external/cpuinfo -iquote external/gemmlowp -iquote bazel-out/k8-opt/bin/external/gemmlowp -iquote external/pthreadpool -iquote bazel-out/k8-opt/bin/external/pthreadpool -iquote external/FXdiv -iquote bazel-out/k8-opt/bin/external/FXdiv -iquote external/arm_neon_2_x86_sse -iquote bazel-out/k8-opt/bin/external/arm_neon_2_x86_sse -iquote external/eigen_archive -iquote bazel-out/k8-opt/bin/external/eigen_archive -iquote external/flatbuffers -iquote bazel-out/k8-opt/bin/external/flatbuffers -iquote external/fft2d -iquote bazel-out/k8-opt/bin/external/fft2d -iquote external/XNNPACK -iquote bazel-out/k8-opt/bin/external/XNNPACK -iquote external/FP16 -iquote bazel-out/k8-opt/bin/external/FP16 -iquote external/com_google_absl -iquote bazel-out/k8-opt/bin/external/com_google_absl -iquote external/nsync -iquote bazel-out/k8-opt/bin/external/nsync -iquote external/com_google_protobuf -iquote bazel-out/k8-opt/bin/external/com_google_protobuf -iquote external/zlib -iquote bazel-out/k8-opt/bin/external/zlib -iquote external/farmhash_archive -iquote bazel-out/k8-opt/bin/external/farmhash_archive -Ibazel-out/k8-opt/bin/external/cpuinfo/_virtual_includes/cpuinfo -Ibazel-out/k8-opt/bin/external/pthreadpool/_virtual_includes/pthreadpool -Ibazel-out/k8-opt/bin/external/FXdiv/_virtual_includes/FXdiv -Ibazel-out/k8-opt/bin/external/flatbuffers/_virtual_includes/flatbuffers -Ibazel-out/k8-opt/bin/external/flatbuffers/src/_virtual_includes/flatbuffers -Ibazel-out/k8-opt/bin/external/flatbuffers/_virtual_includes/runtime_cc -Ibazel-out/k8-opt/bin/external/FP16/_virtual_includes/FP16 -isystem external/cpuinfo/include -isystem bazel-out/k8-opt/bin/external/cpuinfo/include -isystem external/cpuinfo/src -isystem bazel-out/k8-opt/bin/external/cpuinfo/src -isystem external/pthreadpool/include -isystem bazel-out/k8-opt/bin/external/pthreadpool/include -isystem external/FXdiv/include -isystem bazel-out/k8-opt/bin/external/FXdiv/include -isystem third_party/eigen3/mkl_include -isystem bazel-out/k8-opt/bin/third_party/eigen3/mkl_include -isystem external/eigen_archive -isystem bazel-out/k8-opt/bin/external/eigen_archive -isystem tensorflow/lite/schema -isystem bazel-out/k8-opt/bin/tensorflow/lite/schema -isystem tensorflow/lite/experimental/acceleration/configuration -isystem bazel-out/k8-opt/bin/tensorflow/lite/experimental/acceleration/configuration -isystem external/XNNPACK/include -isystem bazel-out/k8-opt/bin/external/XNNPACK/include -isystem external/XNNPACK/src -isystem bazel-out/k8-opt/bin/external/XNNPACK/src -isystem external/FP16/include -isystem bazel-out/k8-opt/bin/external/FP16/include -isystem external/nsync/public -isystem bazel-out/k8-opt/bin/external/nsync/public -isystem external/com_google_protobuf/src -isystem bazel-out/k8-opt/bin/external/com_google_protobuf/src -isystem external/zlib -isystem bazel-out/k8-opt/bin/external/zlib -isystem external/farmhash_archive/src -isystem bazel-out/k8-opt/bin/external/farmhash_archive/src -Wno-all -Wno-extra -Wno-deprecated -Wno-deprecated-declarations -Wno-ignored-attributes -Wno-array-bounds -Wunused-result '-Werror=unused-result' -Wswitch '-Werror=switch' '-Wno-error=unused-but-set-variable' -DAUTOLOAD_DYNAMIC_KERNELS -O3 '-march=native' '-std=c++17' -DFARMHASH_NO_CXX_STRING -msse4.2 -O3 -fno-exceptions '-Wno-error=reorder' -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -c tensorflow/lite/kernels/add.cc -o bazel-out/k8-opt/bin/tensorflow/lite/kernels/_objs/builtin_op_kernels/add.pic.o)
# Configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2
# Execution platform: @local_execution_config_platform//:platform
[1,225 / 1,232] 2 actions, 1 running
    Compiling absl/strings/internal/charconv_bigint.cc; 2s local
    [Prepa] Compiling tensorflow/lite/kernels/add.cc
SUBCOMMAND: # //tensorflow/lite:stderr_reporter [action 'Compiling tensorflow/lite/stderr_reporter.cc', configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2, execution platform: @local_execution_config_platform//:platform]
(cd /root/.cache/bazel/_bazel_root/44af44c54090ffd8c730879fc5d7b491/execroot/org_tensorflow && \
  exec env - \
    LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/local/cuda/lib:/usr/local/lib/x86_64-linux-gnu:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/opt/conda/lib \
    PATH=/opt/bin:/opt/conda/bin:/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin \
    PWD=/proc/self/cwd \
    TF2_BEHAVIOR=1 \
  /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections '-std=c++0x' -MD -MF bazel-out/k8-opt/bin/tensorflow/lite/_objs/stderr_reporter/stderr_reporter.pic.d '-frandom-seed=bazel-out/k8-opt/bin/tensorflow/lite/_objs/stderr_reporter/stderr_reporter.pic.o' -fPIC -DTFLITE_KERNEL_USE_XNNPACK -iquote . -iquote bazel-out/k8-opt/bin -Wno-all -Wno-extra -Wno-deprecated -Wno-deprecated-declarations -Wno-ignored-attributes -Wno-array-bounds -Wunused-result '-Werror=unused-result' -Wswitch '-Werror=switch' '-Wno-error=unused-but-set-variable' -DAUTOLOAD_DYNAMIC_KERNELS -O3 '-march=native' '-std=c++17' -DFARMHASH_NO_CXX_STRING -msse4.2 -O3 -fno-exceptions -Wall -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -c tensorflow/lite/stderr_reporter.cc -o bazel-out/k8-opt/bin/tensorflow/lite/_objs/stderr_reporter/stderr_reporter.pic.o)
# Configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2
# Execution platform: @local_execution_config_platform//:platform
[1,226 / 1,232] 2 actions, 1 running
    Compiling tensorflow/lite/kernels/add.cc; 0s local
    [Prepa] Compiling tensorflow/lite/stderr_reporter.cc
SUBCOMMAND: # @com_google_absl//absl/strings:cord [action 'Compiling absl/strings/cord.cc', configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2, execution platform: @local_execution_config_platform//:platform]
(cd /root/.cache/bazel/_bazel_root/44af44c54090ffd8c730879fc5d7b491/execroot/org_tensorflow && \
  exec env - \
    LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/local/cuda/lib:/usr/local/lib/x86_64-linux-gnu:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/opt/conda/lib \
    PATH=/opt/bin:/opt/conda/bin:/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin \
    PWD=/proc/self/cwd \
    TF2_BEHAVIOR=1 \
  /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections '-std=c++0x' -MD -MF bazel-out/k8-opt/bin/external/com_google_absl/absl/strings/_objs/cord/cord.pic.d '-frandom-seed=bazel-out/k8-opt/bin/external/com_google_absl/absl/strings/_objs/cord/cord.pic.o' -fPIC -iquote external/com_google_absl -iquote bazel-out/k8-opt/bin/external/com_google_absl -Wno-all -Wno-extra -Wno-deprecated -Wno-deprecated-declarations -Wno-ignored-attributes -Wno-array-bounds -Wunused-result '-Werror=unused-result' -Wswitch '-Werror=switch' '-Wno-error=unused-but-set-variable' -DAUTOLOAD_DYNAMIC_KERNELS -O3 '-march=native' '-std=c++17' -Wall -Wextra -Wcast-qual -Wconversion-null -Wformat-security -Wmissing-declarations -Woverlength-strings -Wpointer-arith -Wundef -Wunused-local-typedefs -Wunused-result -Wvarargs -Wvla -Wwrite-strings -DNOMINMAX -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -c external/com_google_absl/absl/strings/cord.cc -o bazel-out/k8-opt/bin/external/com_google_absl/absl/strings/_objs/cord/cord.pic.o)
# Configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2
# Execution platform: @local_execution_config_platform//:platform
[1,227 / 1,232] 2 actions, 1 running
    Compiling tensorflow/lite/kernels/add.cc; 0s local
    [Prepa] Compiling absl/strings/cord.cc
[1,227 / 1,232] 2 actions running
    Compiling tensorflow/lite/kernels/add.cc; 0s local
    Compiling absl/strings/cord.cc; 0s local
[1,227 / 1,232] 2 actions running
    Compiling tensorflow/lite/kernels/add.cc; 1s local
    Compiling absl/strings/cord.cc; 1s local
[1,227 / 1,232] 2 actions running
    Compiling tensorflow/lite/kernels/add.cc; 2s local
    Compiling absl/strings/cord.cc; 2s local
[1,227 / 1,232] 2 actions running
    Compiling tensorflow/lite/kernels/add.cc; 3s local
    Compiling absl/strings/cord.cc; 3s local
[1,227 / 1,232] 2 actions running
    Compiling tensorflow/lite/kernels/add.cc; 4s local
    Compiling absl/strings/cord.cc; 4s local
[1,228 / 1,232] 2 actions, 1 running
    Compiling tensorflow/lite/kernels/add.cc; 5s local
    [Scann] Compiling src/google/protobuf/stubs/statusor.cc
SUBCOMMAND: # @com_google_protobuf//:protobuf_lite [action 'Compiling src/google/protobuf/stubs/statusor.cc', configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2, execution platform: @local_execution_config_platform//:platform]
(cd /root/.cache/bazel/_bazel_root/44af44c54090ffd8c730879fc5d7b491/execroot/org_tensorflow && \
  exec env - \
    LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/local/cuda/lib:/usr/local/lib/x86_64-linux-gnu:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/opt/conda/lib \
    PATH=/opt/bin:/opt/conda/bin:/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin \
    PWD=/proc/self/cwd \
    TF2_BEHAVIOR=1 \
  /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections '-std=c++0x' -MD -MF bazel-out/k8-opt/bin/external/com_google_protobuf/_objs/protobuf_lite/statusor.pic.d '-frandom-seed=bazel-out/k8-opt/bin/external/com_google_protobuf/_objs/protobuf_lite/statusor.pic.o' -fPIC -iquote external/com_google_protobuf -iquote bazel-out/k8-opt/bin/external/com_google_protobuf -isystem external/com_google_protobuf/src -isystem bazel-out/k8-opt/bin/external/com_google_protobuf/src -Wno-all -Wno-extra -Wno-deprecated -Wno-deprecated-declarations -Wno-ignored-attributes -Wno-array-bounds -Wunused-result '-Werror=unused-result' -Wswitch '-Werror=switch' '-Wno-error=unused-but-set-variable' -DAUTOLOAD_DYNAMIC_KERNELS -O3 '-march=native' '-std=c++17' -DHAVE_ZLIB -Woverloaded-virtual -Wno-sign-compare -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -c external/com_google_protobuf/src/google/protobuf/stubs/statusor.cc -o bazel-out/k8-opt/bin/external/com_google_protobuf/_objs/protobuf_lite/statusor.pic.o)
# Configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2
# Execution platform: @local_execution_config_platform//:platform
[1,228 / 1,232] 2 actions, 1 running
    Compiling tensorflow/lite/kernels/add.cc; 5s local
    [Prepa] Compiling src/google/protobuf/stubs/statusor.cc
[1,228 / 1,232] 2 actions running
    Compiling tensorflow/lite/kernels/add.cc; 6s local
    Compiling src/google/protobuf/stubs/statusor.cc; 0s local
[1,229 / 1,232] 2 actions, 1 running
    Compiling tensorflow/lite/kernels/add.cc; 6s local
    [Scann] Compiling absl/synchronization/internal/create_thread_identity.cc
SUBCOMMAND: # @com_google_absl//absl/synchronization:synchronization [action 'Compiling absl/synchronization/internal/create_thread_identity.cc', configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2, execution platform: @local_execution_config_platform//:platform]
(cd /root/.cache/bazel/_bazel_root/44af44c54090ffd8c730879fc5d7b491/execroot/org_tensorflow && \
  exec env - \
    LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/local/cuda/lib:/usr/local/lib/x86_64-linux-gnu:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/opt/conda/lib \
    PATH=/opt/bin:/opt/conda/bin:/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin \
    PWD=/proc/self/cwd \
    TF2_BEHAVIOR=1 \
  /usr/bin/gcc -U_FORTIFY_SOURCE -fstack-protector -Wall -Wunused-but-set-parameter -Wno-free-nonheap-object -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections '-std=c++0x' -MD -MF bazel-out/k8-opt/bin/external/com_google_absl/absl/synchronization/_objs/synchronization/create_thread_identity.pic.d '-frandom-seed=bazel-out/k8-opt/bin/external/com_google_absl/absl/synchronization/_objs/synchronization/create_thread_identity.pic.o' -fPIC -iquote external/com_google_absl -iquote bazel-out/k8-opt/bin/external/com_google_absl -Wno-all -Wno-extra -Wno-deprecated -Wno-deprecated-declarations -Wno-ignored-attributes -Wno-array-bounds -Wunused-result '-Werror=unused-result' -Wswitch '-Werror=switch' '-Wno-error=unused-but-set-variable' -DAUTOLOAD_DYNAMIC_KERNELS -O3 '-march=native' '-std=c++17' -Wall -Wextra -Wcast-qual -Wconversion-null -Wformat-security -Wmissing-declarations -Woverlength-strings -Wpointer-arith -Wundef -Wunused-local-typedefs -Wunused-result -Wvarargs -Wvla -Wwrite-strings -DNOMINMAX -fno-canonical-system-headers -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -c external/com_google_absl/absl/synchronization/internal/create_thread_identity.cc -o bazel-out/k8-opt/bin/external/com_google_absl/absl/synchronization/_objs/synchronization/create_thread_identity.pic.o)
# Configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2
# Execution platform: @local_execution_config_platform//:platform
[1,229 / 1,232] 2 actions, 1 running
    Compiling tensorflow/lite/kernels/add.cc; 6s local
    [Prepa] Compiling absl/synchronization/internal/create_thread_identity.cc
[1,229 / 1,232] 2 actions running
    Compiling tensorflow/lite/kernels/add.cc; 6s local
    Compiling .../synchronization/internal/create_thread_identity.cc; 0s local
[1,230 / 1,232] Compiling tensorflow/lite/kernels/add.cc; 7s local
[1,230 / 1,232] Compiling tensorflow/lite/kernels/add.cc; 9s local
[1,230 / 1,232] Compiling tensorflow/lite/kernels/add.cc; 10s local
[1,230 / 1,232] Compiling tensorflow/lite/kernels/add.cc; 11s local
[1,231 / 1,232] [Prepa] ...r_wrapper:_pywrap_tensorflow_interpreter_wrapper.so
SUBCOMMAND: # //tensorflow/lite/python/interpreter_wrapper:_pywrap_tensorflow_interpreter_wrapper.so [action 'Linking tensorflow/lite/python/interpreter_wrapper/_pywrap_tensorflow_interpreter_wrapper.so', configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2, execution platform: @local_execution_config_platform//:platform]
(cd /root/.cache/bazel/_bazel_root/44af44c54090ffd8c730879fc5d7b491/execroot/org_tensorflow && \
  exec env - \
    LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/local/cuda/lib:/usr/local/lib/x86_64-linux-gnu:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/usr/local/nvidia/lib:/usr/local/nvidia/lib64:/opt/conda/lib \
    PATH=/opt/bin:/opt/conda/bin:/usr/local/nvidia/bin:/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin \
    PWD=/proc/self/cwd \
    TF2_BEHAVIOR=1 \
  /usr/bin/gcc @bazel-out/k8-opt/bin/tensorflow/lite/python/interpreter_wrapper/_pywrap_tensorflow_interpreter_wrapper.so-2.params)
# Configuration: 6bf13bb09c259727d5061837858294f1092bec30d275f05710212182ee5e1ce2
# Execution platform: @local_execution_config_platform//:platform
[1,231 / 1,232] [Prepa] ...r_wrapper:_pywrap_tensorflow_interpreter_wrapper.so
[1,231 / 1,232] ...wrapper:_pywrap_tensorflow_interpreter_wrapper.so; 0s local
Target //tensorflow/lite/python/interpreter_wrapper:_pywrap_tensorflow_interpreter_wrapper up-to-date (nothing to build)
[1,232 / 1,232] checking cached actions
INFO: Elapsed time: 1504.620s, Critical Path: 75.80s
[1,232 / 1,232] checking cached actions
INFO: 1232 processes: 204 internal, 1028 local.
[1,232 / 1,232] checking cached actions
INFO: Build completed successfully, 1232 total actions
INFO: Build completed successfully, 1232 total actions
+ cp /kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/../../../../bazel-bin/tensorflow/lite/python/interpreter_wrapper/_pywrap_tensorflow_interpreter_wrapper.so /kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime
+ chmod u+w /kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime/_pywrap_tensorflow_interpreter_wrapper.so
+ cd /kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3
+ case ""${TENSORFLOW_TARGET}"" in
+ [[ -n '' ]]
+ python3 setup.py bdist bdist_wheel
/opt/conda/lib/python3.10/site-packages/setuptools/_distutils/cmd.py:66: SetuptoolsDeprecationWarning: setup.py install is deprecated.
!!

        ********************************************************************************
        Please avoid running ``setup.py`` directly.
        Instead, use pypa/build, pypa/installer or other
        standards-based tools.

        See https://blog.ganssle.io/articles/2021/10/setup-py-deprecated.html for details.
        ********************************************************************************

!!
  self.initialize_options()
/opt/conda/lib/python3.10/site-packages/setuptools/_distutils/dist.py:947: SetuptoolsDeprecationWarning: setup.py install is deprecated.
!!

        ********************************************************************************
        Please avoid running ``setup.py`` directly.
        Instead, use pypa/build, pypa/installer or other
        standards-based tools.

        See https://blog.ganssle.io/articles/2021/10/setup-py-deprecated.html for details.
        ********************************************************************************

!!
  command.initialize_options()
+ echo 'Output can be found here:'
Output can be found here:
+ find /kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/MANIFEST.in
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/dist
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/dist/tflite-runtime-2.13.0.linux-x86_64.tar.gz
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/dist/tflite_runtime-2.13.0-cp310-cp310-linux_x86_64.whl
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/build
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/build/bdist.linux-x86_64
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/build/lib.linux-x86_64-cpython-310
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/build/lib.linux-x86_64-cpython-310/tflite_runtime
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/build/lib.linux-x86_64-cpython-310/tflite_runtime/_pywrap_tensorflow_interpreter_wrapper.so
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/build/lib.linux-x86_64-cpython-310/tflite_runtime/metrics_interface.py
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/build/lib.linux-x86_64-cpython-310/tflite_runtime/__init__.py
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/build/lib.linux-x86_64-cpython-310/tflite_runtime/interpreter.py
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/build/lib.linux-x86_64-cpython-310/tflite_runtime/metrics_portable.py
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/debian
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/debian/changelog
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/debian/copyright
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/debian/rules
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/debian/control
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/debian/compat
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/interpreter_wrapper
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/interpreter_wrapper/numpy.cc
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/interpreter_wrapper/interpreter_wrapper.h
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/interpreter_wrapper/python_utils.h
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/interpreter_wrapper/numpy.h
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/interpreter_wrapper/interpreter_wrapper_pybind11.cc
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/interpreter_wrapper/python_error_reporter.cc
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/interpreter_wrapper/python_error_reporter.h
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/interpreter_wrapper/python_utils.cc
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/interpreter_wrapper/interpreter_wrapper.cc
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/interpreter_wrapper/BUILD
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime.egg-info
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime.egg-info/PKG-INFO
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime.egg-info/dependency_links.txt
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime.egg-info/requires.txt
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime.egg-info/top_level.txt
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime.egg-info/SOURCES.txt
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime/_pywrap_tensorflow_interpreter_wrapper.so
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime/metrics_interface.py
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime/__init__.py
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime/interpreter.py
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/tflite_runtime/metrics_portable.py
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/setup.py
+ [[ '' != \y ]]
+ exit 0
total 7748
-rw-r--r-- 1 root root 3960944 Sep 19 03:23 tflite-runtime-2.13.0.linux-x86_64.tar.gz
-rw-r--r-- 1 root root 3966013 Sep 19 03:23 tflite_runtime-2.13.0-cp310-cp310-linux_x86_64.whl
/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/dist
Processing ./tflite_runtime-2.13.0-cp310-cp310-linux_x86_64.whl
Requirement already satisfied: numpy>=1.21.2 in /opt/conda/lib/python3.10/site-packages (from tflite-runtime==2.13.0) (1.23.5)
**Installing collected packages: tflite-runtime
Successfully installed tflite-runtime-2.13.0**
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
Cell In[5], line 17
     15 get_ipython().run_line_magic('cd', '/kaggle/working/tensorflow/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/dist/')
     16 get_ipython().system('pip install tflite_runtime-2.13.0-cp310-cp310-linux_x86_64.whl')
**---> 17 import tflite_runtime.interpreter as tflite**

File /opt/conda/lib/python3.10/site-packages/tflite_runtime/interpreter.py:33
     30   from tensorflow.python.util.tf_export import tf_export as _tf_export
     31 else:
     32   # This file is part of tflite_runtime package.
---> 33   from tflite_runtime import _pywrap_tensorflow_interpreter_wrapper as _interpreter_wrapper
     34   from tflite_runtime import metrics_portable as metrics
     36   def _tf_export(*x, **kwargs):

**ImportError: /opt/conda/lib/python3.10/site-packages/tflite_runtime/_pywrap_tensorflow_interpreter_wrapper.so: undefined symbol: _ZN6tflite29farthestpointsamplingLauncherEiiiPKfPfPi**
    
```

**Standalone code to reproduce the issue** 
I tried to add custom OP and built tflite-runtime with shim, see issue https://github.com/tensorflow/tensorflow/issues/61521.
And the custom OP includes some GPU code. 
I built tflite-runtime successfully and the installation seems successfully as well. 
But when tried to import tflite-runtime in python there raised errors about GPU API farthestpointsamplingLauncher. 
Missing the share library of GPU part?

[code and change]
https://github.com/kuangzy2011/tensorflow/blob/main/tensorflow/lite/kernels/shim/test_op/sampling_op.h
https://github.com/kuangzy2011/tensorflow/blob/main/tensorflow/lite/kernels/shim/test_op/sampling_tflite_op.cc
https://github.com/kuangzy2011/tensorflow/blob/main/tensorflow/lite/kernels/shim/test_op/sampling_tflite_op.h
https://github.com/kuangzy2011/tensorflow/blob/main/tensorflow/lite/kernels/shim/test_op/tf_sampling_gpu.cu.cc
https://github.com/kuangzy2011/tensorflow/blob/main/tensorflow/lite/kernels/shim/test_op/BUILD#L159
https://github.com/kuangzy2011/tensorflow/blob/main/tensorflow/lite/kernels/BUILD#L744

**Any other info / logs**

Include any logs or source code that would be helpful to diagnose the problem.
If including tracebacks, please include the full traceback. Large logs and files
should be attached.
",True
Results with error set when running tf.raw_ops.StatelessParameterizedTruncatedNormal stat:awaiting tensorflower type:bug comp:ops TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

22.04

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Maybe a better error message should be raised here? 
```
Error:<class 'tensorflow.python.framework.ops.EagerTensor'> returned a result with an error set
Error:<class 'tensorflow.python.framework.ops.EagerTensor'> returned a result with an error set
```

### Standalone code to reproduce the issue

```shell
results = dict()
import tensorflow as tf
import numpy as np
try:
  try:
    with tf.device('/CPU'):
      shape = []
      seed_0 = -0.28041645497635637
      seed_1 = -434
      seed = [seed_0,seed_1,]
      means = -382
      stddevs_tensor = tf.saturate_cast(tf.random.uniform([], minval=0, maxval=2, dtype=tf.int64), dtype=tf.uint64)
      stddevs = tf.identity(stddevs_tensor)
      minvals = []
      maxvals = []
      name_tensor = tf.random.uniform([], dtype=tf.bfloat16)
      name = tf.identity(name_tensor)
      out = tf.raw_ops.StatelessParameterizedTruncatedNormal(shape=shape,seed=seed,means=means,stddevs=stddevs,minvals=minvals,maxvals=maxvals,name=name,)
  except Exception as e:
    print(""Error:""+str(e))
  try:
    with tf.device('/GPU:0'):
      shape = []
      seed = [seed_0,seed_1,]
      stddevs = tf.identity(stddevs_tensor)
      stddevs = tf.cast(stddevs, tf.uint64)
      minvals = []
      maxvals = []
      name = tf.identity(name_tensor)
      name = tf.cast(name, tf.bfloat16)
      tf.raw_ops.StatelessParameterizedTruncatedNormal(shape=shape,seed=seed,means=means,stddevs=stddevs,minvals=minvals,maxvals=maxvals,name=name,)
  except Exception as e:
    print(""Error:""+str(e))
except Exception as e:
  print(""Error:""+str(e))

print(results)
```
```


### Relevant log output

```shell
2023-09-18 23:45:51.224040: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-09-18 23:45:51.345060: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-09-18 23:45:51.934234: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-09-18 23:45:51.934291: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-09-18 23:45:51.934301: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-09-18 23:45:52.423299: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:980] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-09-18 23:45:52.450695: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudnn.so.8'; dlerror: libcudnn.so.8: cannot open shared object file: No such file or directory
2023-09-18 23:45:52.450716: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1934] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2023-09-18 23:45:52.451038: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
Error:<class 'tensorflow.python.framework.ops.EagerTensor'> returned a result with an error set
Error:<class 'tensorflow.python.framework.ops.EagerTensor'> returned a result with an error set
{}
```
```
",True
FPE in BatchMatMul stat:awaiting response type:bug stale comp:lite TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.14.0

### Custom code

Yes

### OS platform and distribution

Ubuntu 18.04.6

### Mobile device

_No response_

### Python version

Python 3.8.3

### Bazel version

bazel 5.3.0

### GCC/compiler version

gcc 7.5.0

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?
Construct a malicious BatchMatMul operator model with a shape of 4x0x0x0. 
The `input_shape.Dims(i)`  variable may be equal to 0, leading to a division by zero error.
```cpp
// transpose_utils.cc
size_t Flatten(const RuntimeShape& input_shape,
               const RuntimeShape& output_shape, const TransposeParams& params,
               RuntimeShape* non_flatten_input_shape,
               RuntimeShape* non_flatten_output_shape,
               TransposeParams* non_flatten_params) {
  // Calculate the total size of non-flatten dimensions.
  int skip_dims_cnt = 0;
  size_t flat_size = input_shape.FlatSize();
  for (int i = 0; i < params.perm_count; ++i) {
    if (params.perm[i] == i) {
      flat_size /= input_shape.Dims(i);  // FPE
```
[BatchMatMul_FPE.zip](https://github.com/tensorflow/tensorflow/files/12655488/BatchMatMul_FPE.zip)


### Standalone code to reproduce the issue

```shell
When I use the benchmark tool for PoC validation, it causes the TensorFlow Lite inference process to be subjected to a DOS（coredump).


❯ ./benchmark_model --graph=../poc/BatchMatMul_FPE.tflite
INFO: STARTING!
INFO: Log parameter values verbosely: [0]
INFO: Graph: [../poc/BatchMatMul_FPE.tflite]
INFO: Loaded model ../poc/BatchMatMul_FPE.tflite
INFO: Created TensorFlow Lite XNNPACK delegate for CPU.
INFO: The input model file size (MB): 0.0006
INFO: Initialized session in 155.728ms.
INFO: Running benchmark for at least 1 iterations and at least 0.5 seconds but terminate if exceeding 150 seconds.
[1]    26298 floating point exception (core dumped)  ./benchmark_model --graph=../poc/BatchMatMul_FPE.tflite
```
```


### Relevant log output

_No response_",True
module 'tensorflow.python.distribute.input_lib' has no attribute 'DistributedDatasetInterface' stat:awaiting response type:bug stale comp:apis TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

Google Colab

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Very new to coding so am unfamiliar with what to say. I used tensor flow to run a model to find the best fitted line. Last week the model run perfectly. This week the script incurs an error upon running the model. Ran a script that was even older and incurred that same problem.

Had read that the issue is to do with conflict between _tensorflow_ and _keras_ but I don't understand what that means with relation to my code. 

I also read not to use the term 'python' when importing a library.

from tensorflow.**python**.keras.models import Sequential

I have to use 'python' as part of the syntax as google colab reports this message if I don't 
_Import ""tensorflow.keras.models"" could not be resolved(reportMissingImports)_

Is this something to so with my google colab environment? I updated tensorflow to the latest version but the problem still exists. 

I have no idea what to do and am quite stuck.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf

from tensorflow.python.keras.models import Sequential
from tensorflow.python.keras.layers import Dense
from tensorflow.python.keras.activations import linear
from tensorflow.python.keras.optimizers import adam_v2
from tensorflow.python.keras.losses import MeanSquaredError

x = [ [23], [45], [78], [12]]
y = [ [12], [22], [36], [6]]

model = Sequential([
    tf.keras.layers.Dense(units=25, activation='relu', name='layer1'),
    tf.keras.layers.Dense(input_shape=(25,), units=15, activation='relu', name='layer2'),
    tf.keras.layers.Dense(input_shape=(15,), units=1, activation='linear', name='layer3')
] ,name=""Model1""
)

loss=MeanSquaredError()
opt=adam_v2.Adam(learning_rate=0.001)

model.compile(
    loss=loss,
    optimizer=opt
    )
model.fit(x, y, epochs=100)
```


### Relevant log output

```shell
AttributeError                            Traceback (most recent call last)
<ipython-input-27-a1b963ff7586> in <cell line: 26>()
     24     optimizer=opt
     25     )
---> 26 model.fit(x, y, epochs=100)

6 frames
/usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/training.py in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)
   1136          training_utils.RespectCompiledTrainableState(self):
   1137       # Creates a `tf.data.Dataset` and handles batch and epoch iteration.
-> 1138       data_handler = data_adapter.get_data_handler(
   1139           x=x,
   1140           y=y,

/usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/data_adapter.py in get_data_handler(*args, **kwargs)
   1396   if getattr(kwargs[""model""], ""_cluster_coordinator"", None):
   1397     return _ClusterCoordinatorDataHandler(*args, **kwargs)
-> 1398   return DataHandler(*args, **kwargs)
   1399 
   1400 

/usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/data_adapter.py in __init__(self, x, y, sample_weight, batch_size, steps_per_epoch, initial_epoch, epochs, shuffle, class_weight, max_queue_size, workers, use_multiprocessing, model, steps_per_execution, distribute)
   1150       self._steps_per_execution_value = steps_per_execution.numpy().item()
   1151 
-> 1152     adapter_cls = select_data_adapter(x, y)
   1153     self._adapter = adapter_cls(
   1154         x,

/usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/data_adapter.py in select_data_adapter(x, y)
    986 def select_data_adapter(x, y):
    987   """"""Selects a data adapter than can handle a given x and y.""""""
--> 988   adapter_cls = [cls for cls in ALL_ADAPTER_CLS if cls.can_handle(x, y)]
    989   if not adapter_cls:
    990     # TODO(scottzhu): This should be a less implementation-specific error.

/usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/data_adapter.py in <listcomp>(.0)
    986 def select_data_adapter(x, y):
    987   """"""Selects a data adapter than can handle a given x and y.""""""
--> 988   adapter_cls = [cls for cls in ALL_ADAPTER_CLS if cls.can_handle(x, y)]
    989   if not adapter_cls:
    990     # TODO(scottzhu): This should be a less implementation-specific error.

/usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/data_adapter.py in can_handle(x, y)
    705   def can_handle(x, y=None):
    706     return (isinstance(x, (data_types.DatasetV1, data_types.DatasetV2)) or
--> 707             _is_distributed_dataset(x))
    708 
    709   def __init__(self,

/usr/local/lib/python3.10/dist-packages/tensorflow/python/keras/engine/data_adapter.py in _is_distributed_dataset(ds)
   1697 
   1698 def _is_distributed_dataset(ds):
-> 1699   return isinstance(ds, input_lib.DistributedDatasetInterface)

AttributeError: module 'tensorflow.python.distribute.input_lib' has no attribute 'DistributedDatasetInterface'
```
",True
TFLite inference order is not the same as TensorFlow model stat:awaiting response type:bug stale comp:lite TFLiteConverter TF 2.13,"### 1. System information

- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): MacOS
- TensorFlow installation (pip package or built from source): pip
- TensorFlow library (version, if pip package or github SHA, if built from source): 2.13.0

### 2. Code

This is a custom depth-first inference layer, I try it using a (1, 7, 7, 4) tensor, the output is the same as the two layer cnn model and the output size is (1, 3, 3, 1).

```
create_conv_layer1 = Conv2D(filters=4, kernel_size=(3, 3), activation='relu', trainable=False, kernel_initializer=tf.initializers.Constant(0.5))
create_conv_layer2 = Conv2D(filters=1, kernel_size=(3, 3), activation='relu', trainable=False, kernel_initializer=tf.initializers.Constant(0.5))
```

```
class PatchBasedConv2D(Layer):
    def __init__(self, **kwargs):
        super(PatchBasedConv2D, self).__init__(**kwargs)
        self.layer_number = 2
        self.output_size = (3, 3, 1)
        self.expand_size = (1, 1)
        self.patch_stride = None
    
    @staticmethod
    def compute_last_patch_size(output_size, kernel_size, stride):
        input_height = (output_size[0] - 1) * stride[0] + kernel_size[0]
        input_width = (output_size[1] - 1) * stride[1] + kernel_size[1]
        return (input_height, input_width)
    
    def calculate_patch_count(self, input_size, patch_size, stride):
        return ((input_size[0] - patch_size[0]) // stride[0] + 1) * ((input_size[1] - patch_size[1]) // stride[1] + 1)
    
    def get_current_patch_possition(self, input_size, patch_size, stride, current_round):
        return ((current_round // ((input_size[1] - patch_size[1]) // stride[1] + 1)) * stride[0],
              (current_round % ((input_size[1] - patch_size[1]) // stride[1] + 1)) * stride[1])

    def build(self, input_shape):
        with tf.device('/CPU:0'):
            self.conv1 = create_conv_layer1
            self.conv2 = create_conv_layer2
            self.patch_size_tmp = self.compute_last_patch_size(self.expand_size, self.conv2.kernel_size, self.conv2.strides)
            self.patch_size = self.compute_last_patch_size(self.patch_size_tmp, self.conv1.kernel_size, self.conv1.strides)
            self.patch_stride = self.conv1.strides

    def call(self, inputs):
        if self.conv1.padding == 'same':
            inputs = tf.pad(inputs, [[0, 0], [1, 1], [1, 1], [0, 0]], mode='CONSTANT')
            
        num_patch = self.calculate_patch_count((inputs.shape[1], inputs.shape[2]), self.patch_size, self.patch_stride)
        
        number_patch_in_row = int(self.output_size[1] // self.expand_size[1])
        output_feature_map_tmp = None 
        output_feature_map = None
        
        for current_round in range(num_patch):
            position = get_current_patch_possition((inputs.shape[1], inputs.shape[2]), self.patch_size, self.patch_stride, current_round)
            patch_output = self.conv1(inputs[:, position[0]: position[0] + self.patch_size[0], position[1]: position[1] + self.patch_size[1], :])
            patch_output = self.conv2(patch_output)
            
            if output_feature_map_tmp is None:
                output_feature_map_tmp = patch_output
            else:
                output_feature_map_tmp = tf.concat([output_feature_map_tmp, patch_output], axis=2)
            
            if (current_round + 1) % number_patch_in_row == 0 and current_round != 0:
                if output_feature_map is None:
                    output_feature_map = output_feature_map_tmp
                else:
                    output_feature_map = tf.concat([output_feature_map, output_feature_map_tmp], axis=1)
                output_feature_map_tmp = None
        
        return output_feature_map
```

### 3. Failure after conversion
I am working on implementing depth-first inference on Tflite micro, above is my custom layer. You can see that in the call function, I picked out a patch of the input image and did 2 layers of Conv first, then went on to the next patch. It works just fine in my jupyter-notebook. However, when I convert it to tflite using TFLiteConverter, I found that it first expand all the patches, then do 2 Conv on all the patches. This turns out to be an inference layer-by-layer and uses up even more memory, why is that?


![截圖 2023-09-18 下午7 33 19](https://github.com/tensorflow/tensorflow/assets/68526411/e3768de1-b03f-44a8-8a61-51318c8b8f92)",True
tensorflow.tf concurrency issue type:bug comp:ops TF 2.11,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

unknown 2.11.0 (from nvcr.io/nvidia/tensorflow:23.03-tf2-py3))

### Custom code

Yes

### OS platform and distribution

Ubuntu 20.04.6 LTS

### Mobile device

_No response_

### Python version

3.8.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

cuda_12.1.r12.1/compiler.32415258_0

### GPU model and memory

_No response_

### Current behavior?

We found that running tensorflow.concat operation will have concurrency issue only in the Nvidia tensorflow image. We also tried with other image but the issue cannot reproduce.

We expect that tensorflow.concat work fine for multi-thread environment. But it's not. Is it expected? 
FYI, adding a lock for concat can avoid such issue. What's the best practice?

Our environment:
GPU: A100
image: nvcr.io/nvidia/tensorflow:23.03-tf2-py3
driver: NVIDIA-SMI 525.125.06   Driver Version: 525.125.06   CUDA Version: 12.0



### Standalone code to reproduce the issue

```shell
import tensorflow as tf
from concurrent.futures import ThreadPoolExecutor, as_completed

client_num = 10
repeat = 10000
executor = ThreadPoolExecutor(max_workers=client_num)
future_2_input_shapes = {}

# import threading
# lock = threading.Lock()

test_cases = [
    [[1, 2] * 31, [2, 3]],
    [[1, 2, 8, 90] * 31, [2, 3, 3, 1]],
    [[[7, 4, 3], [8, 4, 3]], [[2, 10, 3], [15, 11, 3]] * 63],
]


def do_concat(t1, t2):
    # with lock:
    #     return tf.concat([t1, t2], 0)
    return tf.concat([t1, t2], 0)


print(""creating task"")
for _ in range(repeat):
    for test_case in test_cases:
        a = tf.constant(test_case[0])
        b = tf.constant(test_case[1])
        future = executor.submit(do_concat, a, b)
        future_2_input_shapes[future] = a.shape, b.shape

print(""waiting task"")
count = 0
for future in as_completed(future_2_input_shapes.keys()):
    print(f""{count}: {future_2_input_shapes[future]}"")
    data = future.result()
    count = count + 1




```
```


### Relevant log output

```shell
...
17086: (TensorShape([62]), TensorShape([2]))
17087: (TensorShape([2, 3]), TensorShape([126, 3]))
17088: (TensorShape([124]), TensorShape([4]))
17089: (TensorShape([124]), TensorShape([4]))
17090: (TensorShape([2, 3]), TensorShape([126, 3]))
17091: (TensorShape([124]), TensorShape([4]))
17092: (TensorShape([2, 3]), TensorShape([126, 3]))
Traceback (most recent call last):
  File ""x.py"", line 37, in <module>
    data = future.result()
  File ""/usr/lib/python3.8/concurrent/futures/_base.py"", line 437, in result
    return self.__get_result()
  File ""/usr/lib/python3.8/concurrent/futures/_base.py"", line 389, in __get_result
    raise self._exception
  File ""/usr/lib/python3.8/concurrent/futures/thread.py"", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File ""x.py"", line 22, in do_concat
    return tf.concat([t1, t2], 0)
  File ""/usr/local/lib/python3.8/dist-packages/tensorflow/python/util/traceback_utils.py"", line 153, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File ""/usr/local/lib/python3.8/dist-packages/tensorflow/python/framework/ops.py"", line 7215, in raise_from_not_ok_status
    raise core._status_to_exception(e) from None  # pylint: disable=protected-access
tensorflow.python.framework.errors_impl.InvalidArgumentError: {{function_node __wrapped__ConcatV2_N_2_device_/job:localhost/replica:0/task:0/device:GPU:0}} ConcatOp : Ranks of all input tensors should match: shape[0] = [124] vs. shape[1] = [126,3] [Op:ConcatV2] name: concat
```
",True
Tensorflow failed build due to ImportError: DLL load failed while importing _pywrap_tensorflow_internal: A dynamic link library (DLL) initialization routine failed. stat:awaiting response type:bug type:build/install stale subtype:windows,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

master branch, commit: a442440

### Custom code

No

### OS platform and distribution

Windows Server 2022

### Mobile device

_No response_

### Python version

3.9

### Bazel version

6.3.2

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

ImportError: DLL load failed while importing _pywrap_tensorflow_internal: A dynamic link library (DLL) initialization routine failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""C:\Users\CPPTES~1\AppData\Local\Temp\2\Bazel.runfiles_pr3ptqbl\runfiles\org_tensorflow\tensorflow\python\tools\api\generator\create_python_api.py"", line 22, in <module>
    from tensorflow.python.tools.api.generator import doc_srcs
  File ""C:\Users\CPPTES~1\AppData\Local\Temp\2\Bazel.runfiles_pr3ptqbl\runfiles\org_tensorflow\tensorflow\python\__init__.py"", line 37, in <module>
    from tensorflow.python.tpu import api
  File ""C:\Users\CPPTES~1\AppData\Local\Temp\2\Bazel.runfiles_pr3ptqbl\runfiles\org_tensorflow\tensorflow\python\tpu\api.py"", line 22, in <module>
    from tensorflow.python.tpu import bfloat16
  File ""C:\Users\CPPTES~1\AppData\Local\Temp\2\Bazel.runfiles_pr3ptqbl\runfiles\org_tensorflow\tensorflow\python\tpu\bfloat16.py"", line 20, in <module>
    from tensorflow.python.framework import dtypes
  File ""C:\Users\CPPTES~1\AppData\Local\Temp\2\Bazel.runfiles_pr3ptqbl\runfiles\org_tensorflow\tensorflow\python\framework\dtypes.py"", line 28, in <module>
    from tensorflow.python import pywrap_tensorflow  # pylint: disable=unused-import
  File ""C:\Users\CPPTES~1\AppData\Local\Temp\2\Bazel.runfiles_pr3ptqbl\runfiles\org_tensorflow\tensorflow\python\pywrap_tensorflow.py"", line 77, in <module>
    raise ImportError(
ImportError: Traceback (most recent call last):
  File ""C:\Users\CPPTES~1\AppData\Local\Temp\2\Bazel.runfiles_pr3ptqbl\runfiles\org_tensorflow\tensorflow\python\pywrap_tensorflow.py"", line 62, in <module>
    from tensorflow.python._pywrap_tensorflow_internal import *
ImportError: DLL load failed while importing _pywrap_tensorflow_internal: A dynamic link library (DLL) initialization routine failed.


Failed to load the native TensorFlow runtime.
See https://www.tensorflow.org/install/errors for some common causes and solutions.
If you need help, create an issue at https://github.com/tensorflow/tensorflow/issues and include the entire stack trace above this error message.
Target //tensorflow/tools/pip_package:build_pip_package failed to build
ERROR: F:/tensorflow/tensorflow/tensorflow/tools/pip_package/BUILD:252:10 Middleman _middlemen/tensorflow_Stools_Spip_Upackage_Sbuild_Upip_Upackage.exe-runfiles failed: (Exit 1): bash.exe failed: error executing command (from target //tensorflow:tf_python_api_gen_v2)

### Standalone code to reproduce the issue

```shell
git clone https://github.com/tensorflow/tensorflow.git F:\Tensorflow\tensorflow
cd /d F:\Tensorflow\tensorflow
pip3 uninstall -r tensorflow/tools/ci_build/release/requirements_common.txt --yes
pip3 install -r tensorflow/tools/ci_build/release/requirements_common.txt --upgrade
set PATH=F:\Tensorflow\tensorflow\..\tools;%path%
set PATH=F:\Tensorflow\tensorflow\..\tools\msys64\usr\bin;%path%
yes """" 2>nul | python ./configure.py
C:\Python39\python.exe -m pip install --upgrade pip
set TF_PYTHON_VERSION=3.9
set BAZEL_VC=C:\Program Files\Microsoft Visual Studio\2022\Enterprise\VC
set BAZEL_VC_FULL_VERSION=14.37.32822
set PATH=F:\Tensorflow\tensorflow\..\tools;%path%
set PATH=F:\Tensorflow\tensorflow\..\tools\msys64\usr\bin;%path%
bazel --output_user_root F:\bazelTemp build --jobs 8 --config=opt --local_ram_resources=4096 --host_cxxopt=""/D_DISABLE_CONSTEXPR_MUTEX_CONSTRUCTOR"" --subcommands //tensorflow/tools/pip_package:build_pip_package
```


### Relevant log output

_No response_",True
Cast from int32 to float32 changes the value. stat:awaiting response type:bug stale comp:ops TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

 Here what I see is that the bug actually happens b/c as we are doing the conversion from int32 to float32 the value changes, as there is a rounding error that occurs when casting an integer to a floating-point type as float32 is not the high precision floating point type like float64, and the bug will also remain the same if we change them even to int64 from int32.

### Standalone code to reproduce the issue

```shell
> The code is below 
>> tf.cast(tf.constant(52479845, tf.int64), tf.float32)
<tf.Tensor: shape=(), dtype=float32, numpy=52479844.0>
>> tf.cast(tf.constant(52479843, tf.int64), tf.float32)
<tf.Tensor: shape=(), dtype=float32, numpy=52479843.0>
```


### Relevant log output

```shell
### Relevant log output

_No response_
```
",True
Cast from int32 to float32 changes the value. stat:awaiting response type:bug stale comp:ops TF 2.12,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

2.12.0 through tf-nightly (v1.12.1-99894-g5bef7ce6955 2.15.0-dev20230915)

### Custom code

Yes

### OS platform and distribution

nvcr.io/nvidia/tensorflow:23.07-tf2-py3 docker image

### Mobile device

_No response_

### Python version

3.10.6

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Casting some int32 values to float32 causes a change in value.

### Standalone code to reproduce the issue

```shell
>>> tf.cast(tf.constant(52479843, tf.int32), tf.float32)
<tf.Tensor: shape=(), dtype=float32, numpy=52479844.0>
>>> tf.cast(tf.constant(52479845, tf.int32), tf.float32)
<tf.Tensor: shape=(), dtype=float32, numpy=52479844.0>
```
```


### Relevant log output

_No response_",True
Fails to build on AARCH64 type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

git HEAD

### Custom code

No

### OS platform and distribution

Ubuntu 20.04

### Mobile device

n/a

### Python version

3.9.17

### Bazel version

6.1.0

### GCC/compiler version

16.0.6

### CUDA/cuDNN version

n/a

### GPU model and memory

n/a

### Current behavior?

/tensorflow/lite/kernels/rng_util.h:26:12: error: use of undeclared identifier 'uint32_t'

### Standalone code to reproduce the issue

```shell
bazel test --config=mkl_aarch64_threadpool --copt=-flax-vector-conversions --test_env=TF_ENABLE_ONEDNN_OPTS=1 --test_env=TF2_BEHAVIOR=1 --define=tf_api_version=2 --test_lang_filters=py --flaky_test_attempts=3 --test_size_filters=small,medium --test_output=errors --verbose_failures=true --test_keep_going --notest_verbose_timeout_warnings --action_env=PYTHON_BIN_PATH=/usr/local/bin/python3 --build_tag_filters=-no_oss,-oss_excluded,-oss_serial,-v1only,-benchmark-test,-no_aarch64,-gpu,-tpu,-no_oss_py39,-no_oss_py310 --test_tag_filters=-no_oss,-oss_excluded,-oss_serial,-v1only,-benchmark-test,-no_aarch64,-gpu,-tpu,-no_oss_py39,-no_oss_py310 --local_test_jobs=64 --build_tests_only -- //tensorflow/... -//tensorflow/compiler/tf2tensorrt/... -//tensorflow/compiler/xrt/... -//tensorflow/core/tpu/... -//tensorflow/go/... -//tensorflow/java/... -//tensorflow/python/integration_testing/... -//tensorflow/tools/toolchains/... -//tensorflow/lite/... -//tensorflow/core/kernels/image:resize_bicubic_op_test -//tensorflow/core/grappler/optimizers:auto_mixed_precision_test_cpu -//tensorflow/core/grappler/optimizers:remapper_test_cpu
```


### Relevant log output

```shell
ERROR: /workspace/tensorflow/lite/kernels/BUILD:497:11: Compiling tensorflow/lite/kernels/rng_util.cc failed: (Exit 1): clang failed: error executing command (from target //tensorflow/lite/kernels:rng_util) 
  (cd /tmpfs/bazel_output/_bazel_ubuntu/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow && \
  exec env - \
    CACHEBUSTER=20220325 \
    CLANG_COMPILER_PATH=/usr/lib/llvm-16/bin/clang \
    LD_LIBRARY_PATH='' \
    PATH=/home/ubuntu/actions-runner/_work/tensorflow/tensorflow/bazel-ci_build-cache/.cache/bazelisk/downloads/bazelbuild/bazel-6.1.0-linux-arm64/bin:/home/ubuntu/actions-runner/_work/tensorflow/tensorflow/bazel-ci_build-cache/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin \
    *** \
    PYTHON_BIN_PATH=/usr/local/bin/python3 \
    PYTHON_LIB_PATH=/usr/lib/python3/dist-packages \
    TF2_BEHAVIOR=1 \
  /usr/lib/llvm-16/bin/clang -MD -MF bazel-out/aarch64-opt/bin/tensorflow/lite/kernels/_objs/rng_util/rng_util.pic.d '-frandom-seed=bazel-out/aarch64-opt/bin/tensorflow/lite/kernels/_objs/rng_util/rng_util.pic.o' '-DBAZEL_CURRENT_REPOSITORY=""""' -iquote . -iquote bazel-out/aarch64-opt/bin -fmerge-all-constants -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -fPIC -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -Wno-invalid-partial-specialization -fno-omit-frame-pointer -no-canonical-prefixes -DNDEBUG -g0 -O2 -ffunction-sections -fdata-sections -Wno-all -Wno-extra -Wno-deprecated -Wno-deprecated-declarations -Wno-ignored-attributes -Wno-array-bounds -Wunused-result '-Werror=unused-result' -Wswitch '-Werror=switch' '-Wno-error=unused-but-set-variable' -DAUTOLOAD_DYNAMIC_KERNELS -Wno-gnu-offsetof-extensions -Wno-gnu-offsetof-extensions '-mtune=generic' '-march=armv8-a' -O3 -flax-vector-conversions '-std=c++17' -DFARMHASH_NO_CXX_STRING -DEIGEN_ALLOW_UNALIGNED_SCALARS -Wno-sign-compare -O3 -fno-exceptions '--sysroot=/dt10' -c tensorflow/lite/kernels/rng_util.cc -o bazel-out/aarch64-opt/bin/tensorflow/lite/kernels/_objs/rng_util/rng_util.pic.o)
# Configuration: 91cacbf6409fd17883ece1a0e16168e33815822fe5d36a44e64642fa9b0e32ee
# Execution platform: @local_execution_config_platform//:platform
In file included from tensorflow/lite/kernels/rng_util.cc:15:
./tensorflow/lite/kernels/rng_util.h:26:12: error: use of undeclared identifier 'uint32_t'
std::array<uint32_t, 2> Threefry2x32(uint32_t key_0, uint32_t key_1,
           ^
./tensorflow/lite/kernels/rng_util.h:26:38: error: unknown type name 'uint32_t'
std::array<uint32_t, 2> Threefry2x32(uint32_t key_0, uint32_t key_1,
                                     ^
./tensorflow/lite/kernels/rng_util.h:26:54: error: unknown type name 'uint32_t'
std::array<uint32_t, 2> Threefry2x32(uint32_t key_0, uint32_t key_1,
                                                     ^
./tensorflow/lite/kernels/rng_util.h:27:49: error: use of undeclared identifier 'uint32_t'
                                     std::array<uint32_t, 2> ctr);
                                                ^
./tensorflow/lite/kernels/rng_util.h:32:12: error: use of undeclared identifier 'uint32_t'
std::array<uint32_t, 4> Philox4x32(uint32_t key_0, uint32_t key_1,
           ^
./tensorflow/lite/kernels/rng_util.h:32:36: error: unknown type name 'uint32_t'
std::array<uint32_t, 4> Philox4x32(uint32_t key_0, uint32_t key_1,
                                   ^
./tensorflow/lite/kernels/rng_util.h:32:52: error: unknown type name 'uint32_t'
std::array<uint32_t, 4> Philox4x32(uint32_t key_0, uint32_t key_1,
                                                   ^
./tensorflow/lite/kernels/rng_util.h:33:47: error: use of undeclared identifier 'uint32_t'
                                   std::array<uint32_t, 4> ctr);
                                              ^
8 errors generated.
```
",True
Gather out-of-range read will return different value with `jit_compile` stat:awaiting tensorflower type:bug comp:ops comp:xla TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.15.0-dev20230914

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

When the index is out of range, `gather` will return different values with and without `jit_compile=True`.

The return values are expected to be consistent. Another solution is to throw errors in both cases.

### Standalone code to reproduce the issue

```shell
class Model(tf.keras.Model):

  def __init__(self):
    super(Model, self).__init__()

  @tf.function(jit_compile=True)
  def call(self, input):
    x = tf.gather(input, indices=[5, 8, 7, 16, 256, 123], axis=0) # 256 is out of range
    return x

m = Model()

input_shape = [256]
x1 = tf.ones(input_shape)

# Call model
y = m(x1)
print(y)
# tf.Tensor([1. 1. 1. 1. 1. 1.], shape=(6,), dtype=float32), with jit_compile=True
# tf.Tensor([1. 1. 1. 1. 0. 1.], shape=(6,), dtype=float32), without jit_compile=True
```


### Relevant log output

_No response_",True
Body function of `while_loop` cannot access the external variable after compilation  type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.15.0-dev20230914

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

The body function of `while_loop` cannot access the external variable after compilation. It will raise the error `UnboundLocalError: local variable 'x' referenced before assignment`

However, if I run the model without the `@tf.function(jit_compile=True)`, the model can be executed without any error.

### Standalone code to reproduce the issue

```shell
class Model(tf.keras.Model):

  def __init__(self):
    super(Model, self).__init__()

  @tf.function(jit_compile=True) # Comment this line, it will succeed
  def call(self, x):

    def cond(i, _):
      return i < 10

    def body(i, y):
      y = tf.math.add(y, 2.0)
      x = tf.math.multiply(x, 2.0)
      return [tf.math.subtract(i, 1), y + x]

    i = tf.constant(10)
    y = tf.constant(1.0)
    _, final_y = tf.while_loop(cond, body, [i, y], shape_invariants=[i.shape, y.shape])
    return final_y

m = Model()
input_shape = [1,2]
x = tf.constant([4.,5.], shape=input_shape)

y = m(x)
```


### Relevant log output

```shell
UnboundLocalError: Exception encountered when calling layer 'model_28' (type Model).

in user code:

    File ""<ipython-input-31-1eb50a9c2c75>"", line 16, in body  *
        x = tf.math.multiply(x, 2.0)

    UnboundLocalError: local variable 'x' referenced before assignment


Call arguments received by layer 'model_28' (type Model):
  • x=tf.Tensor(shape=(1, 2), dtype=float32)
```
",True
restoring checkpoint loads weights partially stat:awaiting response type:bug stale comp:keras TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 2.13.0

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I am following this [tfa seq2seq tutorial](https://www.tensorflow.org/addons/tutorials/networks_seq2seq_nmt) for building a seq2seq network with LSTMs. I trained my model and got great accuracy. I saved my model with `tf.train.Checkpoint`. Then, I tried to reload my model with `checkpoint.restore(tf.train.latest_checkpoint(checkpoint_dir))`. 

However, the model gets restored partially.

My encoder weights get restored, however the decoder does not.

How to resolve?

### Standalone code to reproduce the issue

```shell
from typing import Tuple

import tensorflow as tf
import tensorflow_addons as tfa

from tensorflow.keras.preprocessing.text import tokenizer_from_json

import json

import numpy as np

import unicodedata
import re
import os
import io
import time
from collections import Counter

MAX_SEQUENCE_LENGTH = 30

def math_tokenizer(expression):
    regex = r'(\d+|[\+\-\*\/\(\)\^]|[a-zA-Z]+|.)'

    # Use the regex to split the expression into tokens
    _tok = re.findall(regex, expression)

    # Split numbers into individual digits
    ret_tokens = []
    for token in _tok:
        if token.isdigit():
            ret_tokens.extend(list(token))
        else:
            ret_tokens.append(token)

    # Filter out empty strings
    ret_tokens = [token for token in ret_tokens if token.strip()]

    return ret_tokens

def change_variable(expression):
    # Define regular expressions to match different tokens
    tokenstream = math_tokenizer(expression)
    variable = None
    for idx, tok in enumerate(tokenstream):
        if len(tok) == 1 and tok.isalpha():
          variable = tok
          tokenstream[idx] = ""var""
    return ' '.join(tokenstream), variable

def text_cleaning(x):
  modified_text = [None] * len(x)
  tokens = set()
  tok_list = []

  variables = []

  for idx, dx in enumerate(x):
      lhs, rhs = dx.split(""="")
      tokenstream, v = change_variable('='.join([lhs[2:-4], rhs[:-1]]))
      tokens.update(tokenstream)
      tok_list.extend(tokenstream)
      variables.append(v)
      modified_text[idx] = ''.join(tokenstream)

  return modified_text, variables

def generate_train_test_dataset(data, TRAIN_SIZE):
  modified_text, variables = text_cleaning(data)
  inputs = []
  targets = []

  for idx, dx in enumerate(modified_text):
      inp, tgt = dx.split(""="")
      inputs.append(inp)
      targets.append(tgt)

  train_inputs = inputs[:TRAIN_SIZE]
  train_targets = targets[:TRAIN_SIZE]
  train_variables = variables[:TRAIN_SIZE]

  test_inputs = inputs[TRAIN_SIZE:]
  test_targets = targets[TRAIN_SIZE:]
  test_variables = variables[TRAIN_SIZE:]

  return train_inputs, train_targets, train_variables, test_inputs, test_targets, test_variables

  class MyDataset:
    def __init__(self, problem_type='calculus'):
        self.problem_type = 'calculus'
        self.inp_lang_tokenizer = None
        self.targ_lang_tokenizer = None


    def unicode_to_ascii(self, s):
        return ''.join(c for c in unicodedata.normalize('NFD', s) if unicodedata.category(c) != 'Mn')

    def preprocess_sentence(self, w):
        w = w.strip()

        w = 'start ' + w + ' end'
        return w

    def tokenize(self, lang, func):

        lang_tokenizer = tf.keras.preprocessing.text.Tokenizer(filters=None, oov_token='<OOV>', analyzer=func)
        lang_tokenizer.fit_on_texts(lang)

        tensor = lang_tokenizer.texts_to_sequences(lang)

        tensor = tf.keras.preprocessing.sequence.pad_sequences(tensor, padding='post')

        return tensor, lang_tokenizer

    def load_dataset(self, dataset, func):
        # creating cleaned input, output pairs
        targ_lang, inp_lang = dataset

        targ_lang = [self.preprocess_sentence(w) for w in targ_lang]
        inp_lang = [self.preprocess_sentence(w) for w in inp_lang]

        input_tensor, inp_lang_tokenizer = self.tokenize(inp_lang, func)
        target_tensor, targ_lang_tokenizer = self.tokenize(targ_lang, func)

        return input_tensor, target_tensor, inp_lang_tokenizer, targ_lang_tokenizer


    def call(self, dataset, BUFFER_SIZE, BATCH_SIZE, func):
        input_tensor, target_tensor, self.inp_lang_tokenizer, self.targ_lang_tokenizer = self.load_dataset(dataset, func)

        train_dataset = tf.data.Dataset.from_tensor_slices((input_tensor, target_tensor))
        train_dataset = train_dataset.shuffle(BUFFER_SIZE).batch(BATCH_SIZE, drop_remainder=True)

        return train_dataset, self.inp_lang_tokenizer, self.targ_lang_tokenizer

class Encoder(tf.keras.Model):
  def __init__(self, vocab_size, embedding_dim, enc_units, batch_sz):
    super(Encoder, self).__init__()
    self.batch_sz = batch_sz
    self.enc_units = enc_units
    self.embedding = tf.keras.layers.Embedding(vocab_size, embedding_dim)

    self.lstm_layer = tf.keras.layers.LSTM(self.enc_units,
                                   return_sequences=True,
                                   return_state=True,
                                   recurrent_initializer='glorot_uniform')


  def call(self, x, hidden):
    x = self.embedding(x)
    output, h, c = self.lstm_layer(x, initial_state = hidden)
    return output, h, c

  def initialize_hidden_state(self):
    return [tf.zeros((self.batch_sz, self.enc_units)), tf.zeros((self.batch_sz, self.enc_units))]

class Decoder(tf.keras.Model):
  def __init__(self, vocab_size, embedding_dim, dec_units, batch_sz, max_length_input, max_length_output, attention_type='luong'):
    super(Decoder, self).__init__()
    self.batch_sz = batch_sz
    self.dec_units = dec_units
    self.attention_type = attention_type
    self.max_length_output = max_length_output

    # Embedding Layer
    self.embedding = tf.keras.layers.Embedding(vocab_size, embedding_dim)

    #Final Dense layer on which softmax will be applied
    self.fc = tf.keras.layers.Dense(vocab_size)

    # Define the fundamental cell for decoder recurrent structure
    self.decoder_rnn_cell = tf.keras.layers.LSTMCell(self.dec_units)



    # Sampler
    self.sampler = tfa.seq2seq.sampler.TrainingSampler()

    # Create attention mechanism with memory = None
    self.attention_mechanism = self.build_attention_mechanism(self.dec_units,
                                                              None, self.batch_sz*[max_length_input], self.attention_type)

    # Wrap attention mechanism with the fundamental rnn cell of decoder
    self.rnn_cell = self.build_rnn_cell(batch_sz)

    # Define the decoder with respect to fundamental rnn cell
    self.decoder = tfa.seq2seq.BasicDecoder(self.rnn_cell, sampler=self.sampler, output_layer=self.fc)


  def build_rnn_cell(self, batch_sz):
    rnn_cell = tfa.seq2seq.AttentionWrapper(self.decoder_rnn_cell,
                                  self.attention_mechanism, attention_layer_size=self.dec_units)
    return rnn_cell

  def build_attention_mechanism(self, dec_units, memory, memory_sequence_length, attention_type='luong'):
    # ------------- #
    # typ: Which sort of attention (Bahdanau, Luong)
    # dec_units: final dimension of attention outputs
    # memory: encoder hidden states of shape (batch_size, max_length_input, enc_units)
    # memory_sequence_length: 1d array of shape (batch_size) with every element set to max_length_input (for masking purpose)

    if(attention_type=='bahdanau'):
      return tfa.seq2seq.BahdanauAttention(units=dec_units, memory=memory, memory_sequence_length=memory_sequence_length)
    else:
      return tfa.seq2seq.LuongAttention(units=dec_units, memory=memory, memory_sequence_length=memory_sequence_length)

  def build_initial_state(self, batch_sz, encoder_state, Dtype):
    decoder_initial_state = self.rnn_cell.get_initial_state(batch_size=batch_sz, dtype=Dtype)
    decoder_initial_state = decoder_initial_state.clone(cell_state=encoder_state)
    return decoder_initial_state


  def call(self, inputs, initial_state):
    x = self.embedding(inputs)
    outputs, _, _ = self.decoder(x, initial_state=initial_state, sequence_length=self.batch_sz*[self.max_length_output-1])
    return outputs

def loss_function(real, pred):
  # real shape = (BATCH_SIZE, max_length_output)
  # pred shape = (BATCH_SIZE, max_length_output, tar_vocab_size )
  cross_entropy = tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True, reduction='none')
  loss = cross_entropy(y_true=real, y_pred=pred)
  mask = tf.logical_not(tf.math.equal(real,0))   #output 0 for y=0 else output 1
  mask = tf.cast(mask, dtype=loss.dtype)
  loss = mask* loss
  loss = tf.reduce_mean(loss)
  return loss

import json
functions = '8exp^(9e)'

f = open('modified_train.txt', 'r')
modified_text = f.readlines()
f.close()

modified_text = [m[:-1] for m in modified_text]

BUFFER_SIZE = 32000
BATCH_SIZE = 64
# Let's limit the #training examples for faster training
num_examples = 30000

inputs = []
targets = []

N_TRAIN = 800000

for dx in (modified_text):
    try:
      inp, tgt = dx.split(""="")
      inputs.append(inp)
      targets.append(tgt)
    except:
      print(f""Error at: {dx}"")

train_inputs = inputs[:N_TRAIN]
train_targets = targets[:N_TRAIN]

test_inputs = inputs[N_TRAIN:]
test_targets = targets[N_TRAIN:]

data = (train_targets, train_inputs)

print(""Creating the dataset"")
dataset_creator = MyDataset('calculus')

# print(""Training the tokenizer"")
# train_dataset, inp_lang, targ_lang = dataset_creator.call(data, BUFFER_SIZE, BATCH_SIZE, math_tokenizer)

f = open('./inp_lang_tokenizer.json')
inp_json = f.read()
inp_json = json.loads(inp_json)
f.close()

f = open('./targ_lang_tokenizer.json')
targ_json = f.read()
targ_json = json.loads(targ_json)

inp_lang = tokenizer_from_json(inp_json)
targ_lang = tokenizer_from_json(targ_json)


# example_input_batch, example_target_batch = next(iter(train_dataset))
# example_input_batch.shape, example_target_batch.shape
vocab_inp_size = len(inp_lang.word_index)+1
vocab_tar_size = len(targ_lang.word_index)+1
max_length_input = 31
max_length_output = 31

embedding_dim = 128
units = 256
steps_per_epoch = num_examples//BATCH_SIZE

train_dataset, inp_lang, targ_lang = dataset_creator.call(data, BUFFER_SIZE, BATCH_SIZE, math_tokenizer)

## Test Encoder Stack
example_input_batch, example_target_batch = next(iter(train_dataset))
print(""Creating encoder"")
encoder = Encoder(vocab_inp_size, embedding_dim, units, BATCH_SIZE)
sample_hidden = encoder.initialize_hidden_state()
sample_output, sample_h, sample_c = encoder(example_input_batch, sample_hidden)

sample_hidden = encoder.initialize_hidden_state()

# Test decoder stack

print(""Creating decoder"")
# vocab_size, embedding_dim, dec_units, batch_sz, max_length_input, max_length_output, attention_type='luong'
decoder = Decoder(vocab_tar_size, embedding_dim, units, BATCH_SIZE, max_length_input, max_length_output, 'luong')
sample_x = tf.random.uniform((BATCH_SIZE, max_length_output))
decoder.attention_mechanism.setup_memory(sample_output)
initial_state = decoder.build_initial_state(BATCH_SIZE, [sample_h, sample_c], tf.float32)

print(""Creating the optimizer"")
optimizer = tf.keras.optimizers.Adam()

checkpoint_enc_dir = './training_checkpoints/encoder'
checkpoint_enc_prefix = os.path.join(checkpoint_enc_dir, ""ckpt"")

checkpoint_dec_dir = './training_checkpoints/decoder'
checkpoint_dec_prefix = os.path.join(checkpoint_dec_dir, ""ckpt"")

checkpoint_enc = tf.train.Checkpoint(optimizer=optimizer,
                                 encoder=encoder)
checkpoint_dec = tf.train.Checkpoint(optimizer=optimizer,
                                 decoder=decoder)

# restoring the latest checkpoint in checkpoint_dir
checkpoint_enc.restore(tf.train.latest_checkpoint(checkpoint_enc_dir))
checkpoint_dec.restore(tf.train.latest_checkpoint(checkpoint_dec_dir))

print(decoder.embedding.variables)
```


### Relevant log output

```shell
[]
```
",True
ImportError : cannot import name 'context from 'tensorflow.python.eager' stat:awaiting response type:bug stale TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13.0

### Custom code

No

### OS platform and distribution

Windows 11

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
[~\AppData\Local\Temp\ipykernel_23420\1827115418.py](https://file+.vscode-resource.vscode-cdn.net/c%3A/Users/go4av/OneDrive/Desktop/Dissertation/Code/2021fc04746/notebook/~/AppData/Local/Temp/ipykernel_23420/1827115418.py) in <module>
----> 1 from tensorflow import keras
      2 from tensorflow.keras.models import Sequential
      3 from tensorflow.keras.layers import Input, Dense, Activation, Dropout
      4 from tensorflow.keras.optimizers import Adam
      5 from keras import layers

[c:\Program](file:///C:/Program) Files\Python310\lib\site-packages\tensorflow\__init__.py in <module>
     36 import typing as _typing
     37 
---> 38 from tensorflow.python.tools import module_util as _module_util
     39 from tensorflow.python.util.lazy_loader import LazyLoader as _LazyLoader
     40 

[c:\Program](file:///C:/Program) Files\Python310\lib\site-packages\tensorflow\python\__init__.py in <module>
     35 
     36 from tensorflow.python import pywrap_tensorflow as _pywrap_tensorflow
---> 37 from tensorflow.python.eager import context
     38 
     39 # pylint: enable=wildcard-import

ImportError: cannot import name 'context' from 'tensorflow.python.eager'

### Standalone code to reproduce the issue

```shell
from tensorflow import keras 
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Input, Dense, Activation, Dropout
from tensorflow.keras.optimizers import Adam
from keras import layers
from keras import regularizers
```


### Relevant log output

```shell
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
[~\AppData\Local\Temp\ipykernel_23420\1827115418.py](https://file+.vscode-resource.vscode-cdn.net/c%3A/Users/go4av/OneDrive/Desktop/Dissertation/Code/2021fc04746/notebook/~/AppData/Local/Temp/ipykernel_23420/1827115418.py) in <module>
----> 1 from tensorflow import keras
      2 from tensorflow.keras.models import Sequential
      3 from tensorflow.keras.layers import Input, Dense, Activation, Dropout
      4 from tensorflow.keras.optimizers import Adam
      5 from keras import layers

[c:\Program](file:///C:/Program) Files\Python310\lib\site-packages\tensorflow\__init__.py in <module>
     36 import typing as _typing
     37 
---> 38 from tensorflow.python.tools import module_util as _module_util
     39 from tensorflow.python.util.lazy_loader import LazyLoader as _LazyLoader
     40 

[c:\Program](file:///C:/Program) Files\Python310\lib\site-packages\tensorflow\python\__init__.py in <module>
     35 
     36 from tensorflow.python import pywrap_tensorflow as _pywrap_tensorflow
---> 37 from tensorflow.python.eager import context
     38 
     39 # pylint: enable=wildcard-import

ImportError: cannot import name 'context' from 'tensorflow.python.eager'
```
",True
Could not find matching concrete function to call loaded from the SavedModel type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf2.10

### Custom code

Yes

### OS platform and distribution

win10

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

How to match data of signature?

### Standalone code to reproduce the issue

```shell
...

model.save(filepath=save_model_dir, save_format='tf', signatures=None)
local_model = tf.keras.models.load_model(filepath=save_model_dir)

y_local_pred = local_model.predict(x_test)
y_model_pred = model.predict(x_test)
print('y_local_pred == y_model_pred:', numpy.allclose(y_local_pred, y_model_pred))

user_inputs = [
    tf.TensorSpec.from_tensor(tf.convert_to_tensor(user_inputs[0]), name='inputs/0'),
    tf.TensorSpec.from_tensor(tf.convert_to_tensor(user_inputs[1]), name='inputs/1'),
    tf.TensorSpec.from_tensor(tf.convert_to_tensor(user_inputs[2]), name='inputs/2'),
]

user_outputs = local_model.user_fn(user_inputs)
```


### Relevant log output

```shell
Could not find matching concrete function to call loaded from the SavedModel. Got:
  Positional arguments (1 total):
    * [<tf.Tensor 'inputs/0:0' shape=(150, 5) dtype=float32>,
 <tf.Tensor 'inputs/1:0' shape=(150, 10) dtype=int32>,
 <tf.Tensor 'inputs/2:0' shape=(150, 3, 5) dtype=int32>]
  Keyword arguments: {}
 Expected these arguments to match one of the following 1 option(s):
Option 1:
  Positional arguments (1 total):
    * (TensorSpec(shape=(None, 5), dtype=tf.float32, name='inputs/0'),
 TensorSpec(shape=(None, 10), dtype=tf.int32, name='inputs/1'),
 TensorSpec(shape=(None, 3, 5), dtype=tf.int32, name='inputs/2'))
  Keyword arguments: {}
```
",True
load_associated_files does not load a txt file stat:awaiting response type:bug stale comp:apis,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

latest

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

On ""load_associated_files"", it emit longest `does not exist` error.
All the lines below reproduce the same result.

```
populator.load_associated_files([os.path.abspath(""./label_file.txt"")])

populator.load_associated_files([])

populator.load_associated_files(['label_file.txt'])
```

The label_file.txt exist in the same folder as main.py.
<img width=""981"" alt=""スクリーンショット 2023-09-12 12 15 38"" src=""https://github.com/tensorflow/tensorflow/assets/52132649/178ef07f-e6a3-446e-856e-865b12a36962"">



Also, what information am I supposed to put in the txt file ?
Is there any documentation for that ?

### Standalone code to reproduce the issue

```shell
# Creates model info.
model_meta = _metadata_fb.ModelMetadataT()
model_meta.name = ""Cup classifier""
model_meta.description = (""Identify a cup"")
model_meta.version = ""v1""
model_meta.author = ""Integro""
model_meta.license = (""Apache License. Version 2.0 ""
                      ""http://www.apache.org/licenses/LICENSE-2.0."")

# Creates input info.
input_meta = _metadata_fb.TensorMetadataT()

# Creates output info.
output_meta = _metadata_fb.TensorMetadataT()

input_meta.name = ""image""
input_meta.description = (
    ""Input image to be classified. The expected image is {0} x {1}, with ""
    ""three channels (red, blue, and green) per pixel. Each value in the ""
    ""tensor is a single byte between 0 and 255."".format(160, 160))
input_meta.content = _metadata_fb.ContentT()
input_meta.content.contentProperties = _metadata_fb.ImagePropertiesT()
input_meta.content.contentProperties.colorSpace = (
    _metadata_fb.ColorSpaceType.RGB)
input_meta.content.contentPropertiesType = (
    _metadata_fb.ContentProperties.ImageProperties)
input_normalization = _metadata_fb.ProcessUnitT()
input_normalization.optionsType = (
    _metadata_fb.ProcessUnitOptions.NormalizationOptions)
input_normalization.options = _metadata_fb.NormalizationOptionsT()
input_normalization.options.mean = [127.5]
input_normalization.options.std = [127.5]
input_meta.processUnits = [input_normalization]
input_stats = _metadata_fb.StatsT()
input_stats.max = [255]
input_stats.min = [0]
input_meta.stats = input_stats



# Creates output info.
output_meta = _metadata_fb.TensorMetadataT()
output_meta.name = ""probability""
output_meta.description = ""Probabilities of the 1001 labels respectively.""
output_meta.content = _metadata_fb.ContentT()
output_meta.content.content_properties = _metadata_fb.FeaturePropertiesT()
output_meta.content.contentPropertiesType = (
    _metadata_fb.ContentProperties.FeatureProperties)
output_stats = _metadata_fb.StatsT()
output_stats.max = [1.0]
output_stats.min = [0.0]
output_meta.stats = output_stats
label_file = _metadata_fb.AssociatedFileT()
label_file.name = 'label_file.txt'
label_file.description = ""Labels for objects that the model can recognize.""
label_file.type = _metadata_fb.AssociatedFileType.TENSOR_AXIS_LABELS
output_meta.associatedFiles = [label_file]



# Creates subgraph info.
subgraph = _metadata_fb.SubGraphMetadataT()
subgraph.inputTensorMetadata = [input_meta]
subgraph.outputTensorMetadata = [output_meta]
model_meta.subgraphMetadata = [subgraph]

b = flatbuffers.Builder(0)
b.Finish(
    model_meta.Pack(b),
    _metadata.MetadataPopulator.METADATA_FILE_IDENTIFIER)
metadata_buf = b.Output()

populator = _metadata.MetadataPopulator.with_model_file(tflite_model)
populator.load_metadata_buffer(metadata_buf)
populator.load_associated_files([os.path.abspath(""./label_file.txt"")])
populator.populate()
```


### Relevant log output

```shell
.....{q2\xbd\xf6\\\x9c\xbd\x80\xa1\x0c=\xa6\xfa\x1f\xbd\xc2\xdd\x99\xb9:x\xa9\xbb]B\xe4=\xd4\xef\x14\xbdm\xcb\x0c\xbdO8\xfb\xbdk\x8dl=}s\x11=\xb6\xcf\xab=\x07x\x0c=\xf2t\xe5\xbc:\x01\x8a\xb9\xdb+\xa0\xbd\x0f\xf5\xea\xbd\xf8\xaf\x1d\xbd\xe3s\xde\xbcm\x86\x87\xbd\x11\xa3\x18=\x1e\x0bM=\xb6\x00\x17=\x97:\xd0=\x10\xda\xf2;\x89\x1b>=.0\xa4\xbde\xd7\xad\xbd\x88\x00R=\x0f\xe7\x85=_\xda\x9b=\xd2v\xfe<\xa9\xe9\x07=\xba\x91\xaf=\xaa\xad\x98\xbc)\x9c\xbe\xbc""\x17s=0n\xfc\xbdB\x9c\xd1=\x9er\t=R\\\xad=\xac\xc9x=\xe9R\x94\xbdR\xd4\x13=\xb9\xc7D=\x91\x18T=J\x8e\x94=\xe2\xeb\x8a\xbd\xe3\xf8\x00\xbd6\xa2\x9b\xbc\xfa\t\x98=\xf9\x18\xdf<C\x1e\xa7=\xe2\x9a\xa0=]k\x0b\xbd\x86.7\xbc\xbar\xe4;\xcb\x9b\x0c>\xc2#\xd9=\xaaB\x1f\xbc\xa4\x03\xbc\xbd6\xea\xf0\xbd\xca\xae\xa8\xbd(\xb7\xfa\xbd\xff\x92D=\xa66\xd7\xbd\xf7\xea)=`\xf1\xa2=\x92\x120\xbd\x8eb\xa9=\x13\x8e\xfd\xbd\xe0\x9d)\xbd\n\xd1$=\xd7K\x12\xbd\xb6X\xa0<\xaeL\xd1=\x053\xa2=\x01X\xb3\xbd8\x9df\xbd\\\xef&\xbd+k&\xbc\xc8\xa0\x8a=G\x81\xc8\xbd\xeal5=\xd4`\xbf\xbd\xca\ny=T\xb0P\xbd<e\x7f\xbc\xcaU^<\x7f\xc2\xd1;p\xa3\xb8\xbd\x16\xefF\xbd%r\x87\xbd\x81{\xb1=\xf9\x13\xfb\xbc\xc1\xf8\xce;\x06\x8a\x87\xbd\r\x8fK\xbd\xb2\xd4\x14=\x9d\xecL\xbd\x0c\xe6""=F:o\xbd\xd8_\x9c\xbd\x18\xd6:=\xa6\x1b<=\xde\xd3\xa1=fY\xfd\xbcw),=\xec\xa4\x80=\x89\xdf\x9b\xbd\x8c\xf6\x06\xbe\xc9\xc7\xab\xbdO\x00\x93\xbd+\xf8\x98\xbd\x84\xeff\xbb5\xa3\xd2=v4\x19\xbc\xd3\x7f\xe7\xbd\xa3}\x84\xbd\xd6\xb2C\xbd\xda\xc6`\xbd\xf5\xde\xb5\xbdr\xed5<uo\x84<\x03\xd7\xdb\xbd\xa9\x00\x94\xbd\x06(\x88\xbdM\xa4\x82\xbd\x1a\xdb\xc9=\xcf\x9d\xcd\xbc~SG\xbd\x18\xeb~\xbd\xd0Wv<\x01[\x98=\x92\xba\x98= \x83\xd5\xbd\x10\x85b\xbc\x95+\x92=\x8a\x1f\x11\xbb\x18b$=<\xe9\xaf\xbdjfr=\x958\xed\xbd\xd8\xb2\xc2<Q[\x97\xbd\x14\x9e\x9e=\xdd\x19\x18\xbb\x8c\xa0\x81\xbb^0\x1a<\x7fW\x00\xbd\x1c\xc9\xd4=\x83\xa8\x04\xbd\xd7\x99k=-\xe5U=\x16\x83\x9b\xbcf\x90\xb9\xbdJ\x1f\xab=\x82\x00\xe3\xbd@3.=\x1e\x98\xac\xbdX\x8e\x1c\xbd\x91\x83\xca=\xed\xedJ\xbd@\x96\xd8=\x87\xb6\x0e=?q\xb4\xbd\xc4\xe9\xac=q\xe8\xbd\xbd\x7fe\xed<:\xb4\x1a=G\x9a\xc9\xbd\xf0\xc4\xc2=NN\xe8\xbd\xfdb\xf7<\xacs\xb7\xbd\xa6\xd9\xf1\xbcg\xff\x0b<\xdc\x8ea=u>\x98\xbb\xc2f\x86\xbd\xaf\xd8I\xbd|\xc4R=Pk\x04=\xde\xbfL=\xb8&\xa8\xbd:\xe0\xf0\xbdKo\xc9\xbd\xac\x1e-=\xfe\x0b\xa5=2\x02.\xbdk\xac\x8c\xbd\xf8\n;<w\xca)<\xc8\xae\xd9\xbdj\xd9\x9d\xbd\xd4.B\xbd\x80]\x02\xbd\x9a\xe1\xa3\xbdGLe\xba\xac\xf3N\xbd0\x81\x12=\xc0\xa0\xa5\xbd\x0c-\xf3<\xeb\xca\xda\xbd>\x0bE<}\xcf\x84=\xb1\xf9\xac=\xf5\x87X\xbdP""_\xbc\x8c?\xf4<\xb7\x94\x1d=\xd2\xdbG\xbb\xe5?<={Y\xe3=\xbf?\x83\xbd\xfe\xe8\xbb=*\xc2\x9f\xbd\xbd\xb3\xd0=\x18j\xf9=\x9b\x8d\xd0\xbc\x08\xb4^<\xa74*\xbc\xe7\x12\xea\xbc\x81\x88Y=o\r\x7f\xbdP\x8f\x8d<YH\xa8\xbba\x0c\xf9\xbc_\x87\xac\xbd7<_=\x05\xe53=\x01\xabH<%\xfe\x9f<%yP<w\xd3\x83\xbd\x9aL\xbe<&\xd3\xb9=\x93\x94\xbe=\x85\x11o\xbd\x11F\xc1<""\x8c\xa2=\xb5\x13\xb9\xbb\xae\xe4\xef\xbd\xb1y =\x92\xe5\xc5=\x10\xcb\xf8\xbd\xce\x8b\xd0\xbd\\\xceX=$\xb5\xe7<v\x10\x9f\xbd\xd3^\xbf=n\xff\x9f<\x83\xcb\x85\xbd\x14\x7f\x94=\xfb\xda\x95=\xa07q;\x8f\xe9\xb7\xbd\xdc16\xbc\xed_\xb3\xbd\xdf\xf1E\xbd_\xa1\x02\xbe`B\xb5\xbd\x1f\x15\x80=\xc9\xba\x9b<6\xa7\x83\xbd\x8c\x11\xd2\xbd\xe2\xaa\x94\xbc\xafHO=D\xeb\xcb\xbd\x19\xf6\x12\xbb9\xbf\x98=e\xa9\xb4\xbd\xde\x89\xa0\xbc\n\xe6\xcb<\xa5\x99\x89:\xc1z\xd6=\xb7h\xc0\xbde\xde\x13=Fo\xf3\xbd\xc2\xa5\xaf\xbd\x8b\x1bw=7\xf0\xac\xbd\x0e\x9a\x9d<4\x00\x9e\xbb\x8d?\xd1\xbd\x84\xf0w=]Y\'\xbd\x80Dz=\xe0""\xc2=bG?\xbc_7\xc3=\x83=\xc5=;\x11\xea\xbd\x84|\xbc=\xdc\xcf""<\x02\x01\xa8\xbc}\x96\xa0\xbd\xe5\xf9\xd7\xbd\xdaS\xa8=y\xd1\x96<\xe82U\xbdS\xbb\x9f\xbdr\xf7\xca=\x87\xb2\xa7\xbc\xde\x9c\xfa\xbd\xb0\x12\x01=\xef\\\xa3\xbc\x00.\xb4=\xdf\xfdS=\x87\xc3h=\xae \xa9\xbc\x08\xd8\xc9\xbd\xd2P\xcf\xbc\x991\xa4=\xa1s*\xbd\x07\x16\xee;\xb4\xbeO\xbd\x8b\x95\xfd<\xe8H\xb7<\xdd\xe4\xd7\xbd\x87\xefo=\x9f\xc8\xce=\x04A\xa6\xbd\x88\x95q=\xcd\xf9\xd7\xbdZ\xc4\xb3\xbd\xcap~<\xbd\xa8\x86\xbd\xf5\xf2\x83=\xac3^=\x1c\xc6%\xbdn\xd6\x9b\xbd|\xa5\xda\xbd\x12\xec\x98=\xd8\xd2q=H\x1f\x01=\xe7\xcf\xec<\xb6G\xd5\xbc\xf3>w=\x10\x05\xff\xbd\x92\xa2E;\xd4\x8fm\xbd\x07\xce\x1c=\xc3O:\xbd%\xca=\xbcKi\x8d\xbd;\xef,=\xee\x1d\x91=\xca=Z\xbd\x166w\xbc\x1a<\x83=\xbeG\x9e\xbd\xbcw\x04=\xf3$\x96\xbd\xdf\xd5\xa6<\xd8j\xd9=e\xe7\x9b\xbd3s\x81\xbd\x04\x15\xb7\xbc\xc8\x9e\xb0\xbd\xe8\xad\x9b<{\xab\x94<\xa1=\x9a<\x81\xfe\xcf\xbda\xbbr\xbc\x95\x9f\x8d=\r\x9e\xba\xbd\x84(&\xbd-L\xad=\x10)^=\xb1\xefQ=u\xde\xb68\xb7\xe2\xab<\x88\x1c\x9a=R\\\x00\xbd\xa2q\x96\xbd\xda\xc3,\xbd\xaf\xc4\xf3\xbd\xed<:=\xd3\xc1\xe8\xbd\x9d\x12\xa3\xbdG$\xb2\xbdC2\x1e\xbc\xb7o\x05\xbd\x10\xe0Q;\x08\x19\xe7\xbd\xd7\xf4\x94\xbdB\x85\x97\xbd\xbf\xf8\xab\xbd\xb9|m=/h\xa5\xbd\xbe7\x15=\xfd\xd8\xa5\xbd\xbb\xbc\xa8\xbd\x8c\xe3\x02\xbdx\x05\xfe<q}\xcd=G\xd8\xcf\xbc\r\x84\xb1\xbd\xea\n\x84=\xbe\xfai=\x80b\t=\xc5i\xa2=\xf5<""<+K~=_\xcb#\xbd\xfa\xe3N\xbd\x82(\xe1<\x19hs\xbd\xd6\xc9\x0f=\xad\\\x1e<\xb5\xdbL=&\r\x1e=I\x9f\xef<\x05\xbc\xeb=\x90\x8e\xa9\xbb\x1c\x88\xca\xbaT(?\xbd\xa0\x8e\xc7\xbd\x99\xa7 \xbd\x0e\xa8\x94=\xa5*\xea<\xd8\xc2g<\xb26\xc8\xbd\x92\xd4\xee\xbcPQ\xeb\xbd\xdf\x00\x14=\xc2s\xa6\xbd\xd6\xf0\x02\xbd~\x15\xc5=\xa4\x90\xce<\x88\x0b\xb8\xbc\xe2C\x8b\xbcV\xf5\xb2=\x97\xcc\xc7\xbd\xe9\xf7P=\xa3\xceL;\x92\xdb\xd8\xbdsn\x89= u\xf2\xbb\xcc\xf4\xd2<\x01\xfe\x96=\x04\x8c\xa8\xbc\xbca\xd3\xbdUg\xa2=\xd5\xda\xeb=\xb0:\xd0\xbbj\x18=\xbd\x00\xaf\x9a:R\xa0<=\xe0Af;\x98r\xbb\xbd\xb5\x0c\x96\xbd\x0c\xcb\x08\xbc6\xa2\xef\xbd$W\xa9\xbd]\x16\x9b\xbd\x16T\x9b\xbc$\xad\xa0<\x03\x83J\xbd\xf7\xac\xbe\xbda\x9cY<l_\xb3\xbdE_\xb6=5Z\x0b\xbd:N\x8a<o\x1e\x9b=\xc16\x87=\xe2[\x1c\xbc\xc0\xb0\xf3\xbcKo\xb3=\xd1\x04.\xbd\xb6c\xc2\xbd\x16w}=\x8ezY\xbd\x93\xf2\xc8\xbd\xa1]\xac\xbd\xd2\xaf_=\xad\xf0z\xbd\xca\x98\x99\xbdG\x8a\xc0\xbd\xbb\xfa\x9c=\x93\x00n=\xa8Q\xc1\xbc\'\xc8\x95\xbd\x97\xc3\x99=~\x98\x17=\x83\xdc\xcf\xbd\xd9\x04\xbd=\x05\xee\x94\xbd\xbcv\x9b\xbc\xf3\x88\xa2=*\xc9\xab\xbdd\x9c\xa2\xbd\x80d\x13\xbcaB\xd6=hgg\xbc\x90\xd0\xce\xbc\x03\x17\xc2=\n\x83\x93\xbd\xccac\xbd$\xcd\x83=P\xdab\xbc\x11\x1e\xb0\xbcmP\xb9\xbd\x10\xeb\xe6\xbc\x83\xa1\x93\xbd8\xdf\xad\xbd\x08\xf5J<\xfbW\xfe<\x1eF\xc2=\xd1\x11\xea;\xa5\x9e\xcc=\x9d[\r=\xc87\xf9\xbd\xf0\xafH\xbc W\xda<<x+<\x88\x86\x08<\xd7\xd5\x97<w\x99\xb5\xbc\xcd""B\xbd\xa1:\xfe\xbd\xd1m\x96\xbd\x12\xe2\xb0\xbd]~7=}\x80V=\xf0\xed\x94\xbdB\xcb\x17=\xe1\xfb\x8c=\xaa_\xba=\xb6)g\xbd\xde/\x9b\xbd\x94\x18\xc8\xbc<\xde\xc1<\x91\x9a\xa9=r\x04x\xbdZ\xfb|\xbd\x04\x15\x96<\x19C\xad=\xc7\xca\xc3\xbd[\x95\xe9\xbd\xd2.T\xbd\xb0_\t\xbd\x8e\xe2\x04=\xfbM\xbe=\x18g\xe3\xbcdf\x8f\xbd\xb6\x8d\xab\xbd&\x8c\xb9\xbd\x98\xc2\xee\xbd\xdd\x9a4=\x0e\xa65<\xfa,\x0f\xbd\x1dX\xe7<\x7f\x0c\xdc=!\x08\xb0\xbd>\xa2\xce\xbc7\xd7\xb9\xbd1K\xbf=\x98d\xcf\xbdt\xa2\xb7=\'\x18\xa9=\x92\xe7\xb7\xbd\xfe\xb7\xcf\xbd\x9bn\x85\xbd\xcd\x0ca=\xa1Cy=\x84\xb5\xe3<\xc7X_<\x8ey%=bK\xbe=\xab\x01\xb6=h\x88\xd4\xbc2\x92I\xbd\xfc\xee<=62\xef<!\x1c\x15\xbc\xf8$+\xbd|\xf6z=\x8b\xc6\x89=z\x8dp\xbd\x8a\xe0/\xbd\xf2g\xcf\xbd\x16\x18\x01\xbe{_\xc3=\x9b\xf7\xaf\xbc\xda\xa3\xbc;\x0bM\xe4\xbdv\xbf\xd9\xbcD:I=\xd4\xcc\xbc\xbd\xc6x\xdc=\xcdG\xa2=\x1e|\xdd\xbd\x0e#\x9c=\xb3\xf0\x8d=->\x83\xbd\xa1\xd2N\xbdVD\x84\xbc\xe2\x1c\xc8=\xa6\xab\xec<\x1a\xd4\x81=\xe0\x99\xdb<\xeb,\xc6\xbd1\xef\xcf=\x1f\x1f\xbf\xbd\xc2\x84\x19<\xd0\x8an=\xdbg\x86=fs\x97=\xe0=\x02=\x99\xe3\n\xbdX\x13\xe1<)\xe1u\xbc\xba\x9f\x03<\x8a\xc8Z\xbd^[\xbd=\xdfx\x9a\xbdR\x18\x9e=\xc7\x8f\x9c=\x98P\x80\xbd\xa65\x07\xbb\xbe|\xa1=\x04{\xc8=\x06\x94\x84\xbd\x86p4\xbc\xa7l9\xbc\x89\x0e\xa9\xbdh\x0f\xb8\xbc\x02\x9a$<\xfb6\x84\xbd\t\xbe\xc1=F\xbe\x14\xbc@\xb2\xb0=\x11s+=\n\xfb[=4\xdfM\xbb\xf1\x8f\x89\xbd\xad\xc1\x9a<3\xa1/\xbdz\xf8\x9a\xbc^\x96\xd9\xbc\x8c{\xa8=\x02\xff\xa3={\x9a\xa4=Z\xc5\x05=:\x81\x0b\xbd\x02\x95\xcd=a\xcc\xfc=A\xf6\xcc\xbdA\xa0\xd7=""\xa4\x9d=\xdd\xee\xcb\xbd\x8d\x0e\xce;Y\xc7\xfb\xbc\x1e\xa0\x8b=|\xa6\xf6\xbdMS\xa3\xbdE7\x10\xbd\xd5\xc0\x80\xbd\xf5\x8a\x8a=\xb7\'\x9d=\xb8\xea\xe1\xbcJF\xc0<p\x99P\xbd\xe0Uz\xbc\xd2\xf1\x80=\x01\x01,\xbdx\x87@\xbd\xef\x8b_=\x90\x99\xbb\xbdP\x81\xc1=~\xf6\xa6=\xa1\xa3\x99=\xd3mM\xbd\xb96\xe2\xbdP\x8e\xbd\xbd\x90fb\xbdH\x13\xcb\xbd\xd3&\xd0<;\xea\xb3<\x02\xc0\xd2\xbd\xef\xe4&<B.\xbf=\xf0\xc6\xaa\xbd\n\x16*=T\xcc\xae=\xcd\xd7<=\x94\xfdv\xbc\xb9g\x90\xbdp\x1e\xc8\xbd\xb3#\xef<\xb0\xf8\x15=\x9a\xf3Q\xba\xa9B\x8f\xbd\xf1j\x9b\xbd\xb1\x8f\xc6\xbd^\x07\x88=\xc6sj\xbd\xed\xf3\xea\xbd\xf0\xaa\xd8\xbd\xd5\x80e\xbd\xb5\xfch<\xc55\x83\xbd\xc9\xc5\xaa=\x06\x8d\x98\xbd\x9d\xa4\xc7;I\xab\xcf<\x02\xdcU\xbd\x83B\xd3=\x86\x18\xa1;\x1f`\x89=b\x16\xa6:l\xf9\xb0\xbdN\x16\\\xbd>|i\xbc>J\xf1\xbd\xd3\xe0\xb8\xbd\x90lz\xbd_\xae\xe2\xbd\xee\x84\xab=\xcc@\x83<\x99\xaf\xa5=\xe0Y\xcf\xbdH\xaf\x1e=\x16\x12\xd2\xbd\xfd\xcc\xcc=\xd17\xa3\xbcG\xf7\xfb=\xd1\xe9\x9b\xbc\xdc\x16\xf6:\xf4\xb4\xb3\xbd\xd4f\x81=\xf6\x98\x9a;\xf2I\x14\xbda\x98D\xbd\x16eS=\x9cB\x92\xbd\xd5\x07m\xbd)j\x1f=\xa0\x1aW=\xb1\xe8_=\x06\x84\x9b8n\xe7H=\x86\x83T\xbd\x85H\xbc\xbd\xdb\xda1<\x81N\x1f\xbd\x9ff\x1b=\x96\xa07=vCB\xbdL\xad\xbd\xbdjc\xce\xbd\xb3))<\x16$\xdd\xbd\xde~\x19\xbd\xd4\xb5\xa0<y\xfd\xda\xbc\xec\xc8\x84=\xf5\x1au\xbb\xdd\xe9\x0c\xbd\x10\xfd\x92=\x02\xe4\x01=z\x1f^\xbd\x8e\xef\xc9\xbd\x99\xf0\x85=\x90\xba\xc9\xbd\t\xa5\xc7\xbd\xc4\xaf\xe1<\xbf\xae\xc5\xbd\xbdu\xcc\xbcUI\x94=\xa0\xf9\xa5=\x93\x91\x02\xbdY\xed\x88<\xd0L\x16=\x07}a=\xc0\xab\xcc\xbc\x96\xbf\t\xbd\xe9]\x82\xbd\x1c6\xab=\x1d\x0e\x81\xbdm\xb1\xda<\x13`\x03<\xb9\x9d\x14=\xed*\xbc<\xd8V\x96=\xcf\xc1\x90\xbc\xf8\x81\x91=\x1bn\x9e=c\xf9\x93\xbc\xcf\x9d\xe3\xbc\x91\x04\x85\xbd\xb0\xbe\xb2=C%\xa2\xbc\x82\x8e\x99\xbd%\xe4\x86\xbd\'\xe6Z=\xfc\x89V\xbbI\xaf\xda<\x82\xec\x17\xbdp\xeer\xbd\n\x8e\x9c\xbd\x10&\x1f=\xfa:\x14\xbd\xea\xbf%\xbd\xdfB\x02\xbes\xeb\xff;\xfb \xc4\xbd\xcf\xcd\xed\xbd\xe7\x96\x83\xbdK0\x81=\xc0\xb0\xcc\xbd\x81\x05\x9d\xbd\xa4\xff\xc7=Lv7\xbdJ\x04\xf9\xbdp\\\xa3=\x0e\xa9 \xbd-\xc3\x9d\xbcy\xbeb=\xc9\x1b\x92=\x01\x97\xbb\xbd\xd6\xba\xb2=\xda\xee\xeb\xbc\xbb\x16\x94<\xdew\x03\xbe\t+8\xbd\x05<\x88<\xc3l\x02=\xad\xac\x91<\xde\x1f6\xbd\xf2U4\xbc\xab\xddx\xbd\x03\xf4\xc1\xbd\xaci\x10\xbd?\x9c\xc0\xbd\xffMh=dM\x14\xbd?\xa6n\xbd]j\x04\xbd\xa5]\x05\xbb\x0cs\xac\xbd\xf6%\xbd\xbd\xd4s\xa9<\xa8\x1f\xbd=\x19\xdb\xac<\x01\xda\xdb\xbd\x0c\xa6\xdd\xbc\xdcz\x85=<\xde}\xbd\r\xda:\xbd\xee\xa3\xcb=\x9bM\xac\xbdz\x8aT\xbcHF\xc3=!}\x7f\xbd\x1d>\xb2\xbd\xe9\xbe\xba=^\x0c\x9b=\xef-M\xbd\x11\x8f\xb9\xbd\xb9>\x8c\xbb8\xbf\x1d=\xd5\xdc!\xbd\x1a\xb0\xae\xbd\xb7E\xe5;.\x8fN\xbd\xaf&\xfc\xbd\xd2}\xfa;u\xa4;\xbc\xb9-\x93\xbd\x0880\xbc]\xba\xc5=[\xbc\x87\xbd8]\xe5\xbdz\xa4\x08\xbc\xe4\x87\x95=\x8f\xf7\xa6=3\xc9y=\x1a&b\xbd\xc4\x88\xd8=t\xde\xbb\xbb_m\xd1<\r\xa5\x9b=\xf8x\xc7=\xc4\xc1\x0c=w\xcf\xe0\xbd9\xc3P\xbb\xf5J\x8c\xbd\'\xc82=:\xe3\xb8=\rp\x7f\xbd<\xf0T\xbd\xdb3\xcd=\xfd\r\xcd=\x9d\x7f\xad=\xea\xc6\xe1\xbd-\x98\xa1\xbd\xde\xc6\xce=\xcc\x8b|\xbd\xd6\xb4\xc3<\x1ax/\xbdV,\xce=\xb9o\x1d\xbd\x1b\xac\x84\xbdtF\xd0;\xe2\x1f\xb0=\xf7\r\xb7\xbcb\xf6\xa4\xbdt/\xd3\xbd\x9f\xb4\xad\xbd\xd9\x06\x1c\xbdt\n\xce=\xa6\xc5\r=}t\xf1<;]\x93\xbd\xbb5\xee\xbd\x14\x8b\x8d=I2\xa9\xbd\xa7\xd4\t\xbc\xb7\n\xe2\xbb\xaca\xc6=\xc9!\xb7=\xef\x9c\xe2\xbc_,\xd2;\x1c\xbe\'<\x9d\xc5\x8b=\xd57\x1d\xbd\x9b\xd2\xbb=1X\xb6\xbd\xcc\xe6Q\xbd]E\xcb=\x87\xab(=g\xdf\xb0\xbd\xcb\x1d\x82\xbd\x0fb\xae\xbb\xb34\xb3=C&`\xbdw+a\xbd\x96m\x19\xbd)s5=\xfdF\xc3=\xf5F\xb5=\xa46\x9f\xbc\xc7\x96\x8b<u9\x05\xbd;\xe5\x88\xbdQN\x86\xbd\xa9zy<\xfa\x80H=\x15PJ=\xd8\xa4\xa1=\xb2\x0f\xa2=vl_\xbd\x93\x82\xbf\xbdrP3=k#\xc6<U]\x81\xbd\x9d\x7f\x99\xbd)\xe8\x7f\xbd\x82Y\xda=`:\x92=D\xf1O\xbd\x89\xf8 \xbd\x81|`\xbb\xd6\xa6\xea;6t\xa8\xbd\x9f.\xc7\xbc\xe0\xbe\xbe<\x90\xcd\x93\xbd2A&=:\xecm\xbbn\xaa\xa7\xbd\x1e\xe9\xfb<\xae=\x1a=g$\xde\xbdX\xa2Z\xbd\xd4\xde\x00\xbd\xe9)\xf2\xbc\xe4!\xdf\xbc\xea\xcc\x8a\xbc\x05\x94\x8c\xbd\xf6P\xcd=\x16\x12\x8f\xbd\xa6\xac\x15=\x8b$\x1c\xbd\xcas}=\xca\x92\xc7=\x1a\xb0\x12\xbd\xf0\xeck\xbd\xf03\x0b\xbd7\x89\x02>\'\xabM\xbd\xc5+r\xbc\xd8\xd7\xa6=\xa6\x0c\xb5=\x95\t\xb0=\xd5\xc1\xdb;\xc3\xbb\x86\xbd\x89\xe6\xde=\x87\xc0\x1e\xbd\x80A\xef=\x87\xfb\xc3\xbd\x06k\n\xbd""R8=\x99\xddK\xbd\r\xbf\xf9\xbda\xc9\xd2=\xca\xfb\x17=\xa5\xac\xdb\xbd\x12\xfd9\xbd2\xb4%=\x8c\x93\x92\xbdX\xb3\xa7\xbd\xf2\xef\x97\xbd\xbf\xad\xf0\xbd\x8f\x96\xda=\xe8\xc8\xf6\xbb\xafY\x11\xbd\x9d\x12\x07>\x9fE\xa2<M\xf0(=\x8a\xb1\xdc\xbb\x7f\xaa\xb6\xbd\xb9p\x8f\xbd\xb8\xe8\xb3\xbdA\x87\xbd=w+\xe4=\x8d\xcc\x1d=\x049\xad\xbd\x9f\xa4\xd8\xbd\xf6W\xf2<\x028H\xbc\x90\xb1\x82=r\xe2>\xbc\xf4\x8c\r\xbd4\xf3\xab\xbdd\x95\xde<\xcb`\n\xbe\\\xb38=\x81\xef\xa5\xbdq\xd2\x82\xbd<\xb2\xb9;\xb3\x82\x1a\xbd]\xad#=\x10\xb3\xbc\xbd7\xee\x84\xbd\xf037=\xfd\xaa[\xbd\x86\x92\xbb=\xc6\xcf==\xb6b;\xbd\xec\x01\xcd<g%\xbd=d\x11\xc2<\xca\xf7\xa7\xbd\xc39\x9b\xbd\xfaI\xaa\xbc:\x1a\xf5\xbc\x84F\x1e\xbd%;\x8a\xbd\xb6\xbb\xa9\xbd\xd3\x83\xb1\xbd\xf8\xf3\xdf=\x03~\xeb\xbc\xe1\xe8\xf1=\xe9k\xc2\xbd\xcaa\x91\xbc\xd1\x81\xe9\xbc\x06\xbaK=!0Y\xbdy\xba#=\xefL\xe9=\xea\xd6\xd0\xbb\xf3\r\x00\xbd\x0f\xc4\xf3<bX\xc2<\x8ai\xb3\xbd\x95&3=\xbb\xfbh=\xb9\xe1\xa3={\x06\x04>J/\xcb=\xb0\x8a\xaf\xbd\xd2\x18M\xbbm\xa4\x1b=\x99\xc8\xe8\xbds\x0b-\xbd\x8c\xed@=)\xe0\x8c\xbd\xef\x17\xed=\xdf4\x84\xbd\xb4\x08\x8b\xbc\'m[;\xc85\xbe\xbd\x82_\xd7<UJ{=\xadf\xd5\xbd\xb4F\xdc\xbdS=\x9d\xbd\xb7x\x96\xbc\n6\xc3\xbd\xf0\x8f2\xbd\x0cM\x97=\x9b5^=\xbbW}\xbdE\xdfM=8\xa5\xa5\xbb\xfd\x8a\xe9=r\x91\xc7=\x9d\\\xdc\xbd\xddV\x1c\xbd\xa7\xc7\xc1\xbd(\xad\xd9\xbc\xb8Y\xba\xbd\x1c\x9a?\xbd\x7f3\x8e\xbd\xb7\x11\x1d<\x03\xc5\xc6=#{\xa7\xbc\x94\xcf\xd1=\xb6\xf9\xc9\xbc\xbd!\xd1\xbd\xba8\xce\xbd\xaa/2=\xffm!=\x01\xc9\xd7=n\x852<\x8fU\xbf\xbc\x8b|\xa3<V}\xc0<\xa9\xbd\x9f=j\xbe&<\xb3$8=\xd6 \xb2\xbd\x98\xda\xf3\xbd\xce\xe7\xd9\xbd\xc3\x1e\xee\xbde%K=0\x9fZ=\xac\x85\xd6=&p\xab\xbd\xac{\x00<t7g\xbd{\x01\xd5=\xc4eI=A\xf7a\xbc\x18\x15F\xbd\x7fT\xff=\x08\xf4\x10=#l\xd7\xbd\\p\x9f\xbdxm\x0c\xbd\x8f\x92\x1e;O\xde$=\x8ev\xfb\xba\xc9|\x9e\xbc\xef\x8a\xdc=\xa3\n\xae=\xb9\xe4o\xbd\xfa9\xab\xbd\xa8\x1f\xd9=\x06\x15t\xbd\x9c.y\xbd\xc6BW=\xa2*u=\xda\x07d<q\xeb-=\xd3\xf2\x92=\xd8i^=e\x83\xd2=\x12\xa2\xbc:\xb6\xaa+\xbd.\xe7\xeb=]\x9f\x85=<\t\xa7\xbdbZ\xa3\xbd\xd2Z\x9a\xbc\x07\x87\xc5=\x84y\xb2\xbd\x97\xcc\xe6\xbc\xfb\xe2\x11\xbd\x1bG\xb4<\xa9\xfc\xb9=\xdam\x95=v\xf0\xdb<\x06\x1e\xb5\xbd\xbf\x87\xbd=\xa0\x1dA=\x8e\xfb\xcc\xbb#\x19\x15=Bb\xb2\xbd\xf3\xfd\xf0\xbd\xe8\xb9\xe7\xbc\xd5\x86\xc0=4|\x18\xbd\x82\xed\xfe\xbc\xc1\n\xf0=&6\xdb\xbc:\xe5E\xbd\xbd!\xd6=,\xa5\x89=\xae\xfcg\xbdk\xafT=\x15\x8d|\xbcb@\x81<Z\x00\xd8\xbd\x17@\x88\xbc\xaa\x84\x9c=\xc5\xa4\xeb\xbd\x08AX=\xa5t\xdc=\x8f\xb2\x88=\xda\xe0\xab\xbd\xefi\xeb\xbdJ\x05\x94\xbdD\xd9\xda\xbd\xebs\xb4\xbc\x19\xb9\xaa\xbdU^\xb2=\xae\x8f\x89<\xada^=\x93\x0e\x10=\x9f\xe8\x8a\xbc\xc4\xd0\x86=GR\xac;\x12\xd4\x9d\xbd\x95\xbf\xf3\xbcgk\x01\xbd\xacM\xc6=0\xd9\xec\xbc\xba\x02\x9a\xbc\xcc\xe5\xa8\xbbg\xe51\xbd\xee\x1e\xf1<\x04\xf6\xa0\xbd\xf7\xe5\xf3\xbd\xd3\xb4T\xbc\x7fI\x84=""\xea\x12=f\x89\xf7<\xd9\x00\xb7<\xe7K\xe7=\xb3\xcb\xb7=\xd1\xef\xc6\xbc.\xaf\x18\xbcb\x97\x01>a\xe0b=\xed\xbe\xa3\xbc\xb2a\xa1=e\x19T=NX\x95\xbd\xd3J\x8b=3\xf4\xd0<\xe6I\x96\xbdg4\x80\xbd\xf4\x82\xf7\xbd\xc1\x9d\xd8\xbc\xa1\x0e{\xbd\x8e\xf4\xfe\xbd\xa3\x16\xf3=3\xbc\x8b\xbc\xeb\xac\xb6=\x8f\xec\x99<q\xa2\xe3<\x14\xccA\xbd\x02\x9a\xc8\xbdf\xf0:=\xfe\x89\xc0\xbbj\xbe\xb0\xbc\x8bC\x80\xbc!\'5=\xdb\x83\xb2=\x1b\xae\\\xbd\xf3\xb2\xd5=\xe6i\xa6\xbdSi\x95=A\xb6G=\x1f\x95\x94\xbdf\xac\xf5;\x1b\x9c\xad\xbd:C8\xbc\xab\x95\x88\xbc\xe6\x83\x87\xbd\x92\x13\xee\xbd\x88\x11\xb8\xbd\xb1]\xcc=\x9doM\xbd\xde\xa2)=>\xc2v=\x8a\x97\x06\xbcj\xc8\xc0<\xfd*\x1f\xbc\xa8\xd2#=5|\x15\xbd\x05\x10\xcd\xbc\xf1\xa8\xb6\xbd\x85\x94z\xbd=\xf0x\xbdj[\x92\xbci\x03(=\xfeI~\xbd\xbdh\xa4=\x0e=\x06>\xdd\xf4\xba\xbd\x10\xa6\x9d=j\xe0\x96\xbd\xcb\x03\x91=C\xb3\xb1\xbdE\x8c \xbb0\x14\xee;\xc7\xf9&\xbb\\\xea\xf6\xbd\xdd\x1e\xe5\xbb\xd2\xd6\xa1\xbc\x96k\x06\xbd\xa2\xc5+:\x845\x1b\xbd{\xe0&\xbd\xb1\x83Q=L\xa5\xb4\xbd\xa2\x82\xcf=\x19\'\xce:\x9e\x96\xc8=\xec\xa7\xb4\xbbW\x0f\xc3=\n\x00\x9f\xbc\xb7-\xbc=hj\x98=\xd1s\xb1=d`s=\xbb\xd6 \xbc\xee\xd9\xa3\xbc\x16\x9d\xa7=\xc2\xfa\x05=2\x1b\xff\xba\xca\xd6g=\x92\xec\x92\xbdX\xb5)\xbbB\xb8\xc7\xbd\xacf\x95=A\xbf\xc2\xbc\xb7\xb5\xb7=\xa5\xa2>\xbd\xb2\x04\x9f=\x06m\xbb<\xe2\xc6\t\xbd\xc9\x19\xfd\xbd!\xa1;=~M7\xbc{\xe4\x03\xbc+\xdd\xbd=B\xaf \xbc\x82\x95\xcf;c\tS=\x1eU\xe5\xbd\xff\x86l\xbd\xf3\x06\xa5;w\xd6\x16\xbd\x900\x89<\xd5;?\xbd\x9d[\x98\xbd\xf2\xff\x08=\x84\x92\\;\xe3\xa5\x87\xbc\x84\xf4@=\xe0\x03&\xbb\xb9Q\xbe\xbd\x9d0!=\xc8_\x88\xbd{\xa5\xc8=\xaafw\xbdP\x15\xe5\xbc\x99\x03\x89\xbd\xe1b,==\x7f9\xbd\xccK\xe4\xbdp<\x95=\xf0\xc2\xcd=\xf5:\x88=}FF\xbdF4\x1f=\x80\xe4b\xbd\xec\x93\xc8\xbc\x0e\t\xff;Ga\xd7\xbd<l\xaa\xbc\n\xa9}\xbde\xb9w\xbd\xdb\x90\xb9;\x11\xb7\xab\xbd@A\x02\xbd)\x85_\xbd\x87C*\xbd\xd9\xbc\x85<5r\x9f\xbc_\xfa\xf3\xbdGJ\x00\xbe\xc7\xb6\x97\xbd\xf8M\x08=e?\xd4=\xdf\x9cG\xbb6\x8e7=m\x16\x08=\xe5J\r\xbd\xecS\x1c=\x83\xa5\xc0=\xfc\xe1\xcd\xbd\xba\xde\xa6\xbdy\xd7N\xbd\x98{B\xbc\x1a\xfe\xff\xff\x04\x00\x00\x00\x00\x01\x00\x00\xb6_)\xbc\xe4\x81,\xbc\x9b\xcdv\xbb\xf9\x90\x07=\xee\x96""\xbcH\x177\xbc\t\xb4@\xbc\xe2S\x1b\xbc\xd7kq\xbc:\xd3-\xbc\xbe\r\xc9<b\xbd\x92<\x98\xc5%\xbcE6\x13\xbc\x1d)8\xbc\x94N""\xbc!\xe4P\xbcnDG<\x02\xec-\xbb\xbb\x8c\xd7;&\xaa#\xbc\x1b\xec\x02=\xa33T\xbc5\xf5\r\xbc\x10\xf7Q\xbc\xf2p3\xbc[\xa7\x1d\xbco(\x01\xbcE\xe4B\xbc\xf6O\x0f\xbc\x8fJ\xfb\xbb\x03g\xf6;\r\x98$\xbc\xb9\xb9\x83;\xb6%Y\xbc\x82o\x96\xbb\xa6\xe3N\xbc8O\xf2<{U(\xbcg \xf1\xbbOp#\xbc\x8b&3\xbcnW\xdd;\x00\x00\x00\x00\x9b\x92\'\xbc+a|:\xb4\xb5\x98<\x9e\xc9\x8d\xbc\x06\\\xcd\xbb\xff\xc3\xe2\xbb\xcf\x1e\x10\xbc\xff :\xbc\x8es\xc4\xbb\x1b\xf8#\xbc\x0fD}\xbc\xf6a1\xbc\xbf\xca\x7f\xbcE\xcc\x13=]\xa2\x18\xbc\n\xe40\xbc6\xd8%\xbc\xfew\xc3\xbb\xc8\xb0G\xbc\xec\xfdQ\xbc&\xff\xff\xff\x04\x00\x00\x00\x80\x00\x00\x00\xf6c^=5\xd6\xbc<\xa5j4\xbcosb\xba\x16\xe0C\xbc\r\x179\xbc\x8e|\x1a\xbchlT\xbc\xab\x90\x16\xbc<t\x1e\xbc\xcd\x04h;C-\xfb\xbb\x0c\x90\x84<H,\x18\xbaZ\xa0/\xba\xaef\xfd\xb9W1\x07\xbc\xc0\xa37<\xcf\x19\xf4\xbb\xc8{\x14\xbc\xa7\xbbM\xbc\x1e\xc3\x0f=,\x0c.\xbc\xb1\xe26\xbc)\x87\x13\xbcoA\xf8\xbb\x1b\x03<\xbc\x1519\xbc\xebz\x14\xbcE\x89\x03;\xa9S\xab\xb8\xb5~\x15\xbc\xb2\xff\xff\xff\x04\x00\x00\x00@\x00\x00\x00K\x1bo\xbbKj?\xbb6\xee@;]r(\xbc\'\x83\xc1\xba\x1b*\x84<;\xde\xc8\xbc\xef\xd0\x9c\xbaWt%\xbc\xc8\'\x1b=K\xaa\x0c=*\xd4p<\xa3\x9d\x93\xbcJ0\x83; \x9a.<\xa8\x10h\xbc\x00\x00\x06\x00\x08\x00\x04\x00\x06\x00\x00\x00\x04\x00\x00\x00\xc0\x06\x00\x00\x9a\x07\xc7\xb9\xb4\x1f=\xba;,\xb9\xb8\xa0T\x0b\xb8`\xbb\x1b:/$\xc99?\xc8\x808\xbf2\xc89\xe1x_\xb7\xc3\xcd-:1""\xe59K\x00\xdf\xb9\x0e\xf7\x10\xba\xf8\x13\x1c\xb91]\xd6\xb6\xef\x04\x0e:\x87|\xb8\xb83\xfc\x949H\xfcd9\xab]\xe79Di\xf98\x84\xac!:\xe2\xb4\x85\xb7\x04\x8f\x8a\xb9\xa2\x94\x1e:\xfc\xca\x18:\x18\\r\xb7\x8d\xb1\x039\x8d\x0c(9\x1au@\xba[\xc7a96!^\xb9\x94\xbf\xc1\xb9F\xc0\n:\xf7\x84\xd89\x1fJD\xba&\xe0#\xba\xdcY\x16\xbaE\xf7,:\x18\xc3\x198HM\xeb\xb8a\xa8\x199`\x8c\xca\xb9m\'\x13\xb9\xc4\x05\xf79\xee*\xae\xb86g :rs\'9S\xe8\x1c\xba\xfc}o\xb8\xc3<\xd19\x1a\x0b\x8a\xb9-\xc8\x15:\xbd\xf0\x1d\xba\xf2\'$\xba\xa8\x1al\xb7\xcfZZ9\xb4L\xe09h\x16\xcc\xb9#\x00=9\xaa\xa6\x959Y\x8e6\xb9?\xaa\x9a\xb9?\xd0\xd09*M99\xaa\xac\xb1\xb9\xf3\xa30:o(n9\x8d\x82\n:\xc5\x15$:\x93\xd3""\xba\x11\x16\xfd\xb9\x16:\xca9\x90\xcaq\xb9\x06\xfa%:K{3\xba\x9bK\x8d\xb9\x03K\xbe\xb9\xac\x05\x16\xba\x06\x00)\xba\xf9]\x9d9\x85!\x1f\xba:\x142\xbat\x9a""\xb9\xb0\xd4*\xb9V\x90\x1b:~\xc5v9,e\xf99\xd6X]\xb9\xa2s\x1f\xba7X7\xb9\x8f\xe5\x05\xbar6\xcc\xb7%\xcd\x909x\x98\xa59\xc0\xfd\xb8\xb9\xc16\x1b:\xcbe2:W\xe2\xa39w}\xca\xb9\xf4\n\xd07\x89V""\xba\xfa\xbc\x05\xba\x97\xb6t\xb80,J\xb7\xc4\x00\xf19 M\xcc\xb9\x02%V8\xc7\x18\xce\xb9\x8d\x932:\xc6\xa9X:w!\x04\xbaJ\xbb\xd8\xb9\xba\xe7V:\xa8{\x869\x1c\x06\x0e\xbaC\x8b\xd19s\xc3\xa28\xbbT\n\xba\xe3x\x18:\xbe\xa7\xa3\xb9,\xb5\xae\xb9\x84\xb4\xee\xb9\xe5n\xa19\x9a\xca\xed8\xb9\x13\x869\x0bh8\xb9_\x13\x11\xba\xd7\xcb\xea70_f\xb9\xab\xdd\xd4\xb8\xaa\xfc\x8b9\xb0*#:]E\xc0\xb9\x9e\xa5S\xb9\x8f{\xc09p\xe6@9)M\xe8\xb7\x15\xe8r9:$9\xb9\x0b\xb3\x17\xb9\x9f\xc4\xff\xb8\x82\x03\xf2\xb9I\xa6+:\x13\x82\xf69\xe5}\xf3\xb7\xcf\x1c\xa1\xb90\xbc%:Sx""\xbaA\xf0\xb3\xb9\x11E\xc1\xb8t\xa7L\xb9\xc3M\x1a\xba\xcb1\x1c\xb6J\xf5\xb9\xb9\x80K\xfb\xb9\xa9\xe2\x8f9\xdb\x038:\xf4\xd3\xb48\x99\xb8\xcb9\x9f\xaf\xd4\xb9\x98""#\xb9^\xfc0:d\xfbR\xb8\x8c\x0e\x829C\xd8\xc0\xb97\x909:\x8f\xb4\xfe\xb9\x8d\xa1\xca\xb8\x04L@\xba\xf3\xc9\x9e9O\xd6\xc3\xb8\xb8_\x0c9<\x8a\xe17\xb8\xc7\xad\xb9\xd0b\xcb9\x8f\xd4\x9f9\xaed\x0e:0\xc4\xf59\xc3\x0f\xdd93!\xe78\xa0\xbeS9\x81\x88\xd39\xca\xf0:\xb9\t\x86w\xb9lV\x9f9\x05\x08\xb79\x1c\x03T8[%\xba9M-o\xb8\x9f\xa8\x12\xba\\l\x13:\xf1\x9f{9\x88\xc7\xd99\x140\x05\xbagaF\xb9]\x8d\xfb4\x18e\xa5\xb9\xa4\x87\xe0\xb9\x85\x0cQ7\x8aY\x079\x9f\xd6\xe9\xb9n\r\xe1\xb9Iw*\xb9\x88\xf9m7I\xce!:\x06`\x8c\xb9k\xdf\xc6\xb9\x83\xa9\xd89\xd8T\x8d\xb9;\xf9\xaf9\xf8\x95\xd6\xb9\xfc\x98\r\xba\x97\x19Q9\x83\xa9\xe0\xb8\xbd\xd7\x9f\xb9\xdb\xfaX\xb9\xc1\x10\xb09\xe8\xe7$:\xba\x8dP\xb8\x8b8\xd57\x95\xc1(:$6\xcd\xb8\xf3\xf2\x9d\xb9\x8a\x0e\x07\xba\x1cXP9x\xd1\x83\xb8\xc5!^9h\xe9\xa39\x01m>\xba\x03\xb8\x04\xb9H\xf3/\xba\xaf\xf3\x10\xba\xbe3\xad\xb9%&\xe09\xc7A29\x7f\xb4\x8b\xb8\xeb8\x1e\xbaN&\xe8\xb9D\xb2,\xbaw\xa3r\xb9!\xa5\x85\xb9B\xf6u\xb9\xe7\xcf.\xba\x95#\xd5\xb9Ps\xae8\x0c|\xce9U\x05\xa88g\xe8\x1b\xba\xab\x8e\x83\xb7\x07[\xb6\xb9@\x0e^8\xad\x1b\xad\xb9\xd5\x90""\xba\x99(\xe39a\x01\xea9/=P\xb8\xf9\xde<:P\xcf\x1e:\xcc\xde?\xba\xe4\xf0\xfc\xb9Ho\x1c\xb8I\n\x14\xba\x04\xd2\xa08`\x9f\xec8\xca\x1b\x1c\xba\x9ea\xf39\xc7\xdfM:\xbf\x9f\xc58*\xfc\x12\xb9\xbf\xe1\x84\xb8zF#\xba@\t\':k\xe9\xbd\xb9Z+\xe49\xbe\x11\xce\xb9.\xe8$:\x88:\xf1\xb9\xa3\xef\x10\xba\xcar\xe0\xb9\xa4I;\xb9\xae\xa3Z\xb9x\x0f\x1b:O4\x08\xba:x\x17\xba\xdb! :]{""\xba\xeaC\x9d\xb9\xae\xdc\xbe\xb9?i3\xba /\xc7\xb9\n\xb95:\x95\x01\x0e\xba\xe1M\xa09\xa6C(:\xdcD\xeb9\xf7$\xf58/[%\xbak\xb12\xba\x96r\xc49#D\xd79\x17\xd5<:.\x1cA7\xbf\xc6\xdf\xb6r\xe0\x089\xe7\xc7\x05:\x11\xa4/\xba\xf8\x8c?:\x02B@:ky\x969\xaa\xa6=:J\xad\xae9>H\xa2\xb9sl\x18:\xc6N\n\xbaq~;\xba9\x98}8\xfe\xf9""9\xf3d:\xba\xe3\t\xd49\xf6\xcc\xd0\xb9zs3\xba\\\x02\x0b\xbaS\xa4\x95\xb9G\xa8\xb09\xd7\xdd,:O\xfc\x0c\xba\x94\xc2\xe2\xb9<\x97R9\xa5\xf6\xa1\xb6\xf1\x8b\xe0\xb9\xf1\x89\xd2\xb9+f\xdf8\x12g\x04\xb9\xda\xd2\xda9~\x14\xf37\x8c<$:\xf53\x19:\xfcKx7\xae\x9c9\xba\x1f\x8d\xee\xb8\x0f\x19\x1e\xb9\x12\xa5\t:\xe6\xb0z9\xab&\xa6\xb7\xb5\xbcX\xb9\xa2\x9c\x129\x12G\x80\xb9\x91\x92\xf69\x92\x03\x01\xba\xfb\xfd\x0b:\xb4\xf4f9\xcf\x80\x148M\x0b\xb8\xb9\xeb\xebW8,@\xf8\xb9f\x00\xe78\xc64\xfd\xb9+[\x8c8\xec\xca\xd89\x89\xa6%\xb8\xeff\x13\xba\x11_\xf8\xb9)\xd0\xc29\xda4\x1f\xb9O<\x10:\xe3P\x0c:%f\xb8\xb9\x18\xe6\xfa9\x0b/|9\xd8\x8b\xcb9\x8e_\'\xba\x8f\xb5\xbf91r\xf5\xb9\xdf\xfb)\xbaYb\x17\xb8O=\xdf8Q\xea`\xb9\x88+\x058u\xba\x13\xbaG\x1f\x18981\xd09\xb3\x96\xc29\x99I\x1e\xb8G\xb3\x0e\xba|\x0e\x879\xb06\x049\xb1F,:o\x99@\xba\x1b\xa5#9\xf4\x00\xc7\xb7\xa6\x17Q\xba\x07Hp9Z\xc7&:\xe8\xa4\x02:k\xbd\xb19\xffU 8\x0c:R\xba\xb2\xcc\xe49\xfef\x9c9\xf3p6\xba\xe4\x10\xc1\xb9\x1cq9\xb8$\xa9\x06\xba)w\x189%\x18\x00:\xeat\xc9\xb8\x86+!\xb7\xe2\x10\x06\xbaMx48\x06\xf0\xf2\xb9S\x186\xb9\xdc\xc0\x16:\xb6\xb9O\xb9\n\n2\xbaKP\x8e9\xaf\x88\xc39\xb4\x9e6:\xba\xc8\x1a\xb9\x80\xb5\x0f:\xf1\xb8\xc39\xccy\x1f:\xbc\xbf\x1f\xba\xc8\xaf\xed9\x12\x82\x19:*\xfe\xff8\x10\x02\xfa9-\x11a90}5:\x82\x96\xa49\xf8N\x0f:I\xde:\xb9p\xf3\xff\xfft\xf3\xff\xff\x0f\x00\x00\x00MLIR Converted.\x00\x01\x00\x00\x00\x14\x00\x00\x00\x00\x00\x0e\x00\x18\x00\x14\x00\x10\x00\x0c\x00\x08\x00\x04\x00\x0e\x00\x00\x00\x14\x00\x00\x00\x1c\x00\x00\x00\x94\x02\x00\x00\x98\x02\x00\x00\x9c\x02\x00\x00\x04\x00\x00\x00main\x00\x00\x00\x00\t\x00\x00\x000\x02\x00\x00\xcc\x01\x00\x00|\x01\x00\x008\x01\x00\x00\xf8\x00\x00\x00\xb4\x00\x00\x00\x8c\x00\x00\x00<\x00\x00\x00\x04\x00\x00\x00b\xfe\xff\xff\x14\x00\x00\x00\x00\x00\x00\x08\x10\x00\x00\x00\x14\x00\x00\x00\x03\x00\x00\x00\x08\xf4\xff\xff\x01\x00\x00\x00\x14\x00\x00\x00\x03\x00\x00\x00\x13\x00\x00\x00\x0b\x00\x00\x00\x08\x00\x00\x00\x96\xfe\xff\xff\x1c\x00\x00\x00\x00\x00\x00\x08\x1c\x00\x00\x00 \x00\x00\x00\x03\x00\x00\x00\x00\x00\x06\x00\x08\x00\x07\x00\x06\x00\x00\x00\x00\x00\x00\x01\x01\x00\x00\x00\x13\x00\x00\x00\x03\x00\x00\x00\x12\x00\x00\x00\n\x00\x00\x00\t\x00\x00\x00\x00\x00\n\x00\x10\x00\x0c\x00\x08\x00\x04\x00\n\x00\x00\x00\x0c\x00\x00\x00\x10\x00\x00\x00\x02\x00\x00\x00\x01\x00\x00\x00\x12\x00\x00\x00\x02\x00\x00\x00\x11\x00\x00\x00\x07\x00\x00\x00\x06\xff\xff\xff\x14\x00\x00\x00\x00\x00\x00\x05$\x00\x00\x00(\x00\x00\x00\x01\x00\x00\x00\xf6\xfe\xff\xff\x02\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x01\x01\x00\x00\x00\x11\x00\x00\x00\x01\x00\x00\x00\x10\x00\x00\x00\xe6\xfe\xff\xff\x10\x00\x00\x00\x00\x00\x00\x01\x18\x00\x00\x00\x1c\x00\x00\x00\xd8\xfe\xff\xff\x00\x00\x00\x01\x01\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x10\x00\x00\x00\x03\x00\x00\x00\x0f\x00\x00\x00\x06\x00\x00\x00\x04\x00\x00\x00\x82\xff\xff\xff\x14\x00\x00\x00\x00\x00\x00\x05$\x00\x00\x00(\x00\x00\x00\x01\x00\x00\x00r\xff\xff\xff\x02\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x01\x01\x00\x00\x00\x0f\x00\x00\x00\x01\x00\x00\x00\x0e\x00\x00\x00b\xff\xff\xff\x10\x00\x00\x00\x00\x00\x00\x01\x18\x00\x00\x00\x1c\x00\x00\x00T\xff\xff\xff\x00\x00\x00\x01\x01\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x0e\x00\x00\x00\x03\x00\x00\x00\r\x00\x00\x00\x05\x00\x00\x00\x03\x00\x00\x00\x00\x00\x0e\x00\x1a\x00\x14\x00\x10\x00\x0c\x00\x0b\x00\x04\x00\x0e\x00\x00\x00$\x00\x00\x00\x00\x00\x00\x054\x00\x00\x008\x00\x00\x00\x01\x00\x00\x00\x00\x00\x0e\x00\x18\x00\x17\x00\x10\x00\x0c\x00\x08\x00\x04\x00\x0e\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x01\x01\x00\x00\x00\r\x00\x00\x00\x01\x00\x00\x00\x0c\x00\x00\x00\x00\x00\x0e\x00\x14\x00\x00\x00\x10\x00\x0c\x00\x0b\x00\x04\x00\x0e\x00\x00\x00\x1c\x00\x00\x00\x00\x00\x00\x01$\x00\x00\x00(\x00\x00\x00\x0c\x00\x10\x00\x00\x00\x0c\x00\x08\x00\x07\x00\x0c\x00\x00\x00\x00\x00\x00\x01\x01\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x0c\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00\x01\x00\x00\x00\x14\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x15\x00\x00\x00x\t\x00\x00\xac\x08\x00\x00<\x08\x00\x00\xe0\x07\x00\x00\x84\x07\x00\x00,\x07\x00\x00\xd4\x06\x00\x00\x88\x06\x00\x00\x18\x06\x00\x00\xc0\x05\x00\x00t\x05\x00\x00(\x05\x00\x00\\\x04\x00\x00\xe8\x03\x00\x00\x14\x03\x00\x00\x9c\x02\x00\x00\xc8\x01\x00\x00P\x01\x00\x00\xf0\x00\x00\x00`\x00\x00\x00\x04\x00\x00\x00\xf2\xf6\xff\xff\x00\x00\x00\x01\x14\x00\x00\x00\x1c\x00\x00\x00\x1c\x00\x00\x00\x15\x00\x00\x004\x00\x00\x00\x02\x00\x00\x00\xff\xff\xff\xff\x0b\x00\x00\x00\xd4\xf6\xff\xff\x19\x00\x00\x00StatefulPartitionedCall:0\x00\x00\x00\x02\x00\x00\x00\x01\x00\x00\x00\x0b\x00\x00\x00J\xf7\xff\xff\x00\x00\x00\x01\x14\x00\x00\x00\x1c\x00\x00\x00\x1c\x00\x00\x00\x14\x00\x00\x00h\x00\x00\x00\x02\x00\x00\x00\xff\xff\xff\xff\x80\x00\x00\x00,\xf7\xff\xffL\x00\x00\x00sequential_1/dense/MatMul;sequential_1/dense/Relu;sequential_1/dense/BiasAdd\x00\x00\x00\x00\x02\x00\x00\x00\x01\x00\x00\x00\x80\x00\x00\x00\xd6\xf7\xff\xff\x00\x00\x00\x01\x14\x00\x00\x00\x1c\x00\x00\x00\x1c\x00\x00\x00\x13\x00\x00\x008\x00\x00\x00\x02\x00\x00\x00\xff\xff\xff\xff\x00y\x00\x00\xb8\xf7\xff\xff\x1c\x00\x00\x00sequential_1/flatten/Reshape\x00\x00\x00\x00\x02\x00\x00\x00\x01\x00\x00\x00\x00y\x00\x002\xf8\xff\xff\x00\x00\x00\x01\x14\x00\x00\x00$\x00\x00\x00$\x00\x00\x00\x12\x00\x00\x00H\x00\x00\x00\x04\x00\x00\x00\xff\xff\xff\xff\x16\x00\x00\x00\x16\x00\x00\x00@\x00\x00\x00\x1c\xf8\xff\xff$\x00\x00\x00sequential_1/max_pooling2d_2/MaxPool\x00\x00\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00\x16\x00\x00\x00\x16\x00\x00\x00@\x00\x00\x00\xa6\xf8\xff\xff\x00\x00\x00\x01\x14\x00\x00\x00$\x00\x00\x00$\x00\x00\x00\x11\x00\x00\x00\xa4\x00\x00\x00\x04\x00\x00\x00\xff\xff\xff\xff-\x00\x00\x00-\x00\x00\x00@\x00\x00\x00\x90\xf8\xff\xff\x82\x00\x00\x00sequential_1/conv2d_2/Relu;sequential_1/conv2d_2/BiasAdd;sequential_1/conv2d_2/Conv2D;sequential_1/conv2d_2/BiasAdd/ReadVariableOp\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00-\x00\x00\x00-\x00\x00\x00@\x00\x00\x00v\xf9\xff\xff\x00\x00\x00\x01\x14\x00\x00\x00$\x00\x00\x00$\x00\x00\x00\x10\x00\x00\x00H\x00\x00\x00\x04\x00\x00\x00\xff\xff\xff\xff-\x00\x00\x00-\x00\x00\x00 \x00\x00\x00`\xf9\xff\xff$\x00\x00\x00sequential_1/max_pooling2d_1/MaxPool\x00\x00\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00-\x00\x00\x00-\x00\x00\x00 \x00\x00\x00\xea\xf9\xff\xff\x00\x00\x00\x01\x14\x00\x00\x00$\x00\x00\x00$\x00\x00\x00\x0f\x00\x00\x00\xa4\x00\x00\x00\x04\x00\x00\x00\xff\xff\xff\xffZ\x00\x00\x00Z\x00\x00\x00 \x00\x00\x00\xd4\xf9\xff\xff\x82\x00\x00\x00sequential_1/conv2d_1/Relu;sequential_1/conv2d_1/BiasAdd;sequential_1/conv2d_1/Conv2D;sequential_1/conv2d_1/BiasAdd/ReadVariableOp\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00Z\x00\x00\x00Z\x00\x00\x00 \x00\x00\x00\xba\xfa\xff\xff\x00\x00\x00\x01\x14\x00\x00\x00$\x00\x00\x00$\x00\x00\x00\x0e\x00\x00\x00D\x00\x00\x00\x04\x00\x00\x00\xff\xff\xff\xffZ\x00\x00\x00Z\x00\x00\x00\x10\x00\x00\x00\xa4\xfa\xff\xff""\x00\x00\x00sequential_1/max_pooling2d/MaxPool\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00Z\x00\x00\x00Z\x00\x00\x00\x10\x00\x00\x00*\xfb\xff\xff\x00\x00\x00\x01\x14\x00\x00\x00$\x00\x00\x00$\x00\x00\x00\r\x00\x00\x00\x9c\x00\x00\x00\x04\x00\x00\x00\xff\xff\xff\xff\xb4\x00\x00\x00\xb4\x00\x00\x00\x10\x00\x00\x00\x14\xfb\xff\xff{\x00\x00\x00sequential_1/conv2d/Relu;sequential_1/conv2d/BiasAdd;sequential_1/conv2d/Conv2D;sequential_1/conv2d/BiasAdd/ReadVariableOp1\x00\x04\x00\x00\x00\x01\x00\x00\x00\xb4\x00\x00\x00\xb4\x00\x00\x00\x10\x00\x00\x00\xba\xfc\xff\xff\x00\x00\x00\x01\x10\x00\x00\x00\x10\x00\x00\x00\x0c\x00\x00\x00(\x00\x00\x00\xc4\xfb\xff\xff\x1b\x00\x00\x00sequential_1/dense_1/MatMul\x00\x02\x00\x00\x00\x0b\x00\x00\x00\x80\x00\x00\x00\x02\xfd\xff\xff\x00\x00\x00\x01\x10\x00\x00\x00\x10\x00\x00\x00\x0b\x00\x00\x00(\x00\x00\x00\x0c\xfc\xff\xff\x19\x00\x00\x00sequential_1/dense/MatMul\x00\x00\x00\x02\x00\x00\x00\x80\x00\x00\x00\x00y\x00\x00J\xfd\xff\xff\x00\x00\x00\x01\x10\x00\x00\x00\x10\x00\x00\x00\n\x00\x00\x008\x00\x00\x00T\xfc\xff\xff)\x00\x00\x00sequential_1/dense/BiasAdd/ReadVariableOp\x00\x00\x00\x01\x00\x00\x00\x80\x00\x00\x00\x9e\xfd\xff\xff\x00\x00\x00\x01\x10\x00\x00\x00\x10\x00\x00\x00\t\x00\x00\x008\x00\x00\x00\xa8\xfc\xff\xff+\x00\x00\x00sequential_1/dense_1/BiasAdd/ReadVariableOp\x00\x01\x00\x00\x00\x0b\x00\x00\x00\x00\x00\x16\x00\x1c\x00\x18\x00\x17\x00\x10\x00\x0c\x00\x08\x00\x00\x00\x00\x00\x00\x00\x07\x00\x16\x00\x00\x00\x00\x00\x00\x01\x14\x00\x00\x00\x14\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x02(\x00\x00\x00\x18\xfd\xff\xff\x1a\x00\x00\x00sequential_1/flatten/Const\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00R\xfe\xff\xff\x00\x00\x00\x01\x10\x00\x00\x00\x10\x00\x00\x00\x07\x00\x00\x00,\x00\x00\x00\\\xfd\xff\xff\x1c\x00\x00\x00sequential_1/conv2d_2/Conv2D\x00\x00\x00\x00\x04\x00\x00\x00@\x00\x00\x00\x03\x00\x00\x00\x03\x00\x00\x00 \x00\x00\x00\xa6\xfe\xff\xff\x00\x00\x00\x01\x10\x00\x00\x00\x10\x00\x00\x00\x06\x00\x00\x00,\x00\x00\x00\xb0\xfd\xff\xff\x1c\x00\x00\x00sequential_1/conv2d_1/Conv2D\x00\x00\x00\x00\x04\x00\x00\x00 \x00\x00\x00\x03\x00\x00\x00\x03\x00\x00\x00\x10\x00\x00\x00\xfa\xfe\xff\xff\x00\x00\x00\x01\x10\x00\x00\x00\x10\x00\x00\x00\x05\x00\x00\x00<\x00\x00\x00\x04\xfe\xff\xff,\x00\x00\x00sequential_1/conv2d_2/BiasAdd/ReadVariableOp\x00\x00\x00\x00\x01\x00\x00\x00@\x00\x00\x00R\xff\xff\xff\x00\x00\x00\x01\x10\x00\x00\x00\x10\x00\x00\x00\x04\x00\x00\x00<\x00\x00\x00\\\xfe\xff\xff,\x00\x00\x00sequential_1/conv2d_1/BiasAdd/ReadVariableOp\x00\x00\x00\x00\x01\x00\x00\x00 \x00\x00\x00\xaa\xff\xff\xff\x00\x00\x00\x01\x10\x00\x00\x00\x10\x00\x00\x00\x03\x00\x00\x008\x00\x00\x00\xb4\xfe\xff\xff*\x00\x00\x00sequential_1/conv2d/BiasAdd/ReadVariableOp\x00\x00\x01\x00\x00\x00\x10\x00\x00\x00\x00\x00\x16\x00\x18\x00\x14\x00\x00\x00\x10\x00\x0c\x00\x08\x00\x00\x00\x00\x00\x00\x00\x07\x00\x16\x00\x00\x00\x00\x00\x00\x01\x10\x00\x00\x00\x10\x00\x00\x00\x02\x00\x00\x00\x88\x00\x00\x00 \xff\xff\xffz\x00\x00\x00sequential_1/conv2d/Relu;sequential_1/conv2d/BiasAdd;sequential_1/conv2d/Conv2D;sequential_1/conv2d/BiasAdd/ReadVariableOp\x00\x00\x04\x00\x00\x00\x10\x00\x00\x00\x03\x00\x00\x00\x03\x00\x00\x00\x03\x00\x00\x00\x00\x00\x16\x00\x1c\x00\x18\x00\x00\x00\x14\x00\x10\x00\x0c\x00\x00\x00\x00\x00\x08\x00\x07\x00\x16\x00\x00\x00\x00\x00\x00\x01\x14\x00\x00\x00(\x00\x00\x00(\x00\x00\x00\x01\x00\x00\x00H\x00\x00\x00\x04\x00\x00\x00\xff\xff\xff\xff\xb4\x00\x00\x00\xb4\x00\x00\x00\x03\x00\x00\x00\x04\x00\x04\x00\x04\x00\x00\x00""\x00\x00\x00serving_default_sequential_input:0\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00\xb4\x00\x00\x00\xb4\x00\x00\x00\x03\x00\x00\x00\x04\x00\x00\x00@\x00\x00\x00$\x00\x00\x00\x14\x00\x00\x00\x04\x00\x00\x00\xdc\xff\xff\xff\t\x00\x00\x00\x00\x00\x00\t\xe8\xff\xff\xff\x16\x00\x00\x00\x00\x00\x00\x16\xf4\xff\xff\xff\x11\x00\x00\x00\x00\x00\x00\x11\x0c\x00\x0c\x00\x0b\x00\x00\x00\x00\x00\x04\x00\x0c\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x03'', does not exist.
```
",True
ValueError: Unable to create dataset (name already exists) type:bug comp:apis TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Epoch 1/10
1/1 [==============================] - ETA: 0s - loss: 6.8405 - accuracy: 0.3250
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-57-865e41f45523> in <cell line: 1>()
----> 1 transformer.fit(train_ds, epochs=EPOCHS, validation_data=val_ds,batch_size=BATCH_SIZE,callbacks=[early_stop, checkpoint_call, plot_losses])

2 frames
/usr/local/lib/python3.10/dist-packages/h5py/_hl/dataset.py in make_new_dset(parent, shape, dtype, data, name, chunks, compression, shuffle, fletcher32, maxshape, compression_opts, fillvalue, scaleoffset, track_times, external, track_order, dcpl, dapl, efile_prefix, virtual_prefix, allow_unknown_filter, rdcc_nslots, rdcc_nbytes, rdcc_w0)
    161         sid = h5s.create_simple(shape, maxshape)
    162 
--> 163     dset_id = h5d.create(parent.id, name, tid, sid, dcpl=dcpl, dapl=dapl)
    164 
    165     if (data is not None) and (not isinstance(data, Empty)):

h5py/_objects.pyx in h5py._objects.with_phil.wrapper()

h5py/_objects.pyx in h5py._objects.with_phil.wrapper()

h5py/h5d.pyx in h5py.h5d.create()

ValueError: Unable to create dataset (name already exists)


i want to save each epoch as a checkpoint two weeks back back without any any error each checkpoint will save as a checkpoint but suddenly now getting error

### Standalone code to reproduce the issue

```shell
import matplotlib.pyplot as plt

from tensorflow.keras.callbacks import Callback


import os

checkpoint_dir = '/model/checkpoints_m_1'

if not os.path.exists(checkpoint_dir):
    os.makedirs(checkpoint_dir)
from tensorflow.keras.callbacks import EarlyStopping
early_stop = EarlyStopping(monitor='val_loss', patience=3)
# Set up the model checkpoint callback
checkpoint_call = ModelCheckpoint(filepath=checkpoint_dir+""/checkpoint_{epoch}.hdf5"",
                                  monitor='val_loss',
                                  save_best_only=True,
                                  save_weights_only=False,
                                  mode='min',
                                  save_freq='epoch')
transformer.fit(train_ds, epochs=EPOCHS, validation_data=val_ds,batch_size=BATCH_SIZE,callbacks=[early_stop, checkpoint_call)
```


### Relevant log output

_No response_",True
tf.data.Dataset.list_files(): You must feed a value for placeholder tensor type:bug,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.12.0-rc1-12-g0db597d0d75 2.12.0

### Custom code

No

### OS platform and distribution

Ubuntu 20.04.5 LTS

### Mobile device

_No response_

### Python version

3.8.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Reading a dataset obtained with `tf.data.Dataset.list_files()` prints incomprehensible warnings.

Create two files:
```bash
touch a.txt
touch b.txt
```
Run this python program:
```python
import tensorflow as tf
dataset = tf.data.Dataset.list_files(['a.txt', 'b.txt'])
for f in dataset: 
    print(f)
```

Prints some incomprehensible warnings:
```
tf.Tensor(b'b.txt', shape=(), dtype=string)
tf.Tensor(b'a.txt', shape=(), dtype=string)

2023-09-07 17:19:04.634978: I tensorflow/core/common_runtime/executor.cc:1197] [/device:CPU:0] (DEBUG INFO) Executor start aborting (this does not indicate an error and you can ignore this message): INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_0' with dtype string and shape [2]
	 [[{{node Placeholder/_0}}]]
2023-09-07 17:19:04.635273: I tensorflow/core/common_runtime/executor.cc:1197] [/device:CPU:0] (DEBUG INFO) Executor start aborting (this does not indicate an error and you can ignore this message): INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_0' with dtype string and shape [2]
	 [[{{node Placeholder/_0}}]]
```
This is a ~duplicate of https://github.com/tensorflow/tensorflow/issues/41648 that was marked as resolved 3 years ago.

### Standalone code to reproduce the issue

```shell
With tensorflow==2.12.0:  
https://colab.research.google.com/drive/1_kjUH6BzcLnlM4rc8mY7JcnhE5NdaRGy?usp=sharing

No warning with tensorflow==2.11.1  
https://colab.research.google.com/drive/1QhatrE7hdJIxIUAIrYw5yDPQ50SeqFrI?usp=sharing
```


### Relevant log output

```shell
2023-09-07 17:19:04.635273: I tensorflow/core/common_runtime/executor.cc:1197] [/device:CPU:0] (DEBUG INFO) Executor start aborting (this does not indicate an error and you can ignore this message): INVALID_ARGUMENT: You must feed a value for placeholder tensor 'Placeholder/_0' with dtype string and shape [2]
	 [[{{node Placeholder/_0}}]]
```
",True
Linux tensorflow build from source: bash failed genrule-setup.sh has carriage return type:docs-bug stat:awaiting response type:bug type:build/install stale TF 2.13,"### Issue type

Documentation Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.13

### Custom code

Yes

### OS platform and distribution

Linux

### Mobile device

_No response_

### Python version

3.10

### Bazel version

5.3.0

### GCC/compiler version

LLVM = CLang = 16

### CUDA/cuDNN version

CPU only

### GPU model and memory

N/A

### Current behavior?

bazel build fails with ""bash failed: error executing command"", ""/bin/bash: line 1: $'\r': command not found""
(bash failed, genrule-setup.sh has carriage return (windows line endings))
modifying this .sh file does not work, because bazel won't even start the build, saying that file is modified, it might be corrupt.

Docs need to tell us we should check out tf repo after 
`git config --global core.autocrlf input`
Thanks.

### Standalone code to reproduce the issue

```shell
# git config --global core.autocrlf input  # very important!!!  otherwise your bazel build will fail, because an invoked shell script will have Windows line endings.
# git config --global core.eol lf
git clone https://github.com/tensorflow/tensorflow.git &
cd tensorflow
git checkout -b r2.13 origin/r2.13
apt install python3.10-venv
cd ..

python3 -m venv tf_venv
tf_venv/bin/pip install -U pip numpy wheel packaging requests opt_einsum
tf_venv/bin/pip install -U keras_preprocessing --no-deps

wget https://github.com/bazelbuild/bazelisk/releases/download/v1.18.0/bazelisk-linux-amd64
mv bazelisk-linux-amd64 bazel
chmod +x bazel
mv -v bazel /usr/local/bin

#install clang-16 

cd tensorflow
../tf_venv/bin/python3 configure.py   # (dl clang: N, opti flag: -msse4.1)
bazel build  --local_ram_resources=2048 --jobs=4 --verbose_failures  //tensorflow/tools/pip_package:build_pip_package
```


### Relevant log output

_No response_",True
bazel  test failed with some ctest type:bug subtype: ubuntu/linux TF 2.12,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf2.12

### Custom code

Yes

### OS platform and distribution

centos7.6

### Mobile device

_No response_

### Python version

3.9

### Bazel version

5.3.0

### GCC/compiler version

9.3.1

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

After compiling tensorflow based on the source code, bazel test is executed for unit testing, some test items are passed, but there are many failures, and the reasons for the error are as follows
So I want to know if I'm executing the statement incorrectly, how should I set it up?
bazel test -c opt  --config=cuda  --test_sharding_strategy=disabled  //tensorflow/core/kernels/...
output information:
exec ${PAGER:-/usr/bin/less} ""$0"" || exit 1
Executing tests from //tensorflow/core/kernels/image:resize_ops_test_gpu

![image](https://github.com/tensorflow/tensorflow/assets/30514703/bc876890-814c-4488-8c74-ee9f46960ada)


![image](https://github.com/tensorflow/tensorflow/assets/30514703/befa4291-9404-42d1-956a-11250f384cc4)


### Standalone code to reproduce the issue

```shell
bazel test -c opt  --config=cuda  --test_sharding_strategy=disabled  //tensorflow/core/kernels/...
```


### Relevant log output

_No response_",True
Cannot create interpreter when using GPU-Delegate or NNAPI-Delegate stat:awaiting response type:bug stale comp:lite TFLiteNNAPIDelegate TFLiteGooglePlayServices,"**System information**
- Android Device information: samsung/a14mnseea/a14m:13/TP1A.220624.014/A145RXXU2AWG3:user/release-keys
- TensorFlow Lite in Play Services SDK version (found in `build.gradle`):
  - com.google.android.gms:play-services-tflite-java:16.1.0
  - com.google.android.gms:play-services-tflite-support:16.1.0
  - com.google.android.gms:play-services-tflite-gpu:16.2.0
- Google Play Services version: 23.33.16

**Standalone code to reproduce the issue**

        var useGpu = Tasks.await(TfLiteGpu.isGpuDelegateAvailable(context));
        var optionsBuilder = TfLiteInitializationOptions.builder();

        optionsBuilder.setEnableGpuDelegateSupport(useGpu);

        Tasks.await(TfLite.initialize(context, optionsBuilder.build()));

        var options =  new InterpreterApi.Options();
        if(useGpu){
            options.addDelegateFactory(new GpuDelegateFactory());
        }

        /*delegate = new NnApiDelegate();
        options.addDelegate(delegate);
        options.setUseNNAPI(true);*/

        options.setRuntime(InterpreterApi.Options.TfLiteRuntime.FROM_SYSTEM_ONLY);

        //load Model from App assets
        interpreter = InterpreterApi.create(new File(modelPath), options);

**Any other info / logs**
I oriented my code on the official documentation [on here](https://www.tensorflow.org/lite/android/delegates/gpu)

Logcat-Output:
java.lang.IllegalArgumentException: Internal error: Cannot create interpreter: 
                                                                                                    	at com.google.android.gms.tflite.NativeInterpreterWrapper.createInterpreter(Native Method)
                                                                                                    	at com.google.android.gms.tflite.NativeInterpreterWrapper.zzl(com.google.android.gms:play-services-tflite-java@@16.1.0:34)
                                                                                                    	at com.google.android.gms.tflite.NativeInterpreterWrapper.<init>(com.google.android.gms:play-services-tflite-java@@16.1.0:6)
                                                                                                    	at com.google.android.gms.tflite.zzd.<init>(com.google.android.gms:play-services-tflite-java@@16.1.0:1)
                                                                                                    	at com.google.android.gms.tflite.InterpreterFactoryImpl.create(com.google.android.gms:play-services-tflite-java@@16.1.0:2)
                                                                                                    	at org.tensorflow.lite.InterpreterApi.create(InterpreterApi.java:336)
                                                                                                    	at com.example.tfliteaudio.TFLiteEngine.initialize(TFLiteEngine.java:83)
                                                                                                    	at com.example.tfliteaudio.MainActivity.lambda$transcribeAudio$5(MainActivity.java:143)
                                                                                                    	at com.example.tfliteaudio.MainActivity.$r8$lambda$1xqJ9hAvPXTc26gXgWfy8QcV0VE(Unknown Source:0)
                                                                                                    	at com.example.tfliteaudio.MainActivity$$ExternalSyntheticLambda2.run(Unknown Source:2)
                                                                                                    	at java.lang.Thread.run(Thread.java:1012)
",True
Memory leak when using tf.Model and tf.Model.fit() in a loop. clear_session() does not help stat:awaiting response type:bug stale comp:keras TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes (tf-nightly = ""2.15.0.dev20230904"")

### Source

source

### TensorFlow version

2.13, 2.12, 2.11

### Custom code

Yes

### OS platform and distribution

Ubuntu 22.04.1 LTS (GNU/Linux 5.16.10 x86_64)

### Mobile device

_No response_

### Python version

3.10.0, 3.9.0

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

cuDNN 8600

### GPU model and memory

NVIDIA RTX A5000, 24GB

### Current behavior?

Memory usage steadily increases when using tf.keras.Model and tf.keras.Model.fit() in a loop, and leads to Out Of Memory exception saturating the memory eventually. clear_session() does not help. The same code with TF version == 2.9.2 has an almost constant memory usage instead, and works as expected.
I've also opened [this issue](https://github.com/keras-team/tf-keras/issues/286) on Keras's GitHub, months ago, with no solutions from the Keras team.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf # same issue with tf-nightly = ""2.15.0.dev20230904""
import time
import gc
import psutil # psutil == ""5.9.5""
import subprocess as sp

gpus = tf.config.experimental.list_physical_devices('GPU')
for gpu in gpus:
    tf.config.experimental.set_memory_growth(
        device=gpu, enable=True
    )


def get_cpu_memory():
    memory_info = psutil.virtual_memory()
    # you can have the percentage of used RAM
    memory_percent = 100.0 - memory_info.percent
    memory_free_values = memory_info.available / (1024 * 1024)  # in MB
    # you can calculate percentage of available memory
    return memory_free_values, memory_percent


def get_gpu_memory():
    command = ""nvidia-smi --query-gpu=memory.free --format=csv""
    memory_free_info = sp.check_output(command.split()).decode('ascii').split('\n')[:-1][1:]
    memory_free_values = [int(x.split()[0]) for i, x in enumerate(memory_free_info)][0]
    memory_percent = (memory_free_values / 24564) * 100  # my gpu has 24564 MB of memory
    return memory_free_values, memory_percent


class MyModel(tf.keras.Model):

    def __init__(self):
        super().__init__()
        self.dense1 = tf.keras.layers.Dense(1000, activation=tf.nn.relu)
        self.dense2 = tf.keras.layers.Dense(10000, activation=tf.nn.relu)
        self.dense3 = tf.keras.layers.Dense(10000, activation=tf.nn.relu)
        self.dense4 = tf.keras.layers.Dense(1000, activation=tf.nn.softmax)

    def call(self, inputs):
        x = self.dense1(inputs)
        x = self.dense2(x)
        x = self.dense3(x)
        x = self.dense4(x)
        return x


if __name__ == '__main__':
    print(f""Starting.."")
    memory_free_val_initial, memory_perc_initial = get_cpu_memory()
    print(f""[Memory monitoring] Free memory CPU {memory_free_val_initial} MB, {memory_perc_initial} %."")
    memory_free_val_initial_gpu, memory_perc_initial_gpu = get_gpu_memory()
    print(f""[Memory monitoring] Free memory GPU {memory_free_val_initial_gpu} MB, {memory_perc_initial_gpu} %."")

    for r in range(0, 1000):
        model = MyModel()
        # ds = tf.data.Dataset.from_tensor_slices((tf.random.uniform((64*4, 1000)), tf.ones((64*4))))
        ds = (lambda: tf.data.Dataset.from_tensor_slices((tf.random.uniform((64 * 20, 1000)), tf.ones((64 * 20)))))
        model.compile(optimizer='sgd', loss=tf.keras.losses.SparseCategoricalCrossentropy())

        model.fit(ds().batch(64), verbose=0)
        model.evaluate(ds().batch(64), verbose=0)
        tf.keras.backend.clear_session()

        if r % 5 == 0:
            # print every 5 model.fit
            print(f""Round: {r}"")
            memory_free_val, memory_perc = get_cpu_memory()
            print(f""[Memory monitoring] Free memory CPU {memory_free_val} MB, {memory_perc} %."")
            memory_free_val_gpu, memory_perc_gpu = get_gpu_memory()
            print(f""[Memory monitoring] Free memory GPU {memory_free_val_gpu} MB, {memory_perc_gpu} %."")
            if r == 0:
                memory_free_first = memory_free_val
                memory_free_first_gpu = memory_free_val_gpu
            # time.sleep(2)

        del model
        gc.collect()
        del ds

    print(f""[Memory monitoring CPU] Memory usage increased by {memory_free_first - memory_free_val} MB, ""
          ""during the process."")
    print(f""[Memory monitoring GPU] Memory usage increased by {memory_free_first_gpu - memory_free_val_gpu} MB, ""
          ""during the process."")
```


### Relevant log output

```shell
Round: 0
[Memory monitoring] Free memory CPU 56633.48046875 MB, 88.5 %.
[Memory monitoring] Free memory GPU 21180 MB, 86.2237420615535 %.


Round: 995
[Memory monitoring] Free memory CPU 49866.3046875 MB, 77.9 %.
[Memory monitoring] Free memory GPU 21156 MB, 86.12603810454324 %.

[Memory monitoring CPU] Memory usage increased by 6767.17578125 MB, during the process.
[Memory monitoring GPU] Memory usage increased by 24 MB, during the process.
```
",True
"Unable to open file (truncated file: eof = 2568306, sblock->base_addr = 0, stored_eof = 9406464) type:bug subtype:macOS TF 2.13","### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

v2.13.0-rc2-7-g1cb1a030a62 2.13.0

### Custom code

No

### OS platform and distribution

mac os 13.5.1

### Mobile device

_No response_

### Python version

3.11.3

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

---------------------------------------------------------------------------
OSError                                   Traceback (most recent call last)
Cell In[15], line 3
      1 # Create the base model from the pre-trained model MobileNet V2
      2 IMG_SHAPE = IMG_SIZE + (3,)
----> 3 base_model = tf.keras.applications.mobilenet_v2.MobileNetV2(input_shape=IMG_SHAPE,
      4                                                include_top=False,
      5                                                weights='imagenet')

File [~/.pyenv/versions/3.11.3/lib/python3.11/site-packages/keras/src/applications/mobilenet_v2.py:481], in MobileNetV2(input_shape, alpha, include_top, weights, input_tensor, pooling, classes, classifier_activation, **kwargs)
    477         weight_path = BASE_WEIGHT_PATH + model_name
    478         weights_path = data_utils.get_file(
    479             model_name, weight_path, cache_subdir=""models""
    480         )
--> 481     model.load_weights(weights_path)
    482 elif weights is not None:
    483     model.load_weights(weights)

File [~/.pyenv/versions/3.11.3/lib/python3.11/site-packages/keras/src/utils/traceback_utils.py:70], in filter_traceback..error_handler(*args, **kwargs)
     67     filtered_tb = _process_traceback_frames(e.__traceback__)
     68     # To get the full stack trace, call:
     69     # `tf.debugging.disable_traceback_filtering()`
---> 70     raise e.with_traceback(filtered_tb) from None
     71 finally:
     72     del filtered_tb
...
File h5py/_objects.pyx:55, in h5py._objects.with_phil.wrapper()

File h5py/h5f.pyx:106, in h5py.h5f.open()

OSError: Unable to open file (truncated file: eof = 2568306, sblock->base_addr = 0, stored_eof = 9406464)

### Standalone code to reproduce the issue

```shell
https://tensorflow.google.cn/tutorials/images/transfer_learning

# Create the base model from the pre-trained model MobileNet V2
IMG_SHAPE = IMG_SIZE + (3,)
base_model = tf.keras.applications.MobileNetV2(input_shape=IMG_SHAPE,
                                               include_top=False,
                                               weights='imagenet')
```


### Relevant log output

_No response_",True
The model does not save and load correctly when containing `tf.keras.layers.experimental.preprocessing.StringLookup` layer stat:awaiting response type:bug stale comp:keras,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

2.14.0-rc1

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

The model does not save and load correctly when containing `tf.keras.layers.experimental.preprocessing.StringLookup` layer.
It seems that the `vocabulary` is not saved or loaded correctly, which is empty when loading the model.
This behavior may relate to #61369, but different API endpoint.


### Standalone code to reproduce the issue

```python
import pickle
import tensorflow as tf
print(tf.version.GIT_VERSION, tf.version.VERSION, flush=True)

model_input = tf.keras.Input(shape=(1,), dtype=tf.int64)
lookup = tf.keras.layers.experimental.preprocessing.StringLookup(vocabulary=['a', 'b'])(model_input)
output = tf.keras.layers.Dense(10)(lookup)
full_model = tf.keras.Model(model_input, output)

# this part works
try:
    model_bytes = pickle.dumps(full_model)
    model_recovered = pickle.loads(model_bytes)
except Exception as e:
    print(""Failed! Error:"", e, flush=True)
else:
    print(""Success!"", flush=True)

# this part throws an error
try:
    full_model.save(""/tmp/temp_model"")
    full_model_loaded = tf.keras.models.load_model(""/tmp/temp_model"")
    model_bytes = pickle.dumps(full_model_loaded)
    model_recovered = pickle.loads(model_bytes)
except Exception as e:
    print(""Failed! Error:"", e, flush=True)
else:
    print(""Success!"", flush=True)
```


### Relevant log output

```text
v2.14.0-rc0-34-gdd01672d9a9 2.14.0-rc1
Success!
WARNING:tensorflow:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
WARNING:tensorflow:No training configuration found in save file, so the model was *not* compiled. Compile it manually.
WARNING:tensorflow:No training configuration found in save file, so the model was *not* compiled. Compile it manually.
Failed! Error: Error when deserializing class 'StringLookup' using config={'name': 'string_lookup', 'trainable': True, 'dtype': 'int64', 'invert': False, 'max_tokens': None, 'num_oov_indices': 1, 'oov_token': '[UNK]', 'mask_token': None, 'output_mode': 'int', 'sparse': False, 'pad_to_max_tokens': False, 'idf_weights': None, 'vocabulary': [], 'vocabulary_size': 3, 'encoding': 'utf-8'}.

Exception encountered: Cannot set an empty vocabulary, you passed [].
```
",True
"XLA compiled tf.where with known output shape error (set_shape, tf.concat / tf.stack) type:bug comp:xla TF 2.13","### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.13

### Custom code

No

### OS platform and distribution

Google Colab

### Mobile device

_No response_

### Python version

3.10.12

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Output of `tf.where`, when used inside `tf.function` with `jit_compile=True`, can sometimes be used correctly (as with sum), and sometimes raises shape mismatch error (as with concatenation). This error is present even if output shape is set manually with `set_shape`. 

The code below runs without `jit_compile` or with sum instead of `tf.concat`, and only fails if concatenating inside a compiled function. 

Note: `autoclustering` solves the issue on the toy example, but _not_ on the codebase I am working on.

### Standalone code to reproduce the issue

Colab: https://colab.research.google.com/drive/1FuboVMSao8eCZLcZ2F7Fdsa1UvlnHQmG?usp=sharing

```python
import tensorflow as tf

def fun(x, y):
    x = tf.where(x == 1)
    print(f'Shape before (unknown): {x.shape}') 
    x.set_shape(shape=[y.shape[0], 2])
    print(f'Shape after (known): {x.shape}') 
    return tf.concat([x,y], axis=1)  # Concatentation fails
    # return x + y  # Sum would succeed

x = tf.constant([[0,0,1,1,0],
                  [0,1,0,1,0],
                  [1,0,0,0,1],
                  [1,0,1,0,0],
                  [0,1,1,0,0],], dtype=tf.int32)
y = tf.expand_dims(tf.range(x.shape[0] * 2, dtype=tf.int64), axis=-1)

fun(x, y)

tf.function(fun)(x,y)

tf.function(fun, jit_compile=True)(x,y)  # Fails as described above
```


### Relevant log output

```shell
Shape before (unknown): (None, 2)
Shape after (known): (10, 2)
InvalidArgumentError: Cannot concatenate arrays that differ in dimensions other than the one being concatenated. Dimension 0 in both shapes must be equal: s64[<=25,2] vs s64[10,1].
```
",True
incompatible shapes error stat:awaiting response type:bug stale comp:model TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

Ubuntu 22.04.2 LTS

### Mobile device

_No response_

### Python version

3.10.12

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I'm trying to train a model to do binary classification.  I am getting an error about incompatible shapes, but my data seems to be in the correct shape. 









































































































































































































































































































































































### Standalone code to reproduce the issue

```shell
!pip install transformers

import tensorflow as tf
import tensorflow_hub as hub
from transformers import LongformerTokenizer, TFLongformerForSequenceClassification
import pandas as pd
from sklearn.model_selection import train_test_split
import matplotlib.pyplot as plt
from tensorflow.keras.callbacks import LearningRateScheduler
import math
import numpy as np

positive_sentences = [
    ""The weather is absolutely gorgeous today."",
    ""I'm so grateful for the support of my friends and family."",
    ""I achieved my personal best in the race!"",
    ""The new cafe in town serves amazing coffee."",
    ""I love spending time with my adorable pets."",
    ""I received a surprise gift from a dear friend."",
    ""The sunrise this morning was breathtaking."",
    ""I'm excited about the upcoming vacation."",
    ""The concert last night was incredibly entertaining."",
    ""I'm proud of my hard work paying off."",
    ""The park is a peaceful place to relax."",
    ""I found a great book that I can't put down."",
    ""The team's collaboration led to a successful project."",
    ""I'm enjoying learning a new skill."",
    ""Spending time with loved ones always brightens my day."",
    ""I got a promotion at work, and it's a fantastic feeling."",
    ""The movie I watched last night was heartwarming."",
    ""I'm making positive changes in my daily routine."",
    ""The delicious aroma of home-cooked food fills the air."",
    ""I'm surrounded by inspiring and supportive people.""
]

negative_sentences = [
    ""The constant rain is making me feel gloomy."",
    ""I'm disappointed that my plans got canceled."",
    ""The traffic was horrendous this morning."",
    ""I made a mistake on the important presentation."",
    ""I'm feeling overwhelmed with work and tasks."",
    ""The internet connection is frustratingly slow."",
    ""The food I ordered was cold and tasteless."",
    ""I'm exhausted after a long and stressful day."",
    ""My phone battery died at the worst time."",
    ""The store was out of stock of the item I needed."",
    ""I lost my wallet and it's been a hassle."",
    ""The loud construction noise is giving me a headache."",
    ""I'm struggling to meet my deadlines."",
    ""The movie I was looking forward to was disappointing."",
    ""I'm not feeling well and it's affecting my mood."",
    ""My computer crashed and I lost my unsaved work."",
    ""The rude customer service ruined my experience."",
    ""I'm frustrated with the constant delays."",
    ""The rainy weather is putting me in a bad mood."",
    ""I'm stressed about the upcoming exams.""
]

sentences = positive_sentences + negative_sentences

labels = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    ,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
]

df = pd.DataFrame({'sentences':sentences,'labels':labels})

data = df.copy()

display(data.head(5))

tokenizer = LongformerTokenizer.from_pretrained('allenai/longformer-base-4096')
longformer_model = TFLongformerForSequenceClassification.from_pretrained('allenai/longformer-base-4096')

X_train, X_test, y_train, y_test = train_test_split(df['sentences'],df['labels'], stratify=df['labels'])
X_train.head(4)
display(y_train)

x_train_tokens = tokenizer(list(X_train), padding=True, truncation=True, return_tensors=""tf"")
x_test_tokens = tokenizer(list(X_test), padding=True, truncation=True, return_tensors=""tf"")

y_train_encoded = np.array(y_train)
y_test_encoded = np.array(y_test)

display(x_train_tokens)

input_ids = tf.keras.layers.Input(shape=(None,), dtype=tf.int32)
attention_mask = tf.keras.layers.Input(shape=(None,), dtype=tf.int32)
outputs = longformer_model(input_ids, attention_mask=attention_mask)[0]
output_layer = tf.keras.layers.Dense(1, activation='sigmoid', name=""output"")(outputs)

model = tf.keras.Model(inputs=[input_ids, attention_mask], outputs=[output_layer])

def lr_schedule(epoch):
    initial_lr = 0.001  # Set your initial learning rate here
    drop = 0.75
    epochs_drop = 5  # Adjust this value based on your preference
    lr = initial_lr * math.pow(drop, math.floor((1 + epoch) / epochs_drop))
    return lr

lr_scheduler = LearningRateScheduler(lr_schedule)

model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

history = model.fit(
    [x_train_tokens['input_ids'], x_train_tokens['attention_mask']]
    , y_train
    , epochs=5
    , batch_size=5
    , validation_data=([x_test_tokens['input_ids'], x_test_tokens['attention_mask']], y_test)
    , callbacks=[lr_scheduler]
)
```


### Relevant log output

```shell
Epoch 1/5

---------------------------------------------------------------------------

InvalidArgumentError                      Traceback (most recent call last)

<ipython-input-12-24f08ed0005f> in <cell line: 3>()
      1 model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])
      2 
----> 3 history = model.fit(
      4     [x_train_tokens['input_ids'], x_train_tokens['attention_mask']]
      5     , y_train

1 frames

/usr/local/lib/python3.10/dist-packages/tensorflow/python/eager/execute.py in quick_execute(op_name, num_outputs, inputs, attrs, ctx, name)
     51   try:
     52     ctx.ensure_initialized()
---> 53     tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
     54                                         inputs, attrs, num_outputs)
     55   except core._NotOkStatusException as e:

InvalidArgumentError: Graph execution error:

Detected at node 'gradient_tape/model/tf_longformer_for_sequence_classification/longformer/encoder/layer_._0/attention/self/BroadcastGradientArgs_1' defined at (most recent call last):
    File ""/usr/lib/python3.10/runpy.py"", line 196, in _run_module_as_main
      return _run_code(code, main_globals, None,
    File ""/usr/lib/python3.10/runpy.py"", line 86, in _run_code
      exec(code, run_globals)
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel_launcher.py"", line 16, in <module>
      app.launch_new_instance()
    File ""/usr/local/lib/python3.10/dist-packages/traitlets/config/application.py"", line 992, in launch_instance
      app.start()
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel/kernelapp.py"", line 619, in start
      self.io_loop.start()
    File ""/usr/local/lib/python3.10/dist-packages/tornado/platform/asyncio.py"", line 195, in start
      self.asyncio_loop.run_forever()
    File ""/usr/lib/python3.10/asyncio/base_events.py"", line 603, in run_forever
      self._run_once()
    File ""/usr/lib/python3.10/asyncio/base_events.py"", line 1909, in _run_once
      handle._run()
    File ""/usr/lib/python3.10/asyncio/events.py"", line 80, in _run
      self._context.run(self._callback, *self._args)
    File ""/usr/local/lib/python3.10/dist-packages/tornado/ioloop.py"", line 685, in <lambda>
      lambda f: self._run_callback(functools.partial(callback, future))
    File ""/usr/local/lib/python3.10/dist-packages/tornado/ioloop.py"", line 738, in _run_callback
      ret = callback()
    File ""/usr/local/lib/python3.10/dist-packages/tornado/gen.py"", line 825, in inner
      self.ctx_run(self.run)
    File ""/usr/local/lib/python3.10/dist-packages/tornado/gen.py"", line 786, in run
      yielded = self.gen.send(value)
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel/kernelbase.py"", line 361, in process_one
      yield gen.maybe_future(dispatch(*args))
    File ""/usr/local/lib/python3.10/dist-packages/tornado/gen.py"", line 234, in wrapper
      yielded = ctx_run(next, result)
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel/kernelbase.py"", line 261, in dispatch_shell
      yield gen.maybe_future(handler(stream, idents, msg))
    File ""/usr/local/lib/python3.10/dist-packages/tornado/gen.py"", line 234, in wrapper
      yielded = ctx_run(next, result)
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel/kernelbase.py"", line 539, in execute_request
      self.do_execute(
    File ""/usr/local/lib/python3.10/dist-packages/tornado/gen.py"", line 234, in wrapper
      yielded = ctx_run(next, result)
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py"", line 302, in do_execute
      res = shell.run_cell(code, store_history=store_history, silent=silent)
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel/zmqshell.py"", line 539, in run_cell
      return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)
    File ""/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py"", line 2975, in run_cell
      result = self._run_cell(
    File ""/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py"", line 3030, in _run_cell
      return runner(coro)
    File ""/usr/local/lib/python3.10/dist-packages/IPython/core/async_helpers.py"", line 78, in _pseudo_sync_runner
      coro.send(None)
    File ""/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py"", line 3257, in run_cell_async
      has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
    File ""/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py"", line 3473, in run_ast_nodes
      if (await self.run_code(code, result,  async_=asy)):
    File ""/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py"", line 3553, in run_code
      exec(code_obj, self.user_global_ns, self.user_ns)
    File ""<ipython-input-12-24f08ed0005f>"", line 3, in <cell line: 3>
      history = model.fit(
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/utils/traceback_utils.py"", line 65, in error_handler
      return fn(*args, **kwargs)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1742, in fit
      tmp_logs = self.train_function(iterator)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1338, in train_function
      return step_function(self, iterator)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1322, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1303, in run_step
      outputs = model.train_step(data)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1084, in train_step
      self.optimizer.minimize(loss, self.trainable_variables, tape=tape)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/optimizers/optimizer.py"", line 543, in minimize
      grads_and_vars = self.compute_gradients(loss, var_list, tape)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/optimizers/optimizer.py"", line 276, in compute_gradients
      grads = tape.gradient(loss, var_list)
Node: 'gradient_tape/model/tf_longformer_for_sequence_classification/longformer/encoder/layer_._0/attention/self/BroadcastGradientArgs_1'
Detected at node 'gradient_tape/model/tf_longformer_for_sequence_classification/longformer/encoder/layer_._0/attention/self/BroadcastGradientArgs_1' defined at (most recent call last):
    File ""/usr/lib/python3.10/runpy.py"", line 196, in _run_module_as_main
      return _run_code(code, main_globals, None,
    File ""/usr/lib/python3.10/runpy.py"", line 86, in _run_code
      exec(code, run_globals)
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel_launcher.py"", line 16, in <module>
      app.launch_new_instance()
    File ""/usr/local/lib/python3.10/dist-packages/traitlets/config/application.py"", line 992, in launch_instance
      app.start()
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel/kernelapp.py"", line 619, in start
      self.io_loop.start()
    File ""/usr/local/lib/python3.10/dist-packages/tornado/platform/asyncio.py"", line 195, in start
      self.asyncio_loop.run_forever()
    File ""/usr/lib/python3.10/asyncio/base_events.py"", line 603, in run_forever
      self._run_once()
    File ""/usr/lib/python3.10/asyncio/base_events.py"", line 1909, in _run_once
      handle._run()
    File ""/usr/lib/python3.10/asyncio/events.py"", line 80, in _run
      self._context.run(self._callback, *self._args)
    File ""/usr/local/lib/python3.10/dist-packages/tornado/ioloop.py"", line 685, in <lambda>
      lambda f: self._run_callback(functools.partial(callback, future))
    File ""/usr/local/lib/python3.10/dist-packages/tornado/ioloop.py"", line 738, in _run_callback
      ret = callback()
    File ""/usr/local/lib/python3.10/dist-packages/tornado/gen.py"", line 825, in inner
      self.ctx_run(self.run)
    File ""/usr/local/lib/python3.10/dist-packages/tornado/gen.py"", line 786, in run
      yielded = self.gen.send(value)
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel/kernelbase.py"", line 361, in process_one
      yield gen.maybe_future(dispatch(*args))
    File ""/usr/local/lib/python3.10/dist-packages/tornado/gen.py"", line 234, in wrapper
      yielded = ctx_run(next, result)
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel/kernelbase.py"", line 261, in dispatch_shell
      yield gen.maybe_future(handler(stream, idents, msg))
    File ""/usr/local/lib/python3.10/dist-packages/tornado/gen.py"", line 234, in wrapper
      yielded = ctx_run(next, result)
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel/kernelbase.py"", line 539, in execute_request
      self.do_execute(
    File ""/usr/local/lib/python3.10/dist-packages/tornado/gen.py"", line 234, in wrapper
      yielded = ctx_run(next, result)
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py"", line 302, in do_execute
      res = shell.run_cell(code, store_history=store_history, silent=silent)
    File ""/usr/local/lib/python3.10/dist-packages/ipykernel/zmqshell.py"", line 539, in run_cell
      return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)
    File ""/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py"", line 2975, in run_cell
      result = self._run_cell(
    File ""/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py"", line 3030, in _run_cell
      return runner(coro)
    File ""/usr/local/lib/python3.10/dist-packages/IPython/core/async_helpers.py"", line 78, in _pseudo_sync_runner
      coro.send(None)
    File ""/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py"", line 3257, in run_cell_async
      has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
    File ""/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py"", line 3473, in run_ast_nodes
      if (await self.run_code(code, result,  async_=asy)):
    File ""/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py"", line 3553, in run_code
      exec(code_obj, self.user_global_ns, self.user_ns)
    File ""<ipython-input-12-24f08ed0005f>"", line 3, in <cell line: 3>
      history = model.fit(
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/utils/traceback_utils.py"", line 65, in error_handler
      return fn(*args, **kwargs)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1742, in fit
      tmp_logs = self.train_function(iterator)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1338, in train_function
      return step_function(self, iterator)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1322, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1303, in run_step
      outputs = model.train_step(data)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py"", line 1084, in train_step
      self.optimizer.minimize(loss, self.trainable_variables, tape=tape)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/optimizers/optimizer.py"", line 543, in minimize
      grads_and_vars = self.compute_gradients(loss, var_list, tape)
    File ""/usr/local/lib/python3.10/dist-packages/keras/src/optimizers/optimizer.py"", line 276, in compute_gradients
      grads = tape.gradient(loss, var_list)
Node: 'gradient_tape/model/tf_longformer_for_sequence_classification/longformer/encoder/layer_._0/attention/self/BroadcastGradientArgs_1'
2 root error(s) found.
  (0) INVALID_ARGUMENT:  Incompatible shapes: [5,512,12,514] vs. [5,512,12,513]
	 [[{{node gradient_tape/model/tf_longformer_for_sequence_classification/longformer/encoder/layer_._0/attention/self/BroadcastGradientArgs_1}}]]
	 [[model/tf_longformer_for_sequence_classification/longformer/encoder/layer_._6/attention/self/cond_2/pivot_t/_676/_1027]]
  (1) INVALID_ARGUMENT:  Incompatible shapes: [5,512,12,514] vs. [5,512,12,513]
	 [[{{node gradient_tape/model/tf_longformer_for_sequence_classification/longformer/encoder/layer_._0/attention/self/BroadcastGradientArgs_1}}]]
0 successful operations.
0 derived errors ignored. [Op:__inference_train_function_131688]
```
",True
rnn with initial_state model can't be loaded with load_model  stat:awaiting response type:bug comp:keras TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

A simple RNN with LSTMcell model.
I want to initialize the states with `initial_state_h` and `initial_state_c`. 
```
batch_size= 16
inputs = tf.keras.layers.Input(shape=(20,5),batch_size=batch_size)
units = 8
lstm_cell_fw = tf.keras.layers.LSTMCell(units)

initial_state_h = tf.random.normal(shape = (batch_size,units), mean=0., stddev=10., dtype=tf.dtypes.float32)
initial_state_c = tf.random.normal(shape = (batch_size,units), mean=0., stddev=10., dtype=tf.dtypes.float32)
lstm_layer_fw = tf.keras.layers.RNN(lstm_cell_fw, stateful=True, return_state=True, return_sequences=False)
outputs,states_h_fw, states_c_fw= lstm_layer_fw(inputs,initial_state = [initial_state_h,initial_state_c])

lstm_dense1 = tf.keras.layers.Dense(16, activation = 'relu')
lstm_dense2 = tf.keras.layers.Dense(2, activation = 'softmax')
out=lstm_dense2(lstm_dense1(outputs))

model = tf.keras.models.Model(inputs, out)
```
After compile and train, the model is saved with `model.save('my_model_test.keras')`.

```
model.compile(optimizer='adam', loss='categorical_crossentropy',metrics=['accuracy'])
model.summary()

xTrain = np.random.rand(96,20,5)
yTrain = np.random.rand(96,2)

for i in range(10):
  model.fit(xTrain, yTrain,batch_size=batch_size)

model.save('my_model_test.keras')

```
But when I try to load it with `load_model = tf.keras.models.load_model('my_model_test.keras')`, it gives error:
```
13 frames
[/usr/local/lib/python3.10/dist-packages/keras/src/backend.py](https://localhost:8080/#) in int_shape(x)
   1530     """"""
   1531     try:
-> 1532         shape = x.shape
   1533         if not isinstance(shape, tuple):
   1534             shape = tuple(shape.as_list())

AttributeError: 'float' object has no attribute 'shape'

```
I tried to save in other format, `.h5`, `.json`, etc. All give the same error.

But, if I don't use `initial_state` in `outputs,states_h_fw, states_c_fw= lstm_layer_fw(inputs)`, everything goes well. No problem with `load_model`.

### Standalone code to reproduce the issue

```shell
https://colab.research.google.com/drive/1uKEpnddzeYSRG_1vKjtcQ4OLNwLuQeqy?usp=sharing
```


### Relevant log output

```shell
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-7-8e0130abf25e> in <cell line: 1>()
----> 1 load_model = tf.keras.models.load_model('my_model_test.keras')

13 frames
/usr/local/lib/python3.10/dist-packages/keras/src/backend.py in int_shape(x)
   1530     """"""
   1531     try:
-> 1532         shape = x.shape
   1533         if not isinstance(shape, tuple):
   1534             shape = tuple(shape.as_list())

AttributeError: 'float' object has no attribute 'shape'
```
```
",True
Will there a MLP model in the future version? type:bug,"### Issue type

Feature Request

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13.0

### Custom code

No

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

When building deep learning models like Multi-Layer Perceptrons (MLPs), code reusability and conciseness are crucial factors. Currently, using `tf.keras.Sequential` in TensorFlow allows for convenient creation of sequential models. However, manually adding common operations such as Batch Normalization or Dropout to each layer can lead to code redundancy and an increased burden in terms of coding and maintenance. Therefore, proposing the addition of a feature in TensorFlow to directly create MLPs with Batch Normalization and Dropout is highly beneficial.

Here are several reasons why this feature would be advantageous for TensorFlow users:

1. **Simplified Code**: Users won't need to manually add Batch Normalization and Dropout operations to each layer, resulting in cleaner, more readable, and maintainable code.

2. **Reduced Error Rate**: Manual copy-pasting of code is error-prone, especially as model complexity increases. Automating the integration of Batch Normalization and Dropout operations can reduce issues arising from code errors.

3. **Increased Productivity**: Developers can build and iterate on models more swiftly, focusing on design and parameter tuning rather than rewriting the same code segments for every new model.

4. **Education and Learning**: For newcomers to TensorFlow, this feature can provide a quicker onboarding process, lowering the learning curve and enabling them to grasp and apply deep learning concepts faster.

Certainly, here's the additional information:

I also believe that PyTorch has implemented MLP functionality quite effectively. An example of this can be found in the following URL: [PyTorch MLP](https://pytorch.org/vision/main/generated/torchvision.ops.MLP.html). PyTorch's approach to creating MLPs provides a good reference for how TensorFlow could potentially integrate similar features.

### Standalone code to reproduce the issue

```shell
origin

model = tf.keras.Sequential([
    tf.keras.layers.Dense(128),
    tf.keras.layers.BatchNormalization(),
    tf.keras.layers.ReLU(),
    tf.keras.layers.Dropout(0.2),
    tf.keras.layers.Dense(64),
    tf.keras.layers.BatchNormalization(),
    tf.keras.layers.ReLU(),
    tf.keras.layers.Dropout(0.2),
    tf.keras.layers.Dense(32),
    tf.keras.layers.BatchNormalization(),
    tf.keras.layers.ReLU(),
    tf.keras.layers.Dropout(0.2),
    tf.keras.layers.Dense(10),
])


with MLP model
```python
model = tf.keras.MLP(
    hidden_channels=[128, 64, 32, 10],
    norm_layer=tf.keras.layers.BatchNormalization,
    activation_layer=tf.keras.layers.ReLU,
    dropout=0.2,
)
```
```


### Relevant log output

_No response_",True
Issues with Running Custom TensorFlow Lite Model in C++ stat:awaiting response type:bug stale comp:lite TFLiteConverter TF 2.11,"### 1. System information

- Platform and Linux distribution kubuntu 22.04:
- TensorFlow is built from C++ source code:
- Tensorflow 2.11:

### 2. Code

- Link to models that I trained and tried but they don't work in C++ - https://github.com/asuemg1/models_hub/tree/main/Tensorflow%20Lite/Object%20Detection/my_ssd_mobnet/Optimized%20Models
- Link to the model that works in C++ - https://github.com/ankdesh/tflite/blob/master/Android-TensorFlow-Lite-Example/app/src/main/assets/mobilenet_quant_v1_224.tflite
- Link to C++ code (mainwindow.cpp file):
https://drive.google.com/file/d/1u87yK-1qqKeHBjUKq-Lkxi0LMQKkdrPg/view?usp=sharing

### 3. Crash after conversion

- The model does not work in C++.

Please tell me how you can run the Tensorflow Lite model (tflite format) for object detection or image classification in C ++.

My steps:
- Trained the model for object detection using Tensorflow 2 API object detection.
- After training, I converted the model to the savedmodel format, and then to tflite.
- Next, I needed to embed this model into a C++ project. In order to use it in the future on low-power devices such as rasberry pi

My actions:
- Compiled the Tensorflow Lite library for C++.
- Found a test case using the mobilenet_quant_v1_224.tflite model. In this test case, the model runs successfully. However, when trying to use my own model, it does not work, although it has been tested and works in Python.

What was found out:

- The mobilenet_quant_v1_224.tflite model was quantized and had no metadata and no internal labelmap.txt file.
- TensorFlow Lite API 2 for C++ does not currently support metadata.

If you have any information on how to get my tflite model to work in C++ please share.",True
"extensions eglQueryDevicesEXT, eglQueryDeviceAttribEXT and eglGetPlatformDisplayEXT not available stat:awaiting response type:bug stale TF 1.13","### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

1.13.1

### Custom code

Yes

### OS platform and distribution

Unbuntu 22

### Mobile device

_No response_

### Python version

Python 2.7

### Bazel version

_No response_

### GCC/compiler version

9.4.0

### CUDA/cuDNN version

10

### GPU model and memory

GTX 1060 

### Current behavior?

Hi, I got this error when I run Dirt model with my tensorflow-gpu 1.13.1 . 

`2023-08-25 15:23:37.711796: F /home/engineer1/dirt/csrc/gl_common.h:46] extensions eglQueryDevicesEXT, eglQueryDeviceAttribEXT and eglGetPlatformDisplayEXT not available`

### Standalone code to reproduce the issue

```shell
import numpy as np
import tensorflow as tf
import dirt

canvas_width, canvas_height = 128, 128
centre_x, centre_y = 32, 64
square_size = 16


def get_non_dirt_pixels():
    xs, ys = tf.meshgrid(tf.range(canvas_width), tf.range(canvas_height))
    xs = tf.cast(xs, tf.float32) + 0.5
    ys = tf.cast(ys, tf.float32) + 0.5
    x_in_range = tf.less_equal(tf.abs(xs - centre_x), square_size / 2)
    y_in_range = tf.less_equal(tf.abs(ys - centre_y), square_size / 2)
    return tf.cast(tf.logical_and(x_in_range, y_in_range), tf.float32)


def get_dirt_pixels():

    # Build square in screen space
    square_vertices = tf.constant([[0, 0], [0, 1], [1, 1], [1, 0]], dtype=tf.float32) * square_size - square_size / 2.
    square_vertices += [centre_x, centre_y]

    # Transform to homogeneous coordinates in clip space
    square_vertices = square_vertices * 2. / [canvas_width, canvas_height] - 1.
    square_vertices = tf.concat([square_vertices, tf.zeros([4, 1]), tf.ones([4, 1])], axis=1)

    return dirt.rasterise(
        vertices=square_vertices,
        faces=[[0, 1, 2], [0, 2, 3]],
        vertex_colors=tf.ones([4, 1]),
        background=tf.zeros([canvas_height, canvas_width, 1]),
        height=canvas_height, width=canvas_width, channels=1
    )[:, :, 0]


def main():

    if '.' in tf.__version__ and int(tf.__version__.split('.')[0]) < 2:

        session = tf.Session()
        with session.as_default():

            non_dirt_pixels = get_non_dirt_pixels().eval()
            dirt_pixels = get_dirt_pixels().eval()

    else:

        non_dirt_pixels = get_non_dirt_pixels().numpy()
        dirt_pixels = get_dirt_pixels().numpy()

    if np.all(non_dirt_pixels == dirt_pixels):
        print('successful: all pixels agree')
    else:
        print('failed: {} pixels disagree'.format(np.sum(non_dirt_pixels != dirt_pixels)))


if __name__ == '__main__':
    main()
```


### Relevant log output

```shell
2023-08-25 15:23:37.181664: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2023-08-25 15:23:37.186756: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2496000000 Hz
2023-08-25 15:23:37.189184: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x24d6bf0 executing computations on platform Host. Devices:2023-08-25 15:23:37.189205: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2023-08-25 15:23:37.478413: E tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:984] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2023-08-25 15:23:37.478518: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x233ae60 executing computations on platform CUDA. Devices:2023-08-25 15:23:37.478540: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): NVIDIA GeForce GTX 1060 6GB, Compute Capability 6.1
2023-08-25 15:23:37.478666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties:
name: NVIDIA GeForce GTX 1060 6GB major: 6 minor: 1 memoryClockRate(GHz): 1.7085
pciBusID: 0000:01:00.0
totalMemory: 6.00GiB freeMemory: 5.09GiB
2023-08-25 15:23:37.478681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2023-08-25 15:23:37.478801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-08-25 15:23:37.478813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0
2023-08-25 15:23:37.478817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N
2023-08-25 15:23:37.478968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1194] Could not identify NUMA node of platform GPU id 0, defaulting to 0.  Your kernel may not have been built with NUMA support.
2023-08-25 15:23:37.479033: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4913 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce GTX 1060 6GB, pci bus id: 0000:01:00.0, compute capability: 6.1)
2023-08-25 15:23:37.711796: F /home/engineer1/dirt/csrc/gl_common.h:46] extensions eglQueryDevicesEXT, eglQueryDeviceAttribEXT and eglGetPlatformDisplayEXT not available
Aborted
```
",True
JIT yields inconsistent results using tf.math.top_k stat:awaiting response type:bug comp:ops,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

2.15.0-dev20230824

### Custom code

Yes

### OS platform and distribution

Ubuntu 22.04

### Mobile device

_No response_

### Python version

3.11

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

cuda_11.8.r11.8/compiler.31833905_0 / cuDNN version 8700

### GPU model and memory

NVIDIA GeForce RTX 2080 Ti

### Current behavior?

JIT yields inconsistent results using `tf.math.top_k` when `index_type=tf.int32` (no issue with `index_type=tf.int64`).

### Standalone code to reproduce the issue

```shell
import tensorflow as tf


@tf.function(jit_compile=True)
def tf_func(shape):
    x = tf.random.stateless_normal(shape, seed=(1, 2))
    x = tf.transpose(x, perm=[1, 0])
    topk_max, indices = tf.math.top_k(x, 1, sorted=False, index_type=tf.int32)
    reduce_max = tf.reduce_max(x, axis=1, keepdims=True)
    return topk_max - reduce_max


def check(shape):
    should_be_all_zero = tf_func(shape)
    print(f""should_be_all_zero shape {shape}:\n{should_be_all_zero}"")


check((1024, 3))
check((1023, 3))
check((1024, 2))
```


### Relevant log output

```shell
should_be_all_zero shape (1024, 3):
[[-0.7787831 ]
 [ 0.47324872]
 [ 0.30553436]]
should_be_all_zero shape (1023, 3):
[[0.]
 [0.]
 [0.]]
should_be_all_zero shape (1024, 2):
[[0.]
 [0.]]
```
",True
Batch matmul imprecision stat:awaiting response type:bug stale comp:ops TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13 / 2.14.0-dev20230706

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 20.04

### Mobile device

_No response_

### Python version

3.8

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

```
$ mamba list | grep cu
cuda-nvcc                 12.2.128                      0    nvidia
cudatoolkit               11.8.0              h4ba93d1_12    conda-forge
nvidia-cublas-cu11        2022.4.8                 pypi_0    pypi
nvidia-cublas-cu117       11.10.1.25               pypi_0    pypi
nvidia-cuda-nvrtc-cu11    2022.4.8                 pypi_0    pypi
nvidia-cuda-nvrtc-cu117   11.7.50                  pypi_0    pypi
nvidia-cudnn-cu11         8.9.4.25                 pypi_0    pypi
```
### GPU model and memory

NVIDIA GeForce RTX 3060 - 12 GB
Driver Version: 520.61.05

### Current behavior?

I'm trying to do a batch matrix multiply (i.e. I've got a bunch of m x n matrices, all in one tensor, and I want to do a matrix multiply of each of them with some other matrix). However, I'm getting slightly different results than I get from Numpy (and previous TensorFlow versions, this script passed for me in 2.9). 

One interesting thing is that the value 25 (the second dimension of `x`) is significant. If I reduce this to 16 or below, it passes. Also, if I change the second dimension of `c` from 2 to 1, it also passes.

### Standalone code to reproduce the issue

```python
import numpy as np
import tensorflow as tf

print(f""file: {tf.__file__}"")
print(f""git version: {tf.version.GIT_VERSION}"")
print(f""version: {tf.__version__}"")

rng = np.random.RandomState(0)
x = rng.uniform(-1, 1, size=(1, 25, 5)).astype(np.float32)
c = rng.uniform(-1, 1, size=(5, 2)).astype(np.float32)

y = x @ c

x2 = np.tile(x, (2, 1, 1))
y2 = x2 @ c

for y2i in y2:
    np.testing.assert_allclose(y2i, y.squeeze(0))

tols = dict(atol=1e-7, rtol=1e-5)

z = tf.matmul(x, c).numpy()
# z = tf.einsum(""...tq,...qr->...tr"", x, c)
np.testing.assert_allclose(z, y, **tols)

z2 = tf.matmul(x2, c).numpy()
# z2 = tf.einsum(""...tq,...qr->...tr"", x2, c)
np.testing.assert_allclose(z2, y2, **tols)
```


### Relevant log output

```shell
file: /home/ehunsber/mambaforge/envs/tf213/lib/python3.8/site-packages/tensorflow/__init__.py
git version: v1.12.1-96406-gfa4d29bfef8
version: 2.14.0-dev20230706
Traceback (most recent call last):
  File ""test_batch.py"", line 26, in <module>
    np.testing.assert_allclose(z2, y2)
  File ""/home/ehunsber/mambaforge/envs/tf213/lib/python3.8/site-packages/numpy/testing/_private/utils.py"", line 1592, in assert_allclose
    assert_array_compare(compare, actual, desired, err_msg=str(err_msg),
  File ""/home/ehunsber/mambaforge/envs/tf213/lib/python3.8/contextlib.py"", line 75, in inner
    return func(*args, **kwds)
  File ""/home/ehunsber/mambaforge/envs/tf213/lib/python3.8/site-packages/numpy/testing/_private/utils.py"", line 862, in assert_array_compare
    raise AssertionError(msg)
AssertionError: 
Not equal to tolerance rtol=1e-07, atol=0

Mismatched elements: 100 / 100 (100%)
Max absolute difference: 0.00046098
Max relative difference: 0.01047752
 x: array([[[-0.187503,  0.005696],
        [-0.255552, -0.84404 ],
        [ 0.268836, -1.250793],...
 y: array([[[-0.187499,  0.005691],
        [-0.255404, -0.844322],
        [ 0.268935, -1.251033],...
```
",True
Unit test failure when built with clang awaiting review type:bug type:support subtype: ubuntu/linux,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

git HEAD

### Custom code

No

### OS platform and distribution

Ubuntu 20.04

### Mobile device

n/a

### Python version

3.9.17

### Bazel version

6.1.0

### GCC/compiler version

16.0.6

### CUDA/cuDNN version

n/a

### GPU model and memory

n/a

### Current behavior?

//tensorflow/compiler/mlir/lite/sparsity:sparsify_model_test throws a segfault

### Standalone code to reproduce the issue

```shell
bazel test --cache_test_results=no --config=mkl_aarch64_threadpool --copt=-flax-vector-conversions --test_env=TF_ENABLE_ONEDNN_OPTS=1 --test_env=TF2_BEHAVIOR=1 --define=tf_api_version=2 --test_output=errors --verbose_failures=true --test_keep_going --notest_verbose_timeout_warnings --build_tests_only -- //tensorflow/compiler/mlir/lite/sparsity:sparsify_model_test
```


### Relevant log output

```shell
==================== Test output for //tensorflow/compiler/mlir/lite/sparsity:sparsify_model_test:
2023-08-23 14:23:54.976080: I tensorflow/core/util/port.cc:111] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-08-23 14:23:54.977641: W tensorflow/tsl/lib/monitoring/collection_registry.cc:81] Trying to register 2 metrics with the same name: /tensorflow/core/bfc_allocator_delay. The old value will be erased in order to register a new one. Please check if you link the metric more than once, or if the name is already used by other metrics.
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from SparsifyModelTest
[ RUN      ] SparsifyModelTest.MetadataIsAddedToOutputModel
================================================================================
Target //tensorflow/compiler/mlir/lite/sparsity:sparsify_model_test up-to-date:
  bazel-bin/tensorflow/compiler/mlir/lite/sparsity/sparsify_model_test
INFO: Elapsed time: 557.635s, Critical Path: 355.66s
INFO: 4267 processes: 707 internal, 3560 local.
INFO: Build completed, 1 test FAILED, 4267 total actions
//tensorflow/compiler/mlir/lite/sparsity:sparsify_model_test             FAILED in 1.0s
  /home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/aarch64-opt/testlogs/tensorflow/compiler/mlir/lite/sparsity/sparsify_model_test/test.log

Executed 1 out of 1 test: 1 fails locally.
andrew@8bde10e59b61:/workspace$ gdb bazel-bin/tensorflow/compiler/mlir/lite/sparsity/sparsify_model_test
GNU gdb (Ubuntu 9.2-0ubuntu1~20.04.1) 9.2
Copyright (C) 2020 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type ""show copying"" and ""show warranty"" for details.
This GDB was configured as ""aarch64-linux-gnu"".
Type ""show configuration"" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
    <http://www.gnu.org/software/gdb/documentation/>.

For help, type ""help"".
Type ""apropos word"" to search for commands related to ""word""...
Reading symbols from bazel-bin/tensorflow/compiler/mlir/lite/sparsity/sparsify_model_test...
(gdb) run
Starting program: /home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow/bazel-out/aarch64-opt/bin/tensorflow/compiler/mlir/lite/sparsity/sparsify_model_test 
warning: Error disabling address space randomization: Operation not permitted
[Thread debugging using libthread_db enabled]
Using host libthread_db library ""/lib/aarch64-linux-gnu/libthread_db.so.1"".
2023-08-23 14:26:40.332993: W tensorflow/tsl/lib/monitoring/collection_registry.cc:81] Trying to register 2 metrics with the same name: /tensorflow/core/bfc_allocator_delay. The old value will be erased in order to register a new one. Please check if you link the metric more than once, or if the name is already used by other metrics.
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from SparsifyModelTest
[ RUN      ] SparsifyModelTest.MetadataIsAddedToOutputModel

Program received signal SIGSEGV, Segmentation fault.
0x0000ffff80a09040 in ?? () from /lib/aarch64-linux-gnu/libc.so.6
(gdb) bt
#0  0x0000ffff80a09040 in ?? () from /lib/aarch64-linux-gnu/libc.so.6
#1  0x0000ffff8b3df258 in std::__fill_a1<unsigned char> (__first=0xaaaaf5cbc9c1 """", __last=0xaaaaf5cbc9c0 """", __c=@0xaaaaf5cbc9c0: 0 '\000')
    at /dt10/usr/lib/gcc/aarch64-unknown-linux-gnu/10/../../../../include/c++/10/bits/stl_algobase.h:893
#2  std::__fill_a<unsigned char*, unsigned char> (__first=0xaaaaf5cbc9c1 """", __last=0xaaaaf5cbc9c0 """", __value=@0xaaaaf5cbc9c0: 0 '\000')
    at /dt10/usr/lib/gcc/aarch64-unknown-linux-gnu/10/../../../../include/c++/10/bits/stl_algobase.h:914
#3  std::__fill_n_a<unsigned char*, unsigned long, unsigned char> (__n=18446744073708562752, __value=@0xaaaaf5cbc9c0: 0 '\000', 
    __first=<optimized out>) at /dt10/usr/lib/gcc/aarch64-unknown-linux-gnu/10/../../../../include/c++/10/bits/stl_algobase.h:1065
#4  std::fill_n<unsigned char*, unsigned long, unsigned char> (__n=18446744073708562752, __value=@0xaaaaf5cbc9c0: 0 '\000', 
    __first=<optimized out>) at /dt10/usr/lib/gcc/aarch64-unknown-linux-gnu/10/../../../../include/c++/10/bits/stl_algobase.h:1094
#5  std::__uninitialized_default_n_1<true>::__uninit_default_n<unsigned char*, unsigned long> (__first=0xaaaaf5cbc9c0 """", __n=<optimized out>)
    at /dt10/usr/lib/gcc/aarch64-unknown-linux-gnu/10/../../../../include/c++/10/bits/stl_uninitialized.h:598
#6  std::__uninitialized_default_n<unsigned char*, unsigned long> (__first=0xaaaaf5cbc9c0 """", __n=<optimized out>)
    at /dt10/usr/lib/gcc/aarch64-unknown-linux-gnu/10/../../../../include/c++/10/bits/stl_uninitialized.h:632
#7  std::__uninitialized_default_n_a<unsigned char*, unsigned long, unsigned char> (__first=0xaaaaf5cbc9c0 """", __n=<optimized out>)
    at /dt10/usr/lib/gcc/aarch64-unknown-linux-gnu/10/../../../../include/c++/10/bits/stl_uninitialized.h:698
#8  std::vector<unsigned char, std::allocator<unsigned char> >::_M_default_initialize (this=0xffffe8e7e728, __n=<optimized out>)
    at /dt10/usr/lib/gcc/aarch64-unknown-linux-gnu/10/../../../../include/c++/10/bits/stl_vector.h:1606
#9  std::vector<unsigned char, std::allocator<unsigned char> >::vector (this=0xffffe8e7e728, __n=0, __a=...)
    at /dt10/usr/lib/gcc/aarch64-unknown-linux-gnu/10/../../../../include/c++/10/bits/stl_vector.h:512
#10 (anonymous namespace)::Translator::BuildCustomOperator (this=this@entry=0xffffe8e801b8, inst=<optimized out>, op=..., 
    operands=std::vector of length 1, capacity 1 = {...}, results=std::vector of length 1, capacity 1 = {...})
    at tensorflow/compiler/mlir/lite/flatbuffer_export.cc:1248
#11 0x0000ffff8b3d7ca0 in (anonymous namespace)::Translator::BuildOperator (this=this@entry=0xffffe8e801b8, inst=inst@entry=0xaaaaf5d48ec0, 
    operands=std::vector of length 1, capacity 1 = {...}, results=std::vector of length 1, capacity 1 = {...}, 
    intermediates=std::vector of length 0, capacity 0) at tensorflow/compiler/mlir/lite/flatbuffer_export.cc:1434
#12 0x0000ffff8b3d0774 in (anonymous namespace)::Translator::BuildSubGraph (this=this@entry=0xffffe8e801b8, name=""main"", region=0x0, 
    index=index@entry=0) at tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2036
#13 0x0000ffff8b3c7934 in (anonymous namespace)::Translator::TranslateInternal[abi:cxx11]() (this=<optimized out>, this@entry=0xffffe8e801b8)
    at tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2429
#14 0x0000ffff8b3c5bb8 in (anonymous namespace)::Translator::Translate (module=..., toco_flags=..., Python Exception <class 'gdb.error'> No type named std::__detail::_Hash_node<class std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, true>.: 
tags=std::unordered_set with 0 elements, 
    op_or_arg_name_mapper=0xffffe8e7fbc0, metadata=Python Exception <class 'AttributeError'> 'NoneType' object has no attribute 'pointer': 
std::map with 1 element) at tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2331
#15 tflite::MlirToFlatBufferTranslateFunction (module=..., options=..., serialized_flatbuffer=serialized_flatbuffer@entry=0xffffe8e80a00)
    at tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2838
#16 0x0000ffff8b443498 in mlir::lite::SparsifyModel (input_model=..., builder=builder@entry=0xffffe8e80c08, 
    error_reporter=error_reporter@entry=0xffffe8e80c00) at tensorflow/compiler/mlir/lite/sparsity/sparsify_model.cc:91
#17 0x0000aaaae03023c0 in mlir::lite::(anonymous namespace)::SparsifyModelTest_MetadataIsAddedToOutputModel_Test::TestBody (
    this=<optimized out>) at tensorflow/compiler/mlir/lite/sparsity/sparsify_model_test.cc:67
#18 0x0000ffff81043fd4 in testing::internal::HandleSehExceptionsInMethodIfSupported<testing::Test, void> (
    method=&virtual testing::Test::TestBody(), location=0xffff80fef955 ""the test body"", object=<optimized out>)
    at external/com_google_googletest/googletest/src/gtest.cc:2599
#19 testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void> (object=0xaaaaf5c74320, 
    method=(void (testing::Test::*)(class testing::Test * const)) 0x20, location=0xffff80fef955 ""the test body"")
    at external/com_google_googletest/googletest/src/gtest.cc:2635
#20 0x0000ffff81043e6c in testing::Test::Run (this=0xaaaaf5c74320) at external/com_google_googletest/googletest/src/gtest.cc:2674
#21 0x0000ffff810454f8 in testing::TestInfo::Run (this=0xaaaaf5c67960) at external/com_google_googletest/googletest/src/gtest.cc:2853
#22 0x0000ffff81046480 in testing::TestSuite::Run (this=0xaaaaf5c740b0) at external/com_google_googletest/googletest/src/gtest.cc:3012
#23 0x0000ffff81057db4 in testing::internal::UnitTestImpl::RunAllTests (this=0xaaaaf5c73d30)
    at external/com_google_googletest/googletest/src/gtest.cc:5870
#24 0x0000ffff81057844 in testing::internal::HandleSehExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool> (
    method=(bool (testing::internal::UnitTestImpl::*)(class testing::internal::UnitTestImpl * const)) 0xffff810579e8 <testing::internal::UnitTestImpl::RunAllTests()>, location=0xffff80fee5f4 ""auxiliary test code (environments or event listeners)"", object=<optimized out>)
--Type <RET> for more, q to quit, c to continue without paging--q
```
",True
Please help !  type:bug TF 1.13 subtype: ubuntu/linux,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

1.13.1

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 20.0

### Mobile device

_No response_

### Python version

3.6

### Bazel version

_No response_

### GCC/compiler version

10.5.0

### CUDA/cuDNN version

10

### GPU model and memory

RTX 3060 12G

### Current behavior?

I  am running the Octopus repo (https://github.com/thmoa/octopus) which use tensorflow-gpu version 1.13.1 . When I run that model with python, I got some errors from tensorflow. Please help me. 

### Standalone code to reproduce the issue

```shell
import os
import argparse
import tensorflow as tf
import keras.backend as K




from glob import glob

from lib.io import openpose_from_file, read_segmentation, write_mesh
from model.octopus import Octopus



def main(weights, name, segm_dir, pose_dir, out_dir, opt_pose_steps, opt_shape_steps):
    segm_files = sorted(glob(os.path.join(segm_dir, '*.png')))
    pose_files = sorted(glob(os.path.join(pose_dir, '*.json')))

    if len(segm_files) != len(pose_files) or len(segm_files) == len(pose_files) == 0:
        exit('Inconsistent input.')

    K.set_session(tf.Session(config=tf.ConfigProto(gpu_options=tf.GPUOptions(allow_growth=True))))

    model = Octopus(num=len(segm_files))
    model.load(weights)

    segmentations = [read_segmentation(f) for f in segm_files]

    joints_2d, face_2d = [], []
    for f in pose_files:
        j, f = openpose_from_file(f)

        assert(len(j) == 25)
        assert(len(f) == 70)

        joints_2d.append(j)
        face_2d.append(f)

    if opt_pose_steps:
        print('Optimizing for pose...')
        model.opt_pose(segmentations, joints_2d, opt_steps=opt_pose_steps)

    if opt_shape_steps:
        print('Optimizing for shape...')
        model.opt_shape(segmentations, joints_2d, face_2d, opt_steps=opt_shape_steps)

    print('Estimating shape...')
    pred = model.predict(segmentations, joints_2d)

    write_mesh('{}/{}.obj'.format(out_dir, name), pred['vertices'][0], pred['faces'])

    print('Done.')


if __name__ == '__main__':
    parser = argparse.ArgumentParser()

    parser.add_argument(
        'name',
        type=str,
        help=""Sample name"")

    parser.add_argument(
        'segm_dir',
        type=str,
        help=""Segmentation images directory"")

    parser.add_argument(
        'pose_dir',
        type=str,
        help=""2D pose keypoints directory"")

    parser.add_argument(
        '--opt_steps_pose', '-p', default=5, type=int,
        help=""Optimization steps pose"")

    parser.add_argument(
        '--opt_steps_shape', '-s', default=15, type=int,
        help=""Optimization steps"")

    parser.add_argument(
        '--out_dir', '-od',
        default='out',
        help='Output directory')

    parser.add_argument(
        '--weights', '-w',
        default='weights/octopus_weights.hdf5',
        help='Model weights file (*.hdf5)')

    args = parser.parse_args()
    main(args.weights, args.name, args.segm_dir, args.pose_dir, args.out_dir, args.opt_steps_pose, args.opt_steps_shape)

```


### Relevant log output

```shell
Processing sample...
> Optimizing for pose...
  0%|                                                                                                                                                                                                                 | 0/10 [00:00<?, ?it/s]2023-08-22 16:24:18.296359: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library libcublas.so.10.0 locally
2023-08-22 16:25:50.156420: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x55fa094fdcf0
2023-08-22 16:26:08.284736: E tensorflow/stream_executor/cuda/cuda_blas.cc:698] failed to run cuBLAS routine cublasGemmBatchedEx: CUBLAS_STATUS_EXECUTION_FAILED
2023-08-22 16:26:08.284773: E tensorflow/stream_executor/cuda/cuda_blas.cc:2620] Internal: failed BLAS call, see log for details
2023-08-22 16:26:08.326578: I tensorflow/stream_executor/stream.cc:5014] [stream=0x55fa0950bb90,impl=0x55fa093dbf20] did not memcpy device-to-host; source: 0x813bc6700
2023-08-22 16:26:08.326623: F tensorflow/core/framework/op_kernel.cc:1408] Check failed: nullptr == ctx->op_kernel().AsAsync() (nullptr vs. 0x55fa38108400)Use OP_REQUIRES_ASYNC in AsyncOpKernel implementations.
Aborted
```
",True
TF Quantizer breaks pip package type:bug comp:core,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

git HEAD

### Custom code

No

### OS platform and distribution

Ubuntu 20.04

### Mobile device

n/a

### Python version

3.9.16

### Bazel version

6.1.0

### GCC/compiler version

16.0.6

### CUDA/cuDNN version

n/a

### GPU model and memory

n/a

### Current behavior?

The commit https://github.com/tensorflow/tensorflow/commit/fee881376914381062deb767759d144d0f07d760 added pywrap_quantize_model.so to the pip package but the build fails to set the RPATH for _pywrap_tensorflow_internal.so in the new .so leading to a failure in auditwheel when attempting to 'repair' to make it manylinux2014 compatible.

### Standalone code to reproduce the issue

```shell
$ python3 -m auditwheel repair --plat manylinux2014_aarch64 ./tensorflow-pkg/tensorflow_aarch64-2.15.0-cp311-cp311-linux_aarch64.whl --wheel-dir ./whl/
```


### Relevant log output

```shell
$ python3 -m auditwheel repair --plat manylinux2014_aarch64 ./tensorflow-pkg/tensorflow_aarch64-2.15.0-cp311-cp311-linux_aarch64.whl --wheel-dir ./whl/
INFO:auditwheel.main_repair:Repairing tensorflow_aarch64-2.15.0-cp311-cp311-linux_aarch64.whl
Traceback (most recent call last):
  File ""<frozen runpy>"", line 198, in _run_module_as_main
  File ""<frozen runpy>"", line 88, in _run_code
  File ""/usr/local/lib/python3.11/dist-packages/auditwheel/__main__.py"", line 6, in <module>
    sys.exit(main())
             ^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/auditwheel/main.py"", line 59, in main
    rval = args.func(args, p)
           ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/auditwheel/main_repair.py"", line 173, in execute
    out_wheel = repair_wheel(
                ^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/auditwheel/repair.py"", line 80, in repair_wheel
    raise ValueError(
ValueError: Cannot repair wheel, because required library ""_pywrap_tensorflow_internal.so"" could not be located

Also

$ ldd venv_bad/lib/python3.11/site-packages/tensorflow/compiler/mlir/quantization/tensorflow/python/pywrap_quantize_model.so
	linux-vdso.so.1 (0x0000ffffb8af9000)
	libtensorflow_framework.so.2 => /workspace/venv_bad/lib/python3.11/site-packages/tensorflow/compiler/mlir/quantization/tensorflow/python/../../../../../libtensorflow_framework.so.2 (0x0000ffffb6800000)
	_pywrap_tensorflow_internal.so => not found
	libdl.so.2 => /lib/aarch64-linux-gnu/libdl.so.2 (0x0000ffffb8923000)
	libpthread.so.0 => /lib/aarch64-linux-gnu/libpthread.so.0 (0x0000ffffb88f2000)
	libm.so.6 => /lib/aarch64-linux-gnu/libm.so.6 (0x0000ffffb8847000)
	libstdc++.so.6 => /lib/aarch64-linux-gnu/libstdc++.so.6 (0x0000ffffb661b000)
	libgcc_s.so.1 => /lib/aarch64-linux-gnu/libgcc_s.so.1 (0x0000ffffb8823000)
	libc.so.6 => /lib/aarch64-linux-gnu/libc.so.6 (0x0000ffffb64a8000)
	/lib/ld-linux-aarch64.so.1 (0x0000ffffb8ac9000)
	librt.so.1 => /lib/aarch64-linux-gnu/librt.so.1 (0x0000ffffb8809000)

Compare with

$ ldd venv_bad/lib/python3.11/site-packages/tensorflow/python/saved_model/pywrap_saved_model.so
	linux-vdso.so.1 (0x0000ffffa40a2000)
	libtensorflow_framework.so.2 => /workspace/venv_bad/lib/python3.11/site-packages/tensorflow/python/saved_model/../../libtensorflow_framework.so.2 (0x0000ffffa1e00000)
	_pywrap_tensorflow_internal.so => /workspace/venv_bad/lib/python3.11/site-packages/tensorflow/python/saved_model/../_pywrap_tensorflow_internal.so (0x0000ffffa1c0a000)
	libdl.so.2 => /lib/aarch64-linux-gnu/libdl.so.2 (0x0000ffffa3ee5000)
	libm.so.6 => /lib/aarch64-linux-gnu/libm.so.6 (0x0000ffffa3e3a000)
	libpthread.so.0 => /lib/aarch64-linux-gnu/libpthread.so.0 (0x0000ffffa3e09000)
	libstdc++.so.6 => /lib/aarch64-linux-gnu/libstdc++.so.6 (0x0000ffffa1a25000)
	libgcc_s.so.1 => /lib/aarch64-linux-gnu/libgcc_s.so.1 (0x0000ffffa3de5000)
	libc.so.6 => /lib/aarch64-linux-gnu/libc.so.6 (0x0000ffffa18b2000)
	/lib/ld-linux-aarch64.so.1 (0x0000ffffa4072000)
	librt.so.1 => /lib/aarch64-linux-gnu/librt.so.1 (0x0000ffffa3dcd000)
	libtensorflow_cc.so.2 => /workspace/venv_bad/lib/python3.11/site-packages/tensorflow/python/saved_model/../../libtensorflow_cc.so.2 (0x0000ffff8be00000)
	libml_dtypes.so.so => /workspace/venv_bad/lib/python3.11/site-packages/tensorflow/python/saved_model/../../tsl/python/lib/core/libml_dtypes.so.so (0x0000ffffa3d99000)
	libomp.so.5 => /usr/lib/llvm-16/lib/libomp.so.5 (0x0000ffff8bcc0000)
```
",True
python3.11.3 mismatch with tensorflow 2.13.0 stat:awaiting response type:bug stale subtype:macOS TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.13.0

### Custom code

No

### OS platform and distribution

macOS Venture 13.4

### Mobile device

_No response_

### Python version

3.11.3

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

![image](https://github.com/tensorflow/tensorflow/assets/11846497/3459b246-e377-499d-9d9f-e5f666fb7957)


### Standalone code to reproduce the issue

```shell
import tensorflow
```


### Relevant log output

_No response_",True
"  File ""/usr/local/lib/python3.8/dist-packages/tensorflow/lite/python/interpreter.py"", line 915, in invoke     self._interpreter.Invoke() RuntimeError: tensorflow/lite/kernels/concatenation.cc:158 t->dims->data[d] != t0->dims->data[d] (1 != 2)Node number 304 (CONCATENATION) failed to prepare. stat:awaiting response type:bug stale comp:lite TFLiteConverter TF 2.9","### 1. System information
![image](https://github.com/tensorflow/tensorflow/assets/35233355/cfc8e9d3-9790-4a89-86db-062b97d3bbbc)

- OS Platform and Distribution (Linux Ubuntu 20.04):
- TensorFlow installation (2.9.1+nv22.9):

### 2. Code
`import numpy as np
import tensorflow as tf

def main():
    # Load the TFLite model and allocate tensors.
    interpreter = tf.lite.Interpreter(model_path=""model.tflite"")
    interpreter.allocate_tensors()
    
    #return

    # Get input and output tensors.
    input_details = interpreter.get_input_details()
    output_details = interpreter.get_output_details()
    # Test the model on random input data.

    input_shape = input_details[0]['shape']
    input_data = np.array(np.random.random_sample(input_shape), dtype=np.float32)
    #interpreter.set_tensor(input_details[0]['index'], input_data)

    signatures = interpreter.get_signature_list()
    print(signatures)

    interpreter.invoke()
    return
    # The function `get_tensor()` returns a copy of the tensor data.
    # Use `tensor()` in order to get a pointer to the tensor.
    output_data = interpreter.get_tensor(output_details[0]['index'])
    print(output_data)


if __name__ == '__main__':
    main()`

**How to get the model:**
I used a library here to get a unet with efficientnetb0 as encoder
https://github.com/qubvel/segmentation_models.
So you can try to use my script to get the model:
`    BACKBONE = 'efficientnetb0'
    BATCH_SIZE = 1
    CLASSES = [""background"", ""target"", ""others""]
    LR = 0.0001
    EPOCHS = 10

    preprocess_input = sm.get_preprocessing(BACKBONE)

    # define network parameters
    n_classes = 1 if len(CLASSES) == 1 else (len(CLASSES) + 1)  # case for binary and multiclass segmentation
    activation = 'sigmoid' if n_classes == 1 else 'softmax'

    #create model
    model = sm.Unet(BACKBONE, classes=n_classes, activation=activation)`

",True
Unable to serialize VariableSpec stat:awaiting response type:bug stale TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 2.13.0

### Custom code

Yes

### OS platform and distribution

windows 11

### Mobile device

_No response_

### Python version

3.11.4

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

A graph

### Standalone code to reproduce the issue

```shell
from models import *
from conftest import DDPGAgent
import matplotlib as plt
import pytest
import time

# Just disables the warning, doesn't take advantage of AVX/FMA to run faster
import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'

# setting for hidden layers
Layer1 = 400
Layer2 = 300


class MecTer(object):
    """"""
    MEC terminal parent class
    """"""

    def __init__(self, user_config, train_config):
        self.rate = user_config['rate']
        self.dis = user_config['dis']
        self.id = user_config['id']
        self.state_dim = user_config['state_dim']
        self.action_dim = user_config['action_dim']
        self.action_bound = user_config['action_bound']
        self.data_buf_size = user_config['data_buf_size']
        self.t_factor = user_config['t_factor']
        self.penalty = user_config['penalty']

        self.sigma2 = train_config['sigma2']
        self.init_path = ''
        self.isUpdateActor = True
        self.init_seqCnt = 0

        if 'model' not in user_config:
            self.channelModel = MarkovModel(self.dis, seed=train_config['random_seed'])
        else:
            n_t = 1
            n_r = user_config['num_r']
            self.channelModel = ARModel(self.dis, n_t, n_r, seed=train_config['random_seed'])

        self.DataBuf = 0
        self.Channel = self.channelModel.getCh()
        self.SNR = 0
        self.Power = np.zeros(self.action_dim)
        self.Reward = 0
        self.State = []

        # some pre-defined parameters
        self.k = 1e-27
        self.t = 0.001
        self.L = 500

    def localProc(self, p):
        return np.power(p / self.k, 1.0 / 3.0) * self.t / self.L / 1000

    def localProcRev(self, b):
        return np.power(b * 1000 * self.L / self.t, 3.0) * self.k

    def offloadRev(self, b):
        return (np.power(2.0, b) - 1) * self.sigma2 / np.power(np.linalg.norm(self.Channel), 2)

    def offloadRev2(self, b):
        return self.action_bound if self.SNR <= 1e-12 else (np.power(2.0, b) - 1) / self.SNR

    def getCh(self):
        return self.Channel

    def setSNR(self, snr):
        self.SNR = snr
        self.sampleCh()
        channel_gain = np.power(np.linalg.norm(self.Channel), 2) / self.sigma2
        self.State = np.array([self.DataBuf, snr, channel_gain])

    def sampleData(self):
        data_t = np.log2(1 + self.Power[0] * self.SNR)
        data_p = self.localProc(self.Power[1])
        over_power = 0

        self.DataBuf -= data_t + data_p
        if self.DataBuf < 0:
            over_power = self.Power[1] - self.localProcRev(np.fmax(0, self.DataBuf + data_p))
            self.DataBuf = 0

        data_r = np.random.poisson(self.rate)
        self.DataBuf += data_r
        return data_t, data_p, data_r, over_power

    def sampleCh(self):
        # self.Channel = self.channelModel.sampleCh()

        # Calculate channel gain using channel quantization
        raw_channel_gain = np.linalg.norm(self.channelModel.sampleCh())
        min_val = np.min(self.Channel)
        max_val = np.max(self.Channel)

        # Quantize the channel gain into 10 levels
        quantized_channel_gain = min_val + (max_val - min_val) * (raw_channel_gain - min_val) / (max_val - min_val)
        quantized_channel_gain = np.clip(quantized_channel_gain, min_val, max_val)
        self.Channel = quantized_channel_gain

        return self.Channel

    def reset(self, rate, seqCount):
        self.rate = rate
        self.DataBuf = np.random.randint(0, self.data_buf_size - 1) / 2.0
        self.sampleCh()

        if seqCount >= self.init_seqCnt:
            self.isUpdateActor = True

        return self.DataBuf


class MecTermRL(MecTer):
    """"""
    MEC terminal class using RL
    """"""

    # rate:packet poisson arrival, dis: distance in meters
    def __init__(self, user_config, train_config):
        MecTer.__init__(self, user_config, train_config)
        self.agent = DDPGAgent(user_config, train_config)

        if 'init_path' in user_config and len(user_config['init_path']) > 0:
            self.init_path = user_config['init_path']
            self.init_seqCnt = user_config['init_seqCnt']
            self.isUpdateActor = False

    def feedback(self, snr, done):
        isOverflow = 0
        self.SNR = snr

        # update the data buffer
        [data_t, data_p, data_r, over_power] = self.sampleData()

        # get the reward for the current slot
        self.Reward = -self.t_factor * np.sum(self.Power) * 10 - (1 - self.t_factor) * self.DataBuf

        # estimate the channel for next slot
        self.sampleCh()

        # update the actor and critic network
        channel_gain = np.power(np.linalg.norm(self.Channel), 2) / self.sigma2
        next_state = np.array([self.DataBuf, snr, channel_gain])

        self.agent.update(self.State, self.Power, self.Reward, done, next_state, self.isUpdateActor)

        # update system state
        self.State = next_state
        # return the reward in this slot
        sum_power = np.sum(self.Power) - over_power
        return self.Reward, sum_power, over_power, data_t, data_p, data_r, self.DataBuf, channel_gain, isOverflow

    def predict(self, isRandom):
        power, noise = self.agent.predict(self.State, self.isUpdateActor)
        self.Power = np.fmax(0, np.fmin(self.action_bound, power))

        return self.Power, noise


class MecSvrEnv(object):
    """"""
    Simulation environment
    """"""

    def __init__(self, user_list, num_att, sigma2, max_len):
        self.user_list = user_list
        self.num_user = len(user_list)
        self.num_att = num_att
        self.sigma2 = sigma2
        self.count = 0
        self.seqCount = 0
        self.max_len = max_len

        # specially designed for Greedy agent training

    #         self.data_set = []

    def init_target_network(self):
        for user in self.user_list:
            user.critic.init_target_network(path='data_set_OGD.npz')

    def plot_channel_gains_histogram(self):
        # Get the channel gains for all users
        channel_gains = [np.abs(user.getCh()) for user in self.user_list]

        # Flatten the channel gains to a 1D array
        flat_channel_gains = np.concatenate(channel_gains)

        # plot a histogram for the channel gains
        plt.hist(np.abs(flat_channel_gains), bins=20, edgecolor='black')
        plt.title(""Channel Gains Histogram"")
        plt.xlabel(""Channel Gain Magnitude"")
        plt.ylabel(""Frequency"")
        plt.show()

    def step_transmit(self, isRandom=True):
        # get the channel vectors
        channels = np.transpose([user.getCh() for user in self.user_list])
        # get the transmit powers
        powers = []
        noises = []

        for i in range(self.num_user):
            p, n = self.user_list[i].predict(isRandom)
            powers.append(p.copy())
            noises.append(n.copy())
        # compute the snr for each user

        powers = np.array(powers)
        noises = np.array(noises)
        snr_list = self.compute_snr(channels, powers[:, 0])

        rewards = np.zeros(self.num_user)
        powers = np.zeros(self.num_user)
        over_powers = np.zeros(self.num_user)
        data_ts = np.zeros(self.num_user)
        data_ps = np.zeros(self.num_user)
        data_rs = np.zeros(self.num_user)
        data_buf_sizes = np.zeros(self.num_user)
        next_channels = np.zeros(self.num_user)
        isOverflows = np.zeros(self.num_user)

        self.count += 1
        # feedback the snr to each user
        for i in range(self.num_user):
            [rewards[i], powers[i], over_powers[i], data_ts[i], data_ps[i], data_rs[i], data_buf_sizes[i],
             next_channels[i], isOverflows[i]] = self.user_list[i].feedback(snr_list[i], self.count >= self.max_len)

        return rewards, self.count >= self.max_len, powers, over_powers, noises, data_ts, data_ps, data_rs, data_buf_sizes, next_channels, isOverflows

    def compute_snr(self, channels, powers):
        # FDD - Computing SNR
        H_inv = np.linalg.pinv(channels)
        total_signal_power = np.power(np.linalg.norm(channels, axis=1), 2)
        noise = np.power(np.linalg.norm(H_inv, axis=1), 2) * self.sigma2
        snr_list = total_signal_power / noise

        return snr_list

    def reset(self, isTrain=True):
        self.count = 0

        if isTrain:
            init_data_buf_size = [user.reset(user.rate, self.seqCount) for user in self.user_list]
            # get the channel vectors
            channels = np.transpose([user.getCh() for user in self.user_list])
            # get the transmit powers to start
            powers = [np.random.uniform(0, user.action_bound) for user in self.user_list]
            # compute the snr for each user
            snr_list = self.compute_snr(channels, powers)
        else:
            init_data_buf_size = [0 for user in self.user_list]
            snr_list = [0 for user in self.user_list]

        for i in range(self.num_user):
            self.user_list[i].setSNR(snr_list[i])

        self.seqCount += 1
        return init_data_buf_size


# Create the environment
# def env():
#     envi = MecSvrEnv(user_list, NUM_R, SIGMA2, MAX_EPISODE_LEN)
#     return envi

# env = MecSvrEnv(user_list, NUM_R, SIGMA2, MAX_EPISODE_LEN)
# env.init_target_network()

train_config = {
    'sigma2': 0.01,
    'minibatch_size': 64,
    'actor_lr': 0.0001,
    'tau': 0.001,
    'critic_lr': 0.001,
    'gamma': 0.99,
    'buffer_size': 250000,
    'random_seed': int(time.perf_counter() * 1000 % 1000),
    'noise_sigma': 0.12
}

# Define user_list_info with user information
user_list_info = [
    {'state_dim': 3,
     'action_dim': 1,
     'id': '1',
     'action_bound': 1,
     'model': 'AR',
     'num_r': 4,
     'rate': 3.0,
     'dis': 100,
     'data_buf_size': 100,
     't_factor': 1.0,
     'penalty': 1000, }
]

# sess = tf.compat.v1.Session()
# Create instances of the User class from the dictionary in user_list
user_list = [
    MecTermRL(user_config=user_info, train_config=train_config)
    for user_info in user_list_info
]

# Initialize variables
for user in user_list:
    user.agent.init_target_network()
    # (
    #     path=""C:/Users/USER/PycharmProjects/mec_drl-masterr/mec_drl-master/mec_drl-master/data_set_OGD.npz""
    # )

@pytest.fixture
def env():
    # Create and return the environment object
    # Make sure to adjust this to properly create your environment instance
    return MecSvrEnv(user_list, NUM_R, SIGMA2, MAX_EPISODE_LEN)
```


### Relevant log output

```shell
WARNING:tensorflow:The following Variables were used in a Lambda layer's call (tf.__operators__.add_1), but are not present in its tracked objects:   <tf.Variable 'dense_5/bias:0' shape=(300,) dtype=float32>. This is a strong indication that the Lambda layer should be rewritten as a subclassed Layer.
Traceback (most recent call last):
  File ""C:\Users\USER\anaconda3\Lib\site-packages\keras\src\saving\legacy\saved_model\json_utils.py"", line 207, in get_json_type
    type_spec_name = type_spec_registry.get_name(type(obj))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\tensorflow\python\framework\type_spec_registry.py"", line 75, in get_name
    raise ValueError(""TypeSpec %s.%s has not been registered."" %
ValueError: TypeSpec tensorflow.python.ops.resource_variable_ops.VariableSpec has not been registered.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""C:\Users\USER\PycharmProjects\mec_drl-masterr\mec_drl-master\mec_drl-master\test.py"", line 303, in <module>
    user_list = [
                ^
  File ""C:\Users\USER\PycharmProjects\mec_drl-masterr\mec_drl-master\mec_drl-master\test.py"", line 304, in <listcomp>
    MecTermRL(user_config=user_info, train_config=train_config)
  File ""C:\Users\USER\PycharmProjects\mec_drl-masterr\mec_drl-master\mec_drl-master\test.py"", line 125, in __init__
    self.agent = DDPGAgent(user_config, train_config)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\PycharmProjects\mec_drl-masterr\mec_drl-master\mec_drl-master\conftest.py"", line 24, in __init__
    self.critic = CriticNetwork(self.state_dim, self.action_dim, float(train_config['critic_lr']),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\PycharmProjects\mec_drl-masterr\mec_drl-master\mec_drl-master\ddpg.py"", line 102, in __init__
    self.target_model = tf.keras.models.clone_model(self.model)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\keras\src\models\cloning.py"", line 539, in clone_model
    return _clone_functional_model(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\keras\src\models\cloning.py"", line 222, in _clone_functional_model
    model_configs, created_layers = _clone_layers_and_model_config(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\keras\src\models\cloning.py"", line 298, in _clone_layers_and_model_config
    config = functional.get_network_config(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\keras\src\engine\functional.py"", line 1583, in get_network_config
    node_data = node.serialize(
                ^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\keras\src\engine\node.py"", line 219, in serialize
    kwargs = tf.nest.map_structure(_serialize_keras_tensor, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\tensorflow\python\util\nest.py"", line 624, in map_structure
    return nest_util.map_structure(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\tensorflow\python\util\nest_util.py"", line 1054, in map_structure
    return _tf_core_map_structure(func, *structure, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\tensorflow\python\util\nest_util.py"", line 1094, in _tf_core_map_structure
    [func(*x) for x in entries],
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\tensorflow\python\util\nest_util.py"", line 1094, in <listcomp>
    [func(*x) for x in entries],
     ^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\keras\src\engine\node.py"", line 215, in _serialize_keras_tensor
    return (_COMPOSITE_TYPE, json_utils.Encoder().encode(t))
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\keras\src\saving\legacy\saved_model\json_utils.py"", line 55, in encode
    return super().encode(_encode_tuple(obj))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\json\encoder.py"", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\json\encoder.py"", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\keras\src\saving\legacy\saved_model\json_utils.py"", line 52, in default
    return get_json_type(obj)
           ^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\keras\src\saving\legacy\saved_model\json_utils.py"", line 225, in get_json_type
    ""spec"": get_json_type(spec),
            ^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\USER\anaconda3\Lib\site-packages\keras\src\saving\legacy\saved_model\json_utils.py"", line 214, in get_json_type
    raise ValueError(
ValueError: Unable to serialize VariableSpec(shape=(300,), dtype=tf.float32, trainable=True, alias_id=None) to JSON, because the TypeSpec class <class 'tensorflow.python.ops.resource_variable_ops.VariableSpec'> has not been registered.
```
",True
Check failed when running tensorflow.python.ops.gen_nn_ops.max_pool_grad_with_argmax stat:awaiting response type:bug stale comp:ops TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

22.04

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

nvidia-cudnn-cu11==8.6.0.163, cudatoolkit=11.8.0

### GPU model and memory

_No response_

### Current behavior?

Specific input combination is caused check failure.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf
import numpy as np
from tensorflow.python.ops import gen_nn_ops
try:
  try:
    with tf.device('/CPU'):
      arg_0_tensor = tf.random.uniform([2, 3, 3, 1], dtype=tf.float32)
      arg_0 = tf.identity(arg_0_tensor)
      arg_1_tensor = tf.random.uniform([2, 2, 2, 1], dtype=tf.float32)
      arg_1 = tf.identity(arg_1_tensor)
      arg_2_tensor = tf.random.uniform([2, 2, 2, 1], minval=-256, maxval=257, dtype=tf.int64)
      arg_2 = tf.identity(arg_2_tensor)
      ksize_0 = 1
      ksize_1 = 2
      ksize_2 = 2
      ksize_3 = 1
      ksize = [ksize_0,ksize_1,ksize_2,ksize_3,]
      strides_0 = 1
      strides_1 = 1
      strides_2 = 1
      strides_3 = 1
      strides = [strides_0,strides_1,strides_2,strides_3,]
      padding = ""VALID""
      include_batch_in_index = False
      out = gen_nn_ops.max_pool_grad_with_argmax(arg_0,arg_1,arg_2,ksize=ksize,strides=strides,padding=padding,include_batch_in_index=include_batch_in_index,)
  except Exception as e:
    print(""Error:""+str(e))
  try:
    with tf.device('/GPU:0'):
      arg_0 = tf.identity(arg_0_tensor)
      arg_0 = tf.cast(arg_0, tf.float32)
      arg_1 = tf.identity(arg_1_tensor)
      arg_1 = tf.cast(arg_1, tf.float32)
      arg_2 = tf.identity(arg_2_tensor)
      arg_2 = tf.cast(arg_2, tf.int64)
      ksize = [ksize_0,ksize_1,ksize_2,ksize_3,]
      strides = [strides_0,strides_1,strides_2,strides_3,]
      gen_nn_ops.max_pool_grad_with_argmax(arg_0,arg_1,arg_2,ksize=ksize,strides=strides,padding=padding,include_batch_in_index=include_batch_in_index,)
  except Exception as e:
    print(""Error:""+str(e))
except Exception as e:
  print(""Error:""+str(e))
```
```


### Relevant log output

```shell
2023-08-21 00:36:14.553160: F tensorflow/core/kernels/maxpooling_op.cc:1081] Check failed: grad_out_index >= output_start && grad_out_index < output_end Invalid output gradient index: 77, 0, 18
Aborted

```
```
",True
Activation function of a Dense hidden layer not getting invoked. stat:awaiting response type:bug stale subtype:macOS TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

v2.13.0-rc2-7-g1cb1a030a62 2.13.0

### Custom code

Yes

### OS platform and distribution

MacOS 13.4, MacBook Pro M2 Max

### Mobile device

_No response_

### Python version

3.8.17

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Issue:
In the given auto-encoder setup, the encoder layers activation function (relu) is not getting invoked.

1. We create a simple auto-encoder, with Input size 3, hidden size 2, and output back to 3.
2. The activation function of the encoder layer is set a relu.
3. The weights of the encoder layers are all made negative. Idea is, if input is +ve, all the neutrons will have negative value and relu will o/p zero.
4. Give input as [1, 0, 0].
5. We expect the final decoder o/p layer, which has sigmoid activation, to o/p all [0.5, 0.5, 0.5] as the input to this layer from the encoder should have been [0, 0, 0]. 
6. But we find that is not the case, which clearly shows that 'relu' activation of the hidden layer is not getting invoked.

Installation:
pip install tensorflow-macos
pip install tensorflow-metal

### Standalone code to reproduce the issue

```shell
# https://colab.research.google.com/drive/14KKrdiBg8FT2cdUC5pjqJHi5S3BkTOHi?usp=sharing
# The above colab will run fine, but the same code on Mac with the said config has issue.
# Copying the code here for quick reference.

import tensorflow as tf    
import tensorflow.keras
import tensorflow as tf
import platform
import sys
from tensorflow.keras.layers import Input, Dense, Layer
from tensorflow.keras.models import Model

# Print versions:
print(f""Python {sys.version}"")
print(f""Python Platform: {platform.platform()}"")
print(f""Tensor Flow Version: {tf.__version__}"")
gpu = len(tf.config.list_physical_devices('GPU'))>0
print(""GPU is"", ""available"" if gpu else ""NOT AVAILABLE"")

# Setup input
import numpy as np
X_check = np.array([[1, 0, 0]])

# Setup autoencoder model
input_layer = Input(shape=(X_check.shape[1]))
bottleneck = Dense(2, activation='relu', name='bottleneck')(input_layer)
output = Dense(X_check.shape[1], activation='sigmoid', name='output')(bottleneck)
autoencoder = Model(input_layer, output)

# Set encoder layer weights to all negative.
layer = autoencoder.layers[1]
weights = np.array([[-1, -1],[-1, -1], [-1, -1]])
biases = np.array([0, 0])
layer.set_weights([weights, biases])

# create encoder model.
encoder = Model(input_layer, bottleneck)

# create decoder model.
decoder_input = Input(shape=(2,), name='decoder_input')
decoder_layer = autoencoder.layers[-1]
decoder = Model(decoder_input, decoder_layer(decoder_input))

# Run auto-encoder, with [1, 0, 0], since encoder has all negative weights,
# and has 'relu' activation o/p of enocder should all be zeros. And that being
# the input of next sigmod we should get output [0.5, 0.5, 0.5]
output_data = autoencoder.predict(X_check)
print(output_data)
```


### Relevant log output

```shell
Python 3.8.17 (default, Jul  5 2023, 15:45:03) 
[Clang 14.0.6 ]
Python Platform: macOS-13.4-arm64-arm-64bit
Tensor Flow Version: 2.13.0
GPU is available
1/1 [==============================] - 0s 38ms/step
[[0.287966   0.85427195 0.28276426]]
```
",True
Cannot build tensorflow from source stat:awaiting response type:bug type:build/install stale subtype: ubuntu/linux,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

latest

### Custom code

Yes

### OS platform and distribution

Debian 12

### Mobile device

_No response_

### Python version

Python 3.8

### Bazel version

Latest

### GCC/compiler version

Clang 16

### CUDA/cuDNN version

Dont have

### GPU model and memory

Dont have

### Current behavior?

I tried several times, still same error. Searched on google found nothing

### Standalone code to reproduce the issue

```shell
I follow the guide from tensorflow.com but still faced this error. Please help
```


### Relevant log output

```shell
(myenv) root@drowsiness:~/tensorflow# bazel build -j 2 --local_ram_resources=3000 --config=opt --verbose_failures //tensorflow/tools/pip_package:build_pip_package
INFO: Options provided by the client:
  Inherited 'common' options: --isatty=1 --terminal_columns=189
INFO: Reading rc options for 'build' from /root/tensorflow/.bazelrc:
  Inherited 'common' options: --experimental_repo_remote_exec
INFO: Reading rc options for 'build' from /root/tensorflow/.bazelrc:
  'build' options: --define framework_shared_object=true --define tsl_protobuf_header_only=true --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone -c opt --announce_rc --define=grpc_no_ares=true --noincompatible_remove_legacy_whole_archive --features=-force_no_whole_archive --enable_platform_specific_config --define=with_xla_support=true --config=short_logs --config=v2 --define=no_aws_support=true --define=no_hdfs_support=true --experimental_cc_shared_library --experimental_link_static_libraries_once=false --incompatible_enforce_config_setting_visibility
INFO: Reading rc options for 'build' from /root/tensorflow/.tf_configure.bazelrc:
  'build' options: --action_env PYTHON_BIN_PATH=/root/anaconda3/envs/myenv/bin/python3 --action_env PYTHON_LIB_PATH=/root/anaconda3/envs/myenv/lib/python3.8/site-packages --python_path=/root/anaconda3/envs/myenv/bin/python3 --action_env CLANG_COMPILER_PATH=/usr/lib/llvm-16/bin/clang --repo_env=CC=/usr/lib/llvm-16/bin/clang --repo_env=BAZEL_COMPILER=/usr/lib/llvm-16/bin/clang --copt=-Wno-gnu-offsetof-extensions
INFO: Found applicable config definition build:short_logs in file /root/tensorflow/.bazelrc: --output_filter=DONT_MATCH_ANYTHING
INFO: Found applicable config definition build:v2 in file /root/tensorflow/.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1
INFO: Found applicable config definition build:opt in file /root/tensorflow/.tf_configure.bazelrc: --copt=-Wno-sign-compare --host_copt=-Wno-sign-compare
INFO: Found applicable config definition build:linux in file /root/tensorflow/.bazelrc: --host_copt=-w --copt=-Wno-all --copt=-Wno-extra --copt=-Wno-deprecated --copt=-Wno-deprecated-declarations --copt=-Wno-ignored-attributes --copt=-Wno-array-bounds --copt=-Wunused-result --copt=-Werror=unused-result --copt=-Wswitch --copt=-Werror=switch --copt=-Wno-error=unused-but-set-variable --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include --define=PROTOBUF_INCLUDE_PATH=$(PREFIX)/include --cxxopt=-std=c++17 --host_cxxopt=-std=c++17 --config=dynamic_kernels --experimental_guard_against_concurrent_changes
INFO: Found applicable config definition build:dynamic_kernels in file /root/tensorflow/.bazelrc: --define=dynamic_loaded_kernels=true --copt=-DAUTOLOAD_DYNAMIC_KERNELS
INFO: Analyzed target //tensorflow/tools/pip_package:build_pip_package (648 packages loaded, 42257 targets configured).
INFO: Found 1 target...
INFO: Deleting stale sandbox base /root/.cache/bazel/_bazel_root/efb88f6336d9c4a18216fb94287b8d97/sandbox
ERROR: /root/tensorflow/tensorflow/compiler/mlir/tensorflow/BUILD:475:11: Compiling tensorflow/compiler/mlir/tensorflow/ir/tf_ops.cc failed: (Killed): clang failed: error executing command (from target //tensorflow/compiler/mlir/tensorflow:tensorflow_ops) 
  (cd /root/.cache/bazel/_bazel_root/efb88f6336d9c4a18216fb94287b8d97/execroot/org_tensorflow && \
  exec env - \
    CLANG_COMPILER_PATH=/usr/lib/llvm-16/bin/clang \
    PATH=/root/.cache/bazelisk/downloads/bazelbuild/bazel-6.1.0-linux-x86_64/bin:/root/anaconda3/envs/myenv/bin:/root/anaconda3/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin \
    PWD=/proc/self/cwd \
    PYTHON_BIN_PATH=/root/anaconda3/envs/myenv/bin/python3 \
    PYTHON_LIB_PATH=/root/anaconda3/envs/myenv/lib/python3.8/site-packages \
    TF2_BEHAVIOR=1 \
  /usr/lib/llvm-16/bin/clang -U_FORTIFY_SOURCE -fstack-protector -Wall -Wthread-safety -Wself-assign -Wunused-but-set-parameter -Wno-free-nonheap-object -fcolor-diagnostics -fno-omit-frame-pointer -g0 -O2 '-D_FORTIFY_SOURCE=1' -DNDEBUG -ffunction-sections -fdata-sections '-std=c++0x' -MD -MF bazel-out/k8-opt/bin/tensorflow/compiler/mlir/tensorflow/_objs/tensorflow_ops/tf_ops.pic.d '-frandom-seed=bazel-out/k8-opt/bin/tensorflow/compiler/mlir/tensorflow/_objs/tensorflow_ops/tf_ops.pic.o' -fPIC '-DLLVM_ON_UNIX=1' '-DHAVE_BACKTRACE=1' '-DBACKTRACE_HEADER=<execinfo.h>' '-DLTDL_SHLIB_EXT="".so""' '-DLLVM_PLUGIN_EXT="".so""' '-DLLVM_ENABLE_THREADS=1' '-DHAVE_DEREGISTER_FRAME=1' '-DHAVE_LIBPTHREAD=1' '-DHAVE_PTHREAD_GETNAME_NP=1' '-DHAVE_PTHREAD_H=1' '-DHAVE_PTHREAD_SETNAME_NP=1' '-DHAVE_REGISTER_FRAME=1' '-DHAVE_SETENV_R=1' '-DHAVE_STRERROR_R=1' '-DHAVE_SYSEXITS_H=1' '-DHAVE_UNISTD_H=1' -D_GNU_SOURCE '-DHAVE_LINK_H=1' '-DHAVE_MALLINFO=1' '-DHAVE_SBRK=1' '-DHAVE_STRUCT_STAT_ST_MTIM_TV_NSEC=1' '-DLLVM_NATIVE_ARCH=""X86""' '-DLLVM_NATIVE_ASMPARSER=LLVMInitializeX86AsmParser' '-DLLVM_NATIVE_ASMPRINTER=LLVMInitializeX86AsmPrinter' '-DLLVM_NATIVE_DISASSEMBLER=LLVMInitializeX86Disassembler' '-DLLVM_NATIVE_TARGET=LLVMInitializeX86Target' '-DLLVM_NATIVE_TARGETINFO=LLVMInitializeX86TargetInfo' '-DLLVM_NATIVE_TARGETMC=LLVMInitializeX86TargetMC' '-DLLVM_NATIVE_TARGETMCA=LLVMInitializeX86TargetMCA' '-DLLVM_HOST_TRIPLE=""x86_64-unknown-linux-gnu""' '-DLLVM_DEFAULT_TARGET_TRIPLE=""x86_64-unknown-linux-gnu""' '-DLLVM_VERSION_MAJOR=18' '-DLLVM_VERSION_MINOR=0' '-DLLVM_VERSION_PATCH=0' '-DLLVM_VERSION_STRING=""18.0.0git""' -D__STDC_LIMIT_MACROS -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS '-DBLAKE3_USE_NEON=0' -DBLAKE3_NO_AVX2 -DBLAKE3_NO_AVX512 -DBLAKE3_NO_SSE2 -DBLAKE3_NO_SSE41 -DEIGEN_MPL2_ONLY '-DEIGEN_MAX_ALIGN_BYTES=64' -DHAVE_SYS_UIO_H -DTF_USE_SNAPPY '-DBAZEL_CURRENT_REPOSITORY=""""' -iquote . -iquote bazel-out/k8-opt/bin -iquote external/com_google_absl -iquote bazel-out/k8-opt/bin/external/com_google_absl -iquote external/llvm-project -iquote bazel-out/k8-opt/bin/external/llvm-project -iquote external/nsync -iquote bazel-out/k8-opt/bin/external/nsync -iquote external/com_google_protobuf -iquote bazel-out/k8-opt/bin/external/com_google_protobuf -iquote external/gif -iquote bazel-out/k8-opt/bin/external/gif -iquote external/libjpeg_turbo -iquote bazel-out/k8-opt/bin/external/libjpeg_turbo -iquote external/com_googlesource_code_re2 -iquote bazel-out/k8-opt/bin/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/k8-opt/bin/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/k8-opt/bin/external/fft2d -iquote external/highwayhash -iquote bazel-out/k8-opt/bin/external/highwayhash -iquote external/zlib -iquote bazel-out/k8-opt/bin/external/zlib -iquote external/eigen_archive -iquote bazel-out/k8-opt/bin/external/eigen_archive -iquote external/ml_dtypes -iquote bazel-out/k8-opt/bin/external/ml_dtypes -iquote external/double_conversion -iquote bazel-out/k8-opt/bin/external/double_conversion -iquote external/snappy -iquote bazel-out/k8-opt/bin/external/snappy -Ibazel-out/k8-opt/bin/external/llvm-project/mlir/_virtual_includes/ArithCanonicalizationIncGen -Ibazel-out/k8-opt/bin/external/llvm-project/mlir/_virtual_includes/AsmParserTokenKinds -isystem external/llvm-project/llvm/include -isystem bazel-out/k8-opt/bin/external/llvm-project/llvm/include -isystem external/llvm-project/mlir/include -isystem bazel-out/k8-opt/bin/external/llvm-project/mlir/include -isystem external/nsync/public -isystem bazel-out/k8-opt/bin/external/nsync/public -isystem external/com_google_protobuf/src -isystem bazel-out/k8-opt/bin/external/com_google_protobuf/src -isystem external/gif -isystem bazel-out/k8-opt/bin/external/gif -isystem external/farmhash_archive/src -isystem bazel-out/k8-opt/bin/external/farmhash_archive/src -isystem external/zlib -isystem bazel-out/k8-opt/bin/external/zlib -isystem third_party/eigen3/mkl_include -isystem bazel-out/k8-opt/bin/third_party/eigen3/mkl_include -isystem external/eigen_archive -isystem bazel-out/k8-opt/bin/external/eigen_archive -isystem external/ml_dtypes -isystem bazel-out/k8-opt/bin/external/ml_dtypes -isystem external/ml_dtypes/ml_dtypes -isystem bazel-out/k8-opt/bin/external/ml_dtypes/ml_dtypes -Wno-all -Wno-extra -Wno-deprecated -Wno-deprecated-declarations -Wno-ignored-attributes -Wno-array-bounds -Wunused-result '-Werror=unused-result' -Wswitch '-Werror=switch' '-Wno-error=unused-but-set-variable' -DAUTOLOAD_DYNAMIC_KERNELS -Wno-gnu-offsetof-extensions -Wno-sign-compare '-std=c++17' -no-canonical-prefixes -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -c tensorflow/compiler/mlir/tensorflow/ir/tf_ops.cc -o bazel-out/k8-opt/bin/tensorflow/compiler/mlir/tensorflow/_objs/tensorflow_ops/tf_ops.pic.o)
# Configuration: 4332b06bceb8e99a0d8ed4f75fa26218a779c66acf683ffad0936df1e9f625df
# Execution platform: @local_execution_config_platform//:platform
In file included from tensorflow/compiler/mlir/tensorflow/ir/tf_ops.cc:16:
In file included from ./tensorflow/compiler/mlir/tensorflow/ir/tf_ops.h:38:
In file included from ./tensorflow/compiler/mlir/tensorflow/ir/tf_attributes.h:21:
In file included from ./tensorflow/core/ir/types/dialect.h:31:
bazel-out/k8-opt/bin/tensorflow/core/ir/types/dialect.h.inc:31:19: warning: 'parseType' overrides a member function but is not marked 'override' [-Winconsistent-missing-override]
     ::mlir::Type parseType(::mlir::DialectAsmParser &parser) const;
                  ^
external/llvm-project/mlir/include/mlir/IR/Dialect.h:107:16: note: overridden virtual function is here
  virtual Type parseType(DialectAsmParser &parser) const;
               ^
In file included from tensorflow/compiler/mlir/tensorflow/ir/tf_ops.cc:16:
In file included from ./tensorflow/compiler/mlir/tensorflow/ir/tf_ops.h:38:
In file included from ./tensorflow/compiler/mlir/tensorflow/ir/tf_attributes.h:21:
In file included from ./tensorflow/core/ir/types/dialect.h:31:
bazel-out/k8-opt/bin/tensorflow/core/ir/types/dialect.h.inc:32:11: warning: 'printType' overrides a member function but is not marked 'override' [-Winconsistent-missing-override]
     void printType(::mlir::Type type, ::mlir::DialectAsmPrinter &printer) const;
          ^
external/llvm-project/mlir/include/mlir/IR/Dialect.h:110:16: note: overridden virtual function is here
  virtual void printType(Type, DialectAsmPrinter &) const {
               ^
Target //tensorflow/tools/pip_package:build_pip_package failed to build
INFO: Elapsed time: 3990.011s, Critical Path: 343.16s
INFO: 991 processes: 3 internal, 988 local.
FAILED: Build did NOT complete successfully
```
",True
Check failure when running tf.config.experimental_connect_to_host stat:awaiting response type:bug stale comp:ops TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

22.04

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

nvidia-cudnn-cu11==8.6.0.163, cudatoolkit=11.8.0

### GPU model and memory

GTX 1660 TI

### Current behavior?

Due to feeding NaN input Argument

### Standalone code to reproduce the issue

```shell
import tensorflow as tf
import numpy as np
try:
  try:
    with tf.device('/CPU'):
      arg_0 = ""nan""
      out = tf.config.experimental_connect_to_host(arg_0,)
  except Exception as e:
    print(""Error:""+str(e))
  try:
    with tf.device('/GPU:0'):
      tf.config.experimental_connect_to_host(arg_0,)
  except Exception as e:
    print(""Error:""+str(e))
except Exception as e:
  print(""Error:""+str(e))
```
```


### Relevant log output

```shell
2023-08-19 19:02:09.775956: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-08-19 19:02:10.305057: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2023-08-19 19:02:10.742608: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.761041: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.761185: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.762359: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.762491: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.762611: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.826641: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.826771: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.826888: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.826971: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3389 MB memory:  -> device: 0, name: NVIDIA GeForce GTX 1660 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
2023-08-19 19:02:10.829417: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.829515: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.829601: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.829701: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.829789: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-08-19 19:02:10.829854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3389 MB memory:  -> device: 0, name: NVIDIA GeForce GTX 1660 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
2023-08-19 19:02:10.838878: E tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:600] INVALID_ARGUMENT: Could not interpret ""nan"" as a host-port pair.
E0819 19:02:10.839114974  187448 completion_queue.cc:244]    assertion failed: queue.num_items() == 0
Aborted

```
```
",True
"libtensorflowlite_jni.so (offset 0x2f3000):signal 11 (SIGSEGV), code 2 (SEGV_ACCERR), fault addr 0xa59fdbc0 stat:awaiting response type:bug stale comp:lite TF 2.3","### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

org.tensorflow:tensorflow-lite:0.0.0-nightly org.tensorflow:tensorflow-lite-gpu:2.3.0 org.tensorflow:tensorflow-lite-support:0.1.0

### Custom code

Yes

### OS platform and distribution

Andorid 13

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Our process com.vt.tv.aipq use tensorflow-lite cause process crash:
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
Build fingerprint: 'Hisense/songshan-FFM/songshan:11/RTT2.220118.001/00.00.00.40:user/release-keys'
Revision: '1234'
ABI: 'arm'
Timestamp: 2023-05-06 14:36:47+0800
pid: 14794, tid: 28796, name: TFService-T  >>> com.vt.tv.aipq <<<
uid: 1000
signal 11 (SIGSEGV), code 2 (SEGV_ACCERR), fault addr 0xa59fdbc0
    r0  00000004  r1  00000020  r2  00000300  r3  a59fdbc0
    r4  31a05640  r5  000002f0  r6  31a05740  r7  a59fe4c0
    r8  31a056c0  r9  a5674220  r10 a59fe1c0  r11 31a055c0
    ip  a59fdec0  sp  84db73e8  lr  832ded97  pc  832f08ac

backtrace:
      #00 pc 000258ac  /system_ext/app/HiAIPQ/HiAIPQ.apk!libtensorflowlite_jni.so (offset 0x2f3000)

### Standalone code to reproduce the issue

```shell
The Google server background statistics process crash information, unable to clarify the steps to reproduce the problem.
```


### Relevant log output

_No response_",True
Corrupt png files type:support,"### Issue type
Support

### TensorFlow version
2.14

### OS platform and distribution
Windows 11

### Python version
3.9

I am getting an error: Invalid PNG data, size 49253

Part of my classification process classifying bad images from good ones. All of my png files can be opened, so I think the images are getting corrupt with they are resized. In the graphic below are a few of the ""bad"" images. 
![image](https://github.com/tensorflow/tensorflow/assets/7605046/bd18cefb-f001-41a3-8f57-b14379cebdc4)

After importing the images into the training dataset (code below), how I can filter out the images that became corrupt in the resizing? Right now it is throwing an error on when iterating through the normalization_layer

```
batch_size = 32
img_height = 224
img_width = 224
band_count = 4

train_ds = tf.keras.utils.image_dataset_from_directory(
  data_dir,
  validation_split=0.2,
  subset=""training"",
  seed=123,
  image_size=(img_height, img_width),
  batch_size=batch_size,
  color_mode=""rgba"")

normalization_layer = layers.Rescaling(1./255)
normalized_ds = train_ds.map(lambda x, y: (normalization_layer(x), y))
#Error here: Invalid PNG data, size 49253
image_batch, labels_batch = next(iter(normalized_ds))
```


### Standalone code to reproduce the issue

```shell
Code above
```


### Relevant log output

_No response_",False
Issue created for Rollback of PR #61276: return assert_shapes for debugging.assert_shapes ,"Merged PR #61276 is rolled back in 9c492018a641ac6b5a03b65a77ff9d1ce60699eb.
    Please follow up with the reviewer and close this issue once its resolved.",False
[v2.14.0] Build failed on linux/arm64 w/ clang type:build/install subtype:bazel TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf v2.14.0

### Custom code

No

### OS platform and distribution

Linux arm64

### Mobile device

_No response_

### Python version

3.11.2

### Bazel version

6.4.0

### GCC/compiler version

Debian clang version 14.0.6 aarch64-unknown-linux-gnu

### CUDA/cuDNN version

n/a

### GPU model and memory

_No response_

### Current behavior?

When trying to build `libtensorflow` the linking step failed. Is there a way to fix this?

### Standalone code to reproduce the issue

```shell
Run `bazel build --config opt //tensorflow/tools/lib_package:libtensorflow`
```


### Relevant log output

```shell
[5,037 / 5,041] Compiling tensorflow/core/kernels/conv_grad_input_ops_3d.cc; 246s local
[5,037 / 5,041] Compiling tensorflow/core/kernels/conv_grad_input_ops_3d.cc; 276s local
[5,037 / 5,041] Compiling tensorflow/core/kernels/conv_grad_input_ops_3d.cc; 336s local
[5,038 / 5,041] [Prepa] Linking tensorflow/libtensorflow.so.2.14.0
[5,038 / 5,041] Linking tensorflow/libtensorflow.so.2.14.0; 1s local
[5,038 / 5,041] Linking tensorflow/libtensorflow.so.2.14.0; 11s local
[5,038 / 5,041] Linking tensorflow/libtensorflow.so.2.14.0; 41s local
ERROR: /mnt/sandisk/tensorflow/tensorflow/tensorflow/BUILD:1243:20: Linking tensorflow/libtensorflow.so.2.14.0 failed: (Exit 1): clang failed: error executing command (from target //tensorflow:libtensorflow.so.2.14.0) /usr/lib/llvm-14/bin/clang @bazel-out/aarch64-opt/bin/tensorflow/libtensorflow.so.2.14.0-2.params
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
/usr/bin/ld.gold: error: Stub is too far away, try a smaller value for '--stub-group-size'. The current value is 0x7ffbffc.
clang: error: linker command failed with exit code 1 (use -v to see invocation)
[5,039 / 5,041] checking cached actions
Target //tensorflow/tools/lib_package:libtensorflow failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 50743.078s, Critical Path: 1006.17s
INFO: 5039 processes: 38 internal, 5001 local.
FAILED: Build did NOT complete successfully
```
",False
Building pip package broken by new shared object in build type:build/install awaiting PR merge,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

git HEAD

### Custom code

No

### OS platform and distribution

Ubuntu 20.04

### Mobile device

n/a

### Python version

3.9.17

### Bazel version

6.1.0

### GCC/compiler version

17.0.0

### CUDA/cuDNN version

n/a

### GPU model and memory

n/a

### Current behavior?

Auditwheel used during pip package creation fails due to unable to locate needed shared object.

Failure introduced by https://github.com/tensorflow/tensorflow/commit/96c01ac84cc5befb70d258a2ef06846a71d2bc0c

### Standalone code to reproduce the issue

```shell
$ bazel build --config=mkl_aarch64_threadpool --copt=-flax-vector-conversions --define=tf_api_version=2 --verbose_failures --jobs=100 -- //tensorflow/tools/pip_package:build_pip_package
$ bazel-bin/tensorflow/tools/pip_package/build_pip_package --cpu --project_name tensorflow_aarch64 ./tensorflow-pkg
$ auditwheel repair --plat manylinux2014_aarch64 -w /tensorflow/whl /workspace/tensorflow-pkg/tensorflow_aarch64-2.16.0-cp310-cp310-linux_aarch64.whl
```


### Relevant log output

```shell
INFO:auditwheel.main_repair:Repairing tensorflow_aarch64-2.16.0-cp310-cp310-linux_aarch64.whl
Traceback (most recent call last):
  File ""/usr/local/bin/auditwheel"", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/auditwheel/main.py"", line 59, in main
    rval = args.func(args, p)
           ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/auditwheel/main_repair.py"", line 173, in execute
    out_wheel = repair_wheel(
                ^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/auditwheel/repair.py"", line 80, in repair_wheel
    raise ValueError(
ValueError: Cannot repair wheel, because required library ""_pywrap_tensorflow_internal.so"" could not be located
```
",False
Status of ragged tensors in tf nightly  stat:awaiting response type:feature type:support comp:keras,"Hello,

It seems keras 3 (used in tf nightly) has dropped support for ragged tensors.

What are the plans for the future of ragged tensors in keras tf?

Thanks ",False
TF Lite in play services does not support version 1.13.0 stat:awaiting response comp:lite,"I received an error report from a user that was using TensorFlow Lite through the `mobile_scanner` library.

As this library uses the most up-to-date version of `mlkit-barcode-scanning`, which has `TensorFlow Lite` as a dependency,
I cannot resolve the root cause of this issue.

From the changelogs I do not directly see which version of TensorFlow Lite supports version `1.13.0` in the Google Play services.
Thus I don't know if I should ask the maintainers of `play-services-mlkit-barcode-scanning` to update to the latest available version with a fix. (the last version of that dependency dates back a few months)

I can ask the user for their device / Google Play services version.

**System information**
- Android Device information (use `adb shell getprop ro.build.fingerprint`
  if possible): N/A 
- TensorFlow Lite in Play Services SDK version (found in `build.gradle`):
   - is a transitive dependency of `com.google.android.gms:play-services-mlkit-barcode-scanning` version 18.3.0
- Google Play Services version
  (`Settings` > `Apps` > `Google Play Services` > `App details`): N/A

**Standalone code to reproduce the issue**
```
import com.google.mlkit.vision.barcode.BarcodeScanning

class MobileScanner() {
  private var scanner = BarcodeScanning.getClient()
}
```

**Any other info / logs**
```
W/native (30072): W0000 00:00:1698456375.622782 32103 abi_method_util.h:33] not supported: TfLiteInterpreterGetTensor: TF Lite in Google Play services has stable ABI version 1.11.0 which is less than the required version 1.13.0.
```
",False
"`rate` must be a scalar or scalar tensor. Received: rate=ListWrapper([3, 4, 5, 6]) type:support comp:apis TF2.14","### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

tf 2.14.0

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

`tf.saved_model.save` API　can not convert the model with `SpatialDropout2D` operator and threw a crash message: ""
ValueError: `rate` must be a scalar or scalar tensor. Received: rate=ListWrapper([3, 4, 5, 6])""

However, for models containing other operators, The script can run well.


### Standalone code to reproduce the issue

```shell
import tensorflow as tf
from tensorflow import keras as keras
from tensorflow.keras import layers, models
import numpy as np

layer = keras.layers.SpatialDropout2D(rate=[3, 4, 5, 6])
input_shape = [12, 10, 6, 18]
input_data = np.random.random(input_shape)
weights = layer.get_weights()
layer.set_weights(weights)

x = layers.Input(shape=input_shape[1:], dtype=""float32"") 
y = layer(x)
model = models.Model(x, y)
model.summary()
res_keras = model(input_data)
tf.saved_model.save(model, ""tf_model"")
```
```


### Relevant log output

```shell
Traceback (most recent call last):
  File ""test.py"", line 17, in <module>
    tf.saved_model.save(model, ""tf_model"")
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\saved_model\save.py"", line 1331, in save
    save_and_return_nodes(obj, export_dir, signatures, options)
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\saved_model\save.py"", line 1366, in save_and_return_nodes
    _build_meta_graph(obj, signatures, options, meta_graph_def))
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\saved_model\save.py"", line 1578, in _build_meta_graph
    return _build_meta_graph_impl(obj, signatures, options, meta_graph_def)
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\saved_model\save.py"", line 1490, in _build_meta_graph_impl
    signatures = signature_serialization.find_function_to_export(
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\saved_model\signature_serialization.py"", line 109, in find_function_to_export
    for name, child in children:
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\saved_model\save.py"", line 189, in list_children
    for name, child in super(_AugmentedGraphView, self).list_children(
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\checkpoint\graph_view.py"", line 75, in list_children
    for name, ref in super(ObjectGraphView,
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\checkpoint\trackable_view.py"", line 84, in children
    for name, ref in obj._trackable_children(save_type, **kwargs).items():
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\engine\functional.py"", line 460, in _trackable_children
    dependencies.update(super()._trackable_children(save_type, **kwargs))
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\engine\training.py"", line 4002, in _trackable_children
    children = super()._trackable_children(save_type, **kwargs)
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\engine\base_layer.py"", line 3470, in _trackable_children
    children = self._trackable_saved_model_saver.trackable_children(
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\base_serialization.py"", line 61, in trackable_children
    children = self.objects_to_serialize(serialization_cache)
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\layer_serialization.py"", line 79, in objects_to_serialize
    return self._get_serialized_attributes(
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\layer_serialization.py"", line 106, in _get_serialized_attributes
    object_dict, function_dict = self._get_serialized_attributes_internal(
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\model_serialization.py"", line 57, in _get_serialized_attributes_internal
    objects, functions = super()._get_serialized_attributes_internal(
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\layer_serialization.py"", line 117, in _get_serialized_attributes_internal
    functions = save_impl.wrap_layer_functions(
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\save_impl.py"", line 168, in wrap_layer_functions
    original_fns = _replace_child_layer_functions(layer, serialization_cache)
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\save_impl.py"", line 305, in _replace_child_layer_functions
    serialized_functions = child_layer._trackable_saved_model_saver._get_serialized_attributes(  # noqa: E501
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\layer_serialization.py"", line 106, in _get_serialized_attributes
    object_dict, function_dict = self._get_serialized_attributes_internal(
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\layer_serialization.py"", line 117, in _get_serialized_attributes_internal
    functions = save_impl.wrap_layer_functions(
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\save_impl.py"", line 223, in wrap_layer_functions
    fn.get_concrete_function()
  File ""C:\software\conda\envs\torch\lib\contextlib.py"", line 126, in __exit__
    next(self.gen)
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\save_impl.py"", line 390, in tracing_scope
    fn.get_concrete_function(*args, **kwargs)
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\eager\polymorphic_function\polymorphic_function.py"", line 1222, in get_concrete_function
    concrete = self._get_concrete_function_garbage_collected(*args, **kwargs)
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\eager\polymorphic_function\polymorphic_function.py"", line 1192, in _get_concrete_function_garbage_collected
    self._initialize(args, kwargs, add_initializers_to=initializers)
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\eager\polymorphic_function\polymorphic_function.py"", line 694, in _initialize
    self._concrete_variable_creation_fn = tracing_compilation.trace_function(
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\eager\polymorphic_function\tracing_compilation.py"", line 178, in trace_function
    concrete_function = _maybe_define_function(
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\eager\polymorphic_function\tracing_compilation.py"", line 284, in _maybe_define_function
    concrete_function = _create_concrete_function(
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\eager\polymorphic_function\tracing_compilation.py"", line 308, in _create_concrete_function
    traced_func_graph = func_graph_module.func_graph_from_py_func(
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\framework\func_graph.py"", line 1059, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\eager\polymorphic_function\polymorphic_function.py"", line 597, in wrapped_fn
    out = weak_wrapped_fn().__wrapped__(*args, **kwds)
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\save_impl.py"", line 632, in wrapper
    ret = method(*args, **kwargs)
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\utils.py"", line 190, in wrap_with_training_arg
    return control_flow_util.smart_cond(
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\utils\control_flow_util.py"", line 108, in smart_cond
    return tf.__internal__.smart_cond.smart_cond(
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\framework\smart_cond.py"", line 53, in smart_cond
    return true_fn()
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\utils.py"", line 192, in <lambda>
    lambda: replace_training_and_call(True),
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\utils.py"", line 188, in replace_training_and_call
    return wrapped_call(*new_args, **new_kwargs)
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\saving\legacy\saved_model\save_impl.py"", line 698, in call_and_return_conditional_losses
    call_output = layer_call(*args, **kwargs)
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\layers\regularization\dropout.py"", line 120, in call
    output = control_flow_util.smart_cond(
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\utils\control_flow_util.py"", line 108, in smart_cond
    return tf.__internal__.smart_cond.smart_cond(
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\framework\smart_cond.py"", line 53, in smart_cond
    return true_fn()
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\layers\regularization\dropout.py"", line 116, in dropped_inputs
    return self._random_generator.dropout(
  File ""C:\software\conda\envs\torch\lib\site-packages\keras\src\backend.py"", line 2172, in dropout
    return tf.nn.dropout(
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\util\traceback_utils.py"", line 153, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File ""C:\software\conda\envs\torch\lib\site-packages\tensorflow\python\ops\nn_ops.py"", line 5786, in _dropout
    raise ValueError(
ValueError: `rate` must be a scalar or scalar tensor. Received: rate=ListWrapper([3, 4, 5, 6])
```
",False
Shape problems in LSTM; Configuring LSTM properly in Keras stat:awaiting response type:support stale comp:keras TF 2.8,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 2.8

### Custom code

Yes

### OS platform and distribution

Windows 11

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

So I wanted to make a neural network that predicts weather on python. It should take data on previous 30 days as input and make a prediction on how many % (+ or -) will the air temperature change. Neural network will compute 2 inputs, so data on a single day looks like this:

1-st input:
[20, 72, 1]

First entry is temperature, second is humidity and third is atmospheric pressure. 


2-nd input:
[*Weather observations*]

[*Weather observations*] array contains long strings of weather observations. In this array there may be one observation, may be more than one or none.


One complete unit of training data for 30-ty days looks like this:

1-st input:
[ [20, 72, 1], #1-st day
  [15, 89, 1.03], #2-nd day
  [19, 79, 1.01], #3-d day
  [24, 67, 0.98], #...
  ...
  ... ]

2-nd input:

[ [""Many cloudy spots..."", ""Today we had experienced...""], #1-st day
  [""Rain has been going for...""], #2-nd day
  [""""], #3-d day
  [""In following regions..."", ""Cause of geomagnetic..."", ""Today is one of the sunniest...], #...
  ...
  ... ]

So both of those input units contains thirty entries like this (becuase of mentioned 30-ty days), and the label for this unit is air temperature on the day that is a week ahead of the last entry.


Summarizing, the inputs will be lists of lists, where each list contains device readings/weather observations for 30 days with daily readings/observations placed in another list inside. So, first element in the second group of 30 days will be a set of observations which is second element in the first group of 30 days (aka 3-rank list, I hope you got it).

I wrote the following model:

### Standalone code to reproduce the issue

```shell
embedding_dim = 128  
vocab_size = len(words_to_int)  # number of unique words

num_input = keras.Input(shape= (30,3), name=""nums"")
nmlstm = layers.LSTM(64)(num_input) #num input goes to num lstm
nmdense = layers.Dense(64)(nmlstm) #num lstm goes to num dense

text_input = keras.Input(shape= (30, max_sequence_length), name=""text"") #basically length of the longest string observation sequence 

text_vec = layers.Embedding(vocab_size, embedding_dim, mask_zero=True)(text_input) #text input goes to text embedding
txlstm = layers.LSTM(64)(text_vec) #text embedding goes to text lstm


united = layers.concatenate([nmdense, txlstm]) #concatenating text lstm and num dense
almostlast = layers.Dense(64)(united) #computing united input 
last = layers.Dense(2, name='prediction')(almostlast) #output dense layer

model = keras.Model(inputs=[num_input, text_input], outputs=last)
model.compile(optimizer='adam', loss=keras.losses.CategoricalCrossentropy)
model.fit(
    {""nums"": X1_train, ""text"": X2_train},
    {""prediction"": y_train},
    epochs=8,
    batch_size=10)
```
```


### Relevant log output

```shell
When I try to run the code, I get this error:

ValueError: Input 0 of layer ""lstm_1"" is incompatible with the layer: expected ndim=3, found ndim=4. Full shape received: (None, 30, 2, 128)


I tried changing the input shape of text_input, but I kept on getting the same error.
To mention, I didn't have any problems on encoding data, padding it etc. Also it's better if there's a way of fixing it without changing the shape of 2-nd input data because the main goal is to make the neural network treat 30-day data as one input and providing only one output (how many % (+ or -) the air temperature will change) while learning on text observations to make predictions also based on them. Thank you in advance.
```
",False
Installation of Tensorflow type:build/install,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.14

### Custom code

Yes

### OS platform and distribution

Windows10

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I have installed tensorflow. While importing tensorflow with following command it failed to import: 

C:\Program Files\Python39\Lib\site-packages>python3 -c ""import tensorflow as tf; print(tf.reduce_sum(tf.random.normal([1000, 1000])))""



### Standalone code to reproduce the issue

```shell
C:\Program Files\Python39\Lib\site-packages>python3 -c ""import tensorflow as tf; print(tf.reduce_sum(tf.random.normal([1000, 1000])))""
```


### Relevant log output

```shell
Traceback (most recent call last):
  File ""C:\Program Files\Python39\Lib\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 62, in <module>
    from tensorflow.python._pywrap_tensorflow_internal import *
ImportError: DLL load failed while importing _pywrap_tensorflow_internal: The specified module could not be found.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""<string>"", line 1, in <module>
  File ""C:\Program Files\Python39\Lib\site-packages\tensorflow\__init__.py"", line 38, in <module>
    from tensorflow.python.tools import module_util as _module_util
  File ""C:\Program Files\Python39\Lib\site-packages\tensorflow\python\__init__.py"", line 36, in <module>
    from tensorflow.python import pywrap_tensorflow as _pywrap_tensorflow
  File ""C:\Program Files\Python39\Lib\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 77, in <module>
    raise ImportError(
ImportError: Traceback (most recent call last):
  File ""C:\Program Files\Python39\Lib\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 62, in <module>
    from tensorflow.python._pywrap_tensorflow_internal import *
ImportError: DLL load failed while importing _pywrap_tensorflow_internal: The specified module could not be found.


Failed to load the native TensorFlow runtime.
See https://www.tensorflow.org/install/errors for some common causes and solutions.
If you need help, create an issue at https://github.com/tensorflow/tensorflow/issues and include the entire stack trace above this error message.
```
",False
Tensorflow requires Python<3.8 for Docker stat:awaiting response type:build/install stale subtype: ubuntu/linux TF2.14,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.14

### Custom code

Yes

### OS platform and distribution

Ubuntu 20.04

### Mobile device

_No response_

### Python version

3.9.18-slim-bullseye

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

When I tried create a container which based on python:3.9.18-slim-bullseye by docker compose, tensorflow didn't let the build complete as it required python >2.6 and python<3.8. 


### Standalone code to reproduce the issue

```shell
FROM python:3.9.18-slim-bullseye

RUN pip install --upgrade pip && pip install pip-tools

COPY ./requirements.txt .

RUN pip install -r requirements.txt

WORKDIR /app

## add app
COPY . /app

RUN apt-get update && apt-get install -y netcat

ADD https://github.com/krallin/tini/releases/download/v0.19.0/tini /tini
RUN chmod +x /tini
# Set Tini as the ENTRYPOINT and specify Uvicorn CMD
ENTRYPOINT [""/tini"", ""--""]
CMD [""uvicorn"", ""main:app"", ""--host"", ""0.0.0.0"", ""--port"", ""30022""]



requirements.txt

tensorboard==2.14.0
tensorboard-data-server==0.7.2
tensorflow==v2.15.0-rc0
tensorflow-estimator==v2.15.0-rc0
tensorflow-intel==v2.15.0-rc0
tensorflow-io-gcs-filesystem==0.31.0
```


### Relevant log output

```shell
ERROR: Ignored the following versions that require a different python version: 0.2.1 Requires-Python >2.6, !=3.3.*, <3.8
ERROR: Could not find a version that satisfies the requirement tensorflow-intel==2.14.0 (from versions: 0.0.1)
ERROR: No matching distribution found for tensorflow-intel==2.14.0
```
",False
how to self-hosting docs of old version type:support TF 1.12 type:docs-feature,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

1.12

### Custom code

No

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

need to host old version doc as a website

### Standalone code to reproduce the issue

```shell
no code
```


### Relevant log output

_No response_",False
Error when building from source: AddKernelActivityEvent<TF_CUPTI_HAS_CHANNEL_ID> ‘TF_CUPTI_HAS_CHANNEL_ID’ was not declared in this scope type:build/install,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 20.04.6 LTS

### Mobile device

_No response_

### Python version

3.8.10

### Bazel version

6.1.0

### GCC/compiler version

9.4.0

### CUDA/cuDNN version

Cuda=11.4.152, cuDNN=8.9.5

### GPU model and memory

GeForce RTX 2070 Rev. A

### Current behavior?

I am trying to install tensorflow from source. I am following this [tutorial](https://www.tensorflow.org/install/source). I have the cuDNN and the Cuda Toolkit installed, and the following configuration: 
```
You have bazel 6.1.0 installed.
Please specify the location of python. [Default is /usr/bin/python3]: 

Found possible Python library paths:
  /usr/lib/python3/dist-packages
  /usr/local/lib/python3.8/dist-packages
Please input the desired Python library path to use.  Default is [/usr/lib/python3/dist-packages]

Do you wish to build TensorFlow with ROCm support? [y/N]: N
No ROCm support will be enabled for TensorFlow.

Do you wish to build TensorFlow with CUDA support? [y/N]: y
CUDA support will be enabled for TensorFlow.

Do you wish to build TensorFlow with TensorRT support? [y/N]: N
No TensorRT support will be enabled for TensorFlow.

Found CUDA 11.4 in:
    /usr/local/cuda-11.4/targets/x86_64-linux/lib
    /usr/local/cuda-11.4/targets/x86_64-linux/include
Found cuDNN 8 in:
    /usr/local/cuda-11.4/targets/x86_64-linux/lib
    /usr/local/cuda-11.4/targets/x86_64-linux/include

Please specify a list of comma-separated CUDA compute capabilities you want to build with.
You can find the compute capability of your device at: https://developer.nvidia.com/cuda-gpus. Each capability can be specified as ""x.y"" or ""compute_xy"" to include both virtual and binary GPU code, or as ""sm_xy"" to only include the binary code.
Please note that each additional compute capability significantly increases your build time and binary size, and that TensorFlow only supports compute capabilities >= 3.5 [Default is: 7.5]: 

Do you want to use clang as CUDA compiler? [Y/n]: n
nvcc will be used as CUDA compiler.

Please specify which gcc should be used by nvcc as the host compiler. [Default is /usr/bin/gcc]: 

Please specify optimization flags to use during compilation when bazel option ""--config=opt"" is specified [Default is -Wno-sign-compare]: 

Would you like to interactively configure ./WORKSPACE for Android builds? [y/N]: N
Not configuring the WORKSPACE for Android builds.
```

Then doing: `bazel build --config=opt --action_env=PATH -c opt //tensorflow/tools/pip_package:build_pip_package`

```
ERROR: /home/master/.cache/bazel/_bazel_master/7d15ddcbf9badca106464f95f49bc497/external/local_xla/xla/backends/profiler/gpu/BUILD:172:16: Compiling xla/backends/profiler/gpu/cupti_tracer.cc failed: (Exit 1): crosstool_wrapper_driver_is_not_gcc failed: error executing command (from target @local_xla//xla/backends/profiler/gpu:cupti_tracer) external/local_config_cuda/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -MD -MF bazel-out/k8-opt/bin/external/local_xla/xla/backends/profiler/gpu/_objs/cupti_tracer/cupti_tracer.pic.d ... (remaining 180 arguments skipped)
external/local_xla/xla/backends/profiler/gpu/cupti_tracer.cc: In member function ‘tsl::Status xla::profiler::CuptiTracer::ProcessActivityBuffer(CUcontext, uint32_t, uint8_t*, size_t)’:
external/local_xla/xla/backends/profiler/gpu/cupti_tracer.cc:2177:34: error: ‘TF_CUPTI_HAS_CHANNEL_ID’ was not declared in this scope
 2177 |           AddKernelActivityEvent<TF_CUPTI_HAS_CHANNEL_ID>(
      |                                  ^~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/backends/profiler/gpu/cupti_tracer.cc:2178:76: error: no matching function for call to ‘AddKernelActivityEvent<<expression error> >(xla::profiler::CuptiTraceCollector*&, xla::profiler::{anonymous}::CuptiActivityKernelTy*)’
 2178 |               collector_, reinterpret_cast<CuptiActivityKernelTy *>(record));
      |                                                                            ^
external/local_xla/xla/backends/profiler/gpu/cupti_tracer.cc:747:6: note: candidate: ‘template<bool cupti_has_channel_id, class CuptiActivityKernel> void xla::profiler::{anonymous}::AddKernelActivityEvent(xla::profiler::CuptiTraceCollector*, const CuptiActivityKernel*)’
  747 | void AddKernelActivityEvent(CuptiTraceCollector *collector,
      |      ^~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/backends/profiler/gpu/cupti_tracer.cc:747:6: note:   template argument deduction/substitution failed:
external/local_xla/xla/backends/profiler/gpu/cupti_tracer.cc:2178:76: error: template argument 1 is invalid
 2178 |               collector_, reinterpret_cast<CuptiActivityKernelTy *>(record));
      |                                                                            ^
Target //tensorflow/tools/pip_package:build_pip_package failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 2354.699s, Critical Path: 306.56s
INFO: 11360 processes: 84 internal, 11276 local.
FAILED: Build did NOT complete successfully

```

### Standalone code to reproduce the issue

```shell
bazel build --config=opt --action_env=PATH -c opt //tensorflow/tools/pip_package:build_pip_package
```


### Relevant log output

```shell
ERROR: /home/master/Downloads/tensorflow/tensorflow/core/kernels/image/BUILD:325:18: Compiling tensorflow/core/kernels/image/image_ops_gpu.cu.cc failed: (Exit 1): crosstool_wrapper_driver_is_not_gcc failed: error executing command (from target //tensorflow/core/kernels/image:image_ops_gpu) 
  (cd /home/master/.cache/bazel/_bazel_master/7d15ddcbf9badca106464f95f49bc497/execroot/org_tensorflow && \
  exec env - \
    CUDA_TOOLKIT_PATH=/usr/local/cuda-11.4 \
    GCC_HOST_COMPILER_PATH=/usr/bin/x86_64-linux-gnu-gcc-9 \
    LD_LIBRARY_PATH=/usr/local/cuda-11.4/lib64:/home/master/TensorRT-8.6.1.6/lib:/usr/local/cuda-11.4/lib64:/home/master/TensorRT-8.6.1.6/lib \
    PATH=/home/master/.cache/bazelisk/downloads/sha256/6c25a6d716545d6b672ec46f770521cd9ebb63d73617b8f4e6747825d1db1839/bin:/usr/local/cuda-11.4/bin:/home/master/.local/bin:/usr/local/cuda-11.4/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin \
    PWD=/proc/self/cwd \
    PYTHON_BIN_PATH=/usr/bin/python3 \
    PYTHON_LIB_PATH=/usr/lib/python3/dist-packages \
    TF2_BEHAVIOR=1 \
    TF_CUDA_COMPUTE_CAPABILITIES=7.5 \
  external/local_config_cuda/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc -MD -MF bazel-out/k8-opt/bin/tensorflow/core/kernels/image/_objs/image_ops_gpu/image_ops_gpu.cu.pic.d '-frandom-seed=bazel-out/k8-opt/bin/tensorflow/core/kernels/image/_objs/image_ops_gpu/image_ops_gpu.cu.pic.o' '-DEIGEN_MAX_ALIGN_BYTES=64' -DEIGEN_ALLOW_UNALIGNED_SCALARS '-DEIGEN_USE_AVX512_GEMM_KERNELS=0' -DHAVE_SYS_UIO_H -DTF_USE_SNAPPY -DTENSORFLOW_USE_CUSTOM_CONTRACTION_KERNEL -DTENSORFLOW_USE_MKLDNN_CONTRACTION_KERNEL '-DEIGEN_ALTIVEC_USE_CUSTOM_PACK=0' '-DEIGEN_NEON_GEBP_NR=4' '-DBAZEL_CURRENT_REPOSITORY=""""' -iquote . -iquote bazel-out/k8-opt/bin -iquote external/eigen_archive -iquote bazel-out/k8-opt/bin/external/eigen_archive -iquote external/com_google_absl -iquote bazel-out/k8-opt/bin/external/com_google_absl -iquote external/nsync -iquote bazel-out/k8-opt/bin/external/nsync -iquote external/com_google_protobuf -iquote bazel-out/k8-opt/bin/external/com_google_protobuf -iquote external/local_tsl -iquote bazel-out/k8-opt/bin/external/local_tsl -iquote external/com_googlesource_code_re2 -iquote bazel-out/k8-opt/bin/external/com_googlesource_code_re2 -iquote external/farmhash_archive -iquote bazel-out/k8-opt/bin/external/farmhash_archive -iquote external/fft2d -iquote bazel-out/k8-opt/bin/external/fft2d -iquote external/highwayhash -iquote bazel-out/k8-opt/bin/external/highwayhash -iquote external/gif -iquote bazel-out/k8-opt/bin/external/gif -iquote external/libjpeg_turbo -iquote bazel-out/k8-opt/bin/external/libjpeg_turbo -iquote external/zlib -iquote bazel-out/k8-opt/bin/external/zlib -iquote external/ml_dtypes -iquote bazel-out/k8-opt/bin/external/ml_dtypes -iquote external/local_config_cuda -iquote bazel-out/k8-opt/bin/external/local_config_cuda -iquote external/snappy -iquote bazel-out/k8-opt/bin/external/snappy -iquote external/double_conversion -iquote bazel-out/k8-opt/bin/external/double_conversion -iquote external/nccl_archive -iquote bazel-out/k8-opt/bin/external/nccl_archive -iquote external/local_config_rocm -iquote bazel-out/k8-opt/bin/external/local_config_rocm -iquote external/local_config_tensorrt -iquote bazel-out/k8-opt/bin/external/local_config_tensorrt -iquote external/png -iquote bazel-out/k8-opt/bin/external/png -iquote external/onednn -iquote bazel-out/k8-opt/bin/external/onednn -iquote external/local_xla -iquote bazel-out/k8-opt/bin/external/local_xla -Ibazel-out/k8-opt/bin/external/ml_dtypes/_virtual_includes/float8 -Ibazel-out/k8-opt/bin/external/ml_dtypes/_virtual_includes/int4 -Ibazel-out/k8-opt/bin/external/local_config_cuda/cuda/_virtual_includes/cuda_headers_virtual -Ibazel-out/k8-opt/bin/external/nccl_archive/_virtual_includes/nccl_config -Ibazel-out/k8-opt/bin/external/local_config_tensorrt/_virtual_includes/tensorrt_headers -isystem external/eigen_archive -isystem bazel-out/k8-opt/bin/external/eigen_archive -isystem external/eigen_archive/mkl_include -isystem bazel-out/k8-opt/bin/external/eigen_archive/mkl_include -isystem external/nsync/public -isystem bazel-out/k8-opt/bin/external/nsync/public -isystem external/com_google_protobuf/src -isystem bazel-out/k8-opt/bin/external/com_google_protobuf/src -isystem external/farmhash_archive/src -isystem bazel-out/k8-opt/bin/external/farmhash_archive/src -isystem external/gif -isystem bazel-out/k8-opt/bin/external/gif -isystem external/zlib -isystem bazel-out/k8-opt/bin/external/zlib -isystem external/ml_dtypes -isystem bazel-out/k8-opt/bin/external/ml_dtypes -isystem external/ml_dtypes/ml_dtypes -isystem bazel-out/k8-opt/bin/external/ml_dtypes/ml_dtypes -isystem external/local_config_cuda/cuda -isystem bazel-out/k8-opt/bin/external/local_config_cuda/cuda -isystem external/local_config_cuda/cuda/cuda/include -isystem bazel-out/k8-opt/bin/external/local_config_cuda/cuda/cuda/include -isystem external/local_config_rocm/rocm -isystem bazel-out/k8-opt/bin/external/local_config_rocm/rocm -isystem external/local_config_rocm/rocm/rocm/include -isystem bazel-out/k8-opt/bin/external/local_config_rocm/rocm/rocm/include -isystem external/local_config_rocm/rocm/rocm/include/rocrand -isystem bazel-out/k8-opt/bin/external/local_config_rocm/rocm/rocm/include/rocrand -isystem external/local_config_rocm/rocm/rocm/include/roctracer -isystem bazel-out/k8-opt/bin/external/local_config_rocm/rocm/rocm/include/roctracer -isystem external/png -isystem bazel-out/k8-opt/bin/external/png -isystem external/onednn/include -isystem bazel-out/k8-opt/bin/external/onednn/include -isystem external/onednn/src -isystem bazel-out/k8-opt/bin/external/onednn/src -isystem external/onednn/src/common -isystem bazel-out/k8-opt/bin/external/onednn/src/common -isystem external/onednn/src/common/ittnotify -isystem bazel-out/k8-opt/bin/external/onednn/src/common/ittnotify -isystem external/onednn/src/cpu -isystem bazel-out/k8-opt/bin/external/onednn/src/cpu -isystem external/onednn/src/cpu/gemm -isystem bazel-out/k8-opt/bin/external/onednn/src/cpu/gemm -isystem external/onednn/src/cpu/x64/xbyak -isystem bazel-out/k8-opt/bin/external/onednn/src/cpu/x64/xbyak -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -fPIC -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -fno-omit-frame-pointer -no-canonical-prefixes -fno-canonical-system-headers -DNDEBUG -g0 -O2 -ffunction-sections -fdata-sections -Wno-all -Wno-extra -Wno-deprecated -Wno-deprecated-declarations -Wno-ignored-attributes -Wno-array-bounds -Wunused-result '-Werror=unused-result' -Wswitch '-Werror=switch' '-Wno-error=unused-but-set-variable' -DAUTOLOAD_DYNAMIC_KERNELS -Wno-sign-compare '-std=c++17' -x cuda '-DGOOGLE_CUDA=1' '--cuda-include-ptx=sm_75' '--cuda-gpu-arch=sm_75' '-Xcuda-fatbinary=--compress-all' '-nvcc_options=expt-relaxed-constexpr' -DEIGEN_AVOID_STL_ARRAY -Iexternal/gemmlowp -Wno-sign-compare '-ftemplate-depth=900' -fno-exceptions '-DGOOGLE_CUDA=1' '-DTENSORFLOW_USE_NVCC=1' '-DTENSORFLOW_USE_XLA=1' -DINTEL_MKL -DENABLE_ONEDNN_V3 -DAMD_ZENDNN -msse3 -pthread '-nvcc_options=relaxed-constexpr' '-nvcc_options=ftz=true' -c tensorflow/core/kernels/image/image_ops_gpu.cu.cc -o bazel-out/k8-opt/bin/tensorflow/core/kernels/image/_objs/image_ops_gpu/image_ops_gpu.cu.pic.o)
# Configuration: a0763b48cf05909e46ed8ba9df7ecc2eca8eed6449f35b44f6b17dbe52c77dbe
# Execution platform: @local_execution_config_platform//:platform
bazel-out/k8-opt/bin/external/ml_dtypes/_virtual_includes/float8/ml_dtypes/include/float8.h(1164): warning: variable ""aligned_highest"" was declared but never referenced
          detected during:
            instantiation of ""To ml_dtypes::float8_internal::ConvertImpl<From, To, kSaturate, kTruncate, std::enable_if_t<<expression>, void>>::run(const From &) [with From=ml_dtypes::float8_internal::float8_e4m3b11fnuz, To=ml_dtypes::float8_internal::float8_e4m3fn, kSaturate=false, kTruncate=false]"" 
(1255): here
            instantiation of ""Derived ml_dtypes::float8_internal::float8_base<Derived>::ConvertFrom(const From &) [with Derived=ml_dtypes::float8_internal::float8_e4m3fn, kSaturate=false, kTruncate=false, From=ml_dtypes::float8_internal::float8_e4m3b11fnuz]"" 
(258): here

bazel-out/k8-opt/bin/external/ml_dtypes/_virtual_includes/float8/ml_dtypes/include/float8.h(1164): warning: variable ""aligned_highest"" was declared but never referenced
          detected during:
            instantiation of ""To ml_dtypes::float8_internal::ConvertImpl<From, To, kSaturate, kTruncate, std::enable_if_t<<expression>, void>>::run(const From &) [with From=ml_dtypes::float8_internal::float8_e4m3b11fnuz, To=float, kSaturate=false, kTruncate=false]"" 
(1261): here
            instantiation of ""To ml_dtypes::float8_internal::float8_base<Derived>::ConvertTo<To,kSaturate,kTruncate>(const Derived &) [with Derived=ml_dtypes::float8_internal::float8_e4m3b11fnuz, To=float, kSaturate=false, kTruncate=false]"" 
(87): here
            instantiation of ""ml_dtypes::float8_internal::float8_base<Derived>::operator float() const [with Derived=ml_dtypes::float8_internal::float8_e4m3b11fnuz]"" 
(128): here
            instantiation of ""Derived ml_dtypes::float8_internal::float8_base<Derived>::operator-(const Derived &) const [with Derived=ml_dtypes::float8_internal::float8_e4m3b11fnuz]"" 
(287): here

bazel-out/k8-opt/bin/external/ml_dtypes/_virtual_includes/float8/ml_dtypes/include/float8.h(1164): warning: variable ""aligned_highest"" was declared but never referenced
          detected during:
            instantiation of ""To ml_dtypes::float8_internal::ConvertImpl<From, To, kSaturate, kTruncate, std::enable_if_t<<expression>, void>>::run(const From &) [with From=ml_dtypes::float8_internal::float8_e4m3fnuz, To=float, kSaturate=false, kTruncate=false]"" 
(1261): here
            instantiation of ""To ml_dtypes::float8_internal::float8_base<Derived>::ConvertTo<To,kSaturate,kTruncate>(const Derived &) [with Derived=ml_dtypes::float8_internal::float8_e4m3fnuz, To=float, kSaturate=false, kTruncate=false]"" 
(87): here
            instantiation of ""ml_dtypes::float8_internal::float8_base<Derived>::operator float() const [with Derived=ml_dtypes::float8_internal::float8_e4m3fnuz]"" 
(128): here
            instantiation of ""Derived ml_dtypes::float8_internal::float8_base<Derived>::operator-(const Derived &) const [with Derived=ml_dtypes::float8_internal::float8_e4m3fnuz]"" 
(335): here

bazel-out/k8-opt/bin/external/ml_dtypes/_virtual_includes/float8/ml_dtypes/include/float8.h(1164): warning: variable ""aligned_highest"" was declared but never referenced
          detected during:
            instantiation of ""To ml_dtypes::float8_internal::ConvertImpl<From, To, kSaturate, kTruncate, std::enable_if_t<<expression>, void>>::run(const From &) [with From=ml_dtypes::float8_internal::float8_e4m3b11fnuz, To=ml_dtypes::float8_internal::float8_e4m3fnuz, kSaturate=false, kTruncate=false]"" 
(1255): here
            instantiation of ""Derived ml_dtypes::float8_internal::float8_base<Derived>::ConvertFrom(const From &) [with Derived=ml_dtypes::float8_internal::float8_e4m3fnuz, kSaturate=false, kTruncate=false, From=ml_dtypes::float8_internal::float8_e4m3b11fnuz]"" 
(323): here

bazel-out/k8-opt/bin/external/ml_dtypes/_virtual_includes/float8/ml_dtypes/include/float8.h(1164): warning: variable ""aligned_highest"" was declared but never referenced
          detected during:
            instantiation of ""To ml_dtypes::float8_internal::ConvertImpl<From, To, kSaturate, kTruncate, std::enable_if_t<<expression>, void>>::run(const From &) [with From=ml_dtypes::float8_internal::float8_e5m2fnuz, To=ml_dtypes::float8_internal::float8_e5m2, kSaturate=false, kTruncate=false]"" 
(1255): here
            instantiation of ""Derived ml_dtypes::float8_internal::float8_base<Derived>::ConvertFrom(const From &) [with Derived=ml_dtypes::float8_internal::float8_e5m2, kSaturate=false, kTruncate=false, From=ml_dtypes::float8_internal::float8_e5m2fnuz]"" 
(357): here

bazel-out/k8-opt/bin/external/ml_dtypes/_virtual_includes/float8/ml_dtypes/include/float8.h(1164): warning: variable ""aligned_highest"" was declared but never referenced
          detected during:
            instantiation of ""To ml_dtypes::float8_internal::ConvertImpl<From, To, kSaturate, kTruncate, std::enable_if_t<<expression>, void>>::run(const From &) [with From=ml_dtypes::float8_internal::float8_e5m2fnuz, To=float, kSaturate=false, kTruncate=false]"" 
(1261): here
            instantiation of ""To ml_dtypes::float8_internal::float8_base<Derived>::ConvertTo<To,kSaturate,kTruncate>(const Derived &) [with Derived=ml_dtypes::float8_internal::float8_e5m2fnuz, To=float, kSaturate=false, kTruncate=false]"" 
(87): here
            instantiation of ""ml_dtypes::float8_internal::float8_base<Derived>::operator float() const [with Derived=ml_dtypes::float8_internal::float8_e5m2fnuz]"" 
(128): here
            instantiation of ""Derived ml_dtypes::float8_internal::float8_base<Derived>::operator-(const Derived &) const [with Derived=ml_dtypes::float8_internal::float8_e5m2fnuz]"" 
(399): here

bazel-out/k8-opt/bin/external/ml_dtypes/_virtual_includes/float8/ml_dtypes/include/float8.h(1164): warning: variable ""aligned_highest"" was declared but never referenced
          detected during:
            instantiation of ""To ml_dtypes::float8_internal::ConvertImpl<From, To, kSaturate, kTruncate, std::enable_if_t<<expression>, void>>::run(const From &) [with From=ml_dtypes::float8_internal::float8_e5m2, To=ml_dtypes::float8_internal::float8_e5m2fnuz, kSaturate=false, kTruncate=false]"" 
(1255): here
            instantiation of ""Derived ml_dtypes::float8_internal::float8_base<Derived>::ConvertFrom(const From &) [with Derived=ml_dtypes::float8_internal::float8_e5m2fnuz, kSaturate=false, kTruncate=false, From=ml_dtypes::float8_internal::float8_e5m2]"" 
(383): here

external/com_google_absl/absl/status/internal/statusor_internal.h(252): warning: ignoring return value type with ""nodiscard"" attribute

external/com_google_absl/absl/status/internal/statusor_internal.h(259): warning: ignoring return value type with ""nodiscard"" attribute

external/com_google_absl/absl/strings/internal/str_format/bind.h: In constructor ‘absl::lts_20230125::str_format_internal::FormatSpecTemplate<Args>::FormatSpecTemplate(const absl::lts_20230125::str_format_internal::ExtendedParsedFormat<absl::lts_20230125::FormatConversionCharSet(C)...>&)’:
external/com_google_absl/absl/strings/internal/str_format/bind.h:171:1: error: parse error in template argument list
  171 |     CheckArity<sizeof...(C), sizeof...(Args)>();
      | ^   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~              
external/com_google_absl/absl/strings/internal/str_format/bind.h:171:63: error: expected ‘;’ before ‘)’ token
  171 |     CheckArity<sizeof...(C), sizeof...(Args)>();
      |                                                               ^
      |                                                               ;
external/com_google_absl/absl/strings/internal/str_format/bind.h:172:147: error: template argument 1 is invalid
  172 |     CheckMatches<C...>(absl::make_index_sequence<sizeof...(C)>{});
      |                                                                                                                                                   ^
external/com_google_absl/absl/strings/internal/str_format/bind.h:172:151: error: expected primary-expression before ‘{’ token
  172 |     CheckMatches<C...>(absl::make_index_sequence<sizeof...(C)>{});
      |                                                                                                                                                       ^
external/com_google_absl/absl/strings/internal/str_format/bind.h:172:150: error: expected ‘;’ before ‘{’ token
  172 |     CheckMatches<C...>(absl::make_index_sequence<sizeof...(C)>{});
      |                                                                                                                                                      ^ 
      |                                                                                                                                                      ;
external/com_google_absl/absl/strings/internal/str_format/bind.h:172:153: error: expected primary-expression before ‘)’ token
  172 |     CheckMatches<C...>(absl::make_index_sequence<sizeof...(C)>{});
      |                                                                                                                                                         ^
external/com_google_absl/absl/strings/internal/str_format/arg.h: In instantiation of ‘constexpr absl::lts_20230125::FormatConversionCharSet absl::lts_20230125::str_format_internal::ArgumentToConv() [with Arg = long int]’:
external/com_google_absl/absl/strings/str_format.h:268:156:   required by substitution of ‘template<class ... Args> using FormatSpec = absl::lts_20230125::str_format_internal::FormatSpecTemplate<absl::lts_20230125::FormatConversionCharSet((ArgumentToConv<Args>)())...> [with Args = {long int, const tensorflow::ResourceBase*}]’
external/com_google_absl/absl/strings/str_format.h:351:1:   required by substitution of ‘template<class ... Args> std::string absl::lts_20230125::StrFormat(absl::lts_20230125::FormatSpec<Args ...>&, const Args& ...) [with Args = {long int, const tensorflow::ResourceBase*}]’
./tensorflow/core/framework/resource_base.h:44:62:   required from here
external/com_google_absl/absl/strings/internal/str_format/arg.h:403:43: error: no matching function for call to ‘ExtractCharSet(ConvResult)’
  403 |   return absl::str_format_internal::ExtractCharSet(ConvResult{});
      |        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
external/com_google_absl/absl/strings/internal/str_format/arg.h:196:1: note: candidate: ‘template<absl::lts_20230125::FormatConversionCharSet C> constexpr absl::lts_20230125::FormatConversionCharSet absl::lts_20230125::str_format_internal::ExtractCharSet(absl::lts_20230125::FormatConvertResult<(absl::lts_20230125::FormatConversionCharSet)(C)>)’
  196 | constexpr FormatConversionCharSet ExtractCharSet(FormatConvertResult<C>) {
      | ^~~~~~~~~~~~~~
external/com_google_absl/absl/strings/internal/str_format/arg.h:196:1: note:   template argument deduction/substitution failed:
external/com_google_absl/absl/strings/internal/str_format/arg.h:403:43: note:   couldn’t deduce template parameter ‘C’
  403 |   return absl::str_format_internal::ExtractCharSet(ConvResult{});
      |        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
external/com_google_absl/absl/strings/internal/str_format/arg.h:201:1: note: candidate: ‘template<absl::lts_20230125::FormatConversionCharSet C> constexpr absl::lts_20230125::FormatConversionCharSet absl::lts_20230125::str_format_internal::ExtractCharSet(absl::lts_20230125::str_format_internal::ArgConvertResult<(absl::lts_20230125::FormatConversionCharSet)(C)>)’
  201 | constexpr FormatConversionCharSet ExtractCharSet(ArgConvertResult<C>) {
      | ^~~~~~~~~~~~~~
external/com_google_absl/absl/strings/internal/str_format/arg.h:201:1: note:   template argument deduction/substitution failed:
external/com_google_absl/absl/strings/internal/str_format/arg.h:403:43: note:   couldn’t deduce template parameter ‘C’
  403 |   return absl::str_format_internal::ExtractCharSet(ConvResult{});
      |        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
external/com_google_absl/absl/strings/internal/str_format/arg.h: In instantiation of ‘constexpr absl::lts_20230125::FormatConversionCharSet absl::lts_20230125::str_format_internal::ArgumentToConv() [with Arg = const tensorflow::ResourceBase*]’:
external/com_google_absl/absl/strings/str_format.h:268:156:   required by substitution of ‘template<class ... Args> using FormatSpec = absl::lts_20230125::str_format_internal::FormatSpecTemplate<absl::lts_20230125::FormatConversionCharSet((ArgumentToConv<Args>)())...> [with Args = {long int, const tensorflow::ResourceBase*}]’
external/com_google_absl/absl/strings/str_format.h:351:1:   required by substitution of ‘template<class ... Args> std::string absl::lts_20230125::StrFormat(absl::lts_20230125::FormatSpec<Args ...>&, const Args& ...) [with Args = {long int, const tensorflow::ResourceBase*}]’
./tensorflow/core/framework/resource_base.h:44:62:   required from here
external/com_google_absl/absl/strings/internal/str_format/arg.h:403:43: error: no matching function for call to ‘ExtractCharSet(ConvResult)’
external/com_google_absl/absl/strings/internal/str_format/arg.h:196:1: note: candidate: ‘template<absl::lts_20230125::FormatConversionCharSet C> constexpr absl::lts_20230125::FormatConversionCharSet absl::lts_20230125::str_format_internal::ExtractCharSet(absl::lts_20230125::FormatConvertResult<(absl::lts_20230125::FormatConversionCharSet)(C)>)’
  196 | constexpr FormatConversionCharSet ExtractCharSet(FormatConvertResult<C>) {
      | ^~~~~~~~~~~~~~
external/com_google_absl/absl/strings/internal/str_format/arg.h:196:1: note:   template argument deduction/substitution failed:
external/com_google_absl/absl/strings/internal/str_format/arg.h:403:43: note:   couldn’t deduce template parameter ‘C’
  403 |   return absl::str_format_internal::ExtractCharSet(ConvResult{});
      |        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
external/com_google_absl/absl/strings/internal/str_format/arg.h:201:1: note: candidate: ‘template<absl::lts_20230125::FormatConversionCharSet C> constexpr absl::lts_20230125::FormatConversionCharSet absl::lts_20230125::str_format_internal::ExtractCharSet(absl::lts_20230125::str_format_internal::ArgConvertResult<(absl::lts_20230125::FormatConversionCharSet)(C)>)’
  201 | constexpr FormatConversionCharSet ExtractCharSet(ArgConvertResult<C>) {
      | ^~~~~~~~~~~~~~
external/com_google_absl/absl/strings/internal/str_format/arg.h:201:1: note:   template argument deduction/substitution failed:
external/com_google_absl/absl/strings/internal/str_format/arg.h:403:43: note:   couldn’t deduce template parameter ‘C’
  403 |   return absl::str_format_internal::ExtractCharSet(ConvResult{});
      |        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
./tensorflow/core/framework/resource_base.h: In member function ‘virtual std::string tensorflow::ResourceBase::MakeRefCountingHandleName(int64_t) const’:
./tensorflow/core/framework/resource_base.h:44:62: error: no matching function for call to ‘StrFormat(const char [18], int64_t&, const tensorflow::ResourceBase*)’
   44 |     return absl::StrFormat(""Resource-%d-at-%p"", resource_id, this);
      |                                                              ^
external/com_google_absl/absl/strings/str_format.h:351:1: note: candidate: ‘template<class ... Args> std::string absl::lts_20230125::StrFormat(absl::lts_20230125::FormatSpec<Args ...>&, const Args& ...)’
  351 | ABSL_MUST_USE_RESULT std::string StrFormat(const FormatSpec<Args...>& format,
      | ^~~~~~~~~
external/com_google_absl/absl/strings/str_format.h:351:1: note:   substitution of deduced template arguments resulted in errors seen above
external/com_google_absl/absl/strings/internal/str_format/arg.h: In instantiation of ‘constexpr absl::lts_20230125::FormatConversionCharSet absl::lts_20230125::str_format_internal::ArgumentToConv() [with Arg = int]’:
external/com_google_absl/absl/strings/internal/str_format/arg.h:570:61:   required from ‘static bool absl::lts_20230125::str_format_internal::FormatArgImpl::Dispatch(absl::lts_20230125::str_format_internal::FormatArgImpl::Data, absl::lts_20230125::str_format_internal::FormatConversionSpecImpl, void*) [with T = int]’
external/com_google_absl/absl/strings/internal/str_format/arg.h:524:15:   required from ‘void absl::lts_20230125::str_format_internal::FormatArgImpl::Init(const T&) [with T = int]’
external/com_google_absl/absl/strings/internal/str_format/arg.h:474:1:   required from ‘absl::lts_20230125::str_format_internal::FormatArgImpl::FormatArgImpl(const T&) [with T = int]’
external/com_google_absl/absl/strings/internal/str_format/bind.h:202:49:   required from here
external/com_google_absl/absl/strings/internal/str_format/arg.h:403:43: error: no matching function for call to ‘ExtractCharSet(ConvResult)’
  403 |   return absl::str_format_internal::ExtractCharSet(ConvResult{});
      |        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
external/com_google_absl/absl/strings/internal/str_format/arg.h:196:1: note: candidate: ‘template<absl::lts_20230125::FormatConversionCharSet C> constexpr absl::lts_20230125::FormatConversionCharSet absl::lts_20230125::str_format_internal::ExtractCharSet(absl::lts_20230125::FormatConvertResult<(absl::lts_20230125::FormatConversionCharSet)(C)>)’
  196 | constexpr FormatConversionCharSet ExtractCharSet(FormatConvertResult<C>) {
      | ^~~~~~~~~~~~~~
external/com_google_absl/absl/strings/internal/str_format/arg.h:196:1: note:   template argument deduction/substitution failed:
external/com_google_absl/absl/strings/internal/str_format/arg.h:403:43: note:   couldn’t deduce template parameter ‘C’
  403 |   return absl::str_format_internal::ExtractCharSet(ConvResult{});
      |        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
external/com_google_absl/absl/strings/internal/str_format/arg.h:201:1: note: candidate: ‘template<absl::lts_20230125::FormatConversionCharSet C> constexpr absl::lts_20230125::FormatConversionCharSet absl::lts_20230125::str_format_internal::ExtractCharSet(absl::lts_20230125::str_format_internal::ArgConvertResult<(absl::lts_20230125::FormatConversionCharSet)(C)>)’
  201 | constexpr FormatConversionCharSet ExtractCharSet(ArgConvertResult<C>) {
      | ^~~~~~~~~~~~~~
external/com_google_absl/absl/strings/internal/str_format/arg.h:201:1: note:   template argument deduction/substitution failed:
external/com_google_absl/absl/strings/internal/str_format/arg.h:403:43: note:   couldn’t deduce template parameter ‘C’
  403 |   return absl::str_format_internal::ExtractCharSet(ConvResult{});
      |        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~
Target //tensorflow/tools/pip_package:build_pip_package failed to build
INFO: Elapsed time: 35.257s, Critical Path: 32.01s
INFO: 238 processes: 30 internal, 208 local.
FAILED: Build did NOT complete successfully
```
",False
How to use tf.repeat and another buil-in highlevel funcs on Dataset? stat:awaiting response type:support stale,Can you help me in [stackoverflow](https://stackoverflow.com/questions/77332989/how-to-use-tf-repeat-and-another-buil-in-highlevel-funcs-on-dataset)? ,False
New invalid,"**System information**
- Android Device information (use `adb shell getprop ro.build.fingerprint`
  if possible):
- TensorFlow Lite in Play Services SDK version (found in `build.gradle`):
- Google Play Services version
  (`Settings` > `Apps` > `Google Play Services` > `App details`):

**Standalone code to reproduce the issue**
Provide a reproducible test case that is the bare minimum necessary to generate
the problem. If possible, please share a link to or attach code demonstrating
the problem.

**Any other info / logs**
Include any logs or source code that would be helpful to diagnose the problem.
If including tracebacks, please include the full traceback. Large logs and files
should be attached.
",False
can't install @tensorflow/tf-node on npm ,"please help. i can't install @tensorflow/tf-node on my project node.js

i have python 3.12, node.js 18 and npm ver. 10.2.1

but i can install @tensorflow/tfjs

this is the error:

npm WARN cleanup Failed to remove some directories [
npm WARN cleanup   [
npm WARN cleanup     'D:\\xampp8\\htdocs\\testnodejs\\node_modules\\@mapbox',
npm WARN cleanup     [Error: EPERM: operation not permitted, rmdir 'D:\xampp8\htdocs\testnodejs\node_modules\@mapbox\node-pre-gyp\node_modules\agent-base'] {
npm WARN cleanup       errno: -4048,
npm WARN cleanup       code: 'EPERM',
npm WARN cleanup       syscall: 'rmdir',
npm WARN cleanup       path: 'D:\\xampp8\\htdocs\\testnodejs\\node_modules\\@mapbox\\node-pre-gyp\\node_modules\\agent-base'
npm WARN cleanup     }
npm WARN cleanup   ]
npm WARN cleanup ]
npm ERR! code 1
npm ERR! path D:\xampp8\htdocs\testnodejs\node_modules\@tensorflow\tfjs-node
npm ERR! command failed
npm ERR! command C:\WINDOWS\system32\cmd.exe /d /s /c node scripts/install.js
npm ERR! CPU-windows-4.12.0.zip
npm ERR! https://storage.googleapis.com/tensorflow/libtensorflow/libtensorflow-cpu-windows-x86_64-2.9.1.zip
npm ERR! node-pre-gyp install failed with error: Error: Command failed: node-pre-gyp install --fallback-to-build
npm ERR! node-pre-gyp info it worked if it ends with ok
npm ERR! node-pre-gyp info using node-pre-gyp@1.0.9
npm ERR! node-pre-gyp info using node@18.18.2 | win32 | x64
npm ERR! node-pre-gyp info check checked for ""D:\xampp8\htdocs\testnodejs\node_modules\@tensorflow\tfjs-node\lib\napi-v8\tfjs_binding.node"" (not found)
npm ERR! node-pre-gyp http GET https://storage.googleapis.com/tf-builds/pre-built-binary/napi-v8/4.12.0/CPU-windows-4.12.0.zip
npm ERR! node-pre-gyp ERR! install response status 404 Not Found on https://storage.googleapis.com/tf-builds/pre-built-binary/napi-v8/4.12.0/CPU-windows-4.12.0.zip
npm ERR! node-pre-gyp WARN Pre-built binaries not installable for @tensorflow/tfjs-node@4.12.0 and node@18.18.2 (node-v108 ABI, unknown) (falling back to source compile with node-gyp)
npm ERR! node-pre-gyp WARN Hit error response status 404 Not Found on https://storage.googleapis.com/tf-builds/pre-built-binary/napi-v8/4.12.0/CPU-windows-4.12.0.zip
npm ERR! gyp info it worked if it ends with ok
npm ERR! gyp info using node-gyp@9.4.0
npm ERR! gyp info using node@18.18.2 | win32 | x64
npm ERR! gyp info ok
npm ERR! gyp info it worked if it ends with ok
npm ERR! gyp info using node-gyp@9.4.0
npm ERR! gyp info using node@18.18.2 | win32 | x64
npm ERR! gyp info find Python using Python version 3.12.0 found at ""C:\Program Files\Python312\python.exe""
npm ERR! gyp http GET https://nodejs.org/download/release/v18.18.2/node-v18.18.2-headers.tar.gz
npm ERR! gyp http 200 https://nodejs.org/download/release/v18.18.2/node-v18.18.2-headers.tar.gz
npm ERR! gyp http GET https://nodejs.org/download/release/v18.18.2/SHASUMS256.txt
npm ERR! gyp http GET https://nodejs.org/download/release/v18.18.2/win-x64/node.lib
npm ERR! gyp http 200 https://nodejs.org/download/release/v18.18.2/SHASUMS256.txt
npm ERR! gyp http 200 https://nodejs.org/download/release/v18.18.2/win-x64/node.lib
npm ERR! gyp info find VS using VS2022 (17.7.34202.233) found at:
npm ERR! gyp info find VS ""C:\Program Files\Microsoft Visual Studio\2022\Enterprise""
npm ERR! gyp info find VS run with --verbose for detailed information
npm ERR! gyp info spawn C:\Program Files\Python312\python.exe
npm ERR! gyp info spawn args [
npm ERR! gyp info spawn args   'C:\\Users\\User\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\node-gyp\\gyp\\gyp_main.py',
npm ERR! gyp info spawn args   'binding.gyp',
npm ERR! gyp info spawn args   '-f',
npm ERR! gyp info spawn args   'msvs',
npm ERR! gyp info spawn args   '-I',
npm ERR! gyp info spawn args   'D:\\xampp8\\htdocs\\testnodejs\\node_modules\\@tensorflow\\tfjs-node\\build\\config.gypi',
npm ERR! gyp info spawn args   '-I',
npm ERR! gyp info spawn args   'C:\\Users\\User\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\node-gyp\\addon.gypi',
npm ERR! gyp info spawn args   '-I',
npm ERR! gyp info spawn args   'C:\\Users\\User\\AppData\\Local\\node-gyp\\Cache\\18.18.2\\include\\node\\common.gypi',
npm ERR! gyp info spawn args   '-Dlibrary=shared_library',
npm ERR! gyp info spawn args   '-Dvisibility=default',
npm ERR! gyp info spawn args   '-Dnode_root_dir=C:\\Users\\User\\AppData\\Local\\node-gyp\\Cache\\18.18.2',
npm ERR! gyp info spawn args   '-Dnode_gyp_dir=C:\\Users\\User\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\node-gyp',
npm ERR! gyp info spawn args   '-Dnode_lib_file=C:\\\\Users\\\\User\\\\AppData\\\\Local\\\\node-gyp\\\\Cache\\\\18.18.2\\\\<(target_arch)\\\\node.lib',
npm ERR! gyp info spawn args   '-Dmodule_root_dir=D:\\xampp8\\htdocs\\testnodejs\\node_modules\\@tensorflow\\tfjs-node',npm ERR! gyp info spawn args   '-Dnode_engine=v8',
npm ERR! gyp info spawn args   '--depth=.',
npm ERR! gyp info spawn args   '--no-parallel',
npm ERR! gyp info spawn args   '--generator-output',
npm ERR! gyp info spawn args   'D:\\xampp8\\htdocs\\testnodejs\\node_modules\\@tensorflow\\tfjs-node\\build',
npm ERR! gyp info spawn args   '-Goutput_dir=.'
npm ERR! gyp info spawn args ]
npm ERR! Traceback (most recent call last):
npm ERR!   File ""C:\Users\User\AppData\Roaming\npm\node_modules\npm\node_modules\node-gyp\gyp\gyp_main.py"", line 42, in <module>
npm ERR!     import gyp  # noqa: E402
npm ERR!     ^^^^^^^^^^
npm ERR!   File ""C:\Users\User\AppData\Roaming\npm\node_modules\npm\node_modules\node-gyp\gyp\pylib\gyp\__init__.py"", line 9, in <module>
npm ERR!     import gyp.input
npm ERR!   File ""C:\Users\User\AppData\Roaming\npm\node_modules\npm\node_modules\node-gyp\gyp\pylib\gyp\input.py"", line 19, in <module>
npm ERR!     from distutils.version import StrictVersion
npm ERR! ModuleNotFoundError: No module named 'distutils'
npm ERR! gyp ERR! configure error
npm ERR! gyp ERR! stack Error: `gyp` failed with exit code: 1
npm ERR! gyp ERR! stack     at ChildProcess.onCpExit (C:\Users\User\AppData\Roaming\npm\node_modules\npm\node_modules\node-gyp\lib\configure.js:325:16)
npm ERR! gyp ERR! stack     at ChildProcess.emit (node:events:517:28)
npm ERR! gyp ERR! stack     at ChildProcess._handle.onexit (node:internal/child_process:292:12)
npm ERR! gyp ERR! System Windows_NT 10.0.19045
npm ERR! gyp ERR! command ""C:\\Program Files\\nodejs\\node.exe"" ""C:\\Users\\User\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\node-gyp\\bin\\node-gyp.js"" ""configure"" ""--fallback-to-build"" ""--module=D:\\xampp8\\htdocs\\testnodejs\\node_modules\\@tensorflow\\tfjs-node\\lib\\napi-v8\\tfjs_binding.node"" ""--module_name=tfjs_binding"" ""--module_path=D:\\xampp8\\htdocs\\testnodejs\\node_modules\\@tensorflow\\tfjs-node\\lib\\napi-v8"" ""--napi_version=9"" ""--node_abi_napi=napi"" ""--napi_build_version=8"" ""--node_napi_label=napi-v8""
npm ERR! gyp ERR! cwd D:\xampp8\htdocs\testnodejs\node_modules\@tensorflow\tfjs-node
npm ERR! gyp ERR! node -v v18.18.2
npm ERR! gyp ERR! node-gyp -v v9.4.0
npm ERR! gyp ERR! not ok
npm ERR! node-pre-gyp ERR! build error
npm ERR! node-pre-gyp ERR! stack Error: Failed to execute 'C:\Program Files\nodejs\node.exe C:\Users\User\AppData\Roaming\npm\node_modules\npm\node_modules\node-gyp\bin\node-gyp.js configure --fallback-to-build --module=D:\xampp8\htdocs\testnodejs\node_modules\@tensorflow\tfjs-node\lib\napi-v8\tfjs_binding.node --module_name=tfjs_binding --module_path=D:\xampp8\htdocs\testnodejs\node_modules\@tensorflow\tfjs-node\lib\napi-v8 --napi_version=9 --node_abi_napi=napi --napi_build_version=8 --node_napi_label=napi-v8' (1)
npm ERR! node-pre-gyp ERR! stack     at ChildProcess.<anonymous> (D:\xampp8\htdocs\testnodejs\node_modules\@mapbox\node-pre-gyp\lib\util\compile.js:89:23)
npm ERR! node-pre-gyp ERR! stack     at ChildProcess.emit (node:events:517:28)
npm ERR! node-pre-gyp ERR! stack     at maybeClose (node:internal/child_process:1098:16)
npm ERR! node-pre-gyp ERR! stack     at ChildProcess._handle.onexit (node:internal/child_process:303:5)
npm ERR! node-pre-gyp ERR! System Windows_NT 10.0.19045
npm ERR! node-pre-gyp ERR! command ""C:\\Program Files\\nodejs\\node.exe"" ""D:\\xampp8\\htdocs\\testnodejs\\node_modules\\@mapbox\\node-pre-gyp\\bin\\node-pre-gyp"" ""install"" ""--fallback-to-build""
npm ERR! node-pre-gyp ERR! cwd D:\xampp8\htdocs\testnodejs\node_modules\@tensorflow\tfjs-node
npm ERR! node-pre-gyp ERR! node -v v18.18.2
npm ERR! node-pre-gyp ERR! node-pre-gyp -v v1.0.9
npm ERR! node-pre-gyp ERR! not ok
npm ERR! * Downloading libtensorflow
npm ERR!
npm ERR! * Building TensorFlow Node.js bindings

![Screenshot_1](https://github.com/tensorflow/tensorflow/assets/85969639/8f834004-73e9-415c-9436-8a006693074e)
![Screenshot_2](https://github.com/tensorflow/tensorflow/assets/85969639/bea6901a-3557-4f09-b6d0-368ae0852487)
![Screenshot_3](https://github.com/tensorflow/tensorflow/assets/85969639/d4caa528-fbdb-4be4-a0d1-c7c9e03662f4)
![Screenshot_4](https://github.com/tensorflow/tensorflow/assets/85969639/42b7d62e-47af-4571-8d8c-18ab4c256157)
![Screenshot_5](https://github.com/tensorflow/tensorflow/assets/85969639/018b3162-a010-4939-9853-b4735f2fc360)
![Screenshot_6](https://github.com/tensorflow/tensorflow/assets/85969639/0f5fc8a0-57fd-4f6e-9699-573f82b7de04)


what I missed?",False
Set reshuffle_each_iteration option of shuffle as True by default instead of None stat:awaiting response type:feature stale type:docs-feature TF2.14,"### Issue type

Feature Request

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.14.0

### Custom code

Yes

### OS platform and distribution

Windows 11

### Mobile device

_No response_

### Python version

3.11.4

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

When shuffling a dataset, the option reshuffle_each_iteration is None by default. But, when we look closer at the documentation, the default behavior is to reshuffle each iteration.
It would be better to set the default value of reshuffle_each_iteration to 'True' instead of None which is ambiguous.
Please find attached the code of the function at : https://github.com/tensorflow/tensorflow/blame/8c25f8252175c6a4f9614797e953fcbfb93c3aed/tensorflow/python/data/ops/shuffle_op.py#L49C12-L49C12

### Standalone code to reproduce the issue

```shell
# Code in tensorflow/tensorflow/python/data/ops/shuffle_op.py
class _ShuffleDataset(dataset_ops.UnaryUnchangedStructureDataset):
  """"""A `Dataset` that randomly shuffles the elements of its input.""""""

  def __init__(self,
               input_dataset,
               buffer_size,
               seed=None,
               reshuffle_each_iteration=None,
               name=None):
    """"""See `Dataset.shuffle()` for details.""""""
    self._input_dataset = input_dataset
    self._buffer_size = ops.convert_to_tensor(
        buffer_size, dtype=dtypes.int64, name=""buffer_size"")
    self._seed, self._seed2 = random_seed.get_seed(seed)
    if reshuffle_each_iteration is None:
      reshuffle_each_iteration = True
    self._reshuffle_each_iteration = reshuffle_each_iteration
    self._name = name
```


### Relevant log output

_No response_",False
Building failure of libtensorflowlite_gpu_delegate.so stat:awaiting response type:build/install comp:lite subtype: ubuntu/linux,"System information

OS Platform and Distribution: Ubuntu 20.04
TensorFlow installed from (source or binary): source
TensorFlow version: 2.12.0
Bazel version (if compiling from source): 5.3.0
GCC/Compiler version (if compiling from source): 9.4.0


Describe the problem
Building libtensorflowlite_gpu_delegate.so fails
------------------------

Provide the exact sequence of commands / steps that you executed before running into the problem

bazel build -c opt tensorflow/lite/delegates/gpu:libtensorflowlite_gpu_delegate.so --copt -DEGL_NO_X11=1

Any other info / logs

ERROR: /home/sstc/tensorflow/tensorflow/lite/delegates/gpu/BUILD:134:10: Linking tensorflow/lite/delegates/gpu/libtensorflowlite_gpu_delegate.so failed: (Exit 1): crosstool_wrapper_driver_is_not_gcc failed: error executing command external/local_config_cuda/crosstool/clang/bin/crosstool_wrapper_driver_is_not_gcc @bazel-out/k8-opt/bin/tensorflow/lite/delegates/gpu/libtensorflowlite_gpu_delegate.so-2.params
/usr/bin/ld: cannot find -lnativewindow
/usr/bin/ld: cannot find -lnativewindow
collect2: error: ld returned 1 exit status
Target //tensorflow/lite/delegates/gpu:libtensorflowlite_gpu_delegate.so failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 123.625s, Critical Path: 46.21s
INFO: 804 processes: 190 internal, 614 local.
FAILED: Build did NOT complete successfully",False
Cross compilation TensorFlow Lite with CMake mat error stat:awaiting response type:build/install stale comp:lite TF 2.8,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf.2.8

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

gcc-arm-10.3

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I want to get a libtensorflow.so for my Arm Linux.

### Standalone code to reproduce the issue

```shell
ARMCC_FLAGS=""-march=armv7-a -mfpu=neon-vfpv4 -funsafe-math-optimizations -mfp16-format=ieee""
cmake -DCMAKE_C_COMPILER=gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf/bin/arm-none-linux-gnueabihf-gcc \
  -DCMAKE_CXX_COMPILER=gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf/bin/arm-none-linux-gnueabihf-g++ \
  -DCMAKE_C_FLAGS=""${ARMCC_FLAGS}"" \
  -DCMAKE_CXX_FLAGS=""${ARMCC_FLAGS}"" \
  -DCMAKE_VERBOSE_MAKEFILE:BOOL=ON \
  -DCMAKE_SYSTEM_NAME=Linux \
  -DCMAKE_SYSTEM_PROCESSOR=armv7 \
  ../tensorflow/lite/

make -j 16

then I get the Error:
w/tensorflow/build_sdk/xnnpack/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-1x16c4-minmax-neondot.c
[ 79%] Building C object _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-2x8c4-minmax-neondot.c.o
cd /mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk/_deps/xnnpack-build && /mnt/fileroot/guanghui.wan/nanoQ/Algorithm/tools/gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf/bin/arm-none-linux-gnueabihf-gcc -DEIGEN_MPL2_ONLY -DFXDIV_USE_INLINE_ASSEMBLY=0 -DNOMINMAX=1 -DPTHREADPOOL_NO_DEPRECATED_API=1 -DXNN_ENABLE_ARM_BF16=0 -DXNN_ENABLE_ARM_DOTPROD=1 -DXNN_ENABLE_ARM_FP16_SCALAR=1 -DXNN_ENABLE_ARM_FP16_VECTOR=1 -DXNN_ENABLE_ARM_I8MM=0 -DXNN_ENABLE_ASSEMBLY=1 -DXNN_ENABLE_CPUINFO=1 -DXNN_ENABLE_DWCONV_MULTIPASS=0 -DXNN_ENABLE_GEMM_M_SPECIALIZATION=1 -DXNN_ENABLE_JIT=0 -DXNN_ENABLE_MEMOPT=1 -DXNN_ENABLE_RISCV_VECTOR=1 -DXNN_ENABLE_SPARSE=1 -I/mnt/fileroot/guanghui.wan/tensorflow/tensorflow/third_party/xla/third_party/tsl -I/mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk/xnnpack/src -I/mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk/pthreadpool-source/include -I/mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk/FXdiv-source/include -I/mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk/FP16-source/include -march=armv8-a -mfpu=neon-vfpv4 -funsafe-math-optimizations -mfp16-format=ieee -O3 -DNDEBUG -std=c99 -fPIC -Wno-psabi -O2 -pthread  -fno-math-errno  -marm  -march=armv8.2-a+dotprod -mfpu=neon-fp-armv8  -MD -MT _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-2x8c4-minmax-neondot.c.o -MF CMakeFiles/microkernels-all.dir/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-2x8c4-minmax-neondot.c.o.d -o CMakeFiles/microkernels-all.dir/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-2x8c4-minmax-neondot.c.o -c /mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk/xnnpack/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-2x8c4-minmax-neondot.c
/tmp/ccrZ5z20.s: Assembler messages:
/tmp/ccrZ5z20.s:75: Error: selected processor does not support `vsdot.s8 q14,q12,d7[0]' in ARM mode
/tmp/ccrZ5z20.s:76: Error: selected processor does not support `vsdot.s8 q10,q9,d7[0]' in ARM mode
/tmp/ccrZ5z20.s:77: Error: selected processor does not support `vsdot.s8 q14,q11,d7[1]' in ARM mode
/tmp/ccrZ5z20.s:78: Error: selected processor does not support `vsdot.s8 q10,q8,d7[1]' in ARM mode
/tmp/ccrZ5z20.s:134: Error: selected processor does not support `vsdot.s8 q14,q9,d7[0]' in ARM mode
/tmp/ccrZ5z20.s:135: Error: selected processor does not support `vsdot.s8 q10,q8,d7[0]' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:49877: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc4w-gemm/gen/qd8-f32-qc4w-gemm-1x8c4-minmax-neondot.c.o] Error 1
make[2]: *** Waiting for unfinished jobs....
/tmp/ccWEkUHN.s: Assembler messages:
/tmp/ccWEkUHN.s:81: Error: selected processor does not support `vsdot.s8 q12,q9,d7[0]' in ARM mode
/tmp/ccWEkUHN.s:82: Error: selected processor does not support `vsdot.s8 q13,q2,d7[0]' in ARM mode
/tmp/ccWEkUHN.s:83: Error: selected processor does not support `vsdot.s8 q15,q8,d7[0]' in ARM mode
/tmp/ccWEkUHN.s:85: Error: selected processor does not support `vsdot.s8 q10,q14,d7[0]' in ARM mode
/tmp/ccWEkUHN.s:91: Error: selected processor does not support `vsdot.s8 q12,q8,d7[1]' in ARM mode
/tmp/ccWEkUHN.s:93: Error: selected processor does not support `vsdot.s8 q13,q14,d7[1]' in ARM mode
/tmp/ccWEkUHN.s:99: Error: selected processor does not support `vsdot.s8 q10,q14,d7[1]' in ARM mode
/tmp/ccWEkUHN.s:100: Error: selected processor does not support `vsdot.s8 q15,q8,d7[1]' in ARM mode
/tmp/ccWEkUHN.s:184: Error: selected processor does not support `vsdot.s8 q13,q2,d7[0]' in ARM mode
/tmp/ccWEkUHN.s:185: Error: selected processor does not support `vsdot.s8 q12,q9,d7[0]' in ARM mode
/tmp/ccWEkUHN.s:186: Error: selected processor does not support `vsdot.s8 q10,q14,d7[0]' in ARM mode
/tmp/ccWEkUHN.s:187: Error: selected processor does not support `vsdot.s8 q15,q8,d7[0]' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:49905: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc4w-gemm/gen/qd8-f32-qc4w-gemm-1x16c4-minmax-neondot.c.o] Error 1
/tmp/ccEQXTmv.s: Assembler messages:
/tmp/ccEQXTmv.s:88: Error: selected processor does not support `vsdot.s8 q15,q11,d7[0]' in ARM mode
/tmp/ccEQXTmv.s:89: Error: selected processor does not support `vsdot.s8 q14,q9,d7[0]' in ARM mode
/tmp/ccEQXTmv.s:90: Error: selected processor does not support `vsdot.s8 q15,q10,d7[1]' in ARM mode
/tmp/ccEQXTmv.s:91: Error: selected processor does not support `vsdot.s8 q14,q8,d7[1]' in ARM mode
/tmp/ccEQXTmv.s:93: Error: selected processor does not support `vsdot.s8 q13,q11,d7[0]' in ARM mode
/tmp/ccEQXTmv.s:94: Error: selected processor does not support `vsdot.s8 q12,q9,d7[0]' in ARM mode
/tmp/ccEQXTmv.s:95: Error: selected processor does not support `vsdot.s8 q13,q10,d7[1]' in ARM mode
/tmp/ccEQXTmv.s:96: Error: selected processor does not support `vsdot.s8 q12,q8,d7[1]' in ARM mode
/tmp/ccEQXTmv.s:189: Error: selected processor does not support `vsdot.s8 q15,q9,d6[0]' in ARM mode
/tmp/ccEQXTmv.s:190: Error: selected processor does not support `vsdot.s8 q14,q8,d6[0]' in ARM mode
/tmp/ccEQXTmv.s:191: Error: selected processor does not support `vsdot.s8 q13,q9,d7[0]' in ARM mode
/tmp/ccEQXTmv.s:192: Error: selected processor does not support `vsdot.s8 q12,q8,d7[0]' in ARM mode
/tmp/ccmAlACc.s: make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:49933: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc4w-gemm/gen/qd8-f32-qc4w-gemm-2x8c4-minmax-neondot.c.o] Error 1
Assembler messages:
/tmp/ccmAlACc.s:87: Error: selected processor does not support `vsdot.s8 q1,q10,q8' in ARM mode
/tmp/ccmAlACc.s:90: Error: selected processor does not support `vsdot.s8 q0,q5,q8' in ARM mode
/tmp/ccmAlACc.s:91: Error: selected processor does not support `vsdot.s8 q2,q9,q8' in ARM mode
/tmp/ccmAlACc.s:92: Error: selected processor does not support `vsdot.s8 q14,q4,q8' in ARM mode
/tmp/ccmAlACc.s:101: Error: selected processor does not support `vsdot.s8 q13,q5,q8' in ARM mode
/tmp/ccmAlACc.s:102: Error: selected processor does not support `vsdot.s8 q3,q10,q8' in ARM mode
/tmp/ccmAlACc.s:103: Error: selected processor does not support `vsdot.s8 q12,q4,q8' in ARM mode
/tmp/ccmAlACc.s:104: Error: selected processor does not support `vsdot.s8 q15,q9,q8' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:49919: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc4w-gemm/gen/qd8-f32-qc4w-gemm-1x16c8-minmax-neondot-ld64.c.o] Error 1
/tmp/ccBfIgBU.s: Assembler messages:
/tmp/ccBfIgBU.s:109: Error: selected processor does not support `vsdot.s8 q14,q10,d6[0]' in ARM mode
/tmp/ccBfIgBU.s:110: Error: selected processor does not support `vsdot.s8 q13,q9,d6[0]' in ARM mode
/tmp/ccBfIgBU.s:111: Error: selected processor does not support `vsdot.s8 q12,q8,d6[0]' in ARM mode
/tmp/ccBfIgBU.s:112: Error: selected processor does not support `vsdot.s8 q1,q11,d6[0]' in ARM mode
/tmp/ccBfIgBU.s:114: Error: selected processor does not support `vsdot.s8 q0,q10,d7[0]' in ARM mode
/tmp/ccBfIgBU.s:115: Error: selected processor does not support `vsdot.s8 q4,q9,d7[0]' in ARM mode
/tmp/ccBfIgBU.s:116: Error: selected processor does not support `vsdot.s8 q5,q8,d7[0]' in ARM mode
/tmp/ccBfIgBU.s:117: Error: selected processor does not support `vsdot.s8 q6,q11,d7[0]' in ARM mode
/tmp/ccBfIgBU.s:126: Error: selected processor does not support `vsdot.s8 q14,q11,d6[1]' in ARM mode
/tmp/ccBfIgBU.s:127: Error: selected processor does not support `vsdot.s8 q0,q11,d7[1]' in ARM mode
/tmp/ccBfIgBU.s:128: Error: selected processor does not support `vsdot.s8 q13,q10,d6[1]' in ARM mode
/tmp/ccBfIgBU.s:129: Error: selected processor does not support `vsdot.s8 q4,q10,d7[1]' in ARM mode
/tmp/ccBfIgBU.s:130: Error: selected processor does not support `vsdot.s8 q12,q9,d6[1]' in ARM mode
/tmp/ccBfIgBU.s:131: Error: selected processor does not support `vsdot.s8 q1,q8,d6[1]' in ARM mode
/tmp/ccBfIgBU.s:132: Error: selected processor does not support `vsdot.s8 q5,q9,d7[1]' in ARM mode
/tmp/ccBfIgBU.s:133: Error: selected processor does not support `vsdot.s8 q6,q8,d7[1]' in ARM mode
/tmp/ccBfIgBU.s:255: Error: selected processor does not support `vsdot.s8 q13,q9,d6[0]' in ARM mode
/tmp/ccBfIgBU.s:256: Error: selected processor does not support `vsdot.s8 q4,q9,d7[0]' in ARM mode
/tmp/ccBfIgBU.s:258: Error: selected processor does not support `vsdot.s8 q14,q10,d6[0]' in ARM mode
/tmp/ccBfIgBU.s:260: Error: selected processor does not support `vsdot.s8 q0,q10,d7[0]' in ARM mode
/tmp/ccBfIgBU.s:262: Error: selected processor does not support `vsdot.s8 q12,q9,d6[0]' in ARM mode
/tmp/ccBfIgBU.s:263: Error: selected processor does not support `vsdot.s8 q5,q9,d7[0]' in ARM mode
/tmp/ccBfIgBU.s:264: Error: selected processor does not support `vsdot.s8 q1,q8,d6[0]' in ARM mode
/tmp/ccBfIgBU.s:265: Error: selected processor does not support `vsdot.s8 q6,q8,d7[0]' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:49947: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc4w-gemm/gen/qd8-f32-qc4w-gemm-2x16c4-minmax-neondot.c.o] Error 1
/tmp/ccDJj1kS.s: Assembler messages:
/tmp/ccDJj1kS.s:75: Error: selected processor does not support `vsdot.s8 q15,q12,q10' in ARM mode
/tmp/ccDJj1kS.s:76: Error: selected processor does not support `vsdot.s8 q2,q9,q10' in ARM mode
/tmp/ccDJj1kS.s:77: Error: selected processor does not support `vsdot.s8 q13,q11,q10' in ARM mode
/tmp/ccDJj1kS.s:78: Error: selected processor does not support `vsdot.s8 q3,q8,q10' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:49891: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc4w-gemm/gen/qd8-f32-qc4w-gemm-1x8c8-minmax-neondot-ld64.c.o] Error 1
/tmp/ccRqcaMJ.s: Assembler messages:
/tmp/ccRqcaMJ.s:143: Error: selected processor does not support `vsdot.s8 q1,q14,d6[0]' in ARM mode
/tmp/ccRqcaMJ.s:146: Error: selected processor does not support `vsdot.s8 q5,q14,d5[0]' in ARM mode
/tmp/ccRqcaMJ.s:147: Error: selected processor does not support `vsdot.s8 q15,q14,d7[0]' in ARM mode
/tmp/ccRqcaMJ.s:149: Error: selected processor does not support `vsdot.s8 q6,q7,d5[0]' in ARM mode
/tmp/ccRqcaMJ.s:151: Error: selected processor does not support `vsdot.s8 q4,q7,d6[0]' in ARM mode
/tmp/ccRqcaMJ.s:152: Error: selected processor does not support `vsdot.s8 q0,q7,d7[0]' in ARM mode
/tmp/ccRqcaMJ.s:158: Error: selected processor does not support `vsdot.s8 q7,q14,d5[0]' in ARM mode
/tmp/ccRqcaMJ.s:159: Error: selected processor does not support `vsdot.s8 q13,q10,d5[0]' in ARM mode
/tmp/ccRqcaMJ.s:160: Error: selected processor does not support `vsdot.s8 q12,q14,d6[0]' in ARM mode
/tmp/ccRqcaMJ.s:162: Error: selected processor does not support `vsdot.s8 q11,q14,d7[0]' in ARM mode
/tmp/ccRqcaMJ.s:163: Error: selected processor does not support `vsdot.s8 q10,q1,d6[0]' in ARM mode
/tmp/ccRqcaMJ.s:166: Error: selected processor does not support `vsdot.s8 q14,q1,d7[0]' in ARM mode
/tmp/ccRqcaMJ.s:170: Error: selected processor does not support `vsdot.s8 q6,q1,d5[1]' in ARM mode
/tmp/ccRqcaMJ.s:171: Error: selected processor does not support `vsdot.s8 q5,q9,d5[1]' in ARM mode
/tmp/ccRqcaMJ.s:172: Error: selected processor does not support `vsdot.s8 q4,q1,d6[1]' in ARM mode
/tmp/ccRqcaMJ.s:173: Error: selected processor does not support `vsdot.s8 q0,q1,d7[1]' in ARM mode
/tmp/ccRqcaMJ.s:174: Error: selected processor does not support `vsdot.s8 q15,q9,d7[1]' in ARM mode
/tmp/ccRqcaMJ.s:177: Error: selected processor does not support `vsdot.s8 q1,q9,d6[1]' in ARM mode
/tmp/ccRqcaMJ.s:186: Error: selected processor does not support `vsdot.s8 q7,q9,d5[1]' in ARM mode
/tmp/ccRqcaMJ.s:187: Error: selected processor does not support `vsdot.s8 q10,q8,d6[1]' in ARM mode
/tmp/ccRqcaMJ.s:188: Error: selected processor does not support `vsdot.s8 q14,q8,d7[1]' in ARM mode
/tmp/ccRqcaMJ.s:191: Error: selected processor does not support `vsdot.s8 q13,q8,d5[1]' in ARM mode
/tmp/ccRqcaMJ.s:192: Error: selected processor does not support `vsdot.s8 q12,q9,d6[1]' in ARM mode
/tmp/ccRqcaMJ.s:193: Error: selected processor does not support `vsdot.s8 q11,q9,d7[1]' in ARM mode
/tmp/ccRqcaMJ.s:453: Error: selected processor does not support `vsdot.s8 q6,q9,d7[0]' in ARM mode
/tmp/ccRqcaMJ.s:454: Error: selected processor does not support `vsdot.s8 q5,q8,d7[0]' in ARM mode
/tmp/ccRqcaMJ.s:456: Error: selected processor does not support `vsdot.s8 q4,q9,d6[0]' in ARM mode
/tmp/ccRqcaMJ.s:457: Error: selected processor does not support `vsdot.s8 q0,q9,d5[0]' in ARM mode
/tmp/ccRqcaMJ.s:458: Error: selected processor does not support `vsdot.s8 q1,q8,d6[0]' in ARM mode
/tmp/ccRqcaMJ.s:460: Error: selected processor does not support `vsdot.s8 q15,q8,d5[0]' in ARM mode
/tmp/ccRqcaMJ.s:467: Error: selected processor does not support `vsdot.s8 q10,q9,d7[0]' in ARM mode
/tmp/ccRqcaMJ.s:468: Error: selected processor does not support `vsdot.s8 q12,q9,d6[0]' in ARM mode
/tmp/ccRqcaMJ.s:469: Error: selected processor does not support `vsdot.s8 q11,q9,d5[0]' in ARM mode
/tmp/ccRqcaMJ.s:472: Error: selected processor does not support `vsdot.s8 q13,q8,d7[0]' in ARM mode
/tmp/ccRqcaMJ.s:474: Error: selected processor does not support `vsdot.s8 q9,q8,d6[0]' in ARM mode
/tmp/ccRqcaMJ.s:478: Error: selected processor does not support `vsdot.s8 q9,q8,d5[0]' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:49961: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc4w-gemm/gen/qd8-f32-qc4w-gemm-3x16c4-minmax-neondot.c.o] Error 1
/tmp/ccuyJ4D9.s: Assembler messages:
/tmp/ccuyJ4D9.s:64: Error: selected processor does not support `vsdot.s8 q9,q11,d7[0]' in ARM mode
/tmp/ccuyJ4D9.s:66: Error: selected processor does not support `vsdot.s8 q8,q10,d7[0]' in ARM mode
/tmp/ccuyJ4D9.s:69: Error: selected processor does not support `vsdot.s8 q9,q10,d7[1]' in ARM mode
/tmp/ccuyJ4D9.s:73: Error: selected processor does not support `vsdot.s8 q8,q10,d7[1]' in ARM mode
/tmp/ccuyJ4D9.s:130: Error: selected processor does not support `vsdot.s8 q9,q11,d7[0]' in ARM mode
/tmp/ccuyJ4D9.s:132: Error: selected processor does not support `vsdot.s8 q8,q10,d7[0]' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:50031: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-1x8c4-minmax-neondot.c.o] Error 1
/tmp/ccRNmUcC.s: Assembler messages:
/tmp/ccRNmUcC.s:110: Error: selected processor does not support `vsdot.s8 q4,q11,d7[0]' in ARM mode
/tmp/ccRNmUcC.s:111: Error: selected processor does not support `vsdot.s8 q2,q9,d7[0]' in ARM mode
/tmp/ccRNmUcC.s:112: Error: selected processor does not support `vsdot.s8 q4,q10,d7[1]' in ARM mode
/tmp/ccRNmUcC.s:113: Error: selected processor does not support `vsdot.s8 q2,q8,d7[1]' in ARM mode
/tmp/ccRNmUcC.s:116: Error: selected processor does not support `vsdot.s8 q0,q11,d7[0]' in ARM mode
/tmp/ccRNmUcC.s:117: Error: selected processor does not support `vsdot.s8 q15,q9,d7[0]' in ARM mode
/tmp/ccRNmUcC.s:118: Error: selected processor does not support `vsdot.s8 q0,q10,d7[1]' in ARM mode
/tmp/ccRNmUcC.s:119: Error: selected processor does not support `vsdot.s8 q15,q8,d7[1]' in ARM mode
/tmp/ccRNmUcC.s:123: Error: selected processor does not support `vsdot.s8 q1,q11,d7[0]' in ARM mode
/tmp/ccRNmUcC.s:124: Error: selected processor does not support `vsdot.s8 q14,q9,d7[0]' in ARM mode
/tmp/ccRNmUcC.s:125: Error: selected processor does not support `vsdot.s8 q1,q10,d7[1]' in ARM mode
/tmp/ccRNmUcC.s:126: Error: selected processor does not support `vsdot.s8 q14,q8,d7[1]' in ARM mode
/tmp/ccRNmUcC.s:129: Error: selected processor does not support `vsdot.s8 q13,q11,d7[0]' in ARM mode
/tmp/ccRNmUcC.s:130: Error: selected processor does not support `vsdot.s8 q12,q9,d7[0]' in ARM mode
/tmp/ccRNmUcC.s:131: Error: selected processor does not support `vsdot.s8 q13,q10,d7[1]' in ARM mode
/tmp/ccRNmUcC.s:132: Error: selected processor does not support `vsdot.s8 q12,q8,d7[1]' in ARM mode
/tmp/ccRNmUcC.s:300: Error: selected processor does not support `vsdot.s8 q4,q10,d7[0]' in ARM mode
/tmp/ccRNmUcC.s:301: Error: selected processor does not support `vsdot.s8 q2,q9,d7[0]' in ARM mode
/tmp/ccRNmUcC.s:303: Error: selected processor does not support `vsdot.s8 q0,q10,d6[0]' in ARM mode
/tmp/ccRNmUcC.s:304: Error: selected processor does not support `vsdot.s8 q15,q9,d6[0]' in ARM mode
/tmp/ccRNmUcC.s:305: Error: selected processor does not support `vsdot.s8 q1,q10,d7[0]' in ARM mode
/tmp/ccRNmUcC.s:307: Error: selected processor does not support `vsdot.s8 q13,q10,d7[0]' in ARM mode
/tmp/ccRNmUcC.s:309: Error: selected processor does not support `vsdot.s8 q14,q9,d7[0]' in ARM mode
/tmp/ccRNmUcC.s:311: Error: selected processor does not support `vsdot.s8 q12,q9,d7[0]' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:49975: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc4w-gemm/gen/qd8-f32-qc4w-gemm-4x8c4-minmax-neondot.c.o] Error 1
/tmp/ccNllqu0.s: Assembler messages:
/tmp/ccNllqu0.s:176: Error: selected processor does not support `vsdot.s8 q6,q11,d4[0]' in ARM mode
/tmp/ccNllqu0.s:177: Error: selected processor does not support `vsdot.s8 q4,q11,d5[0]' in ARM mode
/tmp/ccNllqu0.s:178: Error: selected processor does not support `vsdot.s8 q15,q11,d6[0]' in ARM mode
/tmp/ccNllqu0.s:179: Error: selected processor does not support `vsdot.s8 q14,q11,d7[0]' in ARM mode
/tmp/ccNllqu0.s:183: Error: selected processor does not support `vsdot.s8 q7,q12,d4[0]' in ARM mode
/tmp/ccNllqu0.s:184: Error: selected processor does not support `vsdot.s8 q5,q12,d5[0]' in ARM mode
/tmp/ccNllqu0.s:186: Error: selected processor does not support `vsdot.s8 q0,q12,d6[0]' in ARM mode
/tmp/ccNllqu0.s:189: Error: selected processor does not support `vsdot.s8 q1,q12,d7[0]' in ARM mode
/tmp/ccNllqu0.s:195: Error: selected processor does not support `vsdot.s8 q9,q11,d5[0]' in ARM mode
/tmp/ccNllqu0.s:196: Error: selected processor does not support `vsdot.s8 q8,q11,d7[0]' in ARM mode
/tmp/ccNllqu0.s:199: Error: selected processor does not support `vsdot.s8 q13,q11,d4[0]' in ARM mode
/tmp/ccNllqu0.s:200: Error: selected processor does not support `vsdot.s8 q12,q10,d4[0]' in ARM mode
/tmp/ccNllqu0.s:203: Error: selected processor does not support `vsdot.s8 q9,q10,d5[0]' in ARM mode
/tmp/ccNllqu0.s:211: Error: selected processor does not support `vsdot.s8 q9,q11,d6[0]' in ARM mode
/tmp/ccNllqu0.s:215: Error: selected processor does not support `vsdot.s8 q9,q10,d7[0]' in ARM mode
/tmp/ccNllqu0.s:221: Error: selected processor does not support `vsdot.s8 q11,q10,d6[0]' in ARM mode
/tmp/ccNllqu0.s:225: Error: selected processor does not support `vsdot.s8 q7,q10,d4[1]' in ARM mode
/tmp/ccNllqu0.s:226: Error: selected processor does not support `vsdot.s8 q5,q10,d5[1]' in ARM mode
/tmp/ccNllqu0.s:227: Error: selected processor does not support `vsdot.s8 q0,q10,d6[1]' in ARM mode
/tmp/ccNllqu0.s:228: Error: selected processor does not support `vsdot.s8 q1,q10,d7[1]' in ARM mode
/tmp/ccNllqu0.s:231: Error: selected processor does not support `vsdot.s8 q6,q9,d4[1]' in ARM mode
/tmp/ccNllqu0.s:232: Error: selected processor does not support `vsdot.s8 q4,q9,d5[1]' in ARM mode
/tmp/ccNllqu0.s:233: Error: selected processor does not support `vsdot.s8 q15,q9,d6[1]' in ARM mode
/tmp/ccNllqu0.s:234: Error: selected processor does not support `vsdot.s8 q14,q9,d7[1]' in ARM mode
/tmp/ccNllqu0.s:240: Error: selected processor does not support `vsdot.s8 q10,q9,d5[1]' in ARM mode
/tmp/ccNllqu0.s:241: Error: selected processor does not support `vsdot.s8 q13,q9,d4[1]' in ARM mode
/tmp/ccNllqu0.s:244: Error: selected processor does not support `vsdot.s8 q12,q8,d4[1]' in ARM mode
/tmp/ccNllqu0.s:245: Error: selected processor does not support `vsdot.s8 q11,q8,d6[1]' in ARM mode
/tmp/ccNllqu0.s:248: Error: selected processor does not support `vsdot.s8 q10,q8,d5[1]' in ARM mode
/tmp/ccNllqu0.s:255: Error: selected processor does not support `vsdot.s8 q10,q9,d6[1]' in ARM mode
/tmp/ccNllqu0.s:260: Error: selected processor does not support `vsdot.s8 q10,q9,d7[1]' in ARM mode
/tmp/ccNllqu0.s:264: Error: selected processor does not support `vsdot.s8 q9,q8,d7[1]' in ARM mode
/tmp/ccNllqu0.s:658: Error: selected processor does not support `vsdot.s8 q7,q9,d7[0]' in ARM mode
/tmp/ccNllqu0.s:659: Error: selected processor does not support `vsdot.s8 q6,q8,d7[0]' in ARM mode
/tmp/ccNllqu0.s:660: Error: selected processor does not support `vsdot.s8 q5,q9,d6[0]' in ARM mode
/tmp/ccNllqu0.s:661: Error: selected processor does not support `vsdot.s8 q4,q8,d6[0]' in ARM mode
/tmp/ccNllqu0.s:665: Error: selected processor does not support `vsdot.s8 q0,q9,d5[0]' in ARM mode
/tmp/ccNllqu0.s:667: Error: selected processor does not support `vsdot.s8 q15,q8,d5[0]' in ARM mode
/tmp/ccNllqu0.s:669: Error: selected processor does not support `vsdot.s8 q1,q9,d4[0]' in ARM mode
/tmp/ccNllqu0.s:670: Error: selected processor does not support `vsdot.s8 q14,q8,d4[0]' in ARM mode
/tmp/ccNllqu0.s:678: Error: selected processor does not support `vsdot.s8 q10,q8,d7[0]' in ARM mode
/tmp/ccNllqu0.s:679: Error: selected processor does not support `vsdot.s8 q13,q9,d7[0]' in ARM mode
/tmp/ccNllqu0.s:684: Error: selected processor does not support `vsdot.s8 q10,q9,d6[0]' in ARM mode
/tmp/ccNllqu0.s:689: Error: selected processor does not support `vsdot.s8 q10,q8,d6[0]' in ARM mode
/tmp/ccNllqu0.s:694: Error: selected processor does not support `vsdot.s8 q10,q9,d5[0]' in ARM mode
/tmp/ccNllqu0.s:699: Error: selected processor does not support `vsdot.s8 q10,q9,d4[0]' in ARM mode
/tmp/ccNllqu0.s:704: Error: selected processor does not support `vsdot.s8 q9,q8,d5[0]' in ARM mode
/tmp/ccNllqu0.s:708: Error: selected processor does not support `vsdot.s8 q9,q8,d4[0]' in ARM mode
/tmp/ccWKfZvp.s: Assembler messages:
/tmp/ccWKfZvp.s:65: Error: selected processor does not support `vsdot.s8 q10,q14,q8' in ARM mode
/tmp/ccWKfZvp.s:68: Error: selected processor does not support `vsdot.s8 q12,q13,q8' in ARM mode
/tmp/ccWKfZvp.s:71: Error: selected processor does not support `vsdot.s8 q9,q13,q8' in ARM mode
/tmp/ccWKfZvp.s:75: Error: selected processor does not support `vsdot.s8 q11,q13,q8' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:49989: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc4w-gemm/gen/qd8-f32-qc4w-gemm-4x16c4-minmax-neondot.c.o] Error 1
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:50045: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-1x8c8-minmax-neondot-ld64.c.o] Error 1
/tmp/ccw5qRTa.s: Assembler messages:
/tmp/ccw5qRTa.s:183: Error: selected processor does not support `vsdot.s8 q6,q7,d2[0]' in ARM mode
/tmp/ccw5qRTa.s:184: Error: selected processor does not support `vsdot.s8 q4,q7,d3[0]' in ARM mode
/tmp/ccw5qRTa.s:185: Error: selected processor does not support `vsdot.s8 q10,q7,d4[0]' in ARM mode
/tmp/ccw5qRTa.s:186: Error: selected processor does not support `vsdot.s8 q15,q7,d5[0]' in ARM mode
/tmp/ccw5qRTa.s:188: Error: selected processor does not support `vsdot.s8 q11,q7,d6[0]' in ARM mode
/tmp/ccw5qRTa.s:189: Error: selected processor does not support `vsdot.s8 q5,q9,d2[0]' in ARM mode
/tmp/ccw5qRTa.s:190: Error: selected processor does not support `vsdot.s8 q0,q9,d3[0]' in ARM mode
/tmp/ccw5qRTa.s:193: Error: selected processor does not support `vsdot.s8 q10,q9,d4[0]' in ARM mode
/tmp/ccw5qRTa.s:196: Error: selected processor does not support `vsdot.s8 q12,q9,d5[0]' in ARM mode
/tmp/ccw5qRTa.s:197: Error: selected processor does not support `vsdot.s8 q14,q9,d6[0]' in ARM mode
/tmp/ccw5qRTa.s:198: Error: selected processor does not support `vsdot.s8 q13,q9,d7[0]' in ARM mode
/tmp/ccw5qRTa.s:201: Error: selected processor does not support `vsdot.s8 q10,q7,d7[0]' in ARM mode
/tmp/ccw5qRTa.s:206: Error: selected processor does not support `vsdot.s8 q6,q9,d2[1]' in ARM mode
/tmp/ccw5qRTa.s:207: Error: selected processor does not support `vsdot.s8 q5,q8,d2[1]' in ARM mode
/tmp/ccw5qRTa.s:208: Error: selected processor does not support `vsdot.s8 q4,q9,d3[1]' in ARM mode
/tmp/ccw5qRTa.s:209: Error: selected processor does not support `vsdot.s8 q0,q8,d3[1]' in ARM mode
/tmp/ccw5qRTa.s:210: Error: selected processor does not support `vsdot.s8 q10,q9,d7[1]' in ARM mode
/tmp/ccw5qRTa.s:212: Error: selected processor does not support `vsdot.s8 q15,q9,d5[1]' in ARM mode
/tmp/ccw5qRTa.s:213: Error: selected processor does not support `vsdot.s8 q1,q9,d4[1]' in ARM mode
/tmp/ccw5qRTa.s:214: Error: selected processor does not support `vsdot.s8 q12,q8,d5[1]' in ARM mode
/tmp/ccw5qRTa.s:216: Error: selected processor does not support `vsdot.s8 q11,q9,d6[1]' in ARM mode
/tmp/ccw5qRTa.s:217: Error: selected processor does not support `vsdot.s8 q14,q8,d6[1]' in ARM mode
/tmp/ccw5qRTa.s:220: Error: selected processor does not support `vsdot.s8 q13,q8,d7[1]' in ARM mode
/tmp/ccw5qRTa.s:221: Error: selected processor does not support `vsdot.s8 q1,q8,d4[1]' in ARM mode
/tmp/ccw5qRTa.s:513: Error: selected processor does not support `vsdot.s8 q6,q9,d7[0]' in ARM mode
/tmp/ccw5qRTa.s:514: Error: selected processor does not support `vsdot.s8 q5,q8,d7[0]' in ARM mode
/tmp/ccw5qRTa.s:515: Error: selected processor does not support `vsdot.s8 q4,q9,d6[0]' in ARM mode
/tmp/ccw5qRTa.s:516: Error: selected processor does not support `vsdot.s8 q0,q8,d6[0]' in ARM mode
/tmp/ccw5qRTa.s:517: Error: selected processor does not support `vsdot.s8 q15,q9,d4[0]' in ARM mode
/tmp/ccw5qRTa.s:519: Error: selected processor does not support `vsdot.s8 q12,q8,d4[0]' in ARM mode
/tmp/ccw5qRTa.s:520: Error: selected processor does not support `vsdot.s8 q3,q9,d5[0]' in ARM mode
/tmp/ccw5qRTa.s:521: Error: selected processor does not support `vsdot.s8 q11,q9,d3[0]' in ARM mode
/tmp/ccw5qRTa.s:523: Error: selected processor does not support `vsdot.s8 q10,q9,d2[0]' in ARM mode
/tmp/ccw5qRTa.s:524: Error: selected processor does not support `vsdot.s8 q14,q8,d3[0]' in ARM mode
/tmp/ccw5qRTa.s:527: Error: selected processor does not support `vsdot.s8 q13,q8,d2[0]' in ARM mode
/tmp/ccw5qRTa.s:528: Error: selected processor does not support `vsdot.s8 q3,q8,d5[0]' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:50003: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc4w-gemm/gen/qd8-f32-qc4w-gemm-6x8c4-minmax-neondot.c.o] Error 1
/tmp/cczsG4jB.s: Assembler messages:
/tmp/cczsG4jB.s:76: Error: selected processor does not support `vsdot.s8 q12,q2,q8' in ARM mode
/tmp/cczsG4jB.s:79: Error: selected processor does not support `vsdot.s8 q3,q2,q8' in ARM mode
/tmp/cczsG4jB.s:82: Error: selected processor does not support `vsdot.s8 q11,q2,q8' in ARM mode
/tmp/cczsG4jB.s:85: Error: selected processor does not support `vsdot.s8 q15,q2,q8' in ARM mode
/tmp/cczsG4jB.s:88: Error: selected processor does not support `vsdot.s8 q10,q2,q8' in ARM mode
/tmp/cczsG4jB.s:91: Error: selected processor does not support `vsdot.s8 q14,q2,q8' in ARM mode
/tmp/cczsG4jB.s:94: Error: selected processor does not support `vsdot.s8 q9,q2,q8' in ARM mode
/tmp/cczsG4jB.s:98: Error: selected processor does not support `vsdot.s8 q13,q2,q8' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:50073: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-1x16c8-minmax-neondot-ld64.c.o] Error 1
/tmp/cchtznlO.s: Assembler messages:
/tmp/cchtznlO.s:236: Error: selected processor does not support `vsdot.s8 q7,q12,d2[0]' in ARM mode
/tmp/cchtznlO.s:238: Error: selected processor does not support `vsdot.s8 q6,q11,d2[0]' in ARM mode
/tmp/cchtznlO.s:240: Error: selected processor does not support `vsdot.s8 q5,q12,d3[0]' in ARM mode
/tmp/cchtznlO.s:242: Error: selected processor does not support `vsdot.s8 q4,q11,d3[0]' in ARM mode
/tmp/cchtznlO.s:245: Error: selected processor does not support `vsdot.s8 q0,q12,d4[0]' in ARM mode
/tmp/cchtznlO.s:246: Error: selected processor does not support `vsdot.s8 q9,q11,d4[0]' in ARM mode
/tmp/cchtznlO.s:247: Error: selected processor does not support `vsdot.s8 q14,q12,d5[0]' in ARM mode
/tmp/cchtznlO.s:250: Error: selected processor does not support `vsdot.s8 q13,q11,d5[0]' in ARM mode
/tmp/cchtznlO.s:251: Error: selected processor does not support `vsdot.s8 q15,q11,d7[0]' in ARM mode
/tmp/cchtznlO.s:255: Error: selected processor does not support `vsdot.s8 q9,q12,d6[0]' in ARM mode
/tmp/cchtznlO.s:261: Error: selected processor does not support `vsdot.s8 q9,q12,d7[0]' in ARM mode
/tmp/cchtznlO.s:267: Error: selected processor does not support `vsdot.s8 q12,q11,d6[0]' in ARM mode
/tmp/cchtznlO.s:274: Error: selected processor does not support `vsdot.s8 q9,q11,d2[0]' in ARM mode
/tmp/cchtznlO.s:275: Error: selected processor does not support `vsdot.s8 q8,q10,d3[0]' in ARM mode
/tmp/cchtznlO.s:281: Error: selected processor does not support `vsdot.s8 q9,q10,d2[0]' in ARM mode
/tmp/cchtznlO.s:286: Error: selected processor does not support `vsdot.s8 q9,q11,d3[0]' in ARM mode
/tmp/cchtznlO.s:291: Error: selected processor does not support `vsdot.s8 q9,q11,d4[0]' in ARM mode
/tmp/cchtznlO.s:296: Error: selected processor does not support `vsdot.s8 q8,q10,d4[0]' in ARM mode
/tmp/cchtznlO.s:301: Error: selected processor does not support `vsdot.s8 q9,q11,d5[0]' in ARM mode
/tmp/cchtznlO.s:306: Error: selected processor does not support `vsdot.s8 q8,q10,d5[0]' in ARM mode
/tmp/cchtznlO.s:311: Error: selected processor does not support `vsdot.s8 q9,q11,d6[0]' in ARM mode
/tmp/cchtznlO.s:316: Error: selected processor does not support `vsdot.s8 q8,q11,d7[0]' in ARM mode
/tmp/cchtznlO.s:321: Error: selected processor does not support `vsdot.s8 q9,q10,d7[0]' in ARM mode
/tmp/cchtznlO.s:329: Error: selected processor does not support `vsdot.s8 q11,q10,d6[0]' in ARM mode
/tmp/cchtznlO.s:335: Error: selected processor does not support `vsdot.s8 q8,q9,d4[1]' in ARM mode
/tmp/cchtznlO.s:336: Error: selected processor does not support `vsdot.s8 q7,q10,d2[1]' in ARM mode
/tmp/cchtznlO.s:339: Error: selected processor does not support `vsdot.s8 q5,q10,d3[1]' in ARM mode
/tmp/cchtznlO.s:340: Error: selected processor does not support `vsdot.s8 q0,q10,d4[1]' in ARM mode
/tmp/cchtznlO.s:341: Error: selected processor does not support `vsdot.s8 q14,q10,d5[1]' in ARM mode
/tmp/cchtznlO.s:344: Error: selected processor does not support `vsdot.s8 q8,q10,d6[1]' in ARM mode
/tmp/cchtznlO.s:347: Error: selected processor does not support `vsdot.s8 q12,q9,d6[1]' in ARM mode
/tmp/cchtznlO.s:348: Error: selected processor does not support `vsdot.s8 q6,q9,d2[1]' in ARM mode
/tmp/cchtznlO.s:349: Error: selected processor does not support `vsdot.s8 q4,q9,d3[1]' in ARM mode
/tmp/cchtznlO.s:352: Error: selected processor does not support `vsdot.s8 q8,q10,d7[1]' in ARM mode
/tmp/cchtznlO.s:353: Error: selected processor does not support `vsdot.s8 q13,q9,d5[1]' in ARM mode
/tmp/cchtznlO.s:356: Error: selected processor does not support `vsdot.s8 q15,q9,d7[1]' in ARM mode
/tmp/cchtznlO.s:367: Error: selected processor does not support `vsdot.s8 q10,q12,d2[1]' in ARM mode
/tmp/cchtznlO.s:368: Error: selected processor does not support `vsdot.s8 q11,q8,d6[1]' in ARM mode
/tmp/cchtznlO.s:372: Error: selected processor does not support `vsdot.s8 q10,q8,d2[1]' in ARM mode
/tmp/cchtznlO.s:377: Error: selected processor does not support `vsdot.s8 q10,q12,d3[1]' in ARM mode
/tmp/cchtznlO.s:382: Error: selected processor does not support `vsdot.s8 q10,q8,d3[1]' in ARM mode
/tmp/cchtznlO.s:387: Error: selected processor does not support `vsdot.s8 q10,q12,d4[1]' in ARM mode
/tmp/cchtznlO.s:392: Error: selected processor does not support `vsdot.s8 q10,q8,d4[1]' in ARM mode
/tmp/cchtznlO.s:397: Error: selected processor does not support `vsdot.s8 q9,q8,d7[1]' in ARM mode
/tmp/cchtznlO.s:404: Error: selected processor does not support `vsdot.s8 q10,q12,d5[1]' in ARM mode
/tmp/cchtznlO.s:409: Error: selected processor does not support `vsdot.s8 q10,q8,d5[1]' in ARM mode
/tmp/cchtznlO.s:414: Error: selected processor does not support `vsdot.s8 q10,q12,d6[1]' in ARM mode
/tmp/cchtznlO.s:419: Error: selected processor does not support `vsdot.s8 q10,q12,d7[1]' in ARM mode
/tmp/cchtznlO.s:1117: Error: selected processor does not support `vsdot.s8 q7,q9,d7[0]' in ARM mode
/tmp/cchtznlO.s:1118: Error: selected processor does not support `vsdot.s8 q6,q8,d7[0]' in ARM mode
/tmp/cchtznlO.s:1119: Error: selected processor does not support `vsdot.s8 q5,q9,d6[0]' in ARM mode
/tmp/cchtznlO.s:1120: Error: selected processor does not support `vsdot.s8 q4,q8,d6[0]' in ARM mode
/tmp/cchtznlO.s:1124: Error: selected processor does not support `vsdot.s8 q12,q8,d5[0]' in ARM mode
/tmp/cchtznlO.s:1126: Error: selected processor does not support `vsdot.s8 q0,q9,d5[0]' in ARM mode
/tmp/cchtznlO.s:1134: Error: selected processor does not support `vsdot.s8 q14,q9,d4[0]' in ARM mode
/tmp/cchtznlO.s:1136: Error: selected processor does not support `vsdot.s8 q13,q8,d4[0]' in ARM mode
/tmp/cchtznlO.s:1140: Error: selected processor does not support `vsdot.s8 q12,q9,d3[0]' in ARM mode
/tmp/cchtznlO.s:1147: Error: selected processor does not support `vsdot.s8 q12,q9,d2[0]' in ARM mode
/tmp/cchtznlO.s:1148: Error: selected processor does not support `vsdot.s8 q15,q8,d2[0]' in ARM mode
/tmp/cchtznlO.s:1151: Error: selected processor does not support `vsdot.s8 q9,q8,d3[0]' in ARM mode
/tmp/cchtznlO.s:1162: Error: selected processor does not support `vsdot.s8 q10,q9,d7[0]' in ARM mode
/tmp/cchtznlO.s:1166: Error: selected processor does not support `vsdot.s8 q10,q8,d7[0]' in ARM mode
/tmp/cchtznlO.s:1171: Error: selected processor does not support `vsdot.s8 q10,q9,d6[0]' in ARM mode
/tmp/cchtznlO.s:1176: Error: selected processor does not support `vsdot.s8 q10,q8,d6[0]' in ARM mode
/tmp/cchtznlO.s:1181: Error: selected processor does not support `vsdot.s8 q10,q9,d5[0]' in ARM mode
/tmp/cchtznlO.s:1186: Error: selected processor does not support `vsdot.s8 q10,q8,d5[0]' in ARM mode
/tmp/cchtznlO.s:1191: Error: selected processor does not support `vsdot.s8 q10,q9,d4[0]' in ARM mode
/tmp/cchtznlO.s:1196: Error: selected processor does not support `vsdot.s8 q10,q8,d4[0]' in ARM mode
/tmp/cchtznlO.s:1201: Error: selected processor does not support `vsdot.s8 q10,q9,d3[0]' in ARM mode
/tmp/cchtznlO.s:1206: Error: selected processor does not support `vsdot.s8 q10,q9,d2[0]' in ARM mode
/tmp/cchtznlO.s:1211: Error: selected processor does not support `vsdot.s8 q9,q8,d3[0]' in ARM mode
/tmp/cchtznlO.s:1216: Error: selected processor does not support `vsdot.s8 q9,q8,d2[0]' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:50017: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc4w-gemm/gen/qd8-f32-qc4w-gemm-6x16c4-minmax-neondot.c.o] Error 1
/tmp/ccJrNOda.s: Assembler messages:
/tmp/ccJrNOda.s:72: Error: selected processor does not support `vsdot.s8 q8,q13,d7[0]' in ARM mode
/tmp/ccJrNOda.s:74: Error: selected processor does not support `vsdot.s8 q11,q12,d7[0]' in ARM mode
/tmp/ccJrNOda.s:77: Error: selected processor does not support `vsdot.s8 q10,q12,d7[0]' in ARM mode
/tmp/ccJrNOda.s:80: Error: selected processor does not support `vsdot.s8 q9,q12,d7[0]' in ARM mode
/tmp/ccJrNOda.s:83: Error: selected processor does not support `vsdot.s8 q8,q12,d7[1]' in ARM mode
/tmp/ccJrNOda.s:86: Error: selected processor does not support `vsdot.s8 q11,q12,d7[1]' in ARM mode
/tmp/ccJrNOda.s:89: Error: selected processor does not support `vsdot.s8 q10,q12,d7[1]' in ARM mode
/tmp/ccJrNOda.s:93: Error: selected processor does not support `vsdot.s8 q9,q12,d7[1]' in ARM mode
/tmp/ccJrNOda.s:171: Error: selected processor does not support `vsdot.s8 q8,q13,d7[0]' in ARM mode
/tmp/ccJrNOda.s:173: Error: selected processor does not support `vsdot.s8 q11,q12,d7[0]' in ARM mode
/tmp/ccJrNOda.s:176: Error: selected processor does not support `vsdot.s8 q10,q12,d7[0]' in ARM mode
/tmp/ccJrNOda.s:180: Error: selected processor does not support `vsdot.s8 q9,q12,d7[0]' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:50059: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-1x16c4-minmax-neondot.c.o] Error 1
/tmp/cceW7UTH.s: Assembler messages:
/tmp/cceW7UTH.s:78: Error: selected processor does not support `vsdot.s8 q10,q11,d6[0]' in ARM mode
/tmp/cceW7UTH.s:80: Error: selected processor does not support `vsdot.s8 q13,q12,d6[0]' in ARM mode
/tmp/cceW7UTH.s:84: Error: selected processor does not support `vsdot.s8 q9,q11,d7[0]' in ARM mode
/tmp/cceW7UTH.s:85: Error: selected processor does not support `vsdot.s8 q8,q12,d7[0]' in ARM mode
/tmp/cceW7UTH.s:87: Error: selected processor does not support `vsdot.s8 q13,q11,d6[1]' in ARM mode
/tmp/cceW7UTH.s:89: Error: selected processor does not support `vsdot.s8 q8,q11,d7[1]' in ARM mode
/tmp/cceW7UTH.s:92: Error: selected processor does not support `vsdot.s8 q10,q11,d6[1]' in ARM mode
/tmp/cceW7UTH.s:93: Error: selected processor does not support `vsdot.s8 q9,q11,d7[1]' in ARM mode
/tmp/cceW7UTH.s:168: Error: selected processor does not support `vsdot.s8 q13,q12,d6[0]' in ARM mode
/tmp/cceW7UTH.s:169: Error: selected processor does not support `vsdot.s8 q8,q12,d7[0]' in ARM mode
/tmp/cceW7UTH.s:171: Error: selected processor does not support `vsdot.s8 q10,q11,d6[0]' in ARM mode
/tmp/cceW7UTH.s:172: Error: selected processor does not support `vsdot.s8 q9,q11,d7[0]' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:50087: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-2x8c4-minmax-neondot.c.o] Error 1
make[2]: Leaving directory '/mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk'
make[1]: *** [CMakeFiles/Makefile2:6654: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/all] Error 2
make[1]: Leaving directory '/mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk'
make: *** [Makefile:139: all] Error 2
guanghui.wan@rd01:/mnt/fileroot/guanghui.wan/tensorflow/tensorflow$
```


### Relevant log output

```shell
[ 79%] Building C object _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-2x8c4-minmax-neondot.c.o
cd /mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk/_deps/xnnpack-build && /mnt/fileroot/guanghui.wan/nanoQ/Algorithm/tools/gcc-arm-10.3-2021.07-x86_64-arm-none-linux-gnueabihf/bin/arm-none-linux-gnueabihf-gcc -DEIGEN_MPL2_ONLY -DFXDIV_USE_INLINE_ASSEMBLY=0 -DNOMINMAX=1 -DPTHREADPOOL_NO_DEPRECATED_API=1 -DXNN_ENABLE_ARM_BF16=0 -DXNN_ENABLE_ARM_DOTPROD=1 -DXNN_ENABLE_ARM_FP16_SCALAR=1 -DXNN_ENABLE_ARM_FP16_VECTOR=1 -DXNN_ENABLE_ARM_I8MM=0 -DXNN_ENABLE_ASSEMBLY=1 -DXNN_ENABLE_CPUINFO=1 -DXNN_ENABLE_DWCONV_MULTIPASS=0 -DXNN_ENABLE_GEMM_M_SPECIALIZATION=1 -DXNN_ENABLE_JIT=0 -DXNN_ENABLE_MEMOPT=1 -DXNN_ENABLE_RISCV_VECTOR=1 -DXNN_ENABLE_SPARSE=1 -I/mnt/fileroot/guanghui.wan/tensorflow/tensorflow/third_party/xla/third_party/tsl -I/mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk/xnnpack/src -I/mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk/pthreadpool-source/include -I/mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk/FXdiv-source/include -I/mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk/FP16-source/include -march=armv8-a -mfpu=neon-vfpv4 -funsafe-math-optimizations -mfp16-format=ieee -O3 -DNDEBUG -std=c99 -fPIC -Wno-psabi -O2 -pthread  -fno-math-errno  -marm  -march=armv8.2-a+dotprod -mfpu=neon-fp-armv8  -MD -MT _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-2x8c4-minmax-neondot.c.o -MF CMakeFiles/microkernels-all.dir/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-2x8c4-minmax-neondot.c.o.d -o CMakeFiles/microkernels-all.dir/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-2x8c4-minmax-neondot.c.o -c /mnt/fileroot/guanghui.wan/tensorflow/tensorflow/build_sdk/xnnpack/src/qd8-f32-qc8w-gemm/gen/qd8-f32-qc8w-gemm-2x8c4-minmax-neondot.c
/tmp/ccrZ5z20.s: Assembler messages:
/tmp/ccrZ5z20.s:75: Error: selected processor does not support `vsdot.s8 q14,q12,d7[0]' in ARM mode
/tmp/ccrZ5z20.s:76: Error: selected processor does not support `vsdot.s8 q10,q9,d7[0]' in ARM mode
/tmp/ccrZ5z20.s:77: Error: selected processor does not support `vsdot.s8 q14,q11,d7[1]' in ARM mode
/tmp/ccrZ5z20.s:78: Error: selected processor does not support `vsdot.s8 q10,q8,d7[1]' in ARM mode
/tmp/ccrZ5z20.s:134: Error: selected processor does not support `vsdot.s8 q14,q9,d7[0]' in ARM mode
/tmp/ccrZ5z20.s:135: Error: selected processor does not support `vsdot.s8 q10,q8,d7[0]' in ARM mode
make[2]: *** [_deps/xnnpack-build/CMakeFiles/microkernels-all.dir/build.make:49877: _deps/xnnpack-build/CMakeFiles/microkernels-all.dir/src/qd8-f32-qc4w-gemm/gen/qd8-f32-qc4w-gemm-1x8c4-minmax-neondot.c.o] Error 1
```
",False
Incorrect calculation of cropping indices stat:awaiting response stale,"https://github.com/tensorflow/tensorflow/blob/b2a7a25d102fec8fc7e3690218b627738d8a6fc2/tensorflow/compiler/mlir/tosa/transforms/legalize_common.cc#L1234

Should be:

```
int crops_lo = crops_const[i * 2 + 0];
int crops_hi = crops_const[i * 2 + 1];
```

The tests happen to cover only the case in which `crops_dims` is 2, so the bug is hidden.",False
Build broken for AARCH64 by XLA PJRT type:build/install comp:xla subtype: ubuntu/linux,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

git HEAD

### Custom code

No

### OS platform and distribution

Ubuntu 20.04

### Mobile device

n/a

### Python version

3.9.17

### Bazel version

6.1.0

### GCC/compiler version

17.0.0

### CUDA/cuDNN version

n/a

### GPU model and memory

n/a

### Current behavior?

Build fails on AARCH64 since https://github.com/tensorflow/tensorflow/commit/7b81b8c94a3fcf067ce50c31ce031a9ea449a59b

### Standalone code to reproduce the issue

```shell
bazel build --config=mkl_aarch64_threadpool --copt=-flax-vector-conversions --define=tf_api_version=2 --verbose_failures --jobs=75 -- //tensorflow/tools/pip_package:build_pip_package
```


### Relevant log output

```shell
ERROR: /home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/external/local_xla/xla/pjrt/BUILD:754:11: Compiling xla/pjrt/transpose.cc failed: (Exit 1): clang failed: error executing command (from target @local_xla//xla/pjrt:transpose) 
  (cd /home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazel/_bazel_andrew/eab0d61a99b6696edb3d2aff87b585e8/execroot/org_tensorflow && \
  exec env - \
    CACHEBUSTER=20220325 \
    CLANG_COMPILER_PATH=/usr/lib/llvm-17/bin/clang \
    PATH=/home/andrew/src/tf_test/tensorflow-git/bazel-ci_build-cache/.cache/bazelisk/downloads/bazelbuild/bazel-6.1.0-linux-arm64/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin \
    PWD=/proc/self/cwd \
    PYTHON_BIN_PATH=/usr/bin/python3.10 \
    PYTHON_LIB_PATH=/usr/lib/python3/dist-packages \
    TF2_BEHAVIOR=1 \
  /usr/lib/llvm-17/bin/clang -MD -MF bazel-out/aarch64-opt/bin/external/local_xla/xla/pjrt/_objs/transpose/transpose.pic.d '-frandom-seed=bazel-out/aarch64-opt/bin/external/local_xla/xla/pjrt/_objs/transpose/transpose.pic.o' -DEIGEN_MPL2_ONLY '-DEIGEN_MAX_ALIGN_BYTES=64' -DHAVE_SYS_UIO_H -DTF_USE_SNAPPY '-DBAZEL_CURRENT_REPOSITORY=""local_xla""' -iquote external/local_xla -iquote bazel-out/aarch64-opt/bin/external/local_xla -iquote external/com_google_absl -iquote bazel-out/aarch64-opt/bin/external/com_google_absl -iquote external/local_tsl -iquote bazel-out/aarch64-opt/bin/external/local_tsl -iquote . -iquote bazel-out/aarch64-opt/bin -iquote external/eigen_archive -iquote bazel-out/aarch64-opt/bin/external/eigen_archive -iquote external/ml_dtypes -iquote bazel-out/aarch64-opt/bin/external/ml_dtypes -iquote external/nsync -iquote bazel-out/aarch64-opt/bin/external/nsync -iquote external/double_conversion -iquote bazel-out/aarch64-opt/bin/external/double_conversion -iquote external/com_google_protobuf -iquote bazel-out/aarch64-opt/bin/external/com_google_protobuf -iquote external/snappy -iquote bazel-out/aarch64-opt/bin/external/snappy -iquote external/com_googlesource_code_re2 -iquote bazel-out/aarch64-opt/bin/external/com_googlesource_code_re2 -Ibazel-out/aarch64-opt/bin/external/ml_dtypes/_virtual_includes/float8 -Ibazel-out/aarch64-opt/bin/external/ml_dtypes/_virtual_includes/int4 -isystem third_party/eigen3/mkl_include -isystem bazel-out/aarch64-opt/bin/third_party/eigen3/mkl_include -isystem external/eigen_archive -isystem bazel-out/aarch64-opt/bin/external/eigen_archive -isystem external/ml_dtypes -isystem bazel-out/aarch64-opt/bin/external/ml_dtypes -isystem external/ml_dtypes/ml_dtypes -isystem bazel-out/aarch64-opt/bin/external/ml_dtypes/ml_dtypes -isystem external/nsync/public -isystem bazel-out/aarch64-opt/bin/external/nsync/public -isystem external/com_google_protobuf/src -isystem bazel-out/aarch64-opt/bin/external/com_google_protobuf/src -fmerge-all-constants -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -fPIC -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -Wno-invalid-partial-specialization -fno-omit-frame-pointer -no-canonical-prefixes -DNDEBUG -g0 -O2 -ffunction-sections -fdata-sections -Wno-all -Wno-extra -Wno-deprecated -Wno-deprecated-declarations -Wno-ignored-attributes -Wno-array-bounds -Wunused-result '-Werror=unused-result' -Wswitch '-Werror=switch' '-Wno-error=unused-but-set-variable' -DAUTOLOAD_DYNAMIC_KERNELS -Wno-gnu-offsetof-extensions '-mtune=generic' '-march=armv8-a' -O3 -flax-vector-conversions '-std=c++17' '--sysroot=/dt10' -c external/local_xla/xla/pjrt/transpose.cc -o bazel-out/aarch64-opt/bin/external/local_xla/xla/pjrt/_objs/transpose/transpose.pic.o)
# Configuration: 05cc03ffdfad7b565350ad2b01d7497c783d20d25ca4abeda724de457d2afb5e
# Execution platform: @local_execution_config_platform//:platform
In file included from external/local_xla/xla/pjrt/transpose.cc:94:
external/local_xla/xla/pjrt/transpose_kernels.h:710:46: error: use of undeclared identifier '__m128i'
  710 |       if constexpr (sizeof(T) * bs <= sizeof(__m128i)) {
      |                                              ^
external/local_xla/xla/pjrt/transpose_kernels.h:576:19: error: static assertion failed due to requirement 'kBytesInMatrix <= sizeof(__attribute__((neon_vector_type(2))) unsigned long) * last_transpose.size()'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<unsigned short, 16>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<unsigned short, 16>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<unsigned short, 16, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:459:9: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<unsigned short, xla::TransposePlan::Transformation::kNone>' requested here
  459 |         ExecuteTyped<uint16_t, Transformation::kNone>(ac, bc, nodes);
      |         ^
external/local_xla/xla/pjrt/transpose_kernels.h:576:34: note: expression evaluates to '512 <= 256'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:471:17: error: static assertion failed due to requirement '32UL * (0 + 1) <= sizeof(__attribute__((neon_vector_type(2))) unsigned long)'
  471 |   static_assert(bytes * (lane + 1) <= sizeof(uint64x2_t));
      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:551:4: note: in instantiation of function template specialization 'xla::StoreElementFromVec128<32UL, 0>' requested here
  551 |   (StoreElementFromVec128</*bytes=*/bytes, lane>(b + ldb * (i + lane), x), ...);
      |    ^
external/local_xla/xla/pjrt/transpose_kernels.h:594:7: note: in instantiation of function template specialization 'xla::StoreElementsFromVec128<32UL, 0UL>' requested here
  594 |       StoreElementsFromVec128<element_size * bs>(
      |       ^
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<unsigned short, 16>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<unsigned short, 16>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<unsigned short, 16, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:459:9: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<unsigned short, xla::TransposePlan::Transformation::kNone>' requested here
  459 |         ExecuteTyped<uint16_t, Transformation::kNone>(ac, bc, nodes);
      |         ^
external/local_xla/xla/pjrt/transpose_kernels.h:471:36: note: expression evaluates to '32 <= 16'
  471 |   static_assert(bytes * (lane + 1) <= sizeof(uint64x2_t));
      |                 ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:498:21: error: static assertion failed due to requirement '32UL == 0'
  498 |       static_assert(bytes == 0);
      |                     ^~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:576:19: error: static assertion failed due to requirement 'kBytesInMatrix <= sizeof(__attribute__((neon_vector_type(2))) unsigned long) * last_transpose.size()'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<unsigned int, 8>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<unsigned int, 8>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<unsigned int, 8, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:463:11: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<unsigned int, xla::TransposePlan::Transformation::kNone>' requested here
  463 |           ExecuteTyped<uint32_t, Transformation::kNone>(ac, bc, nodes);
      |           ^
external/local_xla/xla/pjrt/transpose_kernels.h:576:34: note: expression evaluates to '256 <= 128'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:576:19: error: static assertion failed due to requirement 'kBytesInMatrix <= sizeof(__attribute__((neon_vector_type(2))) unsigned long) * last_transpose.size()'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<unsigned int, 16>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<unsigned int, 16>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<unsigned int, 16, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:463:11: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<unsigned int, xla::TransposePlan::Transformation::kNone>' requested here
  463 |           ExecuteTyped<uint32_t, Transformation::kNone>(ac, bc, nodes);
      |           ^
external/local_xla/xla/pjrt/transpose_kernels.h:576:34: note: expression evaluates to '1024 <= 256'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:471:17: error: static assertion failed due to requirement '64UL * (0 + 1) <= sizeof(__attribute__((neon_vector_type(2))) unsigned long)'
  471 |   static_assert(bytes * (lane + 1) <= sizeof(uint64x2_t));
      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:551:4: note: in instantiation of function template specialization 'xla::StoreElementFromVec128<64UL, 0>' requested here
  551 |   (StoreElementFromVec128</*bytes=*/bytes, lane>(b + ldb * (i + lane), x), ...);
      |    ^
external/local_xla/xla/pjrt/transpose_kernels.h:594:7: note: in instantiation of function template specialization 'xla::StoreElementsFromVec128<64UL, 0UL>' requested here
  594 |       StoreElementsFromVec128<element_size * bs>(
      |       ^
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<unsigned int, 16>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<unsigned int, 16>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<unsigned int, 16, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:463:11: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<unsigned int, xla::TransposePlan::Transformation::kNone>' requested here
  463 |           ExecuteTyped<uint32_t, Transformation::kNone>(ac, bc, nodes);
      |           ^
external/local_xla/xla/pjrt/transpose_kernels.h:471:36: note: expression evaluates to '64 <= 16'
  471 |   static_assert(bytes * (lane + 1) <= sizeof(uint64x2_t));
      |                 ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:498:21: error: static assertion failed due to requirement '64UL == 0'
  498 |       static_assert(bytes == 0);
      |                     ^~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:576:19: error: static assertion failed due to requirement 'kBytesInMatrix <= sizeof(__attribute__((neon_vector_type(2))) unsigned long) * last_transpose.size()'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<unsigned long, 4>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<unsigned long, 4>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<unsigned long, 4, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:470:9: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<unsigned long, xla::TransposePlan::Transformation::kNone>' requested here
  470 |         ExecuteTyped<uint64_t, Transformation::kNone>(ac, bc, nodes);
      |         ^
external/local_xla/xla/pjrt/transpose_kernels.h:576:34: note: expression evaluates to '128 <= 64'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:576:19: error: static assertion failed due to requirement 'kBytesInMatrix <= sizeof(__attribute__((neon_vector_type(2))) unsigned long) * last_transpose.size()'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<unsigned long, 8>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<unsigned long, 8>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<unsigned long, 8, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:470:9: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<unsigned long, xla::TransposePlan::Transformation::kNone>' requested here
  470 |         ExecuteTyped<uint64_t, Transformation::kNone>(ac, bc, nodes);
      |         ^
external/local_xla/xla/pjrt/transpose_kernels.h:576:34: note: expression evaluates to '512 <= 128'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:576:19: error: static assertion failed due to requirement 'kBytesInMatrix <= sizeof(__attribute__((neon_vector_type(2))) unsigned long) * last_transpose.size()'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<unsigned long, 16>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<unsigned long, 16>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<unsigned long, 16, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:470:9: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<unsigned long, xla::TransposePlan::Transformation::kNone>' requested here
  470 |         ExecuteTyped<uint64_t, Transformation::kNone>(ac, bc, nodes);
      |         ^
external/local_xla/xla/pjrt/transpose_kernels.h:576:34: note: expression evaluates to '2048 <= 256'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:471:17: error: static assertion failed due to requirement '128UL * (0 + 1) <= sizeof(__attribute__((neon_vector_type(2))) unsigned long)'
  471 |   static_assert(bytes * (lane + 1) <= sizeof(uint64x2_t));
      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:551:4: note: in instantiation of function template specialization 'xla::StoreElementFromVec128<128UL, 0>' requested here
  551 |   (StoreElementFromVec128</*bytes=*/bytes, lane>(b + ldb * (i + lane), x), ...);
      |    ^
external/local_xla/xla/pjrt/transpose_kernels.h:594:7: note: in instantiation of function template specialization 'xla::StoreElementsFromVec128<128UL, 0UL>' requested here
  594 |       StoreElementsFromVec128<element_size * bs>(
      |       ^
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<unsigned long, 16>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<unsigned long, 16>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<unsigned long, 16, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:470:9: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<unsigned long, xla::TransposePlan::Transformation::kNone>' requested here
  470 |         ExecuteTyped<uint64_t, Transformation::kNone>(ac, bc, nodes);
      |         ^
external/local_xla/xla/pjrt/transpose_kernels.h:471:36: note: expression evaluates to '128 <= 16'
  471 |   static_assert(bytes * (lane + 1) <= sizeof(uint64x2_t));
      |                 ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:498:21: error: static assertion failed due to requirement '128UL == 0'
  498 |       static_assert(bytes == 0);
      |                     ^~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:576:19: error: static assertion failed due to requirement 'kBytesInMatrix <= sizeof(__attribute__((neon_vector_type(2))) unsigned long) * last_transpose.size()'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<xla::uint128, 2>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<xla::uint128, 2>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<xla::uint128, 2, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:473:9: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<xla::uint128, xla::TransposePlan::Transformation::kNone>' requested here
  473 |         ExecuteTyped<uint128, Transformation::kNone>(ac, bc, nodes);
      |         ^
external/local_xla/xla/pjrt/transpose_kernels.h:576:34: note: expression evaluates to '64 <= 32'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:576:19: error: static assertion failed due to requirement 'kBytesInMatrix <= sizeof(__attribute__((neon_vector_type(2))) unsigned long) * last_transpose.size()'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<xla::uint128, 4>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<xla::uint128, 4>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<xla::uint128, 4, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:473:9: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<xla::uint128, xla::TransposePlan::Transformation::kNone>' requested here
  473 |         ExecuteTyped<uint128, Transformation::kNone>(ac, bc, nodes);
      |         ^
external/local_xla/xla/pjrt/transpose_kernels.h:576:34: note: expression evaluates to '256 <= 64'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:576:19: error: static assertion failed due to requirement 'kBytesInMatrix <= sizeof(__attribute__((neon_vector_type(2))) unsigned long) * last_transpose.size()'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<xla::uint128, 8>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<xla::uint128, 8>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<xla::uint128, 8, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:473:9: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<xla::uint128, xla::TransposePlan::Transformation::kNone>' requested here
  473 |         ExecuteTyped<uint128, Transformation::kNone>(ac, bc, nodes);
      |         ^
external/local_xla/xla/pjrt/transpose_kernels.h:576:34: note: expression evaluates to '1024 <= 128'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:576:19: error: static assertion failed due to requirement 'kBytesInMatrix <= sizeof(__attribute__((neon_vector_type(2))) unsigned long) * last_transpose.size()'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<xla::uint128, 16>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<xla::uint128, 16>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<xla::uint128, 16, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:473:9: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<xla::uint128, xla::TransposePlan::Transformation::kNone>' requested here
  473 |         ExecuteTyped<uint128, Transformation::kNone>(ac, bc, nodes);
      |         ^
external/local_xla/xla/pjrt/transpose_kernels.h:576:34: note: expression evaluates to '4096 <= 256'
  576 |     static_assert(kBytesInMatrix <= sizeof(Vec128) * last_transpose.size());
      |                   ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:471:17: error: static assertion failed due to requirement '256UL * (0 + 1) <= sizeof(__attribute__((neon_vector_type(2))) unsigned long)'
  471 |   static_assert(bytes * (lane + 1) <= sizeof(uint64x2_t));
      |                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:551:4: note: in instantiation of function template specialization 'xla::StoreElementFromVec128<256UL, 0>' requested here
  551 |   (StoreElementFromVec128</*bytes=*/bytes, lane>(b + ldb * (i + lane), x), ...);
      |    ^
external/local_xla/xla/pjrt/transpose_kernels.h:594:7: note: in instantiation of function template specialization 'xla::StoreElementsFromVec128<256UL, 0UL>' requested here
  594 |       StoreElementsFromVec128<element_size * bs>(
      |       ^
external/local_xla/xla/pjrt/transpose_kernels.h:711:66: note: in instantiation of member function 'xla::Vec128RectangularTransposeMicroKernelImpl<xla::uint128, 16>::Apply' requested here
  711 |         return Vec128RectangularTransposeMicroKernelImpl<T, bs>::Apply(a, lda,
      |                                                                  ^
external/local_xla/xla/pjrt/transpose.cc:170:42: note: in instantiation of member function 'xla::TransposeMicroKernel<xla::uint128, 16>::Apply' requested here
  170 |       TransposeMicroKernel<T, inner_bs>::Apply(
      |                                          ^
external/local_xla/xla/pjrt/transpose.cc:410:9: note: in instantiation of function template specialization 'xla::MacroKernel<xla::uint128, 16, xla::TransposePlan::Transformation::kNone>' requested here
  410 |         MacroKernel<T, const_inner_block_elems, transformation>(
      |         ^
external/local_xla/xla/pjrt/transpose.cc:473:9: note: in instantiation of function template specialization 'xla::TransposePlan::ExecuteTyped<xla::uint128, xla::TransposePlan::Transformation::kNone>' requested here
  473 |         ExecuteTyped<uint128, Transformation::kNone>(ac, bc, nodes);
      |         ^
external/local_xla/xla/pjrt/transpose_kernels.h:471:36: note: expression evaluates to '256 <= 16'
  471 |   static_assert(bytes * (lane + 1) <= sizeof(uint64x2_t));
      |                 ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
external/local_xla/xla/pjrt/transpose_kernels.h:498:21: error: static assertion failed due to requirement '256UL == 0'
  498 |       static_assert(bytes == 0);
      |                     ^~~~~~~~~~
19 errors generated.
Target //tensorflow/tools/pip_package:build_pip_package failed to build
```
",False
static_assert failure with gcc type:build/install subtype:bazel,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

git HEAD

### Custom code

No

### OS platform and distribution

Ubuntu 20.04

### Mobile device

n/a

### Python version

3.9.17

### Bazel version

6.1.0

### GCC/compiler version

10.2.1

### CUDA/cuDNN version

n/a

### GPU model and memory

n/a

### Current behavior?

Build failure

### Standalone code to reproduce the issue

```shell
bazel build --config=mkl_aarch64_threadpool --copt=-flax-vector-conversions --define=tf_api_version=2 --verbose_failures --jobs=75 -- //tensorflow/tools/pip_package:build_pip_package
```


### Relevant log output

```shell
tensorflow/compiler/mlir/lite/stablehlo/transforms/legalize_hlo.cc: In member function 'mlir::LogicalResult mlir::odml::{anonymous}::ConvertReduceOpToTfArgMinMax<TfReduce, TfArgReduce>::matchAndRewrite(mlir::mhlo::ReduceOp, mlir::OpConversionPattern<mlir::mhlo::ReduceOp>::OpAdaptor, mlir::ConversionPatternRewriter&) const':
tensorflow/compiler/mlir/lite/stablehlo/transforms/legalize_hlo.cc:2186: error: static assertion failed: Only TF::MaxOp and TF::MinOp are supported.
 2186 |         static_assert(false, ""Only TF::MaxOp and TF::MinOp are supported."");
      | 
Target //tensorflow/tools/pip_package:build_pip_package failed to build
INFO: Elapsed time: 502.712s, Critical Path: 197.25s
INFO: 1603 processes: 79 internal, 1524 local.
FAILED: Build did NOT complete successfully
```
",False
Different results interpreter python and Android stat:awaiting response type:support stale TFLiteConverter TF 2.13,"- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): MacOS
- TensorFlow installation (pip package or built from source): pip
- TensorFlow library (version, if pip package or github SHA, if built from source): 2.13


I get different results when running my model with the TF Lite interpreter in Python and on Android. I do the same normalization in both of those.


The Python code:

```
def read_image(file_path):
    mean = 255*np.array([0.485, 0.456, 0.406])
    std = 255*np.array([0.229, 0.224, 0.225])
    img = Image.open(file_path).convert('RGB') 
    img = img.resize((224,224), resample=PIL.Image.BILINEAR) 
    img = np.array(img)
    img = (img - mean[None, None, :]) / std[None, None, :]
    img = np.float32(img)
    return img

img = read_image_normal(path)

interpreter = tf.lite.Interpreter(model_path=""./model.tflite"") 
interpreter.allocate_tensors()
input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()

interpreter.set_tensor(input_details[0]['index'], processed_image)
interpreter.invoke()
predictions = interpreter.get_tensor(output_details[0]['index'])
```

Snippets of the relevant Android code:
For preprocessing:

```
  private fun preprocessImage(image1: Bitmap) = with(TensorImage(DataType.FLOAT32)) {
      load(image1)
      val imageProcessor: ImageProcessor = ImageProcessor.Builder()
              .add(
              ResizeOp(
                  224,
                  224,
                  ResizeOp.ResizeMethod.BILINEAR
              )
          )
          .add(
              NormalizeOp(
                  floatArrayOf(
                          0.485f*255f,
                          0.456f*255f,
                          0.406f*255f,
                  ),
                  floatArrayOf(
                          0.229f*255f,
                          0.224f*255f,
                          0.225f*255f,
                  ),
              )
          )

          .build()
      imageProcessor.process(this)
  }
```

For inference:

  ```
        val options = Interpreter.Options()
        options.setNumThreads(1)
        interpreter = Interpreter(model, options)
        val timeStart = System.currentTimeMillis()
        val image = preprocessImage(bitmap)
        val probabilityBuffer = TensorBuffer.createFixedSize(intArrayOf(1, 1), DataType.FLOAT32)
        interpreter.run(image.buffer, probabilityBuffer.buffer)
        val score = probabilityBuffer.floatArray[0]
```


Both results are different by quite a lot - around 0.1 score. The images that enter are exactly the same.

Model: https://drive.google.com/file/d/1Pr3mCZ7kocEPw_tAQuokrZBpqqXC0gek/view?usp=sharing
",False
Tensorflow Importation Error type:build/install,"Good day! 
I have a project and i need TensorFlow module (this is the first time using the library)
I have installed the library and try to force-download different lower versions and they got installed successfully but to import now is the issue
Below is the error message it keep bringing up:

ImportError                               Traceback (most recent call last)
~\anaconda3\Anaconda3\lib\site-packages\tensorflow\python\pywrap_tensorflow.py in <module>
     61   try:
---> 62     from tensorflow.python._pywrap_tensorflow_internal import *
     63   # This try catch logic is because there is no bazel equivalent for py_extension.

ImportError: DLL load failed: The specified module could not be found.

During handling of the above exception, another exception occurred:

ImportError                               Traceback (most recent call last)
<ipython-input-1-64156d691fe5> in <module>
----> 1 import tensorflow as tf

~\anaconda3\Anaconda3\lib\site-packages\tensorflow\__init__.py in <module>
     35 import typing as _typing
     36 
---> 37 from tensorflow.python.tools import module_util as _module_util
     38 from tensorflow.python.util.lazy_loader import LazyLoader as _LazyLoader
     39 

~\anaconda3\Anaconda3\lib\site-packages\tensorflow\python\__init__.py in <module>
     34 # pylint: disable=wildcard-import,g-bad-import-order,g-import-not-at-top
     35 
---> 36 from tensorflow.python import pywrap_tensorflow as _pywrap_tensorflow
     37 from tensorflow.python.eager import context
     38 

~\anaconda3\Anaconda3\lib\site-packages\tensorflow\python\pywrap_tensorflow.py in <module>
     76 except ImportError:
     77   raise ImportError(
---> 78       f'{traceback.format_exc()}'
     79       f'\n\nFailed to load the native TensorFlow runtime.\n'
     80       f'See https://www.tensorflow.org/install/errors '

ImportError: Traceback (most recent call last):
  File ""C:\Users\DAMMYICAN\anaconda3\Anaconda3\lib\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 62, in <module>
    from tensorflow.python._pywrap_tensorflow_internal import *
ImportError: DLL load failed: The specified module could not be found.

I would be glad if you could be of help
Thanks in advance.
",False
Tensorflow Im type:support,"Please go to Stack Overflow for help and support:

https://stackoverflow.com/questions/tagged/tensorflow

If you open a GitHub issue, here is our policy:

1.  It must be a bug, a feature request, or a significant problem with the
    documentation (for small docs fixes please send a PR instead).
2.  The form below must be filled out.
3.  It shouldn't be a TensorBoard issue. Those go
    [here](https://github.com/tensorflow/tensorboard/issues).

**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.

------------------------

### System information

-   **Have I written custom code (as opposed to using a stock example script
    provided in TensorFlow)**:
-   **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:
-   **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue
    happens on a mobile device**:
-   **TensorFlow installed from (source or binary)**:
-   **TensorFlow version (use command below)**:
-   **Python version**:
-   **Bazel version (if compiling from source)**:
-   **GCC/Compiler version (if compiling from source)**:
-   **CUDA/cuDNN version**:
-   **GPU model and memory**:
-   **Exact command to reproduce**:

You can collect some of this information using our environment capture script:

https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh

You can obtain the TensorFlow version with:

```bash
python -c ""import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)""
```

### Describe the problem
Describe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.

### Source code / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.
",False
How to use Tensorflow or TFLite for Renesas Boards. There are almost no tutorials on official tf website also. stat:awaiting response type:support stale comp:lite,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.14

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 20.04

### Mobile device

Renesas Board

### Python version

3.8

### Bazel version

6.1.0

### GCC/compiler version

9

### CUDA/cuDNN version

11.8/8.6

### GPU model and memory

AXM-8-256

### Current behavior?

I want to run a resnet50 model on Renesas v4h board using tensorflow or tflite. Does tflite/tensorflow support Renesas v-series boards . If so , then do we need to cross-compile tflite for renesas board  and how to run the model on board?

### Standalone code to reproduce the issue

```shell
How to run tensorflow/tflite models on renesas v-series boards?
```


### Relevant log output

_No response_",False
Command `pip install tensorflow[and-cuda]` need quotation mark stat:awaiting response type:support stale,"Running this `pip install tensorflow[and-cuda]` command would be wrong as failed to install, but running `pip install ""tensorflow[and-cuda]""` is okay. It just required the quotation mark. Please fix the documentation. ",False
Questions about the interpreter’s operational flow for quantized neural networks type:support comp:lite TF 2.13,"### Issue type

Others

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13.0

### Custom code

No

### OS platform and distribution

Linux Ubuntu 18.04

### Mobile device

_No response_

### Python version

3.8

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Hi. TensorFlow
This is not a post related to issues or bugs, but a post related to questions.

I am curious about how the interpreter operates when a quantized neural network is given to it.
I looked for documentation related to this, but couldn't find it.

Let me give you an example of what I am looking for in a document.
Let's say that the data type of the convolution's input activation is float32, and the data type of the weight is int8.

At this time, the interpreter
operates after dequantizing the weight of the convolution. 
OR,
operates after converting the activation of Convolution to int8.

I'm looking for an explanation like this.

Is there a link with an explanation like this?

### Standalone code to reproduce the issue

```shell
Not required.
```


### Relevant log output

```shell
Not required.
```
",False
"After compilation, only 'libtensorflow_cc.so' was generated, and 'liblibtensorflow_cc.so.ifso' is missing stat:awaiting response type:build/install stale subtype:windows 2.6.0","### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.6.0

### Custom code

Yes

### OS platform and distribution

Windows

### Mobile device

_No response_

### Python version

3.7.16

### Bazel version

3.7.2

### GCC/compiler version

2019

### CUDA/cuDNN version

11.2/8.1

### GPU model and memory

3090

### Current behavior?


""libtensorflow_cc.so""和""liblibtensorflow_cc.so.ifso"" were both generated.

### Standalone code to reproduce the issue

```shell
only 'libtensorflow_cc.so' was generated, and 'liblibtensorflow_cc.so.ifso' is missing
```


### Relevant log output

_No response_",False
[Q] ConvertPrimitiveTypeToMLIRType and mlir::IntegerType::Signless stat:awaiting response comp:xla,"I have a question about the code block below https://github.com/tensorflow/tensorflow/blob/master/third_party/xla/xla/translate/hlo_to_mhlo/hlo_utils.cc#L286-L288
hlo_utils.cc - ConvertPrimitiveTypeToMLIRType
```
    default:
      if (primitive_util::IsIntegralType(element_type)) {
        return mlir::IntegerType::get(
            builder.getContext(),
            /*width=*/primitive_util::BitWidth(element_type),
            /*signed=*/
            primitive_util::IsUnsignedIntegralType(element_type)
                ? mlir::IntegerType::Unsigned
                : mlir::IntegerType::Signless);
      }
```
Should we return `mlir::IntegerType::Signed` instead of `mlir::IntegerType::Signless` ?
",False
编译后缺少liblibtensorflow_cc.so.ifso文件 只有libtensorflow_cc.so type:build/install invalid,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.6.0

### Custom code

Yes

### OS platform and distribution

Windows

### Mobile device

_No response_

### Python version

3.7.16

### Bazel version

3.7.2

### GCC/compiler version

2019

### CUDA/cuDNN version

11.2/8.1

### GPU model and memory

3090

### Current behavior?

1

### Standalone code to reproduce the issue

```shell
INFO: Analyzed target //tensorflow:libtensorflow_cc.so (227 packages loaded, 22492 targets configured).
INFO: Found 1 target...
Target //tensorflow:libtensorflow_cc.so up-to-date:
  bazel-bin/tensorflow/libtensorflow_cc.so
INFO: Elapsed time: 5307.398s, Critical Path: 942.31s
INFO: 14402 processes: 3952 internal, 10450 local.
INFO: Build completed successfully, 14402 total actions
```


### Relevant log output

_No response_",False
Problemas com instalacao do tensorflow no docker stat:awaiting response type:build/install stale subtype: ubuntu/linux,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

Atual

### Custom code

Yes

### OS platform and distribution

Torizon-Linux arm64

### Mobile device

Linux arm64

### Python version

3.10.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Estou tentando construir um docker, mas somente a lib do tensorflow não funciona. Coisa que não acontecia antes, há pouco tempo atrás, eu não tinha nenhum problema. Já tentei diversas coisas como especificar versão do tensorflow, e do tensorflow-cpu-aws no requirements, atualizo o setuptools, construo a wheel, construo o build.

### Standalone code to reproduce the issue

```shell
Antes usando mesma imagem eu não tinha nenhum problema com instalação das libs, agora eu tenho problema somente com a lib do tensorflow.
```


### Relevant log output

```shell
FROM python:3.10

RUN apt-get update && apt-get install -y libgl1-mesa-glx

RUN pip install --upgrade pip

RUN pip install --upgrade setuptools

RUN pip install -r requirements.txt



Meu arquivo requirements.txt:
pytorch
keras
pytesseract
joblib
facenet-pytorch
flask-cors
flask
pandas
plotly
opencv-python
folium
socketio
regex
paramiko
joblib
numpy
psycopg2
tensorflow



ERRO:
ERROR: Could not find a version that satisfies the requirement tensorflow-cpu-aws==2.11.1; platform_system == ""Linux"" and (platform_machine == ""arm64"" or platform_machine == ""aarch64"") (from tensorflow) (from versions: 2.9.1, 2.10.0rc0, 2.10.0rc2, 2.10.0rc3, 2.10.0, 2.10.1, 2.11.0rc0, 2.11.0rc1, 2.11.0rc2, 2.11.0, 2.12.0rc1, 2.12.0, 2.12.1, 2.13.0rc0, 2.13.0, 2.13.1, 2.14.0rc0, 2.14.0rc1, 2.14.0)
ERROR: No matching distribution found for tensorflow-cpu-aws==2.11.1; platform_system == ""Linux"" and (platform_machine == ""arm64"" or platform_machine == ""aarch64"")
```
",False
The configuration file of newer tensorflow versions doesn't provide building with sycl/opencl option. Does newer versions of Tensorflow doesn't provide sycl support? stat:awaiting response type:support stale TF2.14,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.14

### Custom code

Yes

### OS platform and distribution

Ubuntu 20.04

### Mobile device

_No response_

### Python version

3.8

### Bazel version

_No response_

### GCC/compiler version

9

### CUDA/cuDNN version

11.8/8.6

### GPU model and memory

NVIDIA RTX 3090 24 GB

### Current behavior?

I am trying to build Tensorflow version 2.14 from source with sycl/opencl support but when I am running the configuration file it isn't showing any sycl support option. So does the newer versions of tensorflow doesn't provide opencl/sycl support? 
If they do provide support, how to build newer versions of TF with sycl/opencl support?

### Standalone code to reproduce the issue

```shell
download and unzip the TF 2.14 
and run configure file
```


### Relevant log output

_No response_",False
"Select TensorFlow op(s), included in the given model, is(are) not supported by this interpreter. stat:awaiting response stale comp:lite comp:lite-flex","
ERROR: Select TensorFlow op(s), included in the given model, is(are) not supported by this interpreter. Make sure you apply/link the Flex delegate before inference. For the Android, it can be resolved by adding ""org.tensorflow:tensorflow-lite-select-tf-ops"" dependency. See instructions: https://www.tensorflow.org/lite/guide/ops_select
ERROR: Node number 13 (FlexTensorArrayV3) failed to prepare.

Problems with calling tesonflowlite in C/C++。Has anyone encountered this problem？？",False
WSL2 tensorflow install not working type:build/install wsl2 TF2.14,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

v2.14.0-rc1-21-g4dacf3f368e 2.14.0

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 22.04.1 on WSL2

### Mobile device

_No response_

### Python version

3.10.12

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

CUDA: 12.2 cudnn: ??

### GPU model and memory

rtx 3090 24gb 

### Current behavior?

Im trying to use tensorflow 2 on wsl2. I did the installation as in the tf docs.
After Installing tensorflow on wsl2 and running a test script as stated in the relevant code.

I get this some errors.

I have tried training a simple model with resnet which, at first, didnt work because cudnn was missing. After manually installing cudnn it worked but it feels so sketchy given that it should work without having to install it manually.

Also when I train my model (i dont know if this is normal behaviour) only my vram is used, the compute power of my gpu seems to not be used at all when i look at my taskmanager.


### Standalone code to reproduce the issue

```shell
import tensorflow as tf
tf.test.is_built_with_cuda()
```


### Relevant log output

```shell
2023-10-11 22:19:14.589975: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2023-10-11 22:19:14.590010: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2023-10-11 22:19:14.590032: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-10-11 22:19:14.593224: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/usr/lib/python3/dist-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.17.3 and <1.25.0 is required for this version of SciPy (detected version 1.26.0
  warnings.warn(f""A NumPy version >={np_minversion} and <{np_maxversion}""
```
",False
Is there a way to run predict() for the same batch of data on two different sets of weights (same model architecture) stat:awaiting response type:support stale,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

n/a

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Hi all, sorry If not the write forum to ask such a question, but I am wondering about functionality of TensorFlow.

Basically I want to run the same batch of data, through X different models. These models will have a different set of weights, but are architecturally the same model.

From a technical perspective, I don't see why it is not possible to do in a single set of computations. In practice, it not different than two submodels that share inputs nodes, but the nodes after are just not connected at all, you would have two output nodes (one of each sub-model).

### Standalone code to reproduce the issue

```shell
n/a
```


### Relevant log output

_No response_",False
Conda-forge doesn't have tensorflow 1.15 anymore? stat:awaiting response type:build/install type:support TF 1.15,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

1.15

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I have an old project that uses tensorflow 1.15, but recently I can't install the conda environment for this anymore. The version no longer exists on conda-forge, for some reason?
There are versions 1.14 and lower, and 2.*, but no longer 1.15? Why is that?

### Standalone code to reproduce the issue

```shell
conda create --name tf1 python=3.7
conda activate tf1
conda install -c conda-forge tensorflow=1.15
```


### Relevant log output

```shell
PackagesNotFoundError: The following packages are not available from current channels:                                                                                                                                                                                 
                                                                                                                                                                                                                                                                       
  - tensorflow=1.15   

Current channels:

  - https://conda.anaconda.org/conda-forge/win-64
  - https://conda.anaconda.org/conda-forge/noarch
```
",False
"Tensorflow build with sycl and ComputeCPP throwing error ""missing value for mandatory attribute 'toolchain_config' in 'cc_toolchain' rule"" stat:awaiting response type:build/install stale subtype: ubuntu/linux TF 2.3","### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.3.0

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 20.04

### Mobile device

_No response_

### Python version

3.8

### Bazel version

3.1.0

### GCC/compiler version

9

### CUDA/cuDNN version

11.8 / 8.6

### GPU model and memory

RTX 3090- 24 GB

### Current behavior?

I'm trying to build Tensorflow from source with sycl and ComputeCPP backend but when I'm trying to build Tensorflow, I'm getting following errors:
@local_config_sycl//crosstool:cc-compiler-local: missing value for mandatory attribute 'toolchain_config' in 'cc_toolchain' rule
Target '@local_config_sycl//crosstool:empty' contains an error and its package is in error and referenced by '@local_config_sycl//crosstool:cc-compiler-local'
Target '@local_config_sycl//crosstool:cc-compiler-local' contains an error and its package is in error and referenced by '@local_config_sycl//crosstool:toolchain'
/home/vpy2kor/tensorflow-2.3.0/tensorflow/python/BUILD:2998:1: every rule of type cc_binary implicitly depends upon the target '@local_config_sycl//crosstool:toolchain', but this target could not be found because of: Target '@local_config_sycl//crosstool:toolchain' contains an error and its package is in error

### Standalone code to reproduce the issue

```shell
Move to tensorflow folder 
Run ./configure and make the necessary checks for sycl and computecpp
Start building tensorflow : bazel build --verbose_failures --jobs=16 //tensorflow/tools/pip_package:build_pip_package
```


### Relevant log output

_No response_",False
"GPU not detected even after installing CUDA, cuDNN correct versions type:support","### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.14.0

### Custom code

No

### OS platform and distribution

Windows 10 22H2 19045.3448

### Mobile device

_No response_

### Python version

3.10.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

CUDA v11.2, cudnn-11.2-windows-x64-v8.1.0.77

### GPU model and memory

GeForce GTX 960M, 4Gb

### Current behavior?

Unable to detect the GPU. TF says: 

`print(tf.test.is_built_with_cuda())
False`

### Standalone code to reproduce the issue

```shell
It is an installation issue. 

C:\Users\user>python
Python 3.10.10 (tags/v3.10.10:aad5f6a, Feb  7 2023, 17:20:36) [MSC v.1929 64 bit (AMD64)] on win32
Type ""help"", ""copyright"", ""credits"" or ""license"" for more information.
>>> import tensorflow as tf
>>> import tensorflow as tf
>>> print(tf.test.is_built_with_cuda())
False
>>> print(tf.config.list_physical_devices('GPU'))
[]
>>>
>>> print(tf.config.list_physical_devices())
[PhysicalDevice(name='/physical_device:CPU:0', device_type='CPU')]
>>>
```


### Relevant log output

```shell
C:\Windows\system32>
python -V 
Python 3.10.10 (tags/v3.10.10:aad5f6a, Feb  7 2023, 17:20:36) [MSC v.1929 64 bit (AMD64)] on win32
---------------------------------------------------------------------------------
pip list
Package                      Version
---------------------------- ------------
absl-py                      2.0.0
anyio                        4.0.0
argon2-cffi                  23.1.0
argon2-cffi-bindings         21.2.0
arrow                        1.3.0
asttokens                    2.4.0
astunparse                   1.6.3
async-lru                    2.0.4
attrs                        23.1.0
Babel                        2.13.0
backcall                     0.2.0
beautifulsoup4               4.12.2
bleach                       6.1.0
cachetools                   5.3.1
certifi                      2023.7.22
cffi                         1.16.0
charset-normalizer           3.3.0
colorama                     0.4.6
comm                         0.1.4
contourpy                    1.1.1
cycler                       0.12.1
debugpy                      1.8.0
decorator                    5.1.1
defusedxml                   0.7.1
exceptiongroup               1.1.3
executing                    2.0.0
fastjsonschema               2.18.1
flatbuffers                  23.5.26
fonttools                    4.43.1
fqdn                         1.5.1
gast                         0.5.4
google-auth                  2.23.3
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
grpcio                       1.59.0
h5py                         3.10.0
idna                         3.4
ipykernel                    6.25.2
ipython                      8.16.1
ipython-genutils             0.2.0
ipywidgets                   8.1.1
isoduration                  20.11.0
jedi                         0.19.1
Jinja2                       3.1.2
joblib                       1.3.2
json5                        0.9.14
jsonpointer                  2.4
jsonschema                   4.19.1
jsonschema-specifications    2023.7.1
jupyter                      1.0.0
jupyter_client               8.3.1
jupyter-console              6.6.3
jupyter_core                 5.4.0
jupyter-events               0.7.0
jupyter-lsp                  2.2.0
jupyter_server               2.7.3
jupyter_server_terminals     0.4.4
jupyterlab                   4.0.6
jupyterlab-pygments          0.2.2
jupyterlab_server            2.25.0
jupyterlab-widgets           3.0.9
keras                        2.14.0
kiwisolver                   1.4.5
libclang                     16.0.6
Markdown                     3.5
MarkupSafe                   2.1.3
matplotlib                   3.8.0
matplotlib-inline            0.1.6
mistune                      3.0.2
ml-dtypes                    0.2.0
mpmath                       1.3.0
nbclient                     0.8.0
nbconvert                    7.9.2
nbformat                     5.9.2
nest-asyncio                 1.5.8
notebook                     7.0.4
notebook_shim                0.2.3
numpy                        1.26.0
oauthlib                     3.2.2
opt-einsum                   3.3.0
overrides                    7.4.0
packaging                    23.2
pandas                       2.1.1
pandocfilters                1.5.0
parso                        0.8.3
pickleshare                  0.7.5
Pillow                       10.0.1
pip                          23.2.1
platformdirs                 3.11.0
plotly                       5.17.0
prometheus-client            0.17.1
prompt-toolkit               3.0.39
protobuf                     4.24.4
psutil                       5.9.5
pure-eval                    0.2.2
pyasn1                       0.5.0
pyasn1-modules               0.3.0
pycparser                    2.21
Pygments                     2.16.1
pyparsing                    3.1.1
python-dateutil              2.8.2
python-json-logger           2.0.7
pytz                         2023.3.post1
pywin32                      306
pywinpty                     2.0.12
PyYAML                       6.0.1
pyzmq                        25.1.1
qtconsole                    5.4.4
QtPy                         2.4.0
referencing                  0.30.2
requests                     2.31.0
requests-oauthlib            1.3.1
rfc3339-validator            0.1.4
rfc3986-validator            0.1.1
rpds-py                      0.10.4
rsa                          4.9
scikit-learn                 1.3.1
scipy                        1.11.3
Send2Trash                   1.8.2
setuptools                   65.5.0
six                          1.16.0
sniffio                      1.3.0
soupsieve                    2.5
stack-data                   0.6.3
sympy                        1.12
tenacity                     8.2.3
tensorboard                  2.14.1
tensorboard-data-server      0.7.1
tensorflow                   2.14.0
tensorflow-estimator         2.14.0
tensorflow-intel             2.14.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.3.0
terminado                    0.17.1
threadpoolctl                3.2.0
tinycss2                     1.2.1
tomli                        2.0.1
tornado                      6.3.3
tqdm                         4.66.1
traitlets                    5.11.2
types-python-dateutil        2.8.19.14
typing_extensions            4.8.0
tzdata                       2023.3
uri-template                 1.3.0
urllib3                      2.0.6
wcwidth                      0.2.8
webcolors                    1.13
webencodings                 0.5.1
websocket-client             1.6.4
Werkzeug                     3.0.0
wheel                        0.41.2
widgetNVIDIA snbextension           4.0.9
wrapt                        1.14.1
---------------------------------------------------------------------------------
Hardware: GeForce GTX 960M
https://www.nvidia.com/en-us/geforce/gaming-laptops/geforce-gtx-960m/specifications/
https://docs.nvidia.com/deeplearning/cudnn/support-matrix/index.html

CUDA Cores
1096 + Boost Base Clock (MHz)
GTX 960M Memory Specs:
2500 MHz Memory Clock
GDDR5 Memory Interface
128-bit Memory Interface Width
80Memory Bandwidth (GB/sec)
GTX 960M Technology Support: Yes 
NVIDIA® Optimus™ Support 1 Yes 
NVIDIA Battery Boost™ Support 2
2.0NVIDIA GPU Boost™ Yes
NVIDIA GameStream™-Ready Yes
GeForce ShadowPlay™ Yes
NVIDIA GameWorks™
12 API Microsoft DirectX
4.5 OpenGL 
CUDA Yes
PCI Express 3.0 Bus Support
Windows 8 and 8.1
Windows 7OS Certification

Processor	Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz   2.60 GHz
Installed RAM	32.0 GB (31.8 GB usable)
System type	64-bit operating system, x64-based processor

---------------------------------------------------------------------------------

>>> import tensorflow as tf
>>> print(tf.__version__)
2.14.0

---------------------------------------------------------------------------------
Used table from here: https://www.tensorflow.org/install/source_windows

tensorflow 2.14.0,	Python 3.7-3.10,	cuDNN 8.1	CUDA 11.2

CUDA v11.2, cudnn-11.2-windows-x64-v8.1.0.77, Python 3.10.10
---------------------------------------------------------------------------------

>>> print(tf.test.is_built_with_cuda())
False
>>> print(tf.config.list_physical_devices('GPU'))
[]
>>>
>>> print(tf.config.list_physical_devices())
[PhysicalDevice(name='/physical_device:CPU:0', device_type='CPU')]
>>>

---------------------------------------------------------------------------------
OS

Edition	Windows 10 Home
Version	22H2
Installed on	‎2/‎28/‎2023
OS build	19045.3448
Experience	Windows Feature Experience Pack 1000.19044.1000.0
```
",False
Code to make TFQ Demos run in Colab stat:awaiting response type:build/install type:support stale type:others TF 2.7,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tensorflow==2.7.0

### Custom code

No

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

3.9, Also tried current version in Colab

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Does not correctly install tensorflow or tensorflow_quantum with current version of Python in Colab or Python 3.9 for multiple demos. 

### Standalone code to reproduce the issue

```shell
ERROR: Could not find a version that satisfies the requirement tensorflow==2.7.0 (from versions: 2.8.0rc0, 2.8.0rc1, 2.8.0, 2.8.1, 2.8.2, 2.8.3, 2.8.4, 2.9.0rc0, 2.9.0rc1, 2.9.0rc2, 2.9.0, 2.9.1, 2.9.2, 2.9.3, 2.10.0rc0, 2.10.0rc1, 2.10.0rc2, 2.10.0rc3, 2.10.0, 2.10.1, 2.11.0rc0, 2.11.0rc1, 2.11.0rc2, 2.11.0, 2.11.1, 2.12.0rc0, 2.12.0rc1, 2.12.0, 2.12.1, 2.13.0rc0, 2.13.0rc1, 2.13.0rc2, 2.13.0, 2.13.1, 2.14.0rc0, 2.14.0rc1, 2.14.0)
ERROR: No matching distribution found for tensorflow==2.7.0

ERROR: Could not find a version that satisfies the requirement tensorflow-quantum==0.7.2 (from versions: none)
ERROR: No matching distribution found for tensorflow-quantum==0.7.2

ModuleNotFoundError: No module named 'tensorflow_quantum'
```


### Relevant log output

_No response_",False
Question about ptxas warning output of tensorflow-gpu 2.11 stat:awaiting response type:others comp:ops TF 2.11,"### Issue type

Others

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 2.11

### Custom code

Yes

### OS platform and distribution

Ubuntu 20.04

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

The running environment is cuda 11.7 cuDNN 8.5.0 python 3.10 tensorflow-gpu 2.11
When I run the code, it show the warning message which seems weird. Since my cuda version is 11.7, not older than 11.1 and the log says Loaded cuDNN version 8904 while my cuDNN version is 8500. Althought the code can run successfully, i have doubts about this log, and I hope I can figure out why. Thanks in advance.

The warning log is as follows
 I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:428] Loaded cuDNN version 8904
2023-10-07 11:43:16.647615: W tensorflow/compiler/xla/stream_executor/gpu/asm_compiler.cc:115] *** WARNING *** You are using ptxas 10.1.243, which is older than 11.1. ptxas before 11.1 is known to miscompile XLA code, leading to incorrect results or invalid-address errors.

You may not need to update to CUDA 11.1; cherry-picking the ptxas binary is often sufficient.
2023-10-07 11:43:16.651012: W tensorflow/compiler/xla/stream_executor/gpu/asm_compiler.cc:234] Falling back to the CUDA driver for PTX compilation; ptxas does not support CC 8.6
2023-10-07 11:43:16.651030: W tensorflow/compiler/xla/stream_executor/gpu/asm_compiler.cc:237] Used ptxas at ptxas
2023-10-07 11:43:16.651094: W tensorflow/compiler/xla/stream_executor/gpu/redzone_allocator.cc:318] UNIMPLEMENTED: ptxas ptxas too old. Falling back to the driver to compile.
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.

### Standalone code to reproduce the issue

```shell
any code that use tensorflow-gpu
concretely, the code i run is https://github.com/acctouhou/Prediction_of_battery/blob/main/1_Predicting/predict.py
```


### Relevant log output

_No response_",False
Issue Installing TensorFlow on Windows 11 with Python 3.12.0 ,"Hello,

I am encountering an issue while trying to install TensorFlow on my Windows 11 machine with Python 3.12.0 and pip 23.2.1 (64-bit). Despite several attempts, I keep receiving the following error messages:

```
ERROR: Could not find a version that satisfies the requirement tensorflow (from versions: none)
ERROR: No matching distribution found for tensorflow
```

I have tried creating virtual environments using both Python 3.7.0 and Python 3.6.4
cleared the pip cache using the command `pip cache purge`
Install TensorFlow with various specific versions
`tensorflow==2.1.0`
`tensorflow==2.5.0`
`tensorflow==2.2.0rc4`

I hoping anyone know what the issue here",False
Compatibility with Python 3.12.0 type:build/install,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

tensorflow 2.14.0

### Custom code

No

### OS platform and distribution

Mac OS

### Mobile device

_No response_

### Python version

3.12.0

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Python 3.12.0 is now available. I tried to pip install TensorFlow 2.14.0. The attempt failed as TF is only compatible with Python 3.11 at most at the moment.

When will a version of TensorFlow be available for the latest Python?  

Thanks.

### Standalone code to reproduce the issue

```shell
Terminal output:

(venv) ## my user ## % pip install tensorflow==2.14.0
ERROR: Could not find a version that satisfies the requirement tensorflow==2.14.0 (from versions: none)
```


### Relevant log output

_No response_",False
Building TF 2.14 using bazel with later NDK versions failing stat:awaiting response type:build/install stale subtype: ubuntu/linux TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.14

### Custom code

Yes

### OS platform and distribution

Ubuntu 20.04

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

6.1.0

### GCC/compiler version

_No response_

### CUDA/cuDNN version

Building without CUDA support

### GPU model and memory

_No response_

### Current behavior?

In order to build Tensorflow Delegate Performance Benchmark tool, I am building latest TF (2.14) from source (using ./configure) using bazel 6.1.0 and Android NDK version 25.0.8775105. But this fails

WARNING: The NDK version in /home/<username>/AndroidSDK/ndk/25.0.8775105 is 25, which is not supported by Bazel (officially supported versions: [19, 20, 21]). Please use another version. Compiling Android targets may result in confusing errors.

Traceback (most recent call last):
  File ""./configure.py"", line 1466, in <module>
    main()
  File ""./configure.py"", line 1439, in main
    create_android_ndk_rule(environ_cp)
  File ""./configure.py"", line 658, in create_android_ndk_rule
    get_ndk_api_level(environ_cp, android_ndk_home_path))
  File ""./configure.py"", line 752, in get_ndk_api_level
    api_levels = sorted(os.listdir(platforms))
FileNotFoundError: [Errno 2] No such file or directory: '/home/<username>/AndroidSDK/ndk/25.0.8775105/platforms'

As far as I understand later NDK versions don't have platforms/

As a user I should be able to build tensorflow using later NDK versions. Could someone have a look into this please.
 

### Standalone code to reproduce the issue

```shell
Steps followed:
1. Clone TF : git clone --recurse-submodules https://github.com/tensorflow/tensorflow.git
2. Clone bazel: https://bazel.build/install/ubuntu
3. Install AndroidSDK: sudo snap install androidsdk
4. Install Android NDK : androidsdk --install ""ndk;25.0.8775105""
5. Install android sources: androidsdk --install ""sources;android-30""
6. Install platforms: androidsdk --install ""platforms;android-30""
7. Install platform-tools: androidsdk --install ""platform-tools""
8. Run ./configure
These are the options we provided:

Please specify the location of python. [Default is /usr/bin/python3]:
 
 Found possible Python library paths:
  /usr/lib/python3/dist-packages
  /usr/local/lib/python3.8/dist-packages
Please input the desired Python library path to use.  Default is [/usr/lib/python3/dist-packages]
 
Do you wish to build TensorFlow with ROCm support? [y/N]:
No ROCm support will be enabled for TensorFlow.
 
Do you wish to build TensorFlow with CUDA support? [y/N]:
No CUDA support will be enabled for TensorFlow.
 
Do you wish to download a fresh release of clang? (Experimental) [y/N]:
Clang will not be downloaded.
 
Please specify optimization flags to use during compilation when bazel option ""--config=opt"" is specified [Default is -Wno-sign-compare]: --config=opt
 
 
Would you like to interactively configure ./WORKSPACE for Android builds? [y/N]: y
Searching for NDK and SDK installations.
 
Please specify the home path of the Android NDK to use. [Default is /home/<username>/Android/Sdk/ndk-bundle]: <provide path here>
```


### Relevant log output

_No response_",False
Can TensorFlow be used on other microcontrollers other than listed by TensorFlow?  stat:awaiting response type:support stale comp:lite comp:micro TFLiteConverter,"I have created a TensorFlow model that I wish to run on STM32F407VGT6. 
Is it possible to run TensorFlow model on microcontrollers other than listed ones. 
Also, is there any documentation to create and explore new models other than Hello World, Miro Speech and Person detection to understand TensorFlow Lite Micro more?
Is TensorFlow expandable to other models apart from listed above?",False
2.14 Docker image errors stat:awaiting response type:build/install stale subtype: ubuntu/linux TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 2.14

### Custom code

Yes

### OS platform and distribution

Linux 22.04

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Updating docker file to latest version should allow for building image

### Standalone code to reproduce the issue

```shell
FROM tensorflow/tensorflow:latest-gpu

RUN dpkg --configure -a
```


### Relevant log output

```shell
When building this I get the error 

dpkg: error: error executing hook 'if { test ""$DPKG_HOOK_ACTION"" = add-architecture || test ""$DPKG_HOOK_ACTION"" = remove-architecture; } && test -x /usr/share/pkg-config-dpkghook; then /usr/share/pkg-config-dpkghook update; fi', exit code 32512
```
",False
AttributeError: module 'object_detection.protos.input_reader_pb2' has no attribute 'NUMERICAL_MASKS'  stat:awaiting response type:support stale comp:model TF 2.13,"python3 train.py --logtostderr --train_dir=CAPTCHA_training_dir/ --pipeline_config_path=CAPTCHA_training/faster_rcnn_inception_v2_coco.config

While running this command I am getting error like this :

Traceback (most recent call last):
  File ""train.py"", line 51, in <module>
    from object_detection.builders import dataset_builder
  File ""/home/Desktop/test/test_env/lib/python3.8/site-packages/object_detection/builders/dataset_builder.py"", line 32, in <module>
    from object_detection.builders import decoder_builder
  File ""/home/Desktop/test/test_env/lib/python3.8/site-packages/object_detection/builders/decoder_builder.py"", line 24, in <module>
    from object_detection.data_decoders import tf_example_decoder
  File ""/home/Desktop/test/test_env/lib/python3.8/site-packages/object_detection/data_decoders/tf_example_decoder.py"", line 131, in <module>
    class TfExampleDecoder(data_decoder.DataDecoder):
  File ""/home/Desktop/test/test_env/lib/python3.8/site-packages/object_detection/data_decoders/tf_example_decoder.py"", line 136, in TfExampleDecoder
    instance_mask_type=input_reader_pb2.NUMERICAL_MASKS,
AttributeError: module 'object_detection.protos.input_reader_pb2' has no attribute 'NUMERICAL_MASKS'

Please do help me to solve this issue.

",False
AttributeError: module 'object_detection.protos.input_reader_pb2' has no attribute 'NUMERICAL_MASKS'  stat:awaiting response type:support,"Please go to Stack Overflow for help and support:

https://stackoverflow.com/questions/tagged/tensorflow

If you open a GitHub issue, here is our policy:

1.  It must be a bug, a feature request, or a significant problem with the
    documentation (for small docs fixes please send a PR instead).
2.  The form below must be filled out.
3.  It shouldn't be a TensorBoard issue. Those go
    [here](https://github.com/tensorflow/tensorboard/issues).

**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.

------------------------

### System information

-   **Have I written custom code (as opposed to using a stock example script
    provided in TensorFlow)**:
-   **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:
-   **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue
    happens on a mobile device**:
-   **TensorFlow installed from (source or binary)**:
-   **TensorFlow version (use command below)**:
-   **Python version**:
-   **Bazel version (if compiling from source)**:
-   **GCC/Compiler version (if compiling from source)**:
-   **CUDA/cuDNN version**:
-   **GPU model and memory**:
-   **Exact command to reproduce**:

You can collect some of this information using our environment capture script:

https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh

You can obtain the TensorFlow version with:

```bash
python -c ""import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)""
```

### Describe the problem
Describe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.

### Source code / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.
",False
In TF-v2.12 there are no methods called `_set_hyper` and `_get_hyper` stat:awaiting response type:support stale comp:keras TF 2.12,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

v2.12.0-rc1-12-g0db597d0d75 2.12.0

### Custom code

Yes

### OS platform and distribution

Kaggle kernel

### Mobile device

_No response_

### Python version

3.10.12 | packaged by conda-forge | (main, Jun 23 2023, 22:40:32) [GCC 12.3.0]

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

There are no methods called `_set_hyper` and `_get_hyper`

### Standalone code to reproduce the issue

```shell
import tensorflow as tf

class MyAdamOptimizer(tf.keras.optimizers.Optimizer):
    def __init__(self, learning_rate=0.001, beta_1=0.9, beta_2=0.999, epsilon=1e-7, name=""MyAdamOptimizer"", **kwargs):
        super(MyAdamOptimizer, self).__init__(name, **kwargs)
        
        self._set_hyper(""learning_rate"", kwargs.get(""lr"", learning_rate))
        self._set_hyper(""beta_1"", beta_1)
        self._set_hyper(""beta_2"", beta_2)
        self._set_hyper(""epsilon"", epsilon)
        
    def _create_slots(self, var_list):
        for var in var_list:
            self.add_slot(var, ""m"")
            self.add_slot(var, ""v"")
            
    def _resource_apply_dense(self, grad, var):
        lr = self._get_hyper(""learning_rate"", var_dtype=var.dtype.base_dtype)
        beta_1 = self._get_hyper(""beta_1"", var_dtype=var.dtype.base_dtype)
        beta_2 = self._get_hyper(""beta_2"", var_dtype=var.dtype.base_dtype)
        epsilon = self._get_hyper(""epsilon"", var_dtype=var.dtype.base_dtype)
        
        m = self.get_slot(var, ""m"")
        v = self.get_slot(var, ""v"")
        
        m.assign_add((1 - beta_1) * (grad - m))
        v.assign_add((1 - beta_2) * (tf.square(grad) - v))
        
        m_hat = m / (1 - tf.math.pow(beta_1, tf.cast(self.iterations + 1, tf.float32)))
        v_hat = v / (1 - tf.math.pow(beta_2, tf.cast(self.iterations + 1, tf.float32)))
        
        var_update = lr * m_hat / (tf.sqrt(v_hat) + epsilon)
        
        var.assign_sub(var_update)
        
        return var_update
        
    def _resource_apply_sparse(self, grad, var):
        raise NotImplementedError(""Sparse gradient updates are not supported."")

    
optimizer = MyAdamOptimizer(learning_rate=0.001)
```


### Relevant log output

```shell
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Cell In[5], line 42
     38     def _resource_apply_sparse(self, grad, var):
     39         raise NotImplementedError(""Sparse gradient updates are not supported."")
---> 42 optimizer = MyAdamOptimizer(learning_rate=0.001)

Cell In[5], line 7, in MyAdamOptimizer.__init__(self, learning_rate, beta_1, beta_2, epsilon, name, **kwargs)
      4 def __init__(self, learning_rate=0.001, beta_1=0.9, beta_2=0.999, epsilon=1e-7, name=""MyAdamOptimizer"", **kwargs):
      5     super(MyAdamOptimizer, self).__init__(name, **kwargs)
----> 7     self._set_hyper(""learning_rate"", kwargs.get(""lr"", learning_rate))
      8     self._set_hyper(""beta_1"", beta_1)
      9     self._set_hyper(""beta_2"", beta_2)

AttributeError: 'MyAdamOptimizer' object has no attribute '_set_hyper'
```
",False
Tensorflow debug build reports the error: relocation R_X86_64_PC32 against undefined symbol `_ZN15stream_executor3gpu12_GLOBAL__N_120CUDABlasLtMatmulPlan14kMaxBatchCountE' can not be used when making a shared object stat:awaiting response type:build/install stale TF 2.0 subtype: ubuntu/linux,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 2.0

### Custom code

No

### OS platform and distribution

Linux Ubuntu 20.04

### Mobile device

_No response_

### Python version

3.8.10

### Bazel version

1.16.0

### GCC/compiler version

9.4.0

### CUDA/cuDNN version

12.2

### GPU model and memory

GTX 1080 & RTX 2080

### Current behavior?

Reported the following error:
```
WARNING: The following configs were expanded more than once: [cuda, using_cuda]. For repeatable flags, repeats are counted twice and may lead to unexpected behavior.
INFO: Options provided by the client:
  Inherited 'common' options: --isatty=1 --terminal_columns=120
INFO: Reading rc options for 'build' from /root/tensorflow/.bazelrc:
  Inherited 'common' options: --experimental_repo_remote_exec
INFO: Reading rc options for 'build' from /root/tensorflow/.bazelrc:
  'build' options: --apple_platform_type=macos --define framework_shared_object=true --define open_source_build=true --java_toolchain=//third_party/toolchains/java:tf_java_toolchain --host_java_toolchain=//third_party/toolchains/java:tf_java_toolchain --define=tensorflow_enable_mlir_generated_gpu_kernels=0 --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone -c opt --announce_rc --define=grpc_no_ares=true --noincompatible_remove_legacy_whole_archive --noincompatible_prohibit_aapt1 --enable_platform_specific_config --config=short_logs --config=v2
INFO: Reading rc options for 'build' from /root/tensorflow/.tf_configure.bazelrc:
  'build' options: --action_env PYTHON_BIN_PATH=/usr/bin/python3 --action_env PYTHON_LIB_PATH=/usr/local/lib/python3.8/dist-packages --python_path=/usr/bin/python3 --config=xla --action_env CUDA_TOOLKIT_PATH=/usr/local/cuda-11.7 --action_env TF_CUDA_COMPUTE_CAPABILITIES=6.0,6.1,6.2,7.0,7.2,7.5 --action_env LD_LIBRARY_PATH=/usr/local/nvidia/lib:/usr/local/nvidia/lib64 --action_env GCC_HOST_COMPILER_PATH=/usr/bin/x86_64-linux-gnu-gcc-9 --config=cuda --action_env TF_CONFIGURE_IOS=0
INFO: Found applicable config definition build:short_logs in file /root/tensorflow/.bazelrc: --output_filter=DONT_MATCH_ANYTHING
INFO: Found applicable config definition build:v2 in file /root/tensorflow/.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1
INFO: Found applicable config definition build:xla in file /root/tensorflow/.bazelrc: --define=with_xla_support=true
INFO: Found applicable config definition build:cuda in file /root/tensorflow/.bazelrc: --config=using_cuda --define=using_cuda_nvcc=true
INFO: Found applicable config definition build:using_cuda in file /root/tensorflow/.bazelrc: --define=using_cuda=true --action_env TF_NEED_CUDA=1 --crosstool_top=@local_config_cuda//crosstool:toolchain --define=tensorflow_enable_mlir_generated_gpu_kernels=1
INFO: Found applicable config definition build:cuda in file /root/tensorflow/.bazelrc: --config=using_cuda --define=using_cuda_nvcc=true
INFO: Found applicable config definition build:using_cuda in file /root/tensorflow/.bazelrc: --define=using_cuda=true --action_env TF_NEED_CUDA=1 --crosstool_top=@local_config_cuda//crosstool:toolchain --define=tensorflow_enable_mlir_generated_gpu_kernels=1
INFO: Found applicable config definition build:dbg in file /root/tensorflow/.bazelrc: --config=opt -c dbg --cxxopt -DTF_LITE_DISABLE_X86_NEON --copt -DDEBUG_BUILD
INFO: Found applicable config definition build:opt in file /root/tensorflow/.tf_configure.bazelrc: --copt=-Wno-sign-compare --host_copt=-Wno-sign-compare --define with_default_optimizations=true
INFO: Found applicable config definition build:linux in file /root/tensorflow/.bazelrc: --copt=-w --host_copt=-w --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include --define=PROTOBUF_INCLUDE_PATH=$(PREFIX)/include --cxxopt=-std=c++14 --host_cxxopt=-std=c++14 --config=dynamic_kernels
INFO: Found applicable config definition build:dynamic_kernels in file /root/tensorflow/.bazelrc: --define=dynamic_loaded_kernels=true --copt=-DAUTOLOAD_DYNAMIC_KERNELS
INFO: Build options --copt and --cxxopt have changed, discarding analysis cache.
INFO: Analyzed target //tensorflow/tools/pip_package:build_pip_package (0 packages loaded, 32967 targets configured).
INFO: Found 1 target...
ERROR: /root/tensorflow/tensorflow/BUILD:724:1: Linking of rule '//tensorflow:libtensorflow_framework.so.2.4.4' failed (Exit 1)
/usr/bin/ld: bazel-out/k8-dbg/bin/tensorflow/stream_executor/cuda/libcublas_plugin.lo(cuda_blas.pic.o): relocation R_X86_64_PC32 against undefined symbol `_ZN15stream_executor3gpu12_GLOBAL__N_120CUDABlasLtMatmulPlan14kMaxBatchCountE' can not be used when making a shared object; recompile with -fPIC
/usr/bin/ld: final link failed: bad value
collect2: error: ld returned 1 exit status
Target //tensorflow/tools/pip_package:build_pip_package failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 7241.142s, Critical Path: 2298.04s
INFO: 6729 processes: 6729 local.
FAILED: Build did NOT complete successfully
```

### Standalone code to reproduce the issue

```shell
git clone -b r2.0 https://github.com/tensorflow/tensorflow.git
bazel build --config=cuda --config=dbg --copt=-fPIC --cxxopt=-fPIC //tensorflow/tools/pip_package:build_pip_package
```


### Relevant log output

_No response_",False
implement llama 2 using Tensorflow type:feature,"### Issue type

Feature Request

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 2.8

### Custom code

No

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

-

### Standalone code to reproduce the issue

```shell
-
```


### Relevant log output

```shell
-
```
",False
Why support for Python 3.8 has been removed in Tensorflow 2.14 type:build/install type:support TF2.14,"Not an issue, but a question. Just out of curiosity, Why has support for Python 3.8 been removed in Tensorflow 2.14?",False
can't convert keras model to tflite comp:lite TFLiteConverter TF2.14,"### 1. System information

- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 22
- TensorFlow installation (pip package or built from source): pip 
- TensorFlow library (version, if pip package or github SHA, if built from source): 2.14.0 or tf-nightly

### 2. Code

Provide code to help us reproduce your issues using one of the following options:

#### Option A: Reference colab notebooks

1)  Reference [TensorFlow Model Colab](https://colab.research.google.com/gist/ymodak/e96a4270b953201d5362c61c1e8b78aa/tensorflow-datasets.ipynb?authuser=1): Demonstrate how to build your TF model.
2)  Reference [TensorFlow Lite Model Colab](https://colab.research.google.com/gist/ymodak/0dfeb28255e189c5c48d9093f296e9a8/tensorflow-lite-debugger-colab.ipynb): Demonstrate how to convert your TF model to a TF Lite model (with quantization, if used) and run TFLite Inference (if possible).

```
(You can paste links or attach files by dragging & dropping them below)
- Provide links to your updated versions of the above two colab notebooks.
- Provide links to your TensorFlow model and (optionally) TensorFlow Lite Model.
```

#### Option B: Paste your code here or provide a link to a custom end-to-end colab

```
(You can paste links or attach files by dragging & dropping them below)
- Include code to invoke the TFLite Converter Python API and the errors.
- Provide links to your TensorFlow model and (optionally) TensorFlow Lite Model.
```
import tensorflow as tf

keras_model = tf.keras.models.load_model(keras_model_filename)
converter = tf.lite.TFLiteConverter.from_keras_model(keras_model)
tflite_model = converter.convert()

file = open(tflite_model_filename, 'wb‘）
file.write(tflite_model)

### 3. Failure after conversion
If the conversion is successful, but the generated model is wrong, then state what is wrong:

- Model produces wrong results and/or has lesser accuracy.
- Model produces correct results, but it is slower than expected.

### 4. (optional) RNN conversion support
If converting TF RNN to TFLite fused RNN ops, please prefix [RNN] in the title.

### 5. (optional) Any other info / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.
![image](https://github.com/tensorflow/tensorflow/assets/68658008/dc88001c-02c2-42c6-8c74-8de447c5a776)
",False
con't build_pip_package stat:awaiting response type:build/install stale subtype: ubuntu/linux TF 1.14,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

tf1.14.0

### Custom code

No

### OS platform and distribution

Linux Ubuntu 18.04

### Mobile device

_No response_

### Python version

3.6.9

### Bazel version

bazel 0.24.1

### GCC/compiler version

gcc 4.8

### CUDA/cuDNN version

_No response_

### GPU model and memory

 intel i7-9750H   12g

### Current behavior?

tensorflow/python/lib/core/bfloat16.cc:608:60: note: no known conversion for argument 2 from '<unresolved overloaded function type>' to 'PyUFuncGenericFunction {aka void ()(char**, const long int, const long int*, void*)}'
Target //tensorflow/tools/pip_package:build_pip_package failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 4163.570s, Critical Path: 161.91s
INFO: 5035 processes: 5035 local.
FAILED: Build did NOT complete successfully

### Standalone code to reproduce the issue

```shell
bazel build --jobs=6 //tensorflow/tools/pip_package:build_pip_package
```


### Relevant log output

_No response_",False
About int16 stat:awaiting response type:support stale TFLiteConverter,"### 1. System information

- Linux Ubuntu 16.04
- TensorFlow lite
### 2. Issue

I would like to inquire if my input and output data can only be int16. Can I write ""converter. reference_input_type=tf. int16"" when converting tflite？ or is there any other good method recommended?

Thanks!


",False
Could not find a version that satisfies the requirement tensorflow-macos==2.14.0; stat:awaiting response type:build/install subtype:macOS TF2.14,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

v2.13.0-rc2-7-g1cb1a030a62 2.13.0

### Custom code

No

### OS platform and distribution

mac os 13.5.1

### Mobile device

Apple silicon

### Python version

3.11.3

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Collecting tensorflow==2.14.0
  Obtaining dependency information for tensorflow==2.14.0 from https://files.pythonhosted.org/packages/de/ea/90267db2c02fb61f4d03b9645c7446d3cbca6d5c08522e889535c88edfcd/tensorflow-2.14.0-cp311-cp311-macosx_12_0_arm64.whl.metadata
  Using cached tensorflow-2.14.0-cp311-cp311-macosx_12_0_arm64.whl.metadata (3.3 kB)
INFO: pip is looking at multiple versions of tensorflow to determine which version is compatible with other requirements. This could take a while.
ERROR: Could not find a version that satisfies the requirement tensorflow-macos==2.14.0; platform_system == ""Darwin"" and platform_machine == ""arm64"" (from tensorflow) (from versions: 2.12.0, 2.13.0rc0, 2.13.0rc1, 2.13.0rc2, 2.13.0, 2.14.0rc0, 2.14.0rc1)
ERROR: No matching distribution found for tensorflow-macos==2.14.0; platform_system == ""Darwin"" and platform_machine == ""arm64""

### Standalone code to reproduce the issue

```shell
pip install tensorflow==2.14.0
```


### Relevant log output

_No response_",False
TfLiteGpuDelegate Prepare: delegate is not initialized comp:lite TFLiteGpuDelegate TF 2.13,"**System information**
- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Android 12
- TensorFlow installed from (source or binary): binary
- TensorFlow version (or github SHA if from source): v2.13.0


**Provide the text output from tflite_convert**

```
# Copy and paste here
2023-09-26 13:31:37.492599: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-09-26 13:31:37.500521: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x2168003d970 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2023-09-26 13:31:37.500975: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2023-09-26 13:31:37.599984: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:313] Ignored output_format.
2023-09-26 13:31:37.600138: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:316] Ignored drop_control_dependency.

```

**Standalone code to reproduce the issue** 
**java code**
Interpreter.Options options = new Interpreter.Options();
options.addDelegate(new GpuDelegate());
Interpreter  interpreter = new Interpreter(model, options);

**Convert code**
output_name = ['add_1']

input_shape = [288, 288, 3]

converter = tf.lite.TFLiteConverter.from_frozen_graph('model.pb', input_arrays=[""input_image""], output_arrays=output_name, input_shapes={""input_image"": input_shape})

tflite_model = converter.convert()
open('model.tflite', ""wb"").write(tflite_model)

GraphDef  model:
[GraphDef.zip](https://github.com/tensorflow/tensorflow/files/12723201/GraphDef.zip)

TFlite model:
[tflite.zip](https://github.com/tensorflow/tensorflow/files/12723204/tflite.zip)


**Any other info / logs**
**Java issue**
13:40:05.480  W  java.lang.IllegalArgumentException: Internal error: Failed to apply delegate: TfLiteGpuDelegate Init: DEPTHWISE_CONV_2D: ReadNonConstantTensor: value is a constant tensor: 4
13:40:05.480  W  TfLiteGpuDelegate Prepare: delegate is not initialized
13:40:05.480  W  Node number 69 (TfLiteGpuDelegateV2) failed to prepare.
13:40:05.480  W  Restored original execution plan after delegate application failure.
13:40:05.480  W  	at org.tensorflow.lite.NativeInterpreterWrapper.createInterpreter(Native Method)
13:40:05.480  W  	at org.tensorflow.lite.NativeInterpreterWrapper.init(NativeInterpreterWrapper.java:110)
13:40:05.480  W  	at org.tensorflow.lite.NativeInterpreterWrapper.<init>(NativeInterpreterWrapper.java:58)
13:40:05.480  W  	at org.tensorflow.lite.NativeInterpreterWrapperExperimental.<init>(NativeInterpreterWrapperExperimental.java:32)
13:40:05.480  W  	at org.tensorflow.lite.Interpreter.<init>(Interpreter.java:202)
13:40:05.480  W  	at com.unt.studio.pumpkin.core.style.DCTNet.init(DCTNet.java:33)
13:40:05.480  W  	at com.unt.studio.pumpkin.ui.fragment.StyleTransferFragment$1.run(StyleTransferFragment.java:184)
13:40:05.480  W  	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1167)
13:40:05.480  W  	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:641)
13:40:05.480  W  	at java.lang.Thread.run(Thread.java:920)",False
Build from source 2.13.0 fails on Rocky Linux 8.8 type:build/install subtype: ubuntu/linux TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13.0

### Custom code

No

### OS platform and distribution

Rocky Linux 8.8

### Mobile device

_No response_

### Python version

3.10.2

### Bazel version

5.3.0

### GCC/compiler version

clang 16.0.1 or gcc 11.2.0

### CUDA/cuDNN version

cuda 11.7.1 /  cuDNN 8.5.0.96

### GPU model and memory

_No response_

### Current behavior?

1. load modules (all built locally on the host  and provide an access to the specified software) 
 **module load  bazel/5.3.0    gcc/11.2.0    llvm/16.0.1   clang/16.0.1  python/3.10.2   cuda/11.7.1   tensorRT/8.4.2.4**  

2.  Configure tensroflow:
**./configure**

Resulting  .tf_configure.bazelrc is:
build --action_env PYTHON_BIN_PATH=""/opt/apps/python/3.10.2/bin/python3""
build --action_env PYTHON_LIB_PATH=""/opt/apps/python/3.10.2/lib/python3.10/site-packages""
build --python_path=""/opt/apps/python/3.10.2/bin/python3""
build --config=tensorrt
build --action_env TF_CUDA_VERSION=""11""
build --action_env TF_CUDNN_VERSION=""8""
build --action_env TF_TENSORRT_VERSION=""8""
build --action_env TF_NCCL_VERSION=""""
build --action_env TF_CUDA_PATHS=""/opt/apps/cuda/11.7.1,/opt/apps/tensorRT/8.4.2.4,/usr""
build --action_env CUDA_TOOLKIT_PATH=""/opt/apps/cuda/11.7.1""
build --action_env TF_CUDA_COMPUTE_CAPABILITIES=""7.0""
build --action_env LD_LIBRARY_PATH=""/opt/apps/tensorRT/8.4.2.4/lib:/opt/apps/cuda/11.7.1/lib64:/opt/apps/cuda/11.7.1/nvvm/lib64:/opt/apps/cuda/11.7.1/cublas/lib64:/opt/apps/cuda/11.7.1/extras/CUPTI/lib64:/opt/apps/cuda/11.7.1
/extras/Debugger/lib64:/opt/apps/python/3.10.2/lib:/opt/apps/clang/16.0.1/lib:/opt/apps/llvm/16.0.1/lib:/opt/apps/gcc/11.2.0/lib64:/opt/apps/gcc/11.2.0/lib:/opt/apps/gcc/11.2.0/lib/gcc/x86_64-pc-linux-gnu/11.2.0""
build --config=cuda_clang
build --action_env CLANG_CUDA_COMPILER_PATH=""/opt/apps/clang/16.0.1/bin/clang""
build --config=cuda_clang
build:opt --copt=-mavx2
build:opt --host_copt=-mavx2
test --flaky_test_attempts=3
test --test_size_filters=small,medium
test --test_env=LD_LIBRARY_PATH
test:v1 --test_tag_filters=-benchmark-test,-no_oss,-oss_excluded,-no_gpu,-oss_serial
test:v1 --build_tag_filters=-benchmark-test,-no_oss,-oss_excluded,-no_gpu
test:v2 --test_tag_filters=-benchmark-test,-no_oss,-oss_excluded,-no_gpu,-oss_serial,-v1only
test:v2 --build_tag_filters=-benchmark-test,-no_oss,-oss_excluded,-no_gpu,-v1only

3 Run bazel build
**nohup bazel build --config=opt --jobs=8 --verbose_failures --verbose_explanations \
            --explain=/tmp/explain.txt //tensorflow/tools/pip_package:build_pip_package > build-out.txt &**

The build fails with an error. Attaching output log  files build-out.txt (collect errors) and explain.txt ( collect verbose output)
per above command:
[build-out.txt](https://github.com/tensorflow/tensorflow/files/12719249/build-out.txt)
[explain.txt](https://github.com/tensorflow/tensorflow/files/12719259/explain.txt)

If i compile without cuda/tensorRT, the clang compiler is not chosen and there is no way to choose is per current configure.py
as clang choose seem to be used only for gpu-enabled builds. In this case, gcc 11.2.0 is used and the error happens in a different area.

I tried to use different options adding **--config=cuda** or **--cxxopt=""-D_GLIBCXX_USE_CXX11_ABI=0""** and every 
time i get  a failure on a different file yet always  the culprit seem to be these lines from the  respective build output:

In file included from /opt/rh/gcc-toolset-12/root/usr/lib/gcc/x86_64-redhat-linux/12/../../../../include/c++/12/memory:77:
In file included from /opt/rh/gcc-toolset-12/root/usr/lib/gcc/x86_64-redhat-linux/12/../../../../include/c++/12/bits/shared_ptr.h:53:
/opt/rh/gcc-toolset-12/root/usr/lib/gcc/x86_64-redhat-linux/12/../../../../include/c++/12/bits/shared_ptr_base.h:196:22: error: type name does not allow function specifier to be specified
bazel-out/k8-opt/bin/external/local_config_cuda/cuda/cuda/include/crt/host_defines.h:83:24: note: expanded from macro '__noinline__'
        __attribute__((noinline))

Note, i dont have **/opt/rh...** path on this host so this must  be coming during compiling some external  dependencies 
and looking at my .tf_configure.bazelrc file i dont  really have control over how external dependencies are handled. 
Can reproduce with nightly builds as it uses different  (newer) version of tensorflow and  bazel.

I have previously compiled tensorflow 2.8.0 (with  its corresponding bazel version)  on the same host with the same cuda, python, and gcc using identical build  steps and the builds went perfectly file. I am confident that all prerequisite software is installed correctly (using it for many other packages builds outside tensorflow).

I would really appreciate if someone can point to what am  i doing wrong or what else i can try. 

No conda or docker please. Neither one will work in our environment where i need home built RPMS 
for installation on the HPC cluster. 

Thanks!

### Standalone code to reproduce the issue

```shell
No test case
```


### Relevant log output

_No response_",False
Windows 10 Source build failure if python installed in a directory with spaces stat:awaiting response type:build/install stale subtype:windows TF 2.10,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 2.10

### Custom code

Yes

### OS platform and distribution

Windows 10

### Mobile device

_No response_

### Python version

3.9.13

### Bazel version

5.1.1

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11.2/8.1.1

### GPU model and memory

Quadro P2000 / 5 Gb

### Current behavior?

Building 2.10 tensorflow with cuda support from sources using Bazel 5.1.1 would result in an error if the python is downloaded in a directory with spaces. In my case I had python installed under `C:/Program Files/python39`. The error showed that: `'c:/program' is not recognized as an internal or external command building tensorflow'`. I traced this error into the `tensorflow\third_party\gpus\cuda_configure.bzl` file. In this file there is a function called `_check_cuda_libs` (line 492). This function checks the precense of cuda libraries by compling a cmd. However, the cmd won't work if the python_bin points to a python executive which is located in a directory with spaces. This error was simply fixed by moving python to a directory without spaces (No need to change the scripts inside `.bzl` file).

### Standalone code to reproduce the issue

```shell
You should be able to reproduce the issue by following the ""Build from source on Windows"" instructions and downloading python for example under ""Program Files"" folder. Build should be configured to include CUDA support. I used the following build command: bazel build --config=opt --config=cuda --define=no_tensorflow_py_deps=true //tensorflow/tools/pip_package:build_pip_package
```


### Relevant log output

_No response_",False
Use github.com/apssouza22/chatflow as a conversational layer. It would enable actual API requests to be carried out from natural language inputs. stat:awaiting response type:feature stale comp:apis,"### Issue type

Feature Request

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

all of em

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Fine as hell

### Standalone code to reproduce the issue

```shell
n/a
```


### Relevant log output

```shell
i <3 tensorflow
```
",False
Color prediction result  ,"Fastwin color prediction game results 
",False
"also missing from the include ""patch"" is file ""tensorflow/tsl/c/tsl_status.h"" (there might be others) stat:awaiting tensorflower subtype:windows subtype:cpu-intel TF2.14","              also missing from the include ""patch"" is file ""tensorflow/tsl/c/tsl_status.h"" (there might be others)

_Originally posted by @esohns in https://github.com/tensorflow/tensorflow/issues/59762#issuecomment-1732376736_
            ",False
Error with protobuf during installation type:build/install subtype: ubuntu/linux TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 12.3

### Custom code

Yes

### OS platform and distribution

Ubuntu 22.04

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

6.1.0

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

/home/user1/.cache/bazel/_bazel_user1/2ed8e7afdea3ff827d1d2c14869018ce/external/com_google_protobuf/BUILD.bazel:459:10: Compiling src/google/protobuf/compiler/main.cc [for tool] failed: (Exit 1): clang failed: error executing command (from target @com_google_protobuf//:protoc) 
  (cd /home/user1/.cache/bazel/_bazel_user1/2ed8e7afdea3ff827d1d2c14869018ce/execroot/org_tensorflow && \
  exec env - \
    LD_LIBRARY_PATH=/usr/local/cuda-12.2/lib64 \
    PATH=/home/user1/.cache/bazelisk/downloads/sha256/6c25a6d716545d6b672ec46f770521cd9ebb63d73617b8f4e6747825d1db1839/bin:/home/user1/bin:/usr/local/cuda-12.2/bin:/home/user1/anaconda3/bin:/home/user1/anaconda3/condabin:/home/user1/.local/bin:/home/user1/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/snap/bin \
    PWD=/proc/self/cwd \
  /usr/lib/llvm-16/bin/clang -MD -MF bazel-out/k8-opt-exec-50AE0418/bin/external/com_google_protobuf/_objs/protoc/main.d '-frandom-seed=bazel-out/k8-opt-exec-50AE0418/bin/external/com_google_protobuf/_objs/protoc/main.o' '-DBAZEL_CURRENT_REPOSITORY=""com_google_protobuf""' -iquote external/com_google_protobuf -iquote bazel-out/k8-opt-exec-50AE0418/bin/external/com_google_protobuf -iquote external/zlib -iquote bazel-out/k8-opt-exec-50AE0418/bin/external/zlib -iquote external/bazel_tools -iquote bazel-out/k8-opt-exec-50AE0418/bin/external/bazel_tools -isystem external/com_google_protobuf/src -isystem bazel-out/k8-opt-exec-50AE0418/bin/external/com_google_protobuf/src -isystem external/zlib -isystem bazel-out/k8-opt-exec-50AE0418/bin/external/zlib -fmerge-all-constants -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -fPIE -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -Wno-invalid-partial-specialization -fno-omit-frame-pointer -no-canonical-prefixes -DNDEBUG -g0 -O2 -ffunction-sections -fdata-sections '--cuda-path=/usr/local/cuda-12.2' -g0 -w -g0 '-std=c++17' -c external/com_google_protobuf/src/google/protobuf/compiler/main.cc -o bazel-out/k8-opt-exec-50AE0418/bin/external/com_google_protobuf/_objs/protoc/main.o)
# Configuration: be1b6d30ad6b895c5d0cb4e11b08ee9fdfd7ce804f01eb0679a5e177ceb7e39b
# Execution platform: @local_execution_config_platform//:platform
In file included from external/com_google_protobuf/src/google/protobuf/compiler/main.cc:31:
external/com_google_protobuf/src/google/protobuf/compiler/cpp/generator.h:40:10: fatal error: 'string' file not found
#include <string>
         ^~~~~~~~
1 error generated.
Target //tensorflow/tools/pip_package:build_pip_package failed to build
ERROR: /home/user1/tensorflow/tensorflow/tools/pip_package/BUILD:252:10 Middleman _middlemen/tensorflow_Stools_Spip_Upackage_Sbuild_Upip_Upackage-runfiles failed: (Exit 1): clang failed: error executing command (from target @com_google_protobuf//:protoc) 
  (cd /home/user1/.cache/bazel/_bazel_user1/2ed8e7afdea3ff827d1d2c14869018ce/execroot/org_tensorflow && \
  exec env - \
    LD_LIBRARY_PATH=/usr/local/cuda-12.2/lib64 \
    PATH=/home/user1/.cache/bazelisk/downloads/sha256/6c25a6d716545d6b672ec46f770521cd9ebb63d73617b8f4e6747825d1db1839/bin:/home/user1/bin:/usr/local/cuda-12.2/bin:/home/user1/anaconda3/bin:/home/user1/anaconda3/condabin:/home/user1/.local/bin:/home/user1/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/snap/bin \
    PWD=/proc/self/cwd \
  /usr/lib/llvm-16/bin/clang -MD -MF bazel-out/k8-opt-exec-50AE0418/bin/external/com_google_protobuf/_objs/protoc/main.d '-frandom-seed=bazel-out/k8-opt-exec-50AE0418/bin/external/com_google_protobuf/_objs/protoc/main.o' '-DBAZEL_CURRENT_REPOSITORY=""com_google_protobuf""' -iquote external/com_google_protobuf -iquote bazel-out/k8-opt-exec-50AE0418/bin/external/com_google_protobuf -iquote external/zlib -iquote bazel-out/k8-opt-exec-50AE0418/bin/external/zlib -iquote external/bazel_tools -iquote bazel-out/k8-opt-exec-50AE0418/bin/external/bazel_tools -isystem external/com_google_protobuf/src -isystem bazel-out/k8-opt-exec-50AE0418/bin/external/com_google_protobuf/src -isystem external/zlib -isystem bazel-out/k8-opt-exec-50AE0418/bin/external/zlib -fmerge-all-constants -Wno-builtin-macro-redefined '-D__DATE__=""redacted""' '-D__TIMESTAMP__=""redacted""' '-D__TIME__=""redacted""' -fPIE -U_FORTIFY_SOURCE '-D_FORTIFY_SOURCE=1' -fstack-protector -Wall -Wno-invalid-partial-specialization -fno-omit-frame-pointer -no-canonical-prefixes -DNDEBUG -g0 -O2 -ffunction-sections -fdata-sections '--cuda-path=/usr/local/cuda-12.2' -g0 -w -g0 '-std=c++17' -c external/com_google_protobuf/src/google/protobuf/compiler/main.cc -o bazel-out/k8-opt-exec-50AE0418/bin/external/com_google_protobuf/_objs/protoc/main.o)
# Configuration: be1b6d30ad6b895c5d0cb4e11b08ee9fdfd7ce804f01eb0679a5e177ceb7e39b
# Execution platform: @local_execution_config_platform//:platform
INFO: Elapsed time: 0.200s, Critical Path: 0.08s
INFO: 44 processes: 42 internal, 2 local.
FAILED: Build did NOT complete successfully


### Standalone code to reproduce the issue

```shell
bazel build //tensorflow/tools/pip_package:build_pip_package --verbose_failures
```


### Relevant log output

_No response_",False
TensorFlow.js: export failure ❌ 0.6s: [Errno 2] No such file or directory: 'tensorflowjs_converter' stat:awaiting response stale TFLiteConverter,"System information

OS Platform and Distribution (e.g., Linux Ubuntu 16.04): MAC OS
TensorFlow installed from (source or binary): binray
TensorFlow version (use command below): 2.13.0
TensorFlowJS version: 4.11.0
Python version: 3.9
When I using tensorflowjs_converter to convert pt model:

TensorFlow SavedModel: export success ✅ 29.7s, saved as yolov5n-seg_saved_model (7.9 MB)

TensorFlow GraphDef: starting export with tensorflow 2.13.0...
TensorFlow GraphDef: export success ✅ 3.7s, saved as yolov5n-seg.pb (7.9 MB)
WARNING ⚠️ invalid check_version(4.11.0, ) requested, please check values.

TensorFlow.js: starting export with tensorflowjs 4.11.0...
TensorFlow.js: export failure ❌ 0.6s: [Errno 2] No such file or directory: 'tensorflowjs_converter'

tensorflowjs_converter not founded",False
TF 2.12: InternalError: cudaGetDevice() failed. Status: CUDA driver version is insufficient for CUDA runtime version type:build/install subtype: ubuntu/linux TF 2.12,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

TF 2.12

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 16.04

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11.8

### GPU model and memory

GTX970

### Current behavior?


I have install `pip install tensorflow ==2.12`. 
I followed the page: https://www.tensorflow.org/install/pip
and install 
`conda install -c conda-forge cudatoolkit=11.8.0` and
`nvidia-cudnn-cu11==8.6.0.163`
From the build from source it says that it requires cuda 11.8 
This is determined here `nvcc -version`.
```
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2022 NVIDIA Corporation
Built on Wed_Sep_21_10:33:58_PDT_2022
Cuda compilation tools, release 11.8, V11.8.89
Build cuda_11.8.r11.8/compiler.31833905_0
```

I tried to see if it is using GPU and it does. 

``` 2023-09-22 13:17:18.164612: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-09-22 13:17:18.813461: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2023-09-22 13:17:21.116323: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-09-22 13:17:21.117135: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-09-22 13:17:21.117901: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-09-22 13:17:21.118662: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-09-22 13:17:21.141750: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-09-22 13:17:21.142582: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-09-22 13:17:21.143350: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-09-22 13:17:21.144117: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-09-22 13:17:21.144878: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-09-22 13:17:21.145642: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-09-22 13:17:21.146398: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-09-22 13:17:21.147155: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:2', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:3', device_type='GPU')] ```

However, when I tried to create a neural network: 
It gives me the following error: 

```shell
Traceback (most recent call last):
  File ""/home/trevor/distinguisher/main.py"", line 73, in <module>
    net_pp = train_preprocessor_triplet_loss(n=10000, nr=num_rounds, epochs=epoch)
  File ""/home/trevor/distinguisher/main.py"", line 53, in train_preprocessor_triplet_loss
    net_pp = make_resnet_preprocess(depth=1)
  File ""/home/trevor/distinguisher/main.py"", line 26, in make_resnet_preprocess
    conv0 = Conv1D(num_filters, kernel_size=1, padding='same', kernel_regularizer=l2(reg_param))(perm)
  File ""/home/trevor/anaconda3/envs/tf_2/lib/python3.9/site-packages/keras/utils/traceback_utils.py"", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File ""/home/trevor/anaconda3/envs/tf_2/lib/python3.9/site-packages/keras/backend.py"", line 2101, in random_uniform
    return tf.random.stateless_uniform(
tensorflow.python.framework.errors_impl.InternalError: cudaGetDevice() failed. Status: CUDA driver version is insufficient for CUDA runtime version
```

I have searched online and say that the CUDA version is too high but from build it seems to be 11.8.
May I know what is the issue here? 







### Standalone code to reproduce the issue

```shell
def make_resnet_preprocess(num_blocks=2, num_filters=32, num_outputs=1, d1=64, d2=64, word_size=16, ks=3, depth=5,
                           reg_param=0.0001, final_activation='sigmoid'):
    # Input and preprocessing layers
    inp = Input(shape=(num_blocks * word_size * 2,))
    rs = Reshape((2 * num_blocks, word_size))(inp)
    perm = Permute((2, 1))(rs)
    # add a single residual layer that will expand the data to num_filters channels
    # this is a bit-sliced layer
    conv0 = Conv1D(num_filters, kernel_size=1, padding='same', kernel_regularizer=l2(reg_param))(perm)
    conv0 = BatchNormalization()(conv0)
    conv0 = Activation('relu')(conv0)
    # add residual blocks
    shortcut = conv0
    for i in range(depth):
        conv1 = Conv1D(num_filters, kernel_size=ks, padding='same', kernel_regularizer=l2(reg_param))(shortcut)
        conv1 = BatchNormalization()(conv1)
        conv1 = Activation('relu')(conv1)
        conv2 = Conv1D(num_filters, kernel_size=ks, padding='same', kernel_regularizer=l2(reg_param))(conv1)
        conv2 = BatchNormalization()(conv2)
        conv2 = Activation('relu')(conv2)
        shortcut = Add()([shortcut, conv2])
    # add prediction head
    flat1 = Flatten()(shortcut)
    dense1 = Dense(d1, kernel_regularizer=l2(reg_param))(flat1)
    dense1 = BatchNormalization()(dense1)
    dense1 = Activation('relu')(dense1)
    dense2 = Dense(d2, kernel_regularizer=l2(reg_param))(dense1)
    dense2 = BatchNormalization()(dense2)
    out = Activation('relu')(dense2)
    # out = Dense(num_outputs, activation=final_activation, kernel_regularizer=l2(reg_param))(dense2)
    model = Model(inputs=inp, outputs=out)
    return (model)
net_pp = train_preprocessor_triplet_loss(n=10 ** 7, nr=num_rounds, epochs=epoch)
```


### Relevant log output

```shell
Traceback (most recent call last):
  File ""/home/trevor/distinguisher/main.py"", line 73, in <module>
    net_pp = train_preprocessor_triplet_loss(n=10000, nr=num_rounds, epochs=epoch)
  File ""/home/trevor/distinguisher/main.py"", line 53, in train_preprocessor_triplet_loss
    net_pp = make_resnet_preprocess(depth=1)
  File ""/home/trevor/distinguisher/main.py"", line 26, in make_resnet_preprocess
    conv0 = Conv1D(num_filters, kernel_size=1, padding='same', kernel_regularizer=l2(reg_param))(perm)
  File ""/home/trevor/anaconda3/envs/tf_2/lib/python3.9/site-packages/keras/utils/traceback_utils.py"", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File ""/home/trevor/anaconda3/envs/tf_2/lib/python3.9/site-packages/keras/backend.py"", line 2101, in random_uniform
    return tf.random.stateless_uniform(
tensorflow.python.framework.errors_impl.InternalError: cudaGetDevice() failed. Status: CUDA driver version is insufficient for CUDA runtime version```
```
",False
The metrics values in fit and in evaluate do not match (tf+keras) type:support comp:keras TF 2.9,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.9

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu

### Mobile device

_No response_

### Python version

3.8

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I have the issue which I described under in detail. Might be it's a my mistake but I try to fix it not a one day.

I simplified it as much as possible fitting the model to show you exactly an issue.

Let it be not a pre-trained model ResNet50. And let's I provide a dataset by easy way where X_train and Y_train are the ndarray with correspond shapes [N, 32, 32, 3] and [N, class_num=3].

I set batch_size=128, shuffle=False. Now I fitting my model and after the last epoch I get the metric equals 0.976, BUT If I just make model.evaluate(X_train), where X_train is the same data I use in fit I get absolutely different value - 0.456. The question is - WHY?

That's logs of my fitting: 263/263 [==============================] - 7s 27ms/step - loss: 0.2063 - auc: 0.9899 - mc_f1: 0.9326

That's after evaluate: 1052/1052 [==============================] - 11s 9ms/step - loss: 0.6186 - auc: 0.9053 - mc_f1: 0.4993

To prevent questions - mc_f1 is a custom metric - averaged f1 calculated for each class separately for the multiclass case.

So the code:

    # Change last layers
    last_layer = model.output
    output = tf.keras.layers.Dense(classes, activation=""softmax"")(last_layer)
    model = tf.keras.models.Model(inputs=model.inputs, outputs=output)

    return model


mcf1 = MulticlassF1(num_classes=3)

resnet50 = get_resnet50_model([32, 32, 3], 3)
resnet50.compile(
    optimizer=Adam(),
    loss=tf.keras.losses.CategoricalCrossentropy(),
    metrics=[tf.metrics.AUC(name='auc'), mcf1],
)
```


Fitting:

```
deb_metric_callback = DebugMetricCallback(resnet50, (X_train, Y_train), mcf1)
resnet50.fit(
    X_train, Y_train,
    epochs=100,
    batch_size=128,
    # verbose=0,
    shuffle=False,
    callbacks=[deb_metric_callback],
)
```

I have the issue which I described under in detail. Might be it's a my mistake but I try to fix it not a one day.

I simplified it as much as possible fitting the model to show you exactly an issue.

Let it be not a pre-trained model ResNet50. And let's I provide a dataset by easy way where X_train and Y_train are the ndarray with correspond shapes [N, 32, 32, 3] and [N, class_num=3].

I set batch_size=128, shuffle=False. Now I fitting my model and after the last epoch I get the metric equals 0.976, BUT If I just make model.evaluate(X_train), where X_train is the same data I use in fit I get absolutely different value - 0.456. The question is - WHY?

That's logs of my fitting: 263/263 [==============================] - 7s 27ms/step - loss: 0.2063 - auc: 0.9899 - mc_f1: 0.9326

That's after evaluate: 1052/1052 [==============================] - 11s 9ms/step - loss: 0.6186 - auc: 0.9053 - mc_f1: 0.4993

To prevent questions - mc_f1 is a custom metric - averaged f1 calculated for each class separately for the multiclass case.

So the code:

The metric:
```

class MulticlassF1(tf.keras.metrics.Metric):

    def __init__(self, name='mc_f1', num_classes=None, **kwargs):
        super(MulticlassF1, self).__init__(name=name, **kwargs)
        self.__zero_support = tf.cast(1e-7, dtype=tf.float16)
        self.__cm = self.add_weight(name='fn', initializer='zeros', shape=[num_classes, num_classes])
        if num_classes is not None:
            self.__num_classes = num_classes

    def update_state(self, y_true, y_pred, sample_weight=None):
        y_pred = K.argmax(y_pred, axis=1)
        y_true = K.argmax(y_true, axis=1)
        m = tf.math.confusion_matrix(y_true, y_pred, num_classes=self.__num_classes, dtype=tf.float32)
        self.__cm.assign_add(m)

    def reset_state(self):
        self.__cm.assign(tf.zeros((self.__num_classes, self.__num_classes)))

    def result(self):
        denominator = 0
        m = self.__cm
        for i in range(m.shape[0]):
            tp = m[i, i]
            fn = K.sum(m[:, i]) - tp
            fp = K.sum(m[i, :]) - tp
            tn = K.sum(K.flatten(m)) - (tp + fn + fp)
            tp = K.cast(tp, dtype=tf.float16)
            tn = K.cast(tn, dtype=tf.float16)
            fp = K.cast(fp, dtype=tf.float16)
            fn = K.cast(fn, dtype=tf.float16)
            precision = tp / ((tp + fp) + self.__zero_support) + self.__zero_support
            recall = tp / (tf.cast(tp + fn, dtype=tf.float16) + self.__zero_support) + self.__zero_support
            denominator += (1 / precision + 1 / recall)
        f1_combined = K.cast(2 * m.shape[0] / denominator, dtype=tf.float32)
        return f1_combined
```
The model declaration

```
def get_resnet50_model(window_size, classes):
    # Model initialization
    model = tf.keras.applications.ResNet50V2(
        include_top=False,
        weights=None,
        input_tensor=None,
        input_shape=window_size,
        pooling='max',
        classes=classes,

    )

    # Change last layers
    last_layer = model.output
    output = tf.keras.layers.Dense(classes, activation=""softmax"")(last_layer)
    model = tf.keras.models.Model(inputs=model.inputs, outputs=output)

    return model


mcf1 = MulticlassF1(num_classes=3)

resnet50 = get_resnet50_model([32, 32, 3], 3)
resnet50.compile(
    optimizer=Adam(),
    loss=tf.keras.losses.CategoricalCrossentropy(),
    metrics=[tf.metrics.AUC(name='auc'), mcf1],
)
```
Fitting:

```
deb_metric_callback = DebugMetricCallback(resnet50, (X_train, Y_train), mcf1)
resnet50.fit(
    X_train, Y_train,
    epochs=100,
    batch_size=128,
    # verbose=0,
    shuffle=False,
    callbacks=[deb_metric_callback],
)
```
I tried to do some debug and make a CallBack:

```
class DebugMetricCallback(Callback):
    def __init__(self, test, metr):
        super().__init__()
        self.test = test
        self.metric = metr


    def on_epoch_end(self, epoch, logs=None):
        print(self.metric.result())
        x, y = self.test
        y_pred = self.model.predict(x)
        inline_measure = MulticlassF1(num_classes=3)
        inline_measure.update_state(y, y_pred)
        print(self.metric.result().numpy(), inline_measure.result().numpy())
```

Here I get absolutely different confusion matrices.

Also I thought that this is the problem with BatchNormalization, but I save and compare model before and after evaluate it wasn't changed.

### Standalone code to reproduce the issue

```shell
https://github.com/xxraytz/temp.git
```


### Relevant log output

_No response_",False
"TF Lite runtime error: ""Didn't find op for builtin opcode 'PLACEHOLDER_FOR_GREATER_OP_CODES' version '1'"" stat:awaiting response comp:lite TFLiteConverter TF 2.13","### 1. System information

- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Windows 11, Python 3.10.11
- TensorFlow installation (pip package or built from source): pip
- TensorFlow library (version, if pip package or github SHA, if built from source): 2.13.0

### 2. Code

Repro steps:

1) Download the `lite-model_efficientnet_lite4_uint8_2.tflite` model from here: https://tfhub.dev/tensorflow/lite-model/efficientnet/lite4/uint8/2 (click the 14.34Mb download [link](https://tfhub.dev/tensorflow/lite-model/efficientnet/lite4/uint8/2?lite-format=tflite) ; leave this page open in your browser)
2) Start a TF Lite application using Android or Flutter. I use Flutter and the latest ML Kit.
3) Use the model in your code : it works perfectly fine.
4) Back in your browser, now click the `TF` tab on the left side on the page your left open. The TF tab allows you to download the TF (not TF lite) version of the model. Download the 46.61Mb model file `efficientnet_lite4_classification_2.tar.gz` ([here](https://tfhub.dev/tensorflow/efficientnet/lite4/classification/2)). Uncompress this archive into a `saved_model` folder somewhere.
5) Use the following code to convert the TF model into a TF Lite model;

```
converter = tf.lite.TFLiteConverter.from_saved_model(saved_model_dir, tags='train')
converter.optimizations = [tf.lite.Optimize.DEFAULT]
tflite_model = converter.convert()
outputPath = os.path.join(cur_dir, 'tf_converted_to_tflite.tflite')
fo = open(outputPath, ""wb"")
fo.write(tflite_model)
fo.close()
```
6) Following the instructions from https://www.tensorflow.org/lite/models/convert/metadata, add model metadata by using `metadata_writer_for_image_classifier.py`, and with the following model specification (updated lines ~60 to 70, as instructed):

```
_MODEL_INFO = {
    ""tf_converted_to_tflite.tflite"":
        ModelSpecificInfo(
            name=""EfficientNetB4 image classifier"",
            version=""v1"",
            image_width=380, # As specified in the TF tab in the web page (not the TF Lite tab, which input dimension is listed as 300x300)
            image_height=380, #
            image_min=0,
            image_max=255,
            mean=[127.5],
            std=[127.5],
            num_classes=1000,
            author=""TensorFlow"")
}
```
The processing completes normally.

7) Now use that model `tf_converted_to_tflite.tflite` instead of the original, readily-available TF Lite model available on TF Hub, `lite-model_efficientnet_lite4_uint8_2.tflite` (that was working fine).
In other words, we are now trying to use approximately the same model, except that this time we ran the TF -> TF Lite model conversion ourselves (quantization is a bit different, but it does not matter at all).
8) Run the same application. The following PlatformException is raised:

```
""com.google.mlkit.common.MlKitException: Failed to initialize detector.
Didn't find op for builtin opcode 'PLACEHOLDER_FOR_GREATER_OP_CODES' version '1'.
An older version of this builtin might be supported.
Are you using an old TFLite binary with a newer model?
```

### 3. Failure after conversion

I would expect the conversion process and runtime behavior to be smooth considered the model is hosted on TF Hub: the TF Lite model proposed by TF Hub works fine, but if I manually convert the TF model myself, it doesn't.
Is there anything wrong in the above conversion code? I have been debugging this for days, to no avail.
I have another (custom) model with a similar bug, and so far this is the best repro I could build.

### 4. First investigations

One thing I figured is that I should try to use the same version of TensorFlow on my PC and on my embedded system - as suggested in the following post from the TensorFlow Team:

https://discuss.tensorflow.org/t/tensorflowlite-error-didnt-find-op-for-builtin-opcode-softmax-version-1-an-older-version-of-this-builtin-might-be-supported-are-you-using-an-old-tflite-binary-with-a-newer-model/3885/6

Currently I am using TensorFlow 2.13.0 on my PC, however, how can I determine the version used in Flutter ? I use ML Kit on the Flutter side, which uses, on Android, the following Maven artifact:

https://mvnrepository.com/artifact/com.google.mlkit/image-labeling-custom/17.0.1

Which TF version is this artifact using?
",False
lite hexagon后端ResizeNearestNeighbor算子层执行报错 comp:lite,"**System information**
- OS Platform and Distribution ：Linux Ubuntu 18.04
- TensorFlow installed from (github):
- TensorFlow version (dev分支):


**Provide the text output from tflite_convert**
none

**Standalone code to reproduce the issue** 

tensorflow/lite/delegates/hexagon/builders/resize_nearest_neighbor_builder.cc

**Any other info / logs**
STARTING!
Duplicate flags: num_threads
Log parameter values verbosely: [0]
Min num runs: [1]
Graph: [/home/wangzhiqun/yolox_resize_nearest_neighbor.tflite]
Use Hexagon: [1]
Loaded model /home/wangzhiqun/yolox_resize_nearest_neighbor.tflite
INFO: Initialized TensorFlow Lite runtime.
Hexagon delegate created.
INFO: TfLiteHexagonDelegate delegate: 1 nodes delegated out of 1 nodes with 1 partitions.

INFO: Replacing 1 node(s) with delegate (TfLiteHexagonDelegate) node, yielding 1 partitions.
[hexagon/nn] Add Node: tid(-1) nid(1)
[hexagon_nn] hexagon_nn_append_const_node(gid=1 tid=2 nid=2 type=0x3)
[hexagon/nn] Add Node from Op(331) mid(0) nid(3)
[hexagon_nn] hexagon_nn_append_const_node(gid=1 nid=4 type=0x3)
[hexagon_nn] hexagon_nn_append_const_node(gid=1 nid=5 type=0x3)
[hexagon/nn] Add Node: tid(-1) nid(6)
[hexagon_nn] hexagon_nn_append_node(gid=1 nid=1 type=0x0)
[hexagon_nn] hexagon_nn_append_node(nis=0 nos=1)
[hexagon_nn] hexagon_nn_append_node(outputs[0].elementsize=1)
[hexagon_nn] hexagon_const_node(gid=1 nid=2 type=0x3)
[hexagon_nn] hexagon_nn_append_node(gid=1 nid=3 type=0x14b)
[hexagon_nn] hexagon_nn_append_node(nis=6 nos=3)
Error adding node: id:3, op_type:331
[hexagon_nn] hexagon_const_node(gid=1 nid=4 type=0x3)
[hexagon_nn] hexagon_const_node(gid=1 nid=5 type=0x3)
[hexagon_nn] hexagon_nn_append_node(gid=1 nid=6 type=0x1)
[hexagon_nn] hexagon_nn_append_node(nis=1 nos=0)
----------------
Timestamp: Thu Sep 21 08:06:06 2023


Log
hexagon/src/newnode.c:413:node 3 (ResizeNearestNeighbor_8): bad input count 6
hexagon/src/newnode.c:763:node id=0x3 ctor fail
hexagon/src/prepare.c:4830:input 0x6:0 refers to nonexistent node 0x3
hexagon/src/prepare.c:4644:can't find id 0x3

----------------
ERROR: Failed: Failed to prepare graph.
.
ERROR: Node number 1 (TfLiteHexagonDelegate) failed to prepare.
ERROR: Restored original execution plan after delegate application failure.
Failed to apply Hexagon delegate.
Benchmarking failed.

",False
lite hexagon后端ResizeNearestNeighbor算子层执行报错 comp:lite TFLiteHexagonDelegate,"hexagon/src/newnode.c:413:node 3 (ResizeNearestNeighbor_8): bad input count 6
hexagon/src/newnode.c:763:node id=0x3 ctor fail
hexagon/src/prepare.c:4830:input 0x6:0 refers to nonexistent node 0x3
hexagon/src/prepare.c:4644:can't find id 0x3

----------------
ERROR: Failed: Failed to prepare graph.
.
ERROR: Node number 1 (TfLiteHexagonDelegate) failed to prepare.
ERROR: Restored original execution plan after delegate application failure.
Failed to apply Hexagon delegate.
Benchmarking failed.

",False
Can't get optimizer to apply gradients with Keras and DTensor based model type:support comp:keras comp:tf.function,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13.0 (also tried with 2.9.1)

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 16.04

### Mobile device

_No response_

### Python version

3.8

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Trying to do distributed training, for a rather wide model, with DTensors and Keras. I'm creating an Adam optimizer, trying to update it manually with the following code for a custom DTensor training step (this is within my own model object, with self.model being a Keras model):

 ```
  @tf.function
    def train_step(self, x, y, w, optimizer, train_metrics): 
        if not self.init:   # this runs once to initialize the model variables
            self.model(x)
            self.init = True 
        with tf.GradientTape() as tape:
            logits = self.model(x, training=True)
            logits = tf.reshape(logits, (logits.shape[1], logits.shape[0]))
            loss = tf.reduce_sum(tf.math.multiply(
                tf.keras.losses.binary_crossentropy(
                    y, logits, from_logits=True), w))
        gradients = tape.gradient(loss, self.model.trainable_variables)

        optimizer.apply_gradients(zip(gradients, self.model.trainable_variables))

        loss_per_sample = loss / len(x)
        results = {'loss': loss_per_sample}
        for metric in train_metrics.values():
            metric.update_state(y_true=y, y_pred=logits)
        return results 
        
    def dtensor_fit(        
        self,
        x_train,
        y_train,
        x_val,
        y_val,
        w_train=None):
        num_epochs = 5
        train_metrics = {
            ""accuracy"" : metrics.Accuracy(),
            ""tp"": metrics.TruePositives(),
            ""fp"": metrics.FalsePositives(),
            ""fn"": metrics.FalseNegatives(),
            ""tn"": metrics.TrueNegatives(),
            ""auc"": metrics.AUC(curve=""PR""),
        }
        optimizer = tf.keras.dtensor.experimental.optimizers.Adam(mesh=self.mesh)

        eval_metrics = dict(train_metrics)   
        for epoch in range(num_epochs):
            print(""============================"") 
            print(""Epoch: "", epoch)
            for metric in train_metrics.values():
                metric.reset_state()
            step = 0
            results = {}
            pbar = tf.keras.utils.Progbar(target=None, stateful_metrics=[])
            def batch(x, y, w, n):
                num_samples = x.shape[0]
                l = 0
                while l < num_samples:
                    yield x[l:l+n], y[l:l+n], w[l:l+n]
                    l += n
            self.init = False
            for inputs, labels, weights in batch(x_train, y_train, w_train, NNModel.BATCH_SIZE):
                indices = np.transpose(inputs.nonzero())
                inputs.eliminate_zeros()
                values = inputs.data
                inputs, labels, weights = self.pack_dtensor_inputs(
                    tf.SparseTensor(indices=indices, values=values, dense_shape=(inputs.shape[0], self.input_size)),
                    tf.convert_to_tensor([labels], dtype =tf.bfloat16),
                    tf.convert_to_tensor([weights], dtype=tf.bfloat16), self.input_layout, self.label_layout, self.weight_layout)
                optimizer.build(self.model.trainable_variables)

                results.update(self.train_step(inputs, labels, weights, optimizer, train_metrics))
                for metric_name, metric in train_metrics.items():
                    results[metric_name] = metric.result()

                pbar.update(step, values=results.items(), finalize=False)
                step += 1 
``` 

I get the following error when I reach the apply_gradients step in the train_step function:

ValueError: in user code:

```
File ""/usr/local/home/bill/.cache/bazel/_bazel_bill/254c50c69c3701cca4e904bef759573b/execroot/_main/bazel-out/k8-fastbuild/bin/keystone/training/training.runfiles/_main/keystone/training/model.py"", line 263, in train_step  *
    optimizer.apply_gradients(zip(gradients, self.model.trainable_variables))
File ""/usr/local/home/bill/.cache/bazel/_bazel_bill/254c50c69c3701cca4e904bef759573b/execroot/_main/bazel-out/k8-fastbuild/bin/keystone/training/training.runfiles/rules_python~0.21.0~pip~pip_keras/site-packages/keras/dtensor/optimizers.py"", line 141, in apply_gradients  **
    optimizer_lib._BaseOptimizer.apply_gradients(self, grads_and_vars)
File ""/usr/local/home/bill/.cache/bazel/_bazel_bill/254c50c69c3701cca4e904bef759573b/execroot/_main/bazel-out/k8-fastbuild/bin/keystone/training/training.runfiles/rules_python~0.21.0~pip~pip_keras/site-packages/keras/optimizers/optimizer.py"", line 650, in apply_gradients
    iteration = self._internal_apply_gradients(grads_and_vars)
File ""/usr/local/home/bill/.cache/bazel/_bazel_bill/254c50c69c3701cca4e904bef759573b/execroot/_main/bazel-out/k8-fastbuild/bin/keystone/training/training.runfiles/rules_python~0.21.0~pip~pip_keras/site-packages/keras/dtensor/optimizers.py"", line 153, in _internal_apply_gradients
    optimizer_lib._BaseOptimizer._internal_apply_gradients(
File ""/usr/local/home/bill/.cache/bazel/_bazel_bill/254c50c69c3701cca4e904bef759573b/execroot/_main/bazel-out/k8-fastbuild/bin/keystone/training/training.runfiles/rules_python~0.21.0~pip~pip_keras/site-packages/keras/optimizers/optimizer.py"", line 680, in _internal_apply_gradients
    self._update_step(grad, var)
File ""/usr/local/home/bill/.cache/bazel/_bazel_bill/254c50c69c3701cca4e904bef759573b/execroot/_main/bazel-out/k8-fastbuild/bin/keystone/training/training.runfiles/rules_python~0.21.0~pip~pip_keras/site-packages/keras/optimizers/optimizer.py"", line 240, in _update_step
    self.update_step(gradient, variable)
File ""/usr/local/home/bill/.cache/bazel/_bazel_bill/254c50c69c3701cca4e904bef759573b/execroot/_main/bazel-out/k8-fastbuild/bin/keystone/training/training.runfiles/rules_python~0.21.0~pip~pip_keras/site-packages/keras/optimizers/adam.py"", line 194, in update_step
    m.assign_add((gradient - m) * (1 - self.beta_1))

ValueError: Dimensions must be equal, but are 5 and 0 for '{{node sub_2}} = Sub[T=DT_FLOAT](gradient_tape/keystone/feature/MatMul_1/Cast/Cast, sub_2/ReadVariableOp)' with input shapes: [8299614,5], [0].

```
It looks like the optimizer momentums are not of the correct shape. I tried explicitly adding `optimizer.build(self.model.trainable_variables) `after the `self.model(x)` in `train_step` to force correct population, but the variables are still wrong.

I have seen the same results with TF versions 2.9.1 and 2.13.0.

Is this a bug? How do I get the optimizer to be correctly set up for training?



### Standalone code to reproduce the issue

```shell
see above
```


### Relevant log output

_No response_",False
Failure to create build_pip_package Ubuntu 22.04 LTS / Python 3.10 / Cuda 11.7 stat:awaiting response type:build/install stale subtype: ubuntu/linux TF 2.9,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.9.1

### Custom code

No

### OS platform and distribution

Ubuntu 22.04 LTS

### Mobile device

/

### Python version

3.10

### Bazel version

5.0.0

### GCC/compiler version

11.4.0

### CUDA/cuDNN version

11.7/8.5.0

### GPU model and memory

RTX A6000, GTX 1070

### Current behavior?

I've installed CUDA 11.7 toolkit only and libcudnn 8.5.0 on Ubuntu 22.04 LTS.
I'm using python 3.10 using the `python3.10` cmd.

Here's the script I'm running

```bash
export PATH=$PATH:/usr/local/cuda-11.7/bin
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda-11.7/lib64
export TF_CUDA_VERSION=11.7
export TF_CUDNN_VERSION=8.5.0
export TF_CUBLAS_VERSION=11.10.1

python3.10 -m virtualenv venv
venv/bin/pip install numpy==1.23.5 wheel packaging requests opt_einsum
venv/bin/pip install keras_preprocessing --no-deps

mkdir tmp
cd tmp
git clone https://github.com/tensorflow/tensorflow.git
cd tensorflow
git checkout v2.9.1

cd ..
. venv/bin/activate
cd tmp/tensorflow
./configure  # No ROCm, Yes CUDA, No TensorRT, 3.5,5.2,6.0,6.1,7.0,7.5,8.0 capabilities, No clang, default for the rest

bazel build --config=opt --verbose_failures //tensorflow:libtensorflow_cc.so

bazel build --config=opt --verbose_failures //tensorflow:install_headers

bazel build --config=opt --verbose_failures //tensorflow/tools/pip_package:build_pip_package  # Failure here

./bazel-bin/tensorflow/tools/pip_package/build_pip_package ./bazel-bin/tensorflow/tools/pip_package
```

The output of `bazel build --config=opt --verbose_failures //tensorflow/tools/pip_package:build_pip_package` is available in the relevant log output section.

The interesting line seems to be:
```
cp: cannot stat '/home/cluster/CN_TF/ContextCapture/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/_dtype_api.h': No such file or directory
```
Indeed this file does not exist. I'm unsure why it is needed, but I tried different `numpy` version and failed to find one that works (either I'm missing this file, or `.doxyfile` or something else).

Can you advise which version of numpy should I be using for the compilation to be successful?

### Standalone code to reproduce the issue

```shell
I'm using vanilla Tensorflow checkout, no modifications are applied.
```


### Relevant log output

```shell
INFO: Options provided by the client:
  Inherited 'common' options: --isatty=1 --terminal_columns=116
INFO: Reading rc options for 'build' from /home/cluster/work/ThirdParty/Tensorflow/distrib/tmp/tensorflow/.bazelrc:
  Inherited 'common' options: --experimental_repo_remote_exec
INFO: Reading rc options for 'build' from /home/cluster/work/ThirdParty/Tensorflow/distrib/tmp/tensorflow/.bazelrc:
  'build' options: --define framework_shared_object=true --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone -c opt --announce_rc --define=grpc_no_ares=true --noincompatible_remove_legacy_whole_archive --enable_platform_specific_config --define=with_xla_support=true --config=short_logs --config=v2 --define=no_aws_support=true --define=no_hdfs_support=true --experimental_cc_shared_library
INFO: Reading rc options for 'build' from /home/cluster/work/ThirdParty/Tensorflow/distrib/tmp/tensorflow/.tf_configure.bazelrc:
  'build' options: --action_env PYTHON_BIN_PATH=/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/bin/python3 --action_env PYTHON_LIB_PATH=/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages --python_path=/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/bin/python3 --action_env TF_CUDA_VERSION=11.7 --action_env TF_CUBLAS_VERSION=11.10.1 --action_env TF_CUDNN_VERSION=8.5.0 --action_env CUDA_TOOLKIT_PATH=/usr/local/cuda-11.7 --action_env TF_CUDA_COMPUTE_CAPABILITIES=3.5,5.2,6.0,6.1,7.0,7.5,8.0 --action_env LD_LIBRARY_PATH=:/usr/local/cuda-11.7/lib64 --action_env GCC_HOST_COMPILER_PATH=/usr/bin/x86_64-linux-gnu-gcc-11 --config=cuda
INFO: Reading rc options for 'build' from /home/cluster/work/ThirdParty/Tensorflow/distrib/tmp/tensorflow/.bazelrc:
  'build' options: --deleted_packages=tensorflow/compiler/mlir/tfrt,tensorflow/compiler/mlir/tfrt/benchmarks,tensorflow/compiler/mlir/tfrt/jit/python_binding,tensorflow/compiler/mlir/tfrt/jit/transforms,tensorflow/compiler/mlir/tfrt/python_tests,tensorflow/compiler/mlir/tfrt/tests,tensorflow/compiler/mlir/tfrt/tests/ir,tensorflow/compiler/mlir/tfrt/tests/analysis,tensorflow/compiler/mlir/tfrt/tests/jit,tensorflow/compiler/mlir/tfrt/tests/lhlo_to_tfrt,tensorflow/compiler/mlir/tfrt/tests/tf_to_corert,tensorflow/compiler/mlir/tfrt/tests/tf_to_tfrt_data,tensorflow/compiler/mlir/tfrt/tests/saved_model,tensorflow/compiler/mlir/tfrt/transforms/lhlo_gpu_to_tfrt_gpu,tensorflow/core/runtime_fallback,tensorflow/core/runtime_fallback/conversion,tensorflow/core/runtime_fallback/kernel,tensorflow/core/runtime_fallback/opdefs,tensorflow/core/runtime_fallback/runtime,tensorflow/core/runtime_fallback/util,tensorflow/core/tfrt/common,tensorflow/core/tfrt/eager,tensorflow/core/tfrt/eager/backends/cpu,tensorflow/core/tfrt/eager/backends/gpu,tensorflow/core/tfrt/eager/core_runtime,tensorflow/core/tfrt/eager/cpp_tests/core_runtime,tensorflow/core/tfrt/gpu,tensorflow/core/tfrt/run_handler_thread_pool,tensorflow/core/tfrt/runtime,tensorflow/core/tfrt/saved_model,tensorflow/core/tfrt/graph_executor,tensorflow/core/tfrt/saved_model/tests,tensorflow/core/tfrt/tpu,tensorflow/core/tfrt/utils
INFO: Found applicable config definition build:short_logs in file /home/cluster/work/ThirdParty/Tensorflow/distrib/tmp/tensorflow/.bazelrc: --output_filter=DONT_MATCH_ANYTHING
INFO: Found applicable config definition build:v2 in file /home/cluster/work/ThirdParty/Tensorflow/distrib/tmp/tensorflow/.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1
INFO: Found applicable config definition build:cuda in file /home/cluster/work/ThirdParty/Tensorflow/distrib/tmp/tensorflow/.bazelrc: --repo_env TF_NEED_CUDA=1 --crosstool_top=@local_config_cuda//crosstool:toolchain --@local_config_cuda//:enable_cuda
INFO: Found applicable config definition build:opt in file /home/cluster/work/ThirdParty/Tensorflow/distrib/tmp/tensorflow/.tf_configure.bazelrc: --copt=-Wno-sign-compare --host_copt=-Wno-sign-compare
INFO: Found applicable config definition build:linux in file /home/cluster/work/ThirdParty/Tensorflow/distrib/tmp/tensorflow/.bazelrc: --copt=-w --host_copt=-w --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include --define=PROTOBUF_INCLUDE_PATH=$(PREFIX)/include --cxxopt=-std=c++14 --host_cxxopt=-std=c++14 --config=dynamic_kernels --distinct_host_configuration=false --experimental_guard_against_concurrent_changes
INFO: Found applicable config definition build:dynamic_kernels in file /home/cluster/work/ThirdParty/Tensorflow/distrib/tmp/tensorflow/.bazelrc: --define=dynamic_loaded_kernels=true --copt=-DAUTOLOAD_DYNAMIC_KERNELS
INFO: Analyzed target //tensorflow/tools/pip_package:build_pip_package (236 packages loaded, 7837 targets configured).
INFO: Found 1 target...
ERROR: /home/cluster/.cache/bazel/_bazel_cluster/350d8f2feeb21f42226977fe6efcfb0a/external/local_config_python/BUILD:254:8: Executing genrule @local_config_python//:numpy_include failed: (Exit 1): bash failed: error executing command 
  (cd /home/cluster/.cache/bazel/_bazel_cluster/350d8f2feeb21f42226977fe6efcfb0a/execroot/org_tensorflow && \
  exec env - \
    CUDA_TOOLKIT_PATH=/usr/local/cuda-11.7 \
    GCC_HOST_COMPILER_PATH=/usr/bin/x86_64-linux-gnu-gcc-11 \
    LD_LIBRARY_PATH=:/usr/local/cuda-11.7/lib64 \
    PATH=/home/cluster/.cache/bazelisk/downloads/sha256/399eedb225cff7a13f9f027f7ea2aad02ddb668a8eb89b1d975d222e4dc12ed9/bin:/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/bin:/home/cluster/.vscode-server/bin/8b617bd08fd9e3fc94d14adb8d358b56e3f72314/bin/remote-cli:/home/cluster/.local/bin:/home/cluster/miniconda3/bin:/home/cluster/miniconda3/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/cuda-11.7/bin \
    PYTHON_BIN_PATH=/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/bin/python3 \
    PYTHON_LIB_PATH=/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages \
    TF2_BEHAVIOR=1 \
    TF_CUBLAS_VERSION=11.10.1 \
    TF_CUDA_COMPUTE_CAPABILITIES=3.5,5.2,6.0,6.1,7.0,7.5,8.0 \
    TF_CUDA_VERSION=11.7 \
    TF_CUDNN_VERSION=8.5.0 \
  /bin/bash -c 'source external/bazel_tools/tools/genrule/genrule-setup.sh; 
cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/.doxyfile"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/.doxyfile"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/__multiarray_api.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/__multiarray_api.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/__ufunc_api.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/__ufunc_api.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/_dtype_api.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/_dtype_api.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/_neighborhood_iterator_imp.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/_neighborhood_iterator_imp.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/_numpyconfig.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/_numpyconfig.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/_numpyconfig.h.in"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/_numpyconfig.h.in"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/arrayobject.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/arrayscalars.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/experimental_dtype_api.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/experimental_dtype_api.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/halffloat.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/halffloat.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/libdivide/LICENSE.txt"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/libdivide/LICENSE.txt"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/libdivide/libdivide.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/libdivide/libdivide.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/ndarrayobject.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/ndarraytypes.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/noprefix.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/noprefix.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_1_7_deprecated_api.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_3kcompat.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_3kcompat.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_common.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_common.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_cpu.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_cpu.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_endian.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_endian.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_interrupt.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_interrupt.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_math.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_math.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_no_deprecated_api.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_no_deprecated_api.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_os.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_os.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/numpyconfig.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/numpyconfig.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/old_defines.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/old_defines.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/oldnumeric.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/oldnumeric.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/random/bitgen.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/random/bitgen.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/random/distributions.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/random/distributions.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/ufuncobject.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/utils.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/utils.h""
   ')
# Configuration: d04d20a1a4a46df9c7580a4efee273c7e78fdcec51eaaa1a5c3a4ea89b71ce88
# Execution platform: @local_execution_config_platform//:platform
cp: cannot stat '/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/_dtype_api.h': No such file or directory
Target //tensorflow/tools/pip_package:build_pip_package failed to build
ERROR: /home/cluster/.cache/bazel/_bazel_cluster/350d8f2feeb21f42226977fe6efcfb0a/external/local_config_python/BUILD:66:11 Middleman _middlemen/@local_Uconfig_Upython_S_S_Cnumpy_Uheaders-BazelCppSemantics_build_arch_k8-opt failed: (Exit 1): bash failed: error executing command 
  (cd /home/cluster/.cache/bazel/_bazel_cluster/350d8f2feeb21f42226977fe6efcfb0a/execroot/org_tensorflow && \
  exec env - \
    CUDA_TOOLKIT_PATH=/usr/local/cuda-11.7 \
    GCC_HOST_COMPILER_PATH=/usr/bin/x86_64-linux-gnu-gcc-11 \
    LD_LIBRARY_PATH=:/usr/local/cuda-11.7/lib64 \
    PATH=/home/cluster/.cache/bazelisk/downloads/sha256/399eedb225cff7a13f9f027f7ea2aad02ddb668a8eb89b1d975d222e4dc12ed9/bin:/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/bin:/home/cluster/.vscode-server/bin/8b617bd08fd9e3fc94d14adb8d358b56e3f72314/bin/remote-cli:/home/cluster/.local/bin:/home/cluster/miniconda3/bin:/home/cluster/miniconda3/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/cuda-11.7/bin \
    PYTHON_BIN_PATH=/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/bin/python3 \
    PYTHON_LIB_PATH=/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages \
    TF2_BEHAVIOR=1 \
    TF_CUBLAS_VERSION=11.10.1 \
    TF_CUDA_COMPUTE_CAPABILITIES=3.5,5.2,6.0,6.1,7.0,7.5,8.0 \
    TF_CUDA_VERSION=11.7 \
    TF_CUDNN_VERSION=8.5.0 \
  /bin/bash -c 'source external/bazel_tools/tools/genrule/genrule-setup.sh; 
cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/.doxyfile"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/.doxyfile"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/__multiarray_api.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/__multiarray_api.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/__ufunc_api.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/__ufunc_api.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/_dtype_api.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/_dtype_api.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/_neighborhood_iterator_imp.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/_neighborhood_iterator_imp.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/_numpyconfig.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/_numpyconfig.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/_numpyconfig.h.in"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/_numpyconfig.h.in"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/arrayobject.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/arrayobject.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/arrayscalars.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/arrayscalars.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/experimental_dtype_api.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/experimental_dtype_api.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/halffloat.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/halffloat.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/libdivide/LICENSE.txt"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/libdivide/LICENSE.txt"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/libdivide/libdivide.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/libdivide/libdivide.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/ndarrayobject.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/ndarrayobject.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/ndarraytypes.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/ndarraytypes.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/noprefix.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/noprefix.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_1_7_deprecated_api.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_3kcompat.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_3kcompat.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_common.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_common.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_cpu.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_cpu.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_endian.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_endian.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_interrupt.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_interrupt.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_math.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_math.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_no_deprecated_api.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_no_deprecated_api.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/npy_os.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/npy_os.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/numpyconfig.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/numpyconfig.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/old_defines.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/old_defines.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/oldnumeric.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/oldnumeric.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/random/bitgen.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/random/bitgen.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/random/distributions.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/random/distributions.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/ufuncobject.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/ufuncobject.h"" && cp -f ""/home/cluster/work/ThirdParty/Tensorflow/distrib/venv/lib/python3.10/site-packages/numpy/core/include/numpy/utils.h"" ""bazel-out/k8-opt/bin/external/local_config_python/numpy_include/numpy/utils.h""
   ')
# Configuration: d04d20a1a4a46df9c7580a4efee273c7e78fdcec51eaaa1a5c3a4ea89b71ce88
# Execution platform: @local_execution_config_platform//:platform
INFO: Elapsed time: 136.025s, Critical Path: 44.21s
INFO: 977 processes: 370 internal, 607 local.
FAILED: Build did NOT complete successfully
```
",False
Build issue tenserflow 2.11.0 for tensorflow quantum stat:awaiting response type:build/install stale subtype:macOS TF 2.11,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.11.0

### Custom code

Yes

### OS platform and distribution

Mac OS M1

### Mobile device

_No response_

### Python version

3.9

### Bazel version

bazel 5.3.0

### GCC/compiler version

Apple clang version 14.0.3 (clang-1403.0.22.14.1) Target: arm64-apple-darwin22.5.0 Thread model: posix

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Trying to build package using bazel compiler, as given [here](https://www.tensorflow.org/quantum/install).  Fails to build the file. Gives the following output mentioned in log output, after running the given command.

Output: 
<img width=""1680"" alt=""Screenshot 2023-09-20 at 11 47 36"" src=""https://github.com/tensorflow/tensorflow/assets/69144860/e699f11d-fc31-49af-83b7-34e3330f3358"">


### Standalone code to reproduce the issue

```shell
bazel build -c opt --cxxopt=""-O3"" --cxxopt=""-march=native"" --cxxopt=""-std=c++17"" --cxxopt=""-D_GLIBCXX_USE_CXX11_ABI=1"" //tensorflow/tools/pip_package:build_pip_package
```


### Relevant log output

```shell
ERROR: /private/var/tmp/_bazel_gb/4de1e45218bdc87c870302861e9b2675/external/boringssl/BUILD:161:11: Compiling src/crypto/x509/t_x509.c [for host] failed: (Exit 1): cc_wrapper.sh failed: error executing command external/local_config_cc/cc_wrapper.sh -U_FORTIFY_SOURCE -fstack-protector -Wall -Wthread-safety -Wself-assign -Wunused-but-set-parameter -Wno-free-nonheap-object -fcolor-diagnostics ... (remaining 44 arguments skipped)
external/boringssl/src/crypto/x509/t_x509.c:321:18: error: variable 'l' set but not used [-Werror,-Wunused-but-set-variable]
    int ret = 0, l, i;
                 ^
1 error generated.
Target //tensorflow/tools/pip_package:build_pip_package failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 709.728s, Critical Path: 52.92s
INFO: 4419 processes: 1508 internal, 2911 local.
FAILED: Build did NOT complete successfully
```
",False
Keeping last layer names in Stacked Model stat:awaiting response type:feature stale comp:keras,"### Issue type

Feature Request

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13.0

### Custom code

No

### OS platform and distribution

macOS 13.4

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

When using Model Stacking, I would like to access the last layer in the last stacked model to pass individual loss functions to them
```python
# ------------------ Encoder ------------------
encoder_model = Model(inputs=all_inputs, outputs=latent_space, name=""encoder"")
# ... irrelevant code 

# ------------------ Decoder ------------------
# Output Layers
numeric_output = Dense(
    self.numeric_dim, activation=""linear"", name=""numeric_output"")(decoder2)
binary_output = Dense(
    self.binary_dim, activation=""sigmoid"", name=""binary_output"")(decoder2)

decoder_output = [numeric_output] + [binary_output]
decoder_model = Model(inputs=latent_input, outputs=decoder_output, name=""decoder"")

# ------------------ Autoencoder ------------------
autoencoder_output = decoder_model(encoder_model(all_inputs))
autoencoder = Model(inputs=all_inputs, outputs=pass_through_layers, name=""autoencoder"")

# This will not work:
losses = {
            ""numeric_output"": ""mse"",
            ""binary_output"": ""binary_crossentropy""
}
autoencoder.compile(optimizer=Adam(learning_rate=lr), loss=losses)
```

The last layer will be renamed to decoder1, decoder2, etc. 
It would be much nicer if there was some passthrough argument in a model that would allow referencing the last layer in the stacked model directly

### Standalone code to reproduce the issue

```shell
This will fail


import numpy as np
from tensorflow.keras.layers import Input, Dense
from tensorflow.keras.models import Model
from tensorflow.keras.optimizers import Adam

# Input dimensions
input_dim = 10
latent_dim = 5
numeric_dim = 3
binary_dim = 2

# Learning rate
lr = 0.001

# Number of samples
n_samples = 1000

# Generate random data
X = np.random.rand(n_samples, input_dim)
y_numeric = np.random.rand(n_samples, numeric_dim)
y_binary = np.random.randint(0, 2, size=(n_samples, binary_dim))

# ------------------ Encoder ------------------
all_inputs = Input(shape=(input_dim,), name=""all_inputs"")
latent_space = Dense(latent_dim, activation=""relu"", name=""latent_space"")(all_inputs)
encoder_model = Model(inputs=all_inputs, outputs=latent_space, name=""encoder"")

# ------------------ Decoder ------------------
latent_input = Input(shape=(latent_dim,), name=""latent_input"")
decoder2 = Dense(10, activation=""relu"", name=""decoder2"")(latent_input)

numeric_output = Dense(numeric_dim, activation=""linear"", name=""numeric_output"")(decoder2)
binary_output = Dense(binary_dim, activation=""sigmoid"", name=""binary_output"")(decoder2)

decoder_output = [numeric_output, binary_output]
decoder_model = Model(inputs=latent_input, outputs=decoder_output, name=""decoder"")

# ------------------ Autoencoder ------------------
autoencoder_output = decoder_model(encoder_model(all_inputs))

# This will not work:
losses = {
    ""numeric_output"": ""mse"",
    ""binary_output"": ""binary_crossentropy""
}
autoencoder = Model(inputs=all_inputs, outputs=autoencoder_output, name=""autoencoder"")
autoencoder.compile(optimizer=Adam(learning_rate=lr), loss=losses)

# Fit the model
autoencoder.fit(
    x=X,
    y=[y_numeric, y_binary],
    epochs=10,
    batch_size=32
)
```


### Relevant log output

_No response_",False
Problem installing tensorflow 2.13.0 stat:awaiting response type:build/install stale subtype: ubuntu/linux TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.13.0

### Custom code

No

### OS platform and distribution

Linux Ubuntu 22.04, Lambda Labs TensorBook

### Mobile device

n/a

### Python version

3.11.5

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

8.6.0.163

### GPU model and memory

_No response_

### Current behavior?

TensorFlow 2.1.13 won't run because of an undefined symbol in libtensorflow_cc, apparently a google.protobuf.Message symbol.

### Standalone code to reproduce the issue

```shell
I am on a LambdaLabs TensorBook. This does come with a preloaded tensorflow installation in /usr/lib/python3/dist-packages
However my reading of the error messages on install does not seem to suggest that conflict with that package is to blame here.

Installing per instructions here: https://www.tensorflow.org/install/pip

~~~
conda create --name cuda11
conda activate cuda11
conda install python
conda install -c conda-forge cudatoolkit=11.8.0
python3 -m pip install nvidia-cudnn-cu11==8.6.0.163 tensorflow==2.13.
python3 -c ""import tensorflow""
~~~

...yields the following error message...

~~~
Traceback (most recent call last):
  File ""<string>"", line 1, in <module>
  File ""/home/yam/miniconda3/envs/cuda11/lib/python3.11/site-packages/tensorflow/__init__.py"", line 38, in <module>
    from tensorflow.python.tools import module_util as _module_util
  File ""/home/yam/miniconda3/envs/cuda11/lib/python3.11/site-packages/tensorflow/python/__init__.py"", line 36, in <module>
    from tensorflow.python import pywrap_tensorflow as _pywrap_tensorflow
  File ""/home/yam/miniconda3/envs/cuda11/lib/python3.11/site-packages/tensorflow/python/pywrap_tensorflow.py"", line 26, in <module>
    self_check.preload_check()
  File ""/home/yam/miniconda3/envs/cuda11/lib/python3.11/site-packages/tensorflow/python/platform/self_check.py"", line 63, in preload_check
    from tensorflow.python.platform import _pywrap_cpu_feature_guard
ImportError: /home/yam/miniconda3/envs/cuda11/lib/python3.11/site-packages/tensorflow/python/platform/../../libtensorflow_cc.so.2: undefined symbol: _ZN6google8protobuf7Message19CopyWithSourceCheckERS1_RKS1_
~~~

pip package info:

~~~
(cuda11) yam@TensorYam:~$ python -m pip list
Package                      Version
---------------------------- ---------
absl-py                      2.0.0
astunparse                   1.6.3
cachetools                   5.3.1
certifi                      2023.7.22
charset-normalizer           3.2.0
flatbuffers                  23.5.26
gast                         0.4.0
google-auth                  2.23.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
grpcio                       1.58.0
h5py                         3.9.0
idna                         3.4
keras                        2.13.1
libclang                     16.0.6
Markdown                     3.4.4
MarkupSafe                   2.1.3
numpy                        1.24.3
nvidia-cublas-cu11           11.11.3.6
nvidia-cudnn-cu11            8.6.0.163
oauthlib                     3.2.2
opt-einsum                   3.3.0
packaging                    23.1
pip                          23.2.1
protobuf                     4.24.3
pyasn1                       0.5.0
pyasn1-modules               0.3.0
requests                     2.31.0
requests-oauthlib            1.3.1
rsa                          4.9
setuptools                   68.0.0
six                          1.16.0
tensorboard                  2.13.0
tensorboard-data-server      0.7.1
tensorflow                   2.13.0
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.34.0
termcolor                    2.3.0
typing_extensions            4.5.0
urllib3                      1.26.16
Werkzeug                     2.3.7
wheel                        0.38.4
wrapt                        1.15.0
~~~
```


### Relevant log output

_No response_",False
TensorFlow lite cmake compilation failed to allocate memory stat:awaiting response type:build/install comp:lite wsl2,"Any update with this issue? I'm having the same problem described by @Luca-Stefanescu

I am building Tensorflow Lite with cmake following the instruction given on the minimal example. I am building in a docker container with ubuntu using WSL 2 with docker desktop. The build seems to work until 91%. Then it will start to allocate all the memory (16gb of ram + 8gb of swap) until it fails to allocate throwing an allocation error or sometimes an input/output error.
I think that this error message could be helpful:
```
In file included from /workspaces/tfl-dev-env/tie/../tensorflow_src/tensorflow/lite/kernels/internal/runtime_shape.h:22,
                 from /workspaces/tfl-dev-env/tie/../tensorflow_src/tensorflow/lite/kernels/internal/types.h:24,
                 from /workspaces/tfl-dev-env/tie/../tensorflow_src/tensorflow/lite/kernels/internal/tensor_ctypes.h:22,
                 from /workspaces/tfl-dev-env/tensorflow_src/tensorflow/lite/kernels/embedding_lookup_sparse.cc:72:
/usr/include/c++/13/memory:81:12: fatal error: /workspaces/tfl-dev-env/tie/../tensorflow_src/bits/shared_ptr_atomic.h: Cannot allocate memory
   81 | #  include <bits/shared_ptr_atomic.h>
      |            ^~~~~~~~~~~~~~~~~~~~~~~~~~
compilation terminated.
```

However trying to follow the same steps on a ubuntu VM using VMWare (and with less memory) seems to work.

_Originally posted by @lorenzodellagiustina in https://github.com/tensorflow/tensorflow/issues/61485#issuecomment-1725196272_
            ",False
DenseFeatures Feature column combine order stat:awaiting response type:support stale comp:apis TF 2.13,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I have this code to create DenseFeatures layer.

 ```
       # Define the input for each feature column.
        inputs = {}
        for col in feature_columns:
            if type(col) == type(tf.feature_column.numeric_column(""temp"")):
                dtype = tf.float32
                key = col.key
            else:
                dtype = tf.int64
                key = col.categorical_column.key
            inputs[key] = tf.keras.layers.Input(name=key, shape=(), dtype=dtype)

        // Now use a DenseFeatures layer to combine them
        x = tf.keras.layers.DenseFeatures(feature_columns)(inputs)
```

-----------------

Now, I am trying to implement the output of the DenseFeatures layer for inference. I am facing a situation where I cannot use the TensorFlow model due to latency constraints.

However, my issue is that the manner in which DenseFeatures combines the inputs does not follow the order specified in feature_columns, nor is it sorted based on the feature names.

Is there a way I can determine the order in which these feature columns are combined within the DenseFeatures layer?

As I understand, in most places it is mentioned that it should follow the same order as the feature columns, but this is not what I am observing. I am using TensorFlow 2.13.

### Standalone code to reproduce the issue

```shell
# Define the input for each feature column.
        inputs = {}
        for col in feature_columns:
            if type(col) == type(tf.feature_column.numeric_column(""temp"")):
                dtype = tf.float32
                key = col.key
            else:
                dtype = tf.int64
                key = col.categorical_column.key
            inputs[key] = tf.keras.layers.Input(name=key, shape=(), dtype=dtype)

        // Now use a DenseFeatures layer to combine them
        x = tf.keras.layers.DenseFeatures(feature_columns)(inputs)
```


### Relevant log output

_No response_",False
implementation 'org.tensorflow:tensorflow-lite-support:0.1.0' stat:awaiting response type:support stale comp:lite,"implementation 'org.tensorflow:tensorflow-lite-support:0.1.0'
Why do I run this instruction to generate two dependent libraries, TensorFlow Lite and TensorFlow Lite Support?

How can I generate only tensorflow site support as a dependency library?",False
"How to measure data fetching, forward and backward pass time during training stat:awaiting response type:support stale TF 2.11","Please go to Stack Overflow for help and support:

https://stackoverflow.com/questions/tagged/tensorflow

If you open a GitHub issue, here is our policy:

1.  It must be a bug, a feature request, or a significant problem with the
    documentation (for small docs fixes please send a PR instead).
2.  The form below must be filled out.
3.  It shouldn't be a TensorBoard issue. Those go
    [here](https://github.com/tensorflow/tensorboard/issues).

**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.

------------------------

### System information

-   **Have I written custom code (as opposed to using a stock example script
    provided in TensorFlow)**:   No
-   **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: 
-   **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue
    happens on a mobile device**:
-   **TensorFlow installed from (source or binary)**: Binary
-   **TensorFlow version (use command below)**: 2.11.0
-   **Python version**: 3.8
-   **Bazel version (if compiling from source)**:
-   **GCC/Compiler version (if compiling from source)**:
-   **CUDA/cuDNN version**: 12
-   **GPU model and memory**: A100
-   **Exact command to reproduce**:

You can collect some of this information using our environment capture script:

https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh

You can obtain the TensorFlow version with:

```bash
python -c ""import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)""
```

### Describe the problem
How to measure Data fetching, Data preparation, forward and backward pass time for training [script](https://www.tensorflow.org/tutorials/images/segmentation)?



### Source code / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.
",False
Extra semicolon in tensorflow/lite/micro/micro_profiler.h:90 type:docs-bug comp:lite comp:micro,"Remove extra semicolon in tensorflow/lite/micro/micro_profiler.h on line 90

Before:
```
TF_LITE_REMOVE_VIRTUAL_DELETE;
```

After:
```
TF_LITE_REMOVE_VIRTUAL_DELETE
```",False
Building benchmark_model using Buildroot failed type:build/install comp:lite wsl2 TF 2.11,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.11.0

### Custom code

Yes

### OS platform and distribution

WSL2/Ubuntu 20.04

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

gcc compiler for aarch64

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Hello,

I am trying to build the benchmark_model from tensorflow-lite using Buildroot for my i.MX 8 platform. The tensorflow-lite and label_image examples are built successfully. But now when I am building the benchmark_model I am getting below error from `benchmark_tflite_model.cc`

``undefined reference to `absl::lts_20220623``

Buildroot is using `cmake` and build command is
`/usr/bin/cmake --build /.../build/tensorflow-lite-2.11.0/tensorflow/lite/buildroot-build -t benchmark_model`

Same build command was used for label_image and there were no errors related to linking.

### Standalone code to reproduce the issue

```shell
`/usr/bin/cmake --build /.../build/tensorflow-lite-2.11.0/tensorflow/lite/buildroot-build -t benchmark_model`
```


### Relevant log output

```shell
[ 98%] Building CXX object tools/benchmark/CMakeFiles/benchmark_model.dir/__/delegates/external_delegate_provider.cc.o
[100%] Linking CXX executable benchmark_model
...per-package/tensorflow-lite/host/opt/ext-toolchain/bin/../lib/gcc/aarch64-buildroot-linux-gnu/10.3.0/../../../../aarch64-buildroot-linux-gnu/bin/ld: CMakeFiles/benchmark_model.dir/benchmark_tflite_model.cc.o: in function `absl::lts_20220623::strings_internal::Splitter<absl::lts_20220623::ByChar, absl::lts_20220623::AllowEmpty, std::basic_string_view<char, std::char_traits<char> > >::ConvertToContainer<std::vector<std::basic_string_view<char, std::char_traits<char> >, std::allocator<std::basic_string_view<char, std::char_traits<char> > > >, std::basic_string_view<char, std::char_traits<char> >, false>::operator()(absl::lts_20220623::strings_internal::Splitter<absl::lts_20220623::ByChar, absl::lts_20220623::AllowEmpty, std::basic_string_view<char, std::char_traits<char> > > const&) const [clone .isra.0]':
benchmark_tflite_model.cc:(.text+0x204): undefined reference to `absl::lts_20220623::ByChar::Find(std::basic_string_view<char, std::char_traits<char> >, unsigned long) const'
...per-package/tensorflow-lite/host/opt/ext-toolchain/bin/../lib/gcc/aarch64-buildroot-linux-gnu/10.3.0/../../../../aarch64-buildroot-linux-gnu/bin/ld: benchmark_tflite_model.cc:(.text+0x284): undefined reference to `absl::lts_20220623::ByChar::Find(std::basic_string_view<char, std::char_traits<char> >, unsigned long) const'
...per-package/tensorflow-lite/host/opt/ext-toolchain/bin/../lib/gcc/aarch64-buildroot-linux-gnu/10.3.0/../../../../aarch64-buildroot-linux-gnu/bin/ld: CMakeFiles/benchmark_model.dir/benchmark_tflite_model.cc.o: in function `tflite::benchmark::SplitInputLayerNameAndValueFile(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >&)':
benchmark_tflite_model.cc:(.text+0xcf0): undefined reference to `absl::lts_20220623::StrReplaceAll[abi:cxx11](std::basic_string_view<char, std::char_traits<char> >, std::initializer_list<std::pair<std::basic_string_view<char, std::char_traits<char> >, std::basic_string_view<char, std::char_traits<char> > > >)'
...per-package/tensorflow-lite/host/opt/ext-toolchain/bin/../lib/gcc/aarch64-buildroot-linux-gnu/10.3.0/../../../../aarch64-buildroot-linux-gnu/bin/ld: benchmark_tflite_model.cc:(.text+0xdd4): undefined reference to `absl::lts_20220623::StrReplaceAll[abi:cxx11](std::basic_string_view<char, std::char_traits<char> >, std::initializer_list<std::pair<std::basic_string_view<char, std::char_traits<char> >, std::basic_string_view<char, std::char_traits<char> > > >)'
...per-package/tensorflow-lite/host/opt/ext-toolchain/bin/../lib/gcc/aarch64-buildroot-linux-gnu/10.3.0/../../../../aarch64-buildroot-linux-gnu/bin/ld: CMakeFiles/benchmark_model.dir/benchmark_tflite_model.cc.o: in function `tflite::benchmark::BenchmarkTfLiteModel::ValidateParams()':
benchmark_tflite_model.cc:(.text+0x8388): undefined reference to `absl::lts_20220623::numbers_internal::safe_strto32_base(std::basic_string_view<char, std::char_traits<char> >, int*, int)'
...per-package/tensorflow-lite/host/opt/ext-toolchain/bin/../lib/gcc/aarch64-buildroot-linux-gnu/10.3.0/../../../../aarch64-buildroot-linux-gnu/bin/ld: benchmark_tflite_model.cc:(.text+0x83a4): undefined reference to `absl::lts_20220623::numbers_internal::safe_strto32_base(std::basic_string_view<char, std::char_traits<char> >, int*, int)'
collect2: error: ld returned 1 exit status
```
",False
Build problems when using TensorFlow Lite from another project in Windows stat:awaiting response type:build/install comp:lite subtype:windows TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13

### Custom code

Yes

### OS platform and distribution

Windows 10

### Mobile device

_No response_

### Python version

3.11

### Bazel version

compiled using CMake

### GCC/compiler version

MSVC 17 2022

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

When trying to create a project wheel which uses TensorFlow Lite, it is expected to work fine with:
`python setup.py bdist_wheel`

This command works fine for MacOS and Linux but does not work for Windows raising an error from the `tensorflow_src\tensorflow/lite/core/interpreter.h` file (you can see the error in the Relevant log output section).

For using TensorFlow Lite from the project, we followed the instructions in https://www.tensorflow.org/lite/guide/build_cmake#create_a_cmake_project_which_uses_tensorflow_lite as can be seen in its CMake files (https://github.com/Blosc/blosc2_btune/blob/main/src/CMakeLists.txt).

Also, there is no issue even on Windows for building TensorFlow Lite alone with 
```
cmake ../tensorflow_src/tensorflow/lite
cmake --build . -j
```

### Standalone code to reproduce the issue

```shell
The issue project is blosc2_btune (https://github.com/Blosc/blosc2_btune). You can clone it

`git clone https://github.com/Blosc/blosc2_btune.git`

install the requirements

`python -m pip install -r requirements-build.txt`

and reproduce the error with


prebuild.sh
python setup.py bdist_wheel
```
```


### Relevant log output

```shell
Generating Code...
  btune_model.cpp
C:\Users\marta\blosc2_btune\tensorflow_src\tensorflow/lite/core/interpreter.h(1000,40): error C2665: 'std::atomic_flag:
:atomic_flag': no overloaded function could convert all the argument types [C:\Users\marta\blosc2_btune\_skbuild\win-am
d64-3.11\cmake-build\src\blosc2_btune.vcxproj]
C:\Program Files (x86)\Microsoft Visual Studio\2022\BuildTools\VC\Tools\MSVC\14.37.32822\include\atomic(2886,1): messag
e : could be 'std::atomic_flag::atomic_flag(const std::atomic_flag &)' [C:\Users\marta\blosc2_btune\_skbuild\win-amd64-
3.11\cmake-build\src\blosc2_btune.vcxproj]
C:\Users\marta\blosc2_btune\tensorflow_src\tensorflow/lite/core/interpreter.h(1000,40): message : 'std::atomic_flag::at
omic_flag(const std::atomic_flag &)': cannot convert argument 1 from 'bool' to 'const std::atomic_flag &' [C:\Users\mar
ta\blosc2_btune\_skbuild\win-amd64-3.11\cmake-build\src\blosc2_btune.vcxproj]
C:\Users\marta\blosc2_btune\tensorflow_src\tensorflow/lite/core/interpreter.h(1000,41): message : Reason: cannot conver
t from 'bool' to 'const std::atomic_flag' [C:\Users\marta\blosc2_btune\_skbuild\win-amd64-3.11\cmake-build\src\blosc2_b
tune.vcxproj]
C:\Users\marta\blosc2_btune\tensorflow_src\tensorflow/lite/core/interpreter.h(1000,40): message : while trying to match
 the argument list '(bool)' [C:\Users\marta\blosc2_btune\_skbuild\win-amd64-3.11\cmake-build\src\blosc2_btune.vcxproj]
Traceback (most recent call last):
  File ""C:\Users\marta\miniconda3\envs\blosc2_btune2\Lib\site-packages\skbuild\setuptools_wrap.py"", line 674, in setup
    cmkr.make(make_args, install_target=cmake_install_target, env=env)
  File ""C:\Users\marta\miniconda3\envs\blosc2_btune2\Lib\site-packages\skbuild\cmaker.py"", line 697, in make
    self.make_impl(clargs=clargs, config=config, source_dir=source_dir, install_target=install_target, env=env)
  File ""C:\Users\marta\miniconda3\envs\blosc2_btune2\Lib\site-packages\skbuild\cmaker.py"", line 742, in make_impl
    raise SKBuildError(msg)

An error occurred while building with CMake.
  Command:
    'C:\Users\marta\miniconda3\envs\blosc2_btune2\Lib\site-packages\cmake\data\bin/cmake.exe' --build . --target install --config Release --
  Install target:
    install
  Source directory:
    C:\Users\marta\blosc2_btune
  Working directory:
    C:\Users\marta\blosc2_btune\_skbuild\win-amd64-3.11\cmake-build
Please check the install target is valid and see CMake's output for more information.
```
",False
org.tensorflow:tensorflow-lite-task-vision: type:support comp:lite,"implementation 'org.tensorflow:tensorflow-lite-task-vision:0.1.0'

Can I generate this dependency locally?

What instructions should I use to generate in TFlite?",False
ERROR: No matching distribution found for tensorflow==2.12.0 stat:awaiting response type:build/install stale TF 2.12,"### Issue type

Others

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

2.12.0

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

 pip3 install tensorflow==2.12.0
 
 

### Standalone code to reproduce the issue

```shell
ERROR: Could not find a version that satisfies the requirement tensorflow==2.12.0 (from versions: 1.13.1, 1.13.2, 1.14.0, 1.15.0, 1.15.2, 1.15.3, 1.15.4, 1.15.5, 2.0.0, 2.0.1, 2.0.2, 2.0.3, 2.0.4, 2.1.0, 2.1.1, 2.1.2, 2.1.3, 2.1.4, 
2.2.0, 2.2.1, 2.2.2, 2.2.3, 2.3.0, 2.3.1, 2.3.2, 2.3.3, 2.3.4, 2.4.0, 2.4.1, 2.4.2, 2.4.3, 2.4.4, 2.5.0, 2.5.1, 2.5.2, 2.5.3, 2.6.0rc0, 2.6.0rc1, 2.6.0rc2, 2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.7.0rc0, 2.7.0rc1, 2.7.0, 2.7.1, 
2.7.2, 2.7.3, 2.7.4, 2.8.0rc0, 2.8.0rc1, 2.8.0, 2.8.1, 2.8.2, 2.8.3, 2.8.4, 2.9.0rc0, 2.9.0rc1, 2.9.0rc2, 2.9.0, 2.9.1, 2.9.2, 2.9.3, 2.10.0rc0, 2.10.0rc1, 2.10.0rc2, 2.10.0rc3, 2.10.0, 2.10.1, 2.11.0rc0, 2.11.0rc1, 2.11.0rc2, 2.11.0)
ERROR: No matching distribution found for tensorflow==2.12.0
```


### Relevant log output

_No response_",False
tf-nightly import fails with keras stat:awaiting response type:build/install stale comp:keras subtype: ubuntu/linux,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

2.15.0.dev20230914

### Custom code

No

### OS platform and distribution

Arch Linux

### Mobile device

_No response_

### Python version

Both 3.10 and 3.11

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Running `import tensorflow.compat.v2 as tf` causes the following when keras is installed alongside tf-nightly:

```
/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/tensorflow/__init__.py:29: DeprecationWarning: The distutils package is deprecated and slated for removal in Python 3.12. Use setuptool
s or check PEP 632 for potential alternatives                                                                                                                                                  
  import distutils as _distutils                                                                                                                                                               
2023-09-14 14:47:40.395318: I external/local_tsl/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.                                                
2023-09-14 14:47:40.429289: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9511] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has alre
ady been registered                                                                                                                                                                            
2023-09-14 14:47:40.429321: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has alrea
dy been registered
2023-09-14 14:47:40.429377: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has a
lready been registered
2023-09-14 14:47:40.436510: I external/local_tsl/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2023-09-14 14:47:40.436868: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-09-14 14:47:42.270861: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Traceback (most recent call last):
  File ""<stdin>"", line 1, in <module>
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/tensorflow/__init__.py"", line 483, in <module>
    importlib.import_module(""keras.optimizers"") 
  File ""/home/gap/.pyenv/versions/3.10.2-debug/lib/python3.10/importlib/__init__.py"", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/__init__.py"", line 3, in <module>
    from keras import __internal__
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/__internal__/__init__.py"", line 3, in <module>
    from keras.__internal__ import backend
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/__internal__/backend/__init__.py"", line 3, in <module>
    from keras.src.backend import _initialize_variables as initialize_variables
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/src/__init__.py"", line 21, in <module>
    from keras.src import models
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/src/models/__init__.py"", line 18, in <module>
    from keras.src.engine.functional import Functional
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/src/engine/functional.py"", line 25, in <module>
    from keras.src import backend
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/src/backend.py"", line 35, in <module>
    from keras.src.engine import keras_tensor
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/src/engine/keras_tensor.py"", line 19, in <module>
    from keras.src.utils import object_identity
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/src/utils/__init__.py"", line 20, in <module>
    from keras.src.saving.serialization_lib import deserialize_keras_object
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/src/saving/serialization_lib.py"", line 28, in <module>
    from keras.src.saving.legacy.saved_model.utils import in_tf_saved_model_scope
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/src/saving/legacy/saved_model/utils.py"", line 30, in <module>
    from keras.src.utils.layer_utils import CallFunctionSpec
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/src/utils/layer_utils.py"", line 26, in <module>
    from keras.src import initializers
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/src/initializers/__init__.py"", line 23, in <module>
    from keras.src.initializers import initializers_v1
  File ""/home/gap/work/SHARK/venv2/lib/python3.10/site-packages/keras/src/initializers/initializers_v1.py"", line 32, in <module>
    keras_export(
TypeError: api_export.__init__() got an unexpected keyword argument 'allow_multiple_exports'
```

### Standalone code to reproduce the issue

```shell
python3 -c 'import tensorflow.compat.v2 as tf'
```


### Relevant log output

_No response_",False
Using TFLite GPU in Android gives warning about duplicate namespaces stat:contribution welcome type:build/install comp:lite Android TF 2.12,"**Standalone code to reproduce the issue**
See: https://github.com/bvschaik/tflite-android-warning

Basically:

1. Create an empty Android project
2. Add tflite gpu dependency to build.gradle: `implementation(""com.google.android.gms:play-services-tflite-gpu:16.2.0"")`
3. Compile app: `./gradlew assembleDebug`
4. Note the warning emitted: 

> [org.tensorflow:tensorflow-lite-api:2.12.0] ~/.gradle/caches/transforms-3/2eb840e608fe786447e3ad08d13f4541/transformed/tensorflow-lite-api-2.12.0/AndroidManifest.xml Warning:
> Namespace 'org.tensorflow.lite' is used in multiple modules and/or libraries: org.tensorflow:tensorflow-lite-api:2.12.0, org.tensorflow:tensorflow-lite-gpu-api:2.12.0. Please ensure that all modules and libraries have a unique namespace. For more information, See https://developer.android.com/studio/build/configure-app-module#set-namespace

Cause:

Using tflite-gpu adds both the -api and -gpu-api libraries (output from `./gradlew :app:dependencies`):

```
\--- com.google.android.gms:play-services-tflite-gpu:16.2.0
     +--- com.google.android.gms:play-services-base:18.1.0 (*)
     +--- com.google.android.gms:play-services-basement:18.1.0 (*)
     +--- com.google.android.gms:play-services-tasks:18.0.2 (*)
     +--- org.tensorflow:tensorflow-lite-api:2.12.0
     \--- org.tensorflow:tensorflow-lite-gpu-api:2.12.0
```

Both org.tensorflow:tensorflow-lite-api and org.tensorflow:tensorflow-lite-gpu-api specify the same namespace (`org.tensorflow.lite`) in their mainfest:

```xml
<manifest xmlns:android=""http://schemas.android.com/apk/res/android""
    package=""org.tensorflow.lite"">
...
```

Suggested solution:

Change the namespace in the manifest of org.tensorflow:tensorflow-lite-gpu-api to `org.tensorflow.lite.gpu` to make them unique.",False
ConverterError: 'tf.FastWordpieceTokenizeWithOffsets' op is neither a custom op nor a flex op stat:awaiting response stale type:performance TFLiteConverter,"While doing tflite lite model conversion with input signature as string data type i am getting this error
ConverterError: /usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/func_graph.py:670:0: error: 'tf.FastWordpieceTokenizeWithOffsets' op is neither a custom op nor a flex op
:0: note: loc(fused[""StatefulPartitionedCall:"", ""StatefulPartitionedCall""]): called from
/usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/func_graph.py:670:0: note: Error code: ERROR_NEEDS_CUSTOM_OPS
/usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/func_graph.py:670:0: error: 'tf.TFText>FastWordpieceDetokenize' op is neither a custom op nor a flex op
:0: note: loc(fused[""StatefulPartitionedCall:"", ""StatefulPartitionedCall""]): called from
/usr/local/lib/python3.10/dist-packages/tensorflow/python/framework/func_graph.py:670:0: note: Error code: ERROR_NEEDS_CUSTOM_OPS
:0: error: failed while converting: 'main':
Some ops in the model are custom ops, See instructions to implement custom ops: https://www.tensorflow.org/lite/guide/ops_custom
Custom ops: FastWordpieceTokenizeWithOffsets, TFText>FastWordpieceDetokenize
Details:
tf.FastWordpieceTokenizeWithOffsets(tensor<?x!tf_type.string>, tensor<241460xui8>) -> (tensor<?x!tf_type.string>, tensor<?xi64>, tensor<?xi64>, tensor<?xi64>, tensor<?xi64>) : {device = ""/device:CPU:0""}
tf.TFText>FastWordpieceDetokenize(tensor<40xi32>, tensor<2xi64>, tensor<339052xui8>) -> (tensor<?x!tf_type.string>) : {device = """"}

kindly please check this below colab link
https://colab.research.google.com/drive/14_ajVH4r4NXN6cDw96XJNBtltoueoGfN?usp=sharing",False
"tensorflow-macos 2.13.0 requires typing-extensions<4.6.0,>=3.6.6, but you have typing-extensions 4.7.1 which is incompatible. stat:awaiting response type:feature type:build/install stale subtype:macOS TF 2.13","### Issue type

Feature Request

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

MacOS 13

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I can't use pydantic because it needs typing-extensions>=4.6.1 but tensorflow-macos doesn't support typing-extensions>4.6.0

please update tensorflow-macos for newer typing-extensions

pydantic-core 2.6.3 requires typing-extensions!=4.7.0,>=4.6.0, but you have typing-extensions 4.5.0 which is incompatible.
pydantic 2.3.0 requires typing-extensions>=4.6.1, but you have typing-extensions 4.5.0 which is incompatible.

tensorflow-macos 2.13.0 requires typing-extensions<4.6.0,>=3.6.6, but you have typing-extensions 4.7.1 which is incompatible.

Thanks

### Standalone code to reproduce the issue

```shell
just install the pip packages in MacOS terminal.
```


### Relevant log output

_No response_",False
Build fail on TFLite C API for Android with CMake stat:awaiting tensorflower type:build/install comp:lite awaiting PR merge TF2.14,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.14.0-rc1

### Custom code

No

### OS platform and distribution

macOS 13.5.2

### Mobile device

Android

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

On version 2.14.0-rc1, Building TFLite C API for Android target with CMake fails by link error.
It works fine on version 2.13.0.

`ld: error: unable to find library -lpthread`
Error is caused by linking `pthread`. I guess pthread is unnecessary for android.

#### Extra information to my environment
- CMake: 3.26.4
- Android NDK: 25.2.9519653(r25c)

### Standalone code to reproduce the issue

```shell
mkdir tf-build
cd tf-build
cmake -DCMAKE_TOOLCHAIN_FILE=<NDK path>/build/cmake/android.toolchain.cmake -DANDROID_ABI=arm64-v8a ../tensorflow/lite/c
cmake --build . -j
```


### Relevant log output

```shell
...
[ 70%] Built target absl_status
[ 75%] Built target absl_flags
[ 95%] Built target tensorflow-lite
[100%] Linking CXX shared library libtensorflowlite_c.so
ld: error: unable to find library -lpthread
clang++: error: linker command failed with exit code 1 (use -v to see invocation)
make[2]: *** [libtensorflowlite_c.so] Error 1
make[1]: *** [CMakeFiles/tensorflowlite_c.dir/all] Error 2
make: *** [all] Error 2
```
",False
Model train failing stat:awaiting response comp:apis type:performance TF 2.4,"### Issue type

Performance

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.4.1

### Custom code

No

### OS platform and distribution

Windows 11 WSL Ubuntu 20.04.6 LTS

### Mobile device

_No response_

### Python version

3.9.17

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

Cudatoolkit 10.1.234 Cudann 7.6.5

### GPU model and memory

NVIDIA GeForce RTX 4080 deviceMemorySize: 15.99GiB

### Current behavior?

Running : jupyter notebook: TensorFlow 2 quickstart for experts
https://www.tensorflow.org/tutorials/quickstart/advanced

2023-09-08 23:55:01.853625: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: NVIDIA GeForce RTX 4080 computeCapability: 8.9
coreClock: 2.505GHz coreCount: 76 deviceMemorySize: 15.99GiB deviceMemoryBandwidth: 667.63GiB/s


TRAINING THE MODEL:

2023-09-09 14:21:13.106797: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2023-09-09 14:21:13.108589: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3417595000 Hz
2023-09-09 14:21:13.135568: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2023-09-09 14:22:05.711952: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7

NOT LEARNING!!!
Epoch 14, Loss: 2.3014447689056396, Accuracy: 11.233333587646484, Test Loss: 2.3011932373046875, Test Accuracy: 11.34000015258789
Epoch 15, Loss: 2.301426410675049, Accuracy: 11.236666679382324, Test Loss: 2.3012006282806396, Test Accuracy: 11.329999923706055



### Standalone code to reproduce the issue

```shell
https://www.tensorflow.org/tutorials/quickstart/advanced
```


### Relevant log output

_No response_",False
Tersorflow deterministic training not working for different workflows even when GPU and envs are same stat:awaiting response stale type:performance comp:core TF 2.5,"### System information

- Ubuntu 20.04
- Tensorflow version :-  2.5.0
- python version :- 3.7
- GPU model and memory :- Nvidia RTX 4090, 24 GB GPU memory


### Describe the problem
We recently started setting environmental variable for enabling deterministic training on tensorflow version 2.5. We have 5 to 6 models, most of which are regression models and one of them is a classification model. The following seed values were set :- 
   ```
    os.environ[""PYTHONHASHSEED""] = str(seed)
    
    import tensorflow as tf
    import random
    import numpy as np
    
    # set seed for random, numpy and tensorflow
    random.seed(seed)
    np.random.seed(seed)
    tf.random.set_seed(seed)

    # set env for determinism
    os.environ[""TF_DETERMINISTIC_OPS""] = ""1""
    os.environ[""TF_CUDNN_DETERMINISTIC""] = ""1""
   
    # to ensure determinism set threads to one
    tf.config.threading.set_inter_op_parallelism_threads(1)
    tf.config.threading.set_intra_op_parallelism_threads(1)
``````

 We created multiple workflows by keeping the same GPU version and all of the above environmental variables and seed values. But, for different workflows we get different results even though the initial weights for all models on both workflows are same. On the other hand, on training in the same workflow, we get similar results. kindly let us know what other seed values do we need to set and let us know a solution so that we can train the models in a deterministic way


### Source code / logs

Here is the code to compare initialised weights of model in different workflow but when performing inference after training for 70 epochs the results vary a lot

```
import tensorflow as tf
import numpy as np


tf_det_ini = tf.keras.models.load_model(""./tf_det/nobrainer_initial.h5"")
wb_diff_ini = tf.keras.models.load_model(""./wb_diff/nobrainer_initial.h5"")

diff_arr = []

cnt = 0
for tf_m, wb in zip(tf_det_ini.layers[1:], wb_diff_ini.layers[1:]):
    if tf_m.name == 'MobilenetV3large':
        tf_m_mob = tf_m.layers
        wb_mob = wb.layers

        for tf_m_mobl, wb_mob_l in zip(tf_m_mob[2:], wb_mob[2:]):
            try:
                diff = np.unique(tf_m_mobl.weights[0].numpy() - wb_mob_l.weights[0].numpy())
                diff_arr.extend(diff)
            except:
                continue
            # print(tf_m_mobl.weights[0].numpy())

    try:
        print(tf_m.name)
        diff = tf_m.weights[0].numpy() - wb.weights[0].numpy()
        diff_arr.extend(np.unique(diff))
    except:
        continue

print(max(diff_arr))
print(min(diff_arr))
```

output :- 

```
MobilenetV3large
global_average_pooling2d
extradata
concatenate
dense
0.0
0.0
```",False
[rocm] [build] sh: line 1: /opt/rocm/hip/bin/hipcc: No such file or directory stat:awaiting tensorflower type:build/install subtype: ubuntu/linux TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13.0

### Custom code

No

### OS platform and distribution

Arch Linux

### Mobile device

_No response_

### Python version

3.11

### Bazel version

5.4.0

### GCC/compiler version

12.3.0

### CUDA/cuDNN version

ROCm 5.6.0

### GPU model and memory

_No response_

### Current behavior?

Build fails with the following error:
```
sh: line 1: /opt/rocm/hip/bin/hipcc: No such file or directory
```

### Standalone code to reproduce the issue

```shell
Build the code from source with ROCM 5.6.0
```


### Relevant log output

_No response_",False
Dataset will not be optimized because the dataset does not implement the AsGraphDefInternal() method needed to apply optimizations stat:awaiting response comp:apis type:performance TF 2.11,"### Issue type

Performance

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.11.0

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 20.04

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I have an issue with memory consumption during training. After each epoch more memory is used. In case of bigger dataset, the training crashed mid training. 
I use loading the training data from generator, where I sample the batch using pandas sample method. 
One of the warnings from tf is: 

`W tensorflow/core/framework/dataset.cc:769] Input of GeneratorDatasetOp::Dataset will not be optimized because the dataset does not implement the AsGraphDefInternal() method needed to apply optimizations.`

I am a bit confused, whether using the generator and sampling from a pandas dataframe can cause memory accumulation during the training?



### Standalone code to reproduce the issue

```shell
def generate_samples(epochs: int, steps_per_epoch: int, token_y_df: pd.DataFrame, num_fields: int, batch_size: int = 32, max_len: int = 1024) -> tuple[np.array, np.array]:
        pad_value_y = get_padding_value_y(num_fields)
        while True:
            batch_df = token_y_df.sample(batch_size, replace=True)
            _x, _y = get_fixed_batch(batch_df, max_len, pad_value_y=pad_value_y,
                                     use_additional_features=use_additional_features)
            yield _x, _y

model.fit(generate_samples, ....)


The `get_padding` and the `get_fixed_batch` are longer functions, that pad and create the X and y np.arrays from the sampled pandas dataframe.
```


### Relevant log output

```shell
W tensorflow/core/framework/dataset.cc:769] Input of GeneratorDatasetOp::Dataset will not be optimized because the dataset does not implement the AsGraphDefInternal() method needed to apply optimizations.
```
",False
ADD Suppport for VEDV (https://github.com/yunielrc/vedv) type:support,"Please go to Stack Overflow for help and support:

https://stackoverflow.com/questions/tagged/tensorflow

If you open a GitHub issue, here is our policy:

1.  It must be a bug, a feature request, or a significant problem with the
    documentation (for small docs fixes please send a PR instead).
2.  The form below must be filled out.
3.  It shouldn't be a TensorBoard issue. Those go
    [here](https://github.com/tensorflow/tensorboard/issues).

**Here's why we have that policy**: TensorFlow developers respond to issues. We want to focus on work that benefits the whole community, e.g., fixing bugs and adding features. Support only helps individuals. GitHub also notifies thousands of people when issues are filed. We want them to see you communicating an interesting problem, rather than being redirected to Stack Overflow.

------------------------

### System information

-   **Have I written custom code (as opposed to using a stock example script
    provided in TensorFlow)**:
-   **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**:
-   **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue
    happens on a mobile device**:
-   **TensorFlow installed from (source or binary)**:
-   **TensorFlow version (use command below)**:
-   **Python version**:
-   **Bazel version (if compiling from source)**:
-   **GCC/Compiler version (if compiling from source)**:
-   **CUDA/cuDNN version**:
-   **GPU model and memory**:
-   **Exact command to reproduce**:

You can collect some of this information using our environment capture script:

https://github.com/tensorflow/tensorflow/tree/master/tools/tf_env_collect.sh

You can obtain the TensorFlow version with:

```bash
python -c ""import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)""
```

### Describe the problem
Describe the problem clearly here. Be sure to convey here why it's a bug in TensorFlow or a feature request.

### Source code / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached. Try to provide a reproducible test case that is the bare minimum necessary to generate the problem.
",False
import tensorflow as tf delegate = tf.lite.experimental.load_delegate('/content/drive/MyDrive/test_delegate/libtensorflowlite_gpu_delegate.so')#with this we ca get faster predictions OSError: libEGL.so: cannot open shared object file: No such file or directory type:build/install comp:lite TFLiteConverter TFLiteGpuDelegate,"### 1. System information

- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):
- TensorFlow installation (pip package or built from source):
- TensorFlow library (version, if pip package or github SHA, if built from source):

### 2. Code

Provide code to help us reproduce your issues using one of the following options:

#### Option A: Reference colab notebooks

1)  Reference [TensorFlow Model Colab](https://colab.research.google.com/gist/ymodak/e96a4270b953201d5362c61c1e8b78aa/tensorflow-datasets.ipynb?authuser=1): Demonstrate how to build your TF model.
2)  Reference [TensorFlow Lite Model Colab](https://colab.research.google.com/gist/ymodak/0dfeb28255e189c5c48d9093f296e9a8/tensorflow-lite-debugger-colab.ipynb): Demonstrate how to convert your TF model to a TF Lite model (with quantization, if used) and run TFLite Inference (if possible).

```
(You can paste links or attach files by dragging & dropping them below)
- Provide links to your updated versions of the above two colab notebooks.
- Provide links to your TensorFlow model and (optionally) TensorFlow Lite Model.
```

#### Option B: Paste your code here or provide a link to a custom end-to-end colab

```
(You can paste links or attach files by dragging & dropping them below)
- Include code to invoke the TFLite Converter Python API and the errors.
- Provide links to your TensorFlow model and (optionally) TensorFlow Lite Model.
```

### 3. Failure after conversion
If the conversion is successful, but the generated model is wrong, then state what is wrong:

- Model produces wrong results and/or has lesser accuracy.
- Model produces correct results, but it is slower than expected.

### 4. (optional) RNN conversion support
If converting TF RNN to TFLite fused RNN ops, please prefix [RNN] in the title.

### 5. (optional) Any other info / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.
",False
TensorFlow Lite in Play Services issue aguinigacervantesjerardo@gmail.com not my devices are the login in just this phone device that are not this one  getting them out of my server please send them a little massage to buy there phone and don't use my phone number and my email at all stat:awaiting response type:support stale comp:lite,"**System information**
- Android Device information (use `adb shell getprop ro.build.fingerprint`
  if possible):
- TensorFlow Lite in Play Services SDK version (found in `build.gradle`):
- Google Play Services version
  (`Settings` > `Apps` > `Google Play Services` > `App details`):

**Standalone code to reproduce the issue**
Provide a reproducible test case that is the bare minimum necessary to generate
the problem. If possible, please share a link to or attach code demonstrating
the problem.

**Any other info / logs**
Include any logs or source code that would be helpful to diagnose the problem.
If including tracebacks, please include the full traceback. Large logs and files
should be attached.
",False
How do I set the threshold(iou/score) of TFLite Detection PostProcess via interpreter? stat:awaiting response comp:lite TFLiteConverter comp:lite-support TF 2.13,"### 1. System information

- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): 18.04
- TensorFlow installation (pip package or built from source): pip package, python3.8
- TensorFlow library (version, if pip package or github SHA, if built from source): 2.13.0

### 2. Code

Provide code to help us reproduce your issues using one of the following options:
Download tflite model from https://tfhub.dev/iree/lite-model/ssd_mobilenet_v1_100_320/fp32/nms/1?lite-format=tflite

#### Interpreter code
`
import numpy as np
import tensorflow as tf

//TensorFlow Lite model path
tflite_model_file = 'lite-model_ssd_mobilenet_v1_100_320_fp32_nms_1.tflite'

interpreter = tf.lite.Interpreter(model_path=tflite_model_file)
interpreter.allocate_tensors()

input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()

input_shape = input_details[0]['shape']
input_array =  np.array(np.random.random_sample(input_shape), dtype=np.float32)

//HOW TO SET THRESHOLD POST-PROCESS
// is there any method like 'interpreter.set_threshold()' ?

interpreter.set_tensor(input_details[0]['index'], input_array)
interpreter.invoke()

output_data = interpreter.get_tensor(output_details[0]['index'])

print(output_data)
`

### 3. Failure after conversion


### 4. (optional) RNN conversion support
If converting TF RNN to TFLite fused RNN ops, please prefix [RNN] in the title.

### 5. (optional) Any other info / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.
",False
Quantization aware training - label smoothing drops performance? comp:lite type:performance TFLiteConverter ModelOptimizationToolkit TF 2.13,"### 1. System information

- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): ubuntu18.04
- TensorFlow installation (pip package or built from source): pip package
- TensorFlow library (version, if pip package or github SHA, if built from source): 2.13.0

### 2. Code
```python
# fine-tunining baseline model for few epochs
history = run_model(args, save_model_file)
    
# load trained weights for quantization aware training
model = setup_pretrained_model(args, save_model_file)
    
def apply_quantization_to_dense(layer):
    if isinstance(layer, tf.keras.layers.Dense):
        return tfmot.quantization.keras.quantize_annotate_layer(layer)
    return layer

annotated_model = tf.keras.models.clone_model(
    model,
    clone_function=apply_quantization_to_dense,
)

# Build Model
annotated_model.build((None, args.input_dim, args.input_dim ,3))

# Now that the Dense layers are annotated,
# `quantize_apply` actually makes the model quantization aware.
quant_aware_model = tfmot.quantization.keras.quantize_apply(annotated_model)

#     quant_aware_model.summary()
n_sample, train_ds, val_ds = load_data(args, args.input_dim)

# `quantize_model` requires a recompile.
lr_schedule = tf.keras.optimizers.schedules.ExponentialDecay(
    args.lr / 10.0,
    decay_steps=100000,
    decay_rate=0.96,
    staircase=True)
    
# Compile the model
quant_aware_model.compile(optimizer=tf.keras.optimizers.Lion(lr=lr_schedule), 
              loss=tf.keras.losses.CategoricalCrossentropy(label_smoothing=args.label_smoothing),
              metrics=['accuracy']
              )
```

### 3. Failure after conversion
model successfully converted into tflite with the example code flow of quantization aware training,
but the test accuracy for tflite model is so low (~80%) compared to .pb model file. (~97%)

Before adopting label smoothing, quantization aware trained model (tflite) was working as good as original .pb model.

Is there any relationship between label smoothing and quantization aware training process?

Thanks!
",False
Can't run bert_vocab_from_dataset without TypeError: Tensor is unhashable stat:awaiting response type:support stale comp:apis TF 2.13,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

This is the code from you [manual ](https://www.tensorflow.org/text/guide/subwords_tokenizer#generate_the_vocabulary)and I really don't understans that I get this error. Why is it? 

If I add 
tf.compat.v1.disable_eager_execution()
tf.compat.v1.disable_v2_behavior()

I get
RuntimeError: input_dataset: Attempting to capture an EagerTensor without building a function.

### Standalone code to reproduce the issue

```shell
data = tf.data.TextLineDataset([SENTENCES_PATH, TAGS_PATH])

from tensorflow_text.tools.wordpiece_vocab import bert_vocab_from_dataset as bert_vocab

tokens = bert_vocab.bert_vocab_from_dataset(
    data,
    # The target vocabulary size
    vocab_size = 50000,
    # Reserved tokens that must be included in the vocabulary
    reserved_tokens=[""[PAD]"", ""[UNK]"", ""[START]"", ""[END]""],
    # Arguments for `text.BertTokenizer`
    bert_tokenizer_params=dict(lower_case=True),
    # Arguments for `wordpiece_vocab.wordpiece_tokenizer_learner_lib.learn`
    learn_params={},
)
```


### Relevant log output

```shell
TypeError: Tensor is unhashable. Instead, use tensor.ref() as the key.
```
",False
What is generate_vocab func?  stat:awaiting response type:support stale,"You referenced in [this ](https://www.tensorflow.org/text/guide/subwords_tokenizer#generate_the_vocabulary)tutorial to [generate_vocab.py](https://github.com/tensorflow/text/blob/master/tensorflow_text/tools/wordpiece_vocab/generate_vocab.py), if I understand correct, as a ready to prod highlevel func that I can use. But I don't have it in downloaded repository of tensorflow-text. 

Can you explain me a bit more how should be my attitude to this reference? 
",False
Float16 mixed precision training stat:awaiting response type:support comp:ops TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

Ubuntu 20.04.5 LTS

### Mobile device

_No response_

### Python version

Python 3.10.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

A6000

### Current behavior?

Enabled float16 training by setting the mixed precision policy, but why I still need to manually cast the y tensors to float16 before calculating the loss?


Error when no manual cast the tensor:
![image](https://github.com/tensorflow/tensorflow/assets/25906607/46c5efcb-f2c2-4b7a-9483-46656009071b)


### Standalone code to reproduce the issue

```shell
Confidential.
```


### Relevant log output

_No response_",False
I am not able to install the correct version for typing-extensions stat:awaiting response type:build/install stale subtype:windows TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

Windows 10

### Mobile device

_No response_

### Python version

3.11.3

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Their are different support problems when I install tensorflow

I installed it by entering
`pip install tensorflow`

The output was

> Collecting tensorflow
  Obtaining dependency information for tensorflow from https://files.pythonhosted.org/packages/9e/b8/ed5f794359d05cd0bffb894c6418da87b93016ee17b669d55c45d1bd5d5b/tensorflow-2.13.0-cp311-cp311-win_amd64.whl.metadata
  Downloading tensorflow-2.13.0-cp311-cp311-win_amd64.whl.metadata (2.6 kB)
Collecting tensorflow-intel==2.13.0 (from tensorflow)
  Obtaining dependency information for tensorflow-intel==2.13.0 from https://files.pythonhosted.org/packages/2f/2f/3c84f675931ce3bcbc7e23acbba1e5d7f05ce769adab48322de57a9f5928/tensorflow_intel-2.13.0-cp311-cp311-win_amd64.whl.metadata
  Downloading tensorflow_intel-2.13.0-cp311-cp311-win_amd64.whl.metadata (4.1 kB)
Collecting absl-py>=1.0.0 (from tensorflow-intel==2.13.0->tensorflow)
  Using cached absl_py-1.4.0-py3-none-any.whl (126 kB)
Collecting astunparse>=1.6.0 (from tensorflow-intel==2.13.0->tensorflow)
  Using cached astunparse-1.6.3-py2.py3-none-any.whl (12 kB)
Collecting flatbuffers>=23.1.21 (from tensorflow-intel==2.13.0->tensorflow)
  Obtaining dependency information for flatbuffers>=23.1.21 from https://files.pythonhosted.org/packages/6f/12/d5c79ee252793ffe845d58a913197bfa02ae9a0b5c9bc3dc4b58d477b9e7/flatbuffers-23.5.26-py2.py3-none-any.whl.metadata
  Downloading flatbuffers-23.5.26-py2.py3-none-any.whl.metadata (850 bytes)
Collecting gast<=0.4.0,>=0.2.1 (from tensorflow-intel==2.13.0->tensorflow)
  Using cached gast-0.4.0-py3-none-any.whl (9.8 kB)
Collecting google-pasta>=0.1.1 (from tensorflow-intel==2.13.0->tensorflow)
  Using cached google_pasta-0.2.0-py3-none-any.whl (57 kB)
Collecting h5py>=2.9.0 (from tensorflow-intel==2.13.0->tensorflow)
  Obtaining dependency information for h5py>=2.9.0 from https://files.pythonhosted.org/packages/d1/93/0f4cf5058095d749d464e4f770d2bf339930e5f3374331f0d2fa6ddfbf28/h5py-3.9.0-cp311-cp311-win_amd64.whl.metadata
  Downloading h5py-3.9.0-cp311-cp311-win_amd64.whl.metadata (2.5 kB)
Collecting libclang>=13.0.0 (from tensorflow-intel==2.13.0->tensorflow)
  Obtaining dependency information for libclang>=13.0.0 from https://files.pythonhosted.org/packages/02/8c/dc970bc00867fe290e8c8a7befa1635af716a9ebdfe3fb9dce0ca4b522ce/libclang-16.0.6-py2.py3-none-win_amd64.whl.metadata
  Downloading libclang-16.0.6-py2.py3-none-win_amd64.whl.metadata (5.3 kB)
Collecting numpy<=1.24.3,>=1.22 (from tensorflow-intel==2.13.0->tensorflow)
  Using cached numpy-1.24.3-cp311-cp311-win_amd64.whl (14.8 MB)
Collecting opt-einsum>=2.3.2 (from tensorflow-intel==2.13.0->tensorflow)
  Using cached opt_einsum-3.3.0-py3-none-any.whl (65 kB)
Requirement already satisfied: packaging in c:\users\wadhw\appdata\local\programs\python\python311\lib\site-packages (from tensorflow-intel==2.13.0->tensorflow) (23.1)
Collecting protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 (from tensorflow-intel==2.13.0->tensorflow)
  Obtaining dependency information for protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 from https://files.pythonhosted.org/packages/14/ff/10f746c03212fe48576b2c0f5ada73c3400b6d90f769728c4f07656d8b27/protobuf-4.24.2-cp310-abi3-win_amd64.whl.metadata
  Downloading protobuf-4.24.2-cp310-abi3-win_amd64.whl.metadata (540 bytes)
Requirement already satisfied: setuptools in c:\users\wadhw\appdata\local\programs\python\python311\lib\site-packages (from tensorflow-intel==2.13.0->tensorflow) (65.5.0)
Requirement already satisfied: six>=1.12.0 in c:\users\wadhw\appdata\local\programs\python\python311\lib\site-packages (from tensorflow-intel==2.13.0->tensorflow) (1.16.0)
Collecting termcolor>=1.1.0 (from tensorflow-intel==2.13.0->tensorflow)
  Using cached termcolor-2.3.0-py3-none-any.whl (6.9 kB)
Collecting typing-extensions<4.6.0,>=3.6.6 (from tensorflow-intel==2.13.0->tensorflow)
  Using cached typing_extensions-4.5.0-py3-none-any.whl (27 kB)
Collecting wrapt>=1.11.0 (from tensorflow-intel==2.13.0->tensorflow)
  Using cached wrapt-1.15.0-cp311-cp311-win_amd64.whl (36 kB)
Collecting grpcio<2.0,>=1.24.3 (from tensorflow-intel==2.13.0->tensorflow)
  Obtaining dependency information for grpcio<2.0,>=1.24.3 from https://files.pythonhosted.org/packages/8d/58/ede228c07bdf3780c5332660c89f3c7a37fe8bfb9bd73a97ad2614420bd4/grpcio-1.57.0-cp311-cp311-win_amd64.whl.metadata
  Downloading grpcio-1.57.0-cp311-cp311-win_amd64.whl.metadata (4.1 kB)
Collecting tensorboard<2.14,>=2.13 (from tensorflow-intel==2.13.0->tensorflow)
  Using cached tensorboard-2.13.0-py3-none-any.whl (5.6 MB)
Collecting tensorflow-estimator<2.14,>=2.13.0 (from tensorflow-intel==2.13.0->tensorflow)
  Obtaining dependency information for tensorflow-estimator<2.14,>=2.13.0 from https://files.pythonhosted.org/packages/72/5c/c318268d96791c6222ad7df1651bbd1b2409139afeb6f468c0f327177016/tensorflow_estimator-2.13.0-py2.py3-none-any.whl.metadata
  Downloading tensorflow_estimator-2.13.0-py2.py3-none-any.whl.metadata (1.3 kB)
Collecting keras<2.14,>=2.13.1 (from tensorflow-intel==2.13.0->tensorflow)
  Obtaining dependency information for keras<2.14,>=2.13.1 from https://files.pythonhosted.org/packages/2e/f3/19da7511b45e80216cbbd9467137b2d28919c58ba1ccb971435cb631e470/keras-2.13.1-py3-none-any.whl.metadata
  Downloading keras-2.13.1-py3-none-any.whl.metadata (2.4 kB)
Collecting tensorflow-io-gcs-filesystem>=0.23.1 (from tensorflow-intel==2.13.0->tensorflow)
  Using cached tensorflow_io_gcs_filesystem-0.31.0-cp311-cp311-win_amd64.whl (1.5 MB)
Collecting wheel<1.0,>=0.23.0 (from astunparse>=1.6.0->tensorflow-intel==2.13.0->tensorflow)
  Obtaining dependency information for wheel<1.0,>=0.23.0 from https://files.pythonhosted.org/packages/b8/8b/31273bf66016be6ad22bb7345c37ff350276cfd46e389a0c2ac5da9d9073/wheel-0.41.2-py3-none-any.whl.metadata
  Using cached wheel-0.41.2-py3-none-any.whl.metadata (2.2 kB)
Collecting google-auth<3,>=1.6.3 (from tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow)
  Obtaining dependency information for google-auth<3,>=1.6.3 from https://files.pythonhosted.org/packages/9c/8d/bff87fc722553a5691d8514da5523c23547f3894189ba03b57592e37bdc2/google_auth-2.22.0-py2.py3-none-any.whl.metadata
  Downloading google_auth-2.22.0-py2.py3-none-any.whl.metadata (4.2 kB)
Collecting google-auth-oauthlib<1.1,>=0.5 (from tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow)
  Using cached google_auth_oauthlib-1.0.0-py2.py3-none-any.whl (18 kB)
Collecting markdown>=2.6.8 (from tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow)
  Obtaining dependency information for markdown>=2.6.8 from https://files.pythonhosted.org/packages/1a/b5/228c1cdcfe138f1a8e01ab1b54284c8b83735476cb22b6ba251656ed13ad/Markdown-3.4.4-py3-none-any.whl.metadata
  Downloading Markdown-3.4.4-py3-none-any.whl.metadata (6.9 kB)
Requirement already satisfied: requests<3,>=2.21.0 in c:\users\wadhw\appdata\local\programs\python\python311\lib\site-packages (from tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow) (2.31.0)
Collecting tensorboard-data-server<0.8.0,>=0.7.0 (from tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow)
  Obtaining dependency information for tensorboard-data-server<0.8.0,>=0.7.0 from https://files.pythonhosted.org/packages/da/61/6e9ff8258422d287eec718872fb71e05324356722ab658c8afda25f51539/tensorboard_data_server-0.7.1-py3-none-any.whl.metadata
  Downloading tensorboard_data_server-0.7.1-py3-none-any.whl.metadata (1.1 kB)
Requirement already satisfied: werkzeug>=1.0.1 in c:\users\wadhw\appdata\local\programs\python\python311\lib\site-packages (from tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow) (2.3.7)
Collecting cachetools<6.0,>=2.0.0 (from google-auth<3,>=1.6.3->tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow)
  Obtaining dependency information for cachetools<6.0,>=2.0.0 from https://files.pythonhosted.org/packages/a9/c9/c8a7710f2cedcb1db9224fdd4d8307c9e48cbddc46c18b515fefc0f1abbe/cachetools-5.3.1-py3-none-any.whl.metadata
  Downloading cachetools-5.3.1-py3-none-any.whl.metadata (5.2 kB)
Collecting pyasn1-modules>=0.2.1 (from google-auth<3,>=1.6.3->tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow)
  Using cached pyasn1_modules-0.3.0-py2.py3-none-any.whl (181 kB)
Collecting rsa<5,>=3.1.4 (from google-auth<3,>=1.6.3->tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow)
  Using cached rsa-4.9-py3-none-any.whl (34 kB)
Collecting urllib3<2.0 (from google-auth<3,>=1.6.3->tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow)
  Obtaining dependency information for urllib3<2.0 from https://files.pythonhosted.org/packages/c5/05/c214b32d21c0b465506f95c4f28ccbcba15022e000b043b72b3df7728471/urllib3-1.26.16-py2.py3-none-any.whl.metadata
  Downloading urllib3-1.26.16-py2.py3-none-any.whl.metadata (48 kB)
     ---------------------------------------- 48.4/48.4 kB 1.2 MB/s eta 0:00:00
Collecting requests-oauthlib>=0.7.0 (from google-auth-oauthlib<1.1,>=0.5->tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow)
  Using cached requests_oauthlib-1.3.1-py2.py3-none-any.whl (23 kB)
Requirement already satisfied: charset-normalizer<4,>=2 in c:\users\wadhw\appdata\local\programs\python\python311\lib\site-packages (from requests<3,>=2.21.0->tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow) (3.2.0)
Requirement already satisfied: idna<4,>=2.5 in c:\users\wadhw\appdata\local\programs\python\python311\lib\site-packages (from requests<3,>=2.21.0->tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow) (3.4)
Requirement already satisfied: certifi>=2017.4.17 in c:\users\wadhw\appdata\local\programs\python\python311\lib\site-packages (from requests<3,>=2.21.0->tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow) (2023.7.22)
Requirement already satisfied: MarkupSafe>=2.1.1 in c:\users\wadhw\appdata\local\programs\python\python311\lib\site-packages (from werkzeug>=1.0.1->tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow) (2.1.3)
Collecting pyasn1<0.6.0,>=0.4.6 (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow)
  Using cached pyasn1-0.5.0-py2.py3-none-any.whl (83 kB)
Collecting oauthlib>=3.0.0 (from requests-oauthlib>=0.7.0->google-auth-oauthlib<1.1,>=0.5->tensorboard<2.14,>=2.13->tensorflow-intel==2.13.0->tensorflow)
  Using cached oauthlib-3.2.2-py3-none-any.whl (151 kB)
Using cached tensorflow-2.13.0-cp311-cp311-win_amd64.whl (1.9 kB)
Using cached tensorflow_intel-2.13.0-cp311-cp311-win_amd64.whl (276.6 MB)
Using cached flatbuffers-23.5.26-py2.py3-none-any.whl (26 kB)
Using cached grpcio-1.57.0-cp311-cp311-win_amd64.whl (4.3 MB)
Using cached h5py-3.9.0-cp311-cp311-win_amd64.whl (2.7 MB)
Using cached keras-2.13.1-py3-none-any.whl (1.7 MB)
Using cached libclang-16.0.6-py2.py3-none-win_amd64.whl (24.4 MB)
Using cached protobuf-4.24.2-cp310-abi3-win_amd64.whl (430 kB)
Using cached tensorflow_estimator-2.13.0-py2.py3-none-any.whl (440 kB)
Using cached google_auth-2.22.0-py2.py3-none-any.whl (181 kB)
Using cached Markdown-3.4.4-py3-none-any.whl (94 kB)
Using cached tensorboard_data_server-0.7.1-py3-none-any.whl (2.4 kB)
Using cached wheel-0.41.2-py3-none-any.whl (64 kB)
Using cached cachetools-5.3.1-py3-none-any.whl (9.3 kB)
Using cached urllib3-1.26.16-py2.py3-none-any.whl (143 kB)
Installing collected packages: libclang, flatbuffers, wrapt, wheel, urllib3, typing-extensions, termcolor, tensorflow-io-gcs-filesystem, tensorflow-estimator, tensorboard-data-server, pyasn1, protobuf, oauthlib, numpy, markdown, keras, grpcio, google-pasta, gast, cachetools, absl-py, rsa, pyasn1-modules, opt-einsum, h5py, astunparse, requests-oauthlib, google-auth, google-auth-oauthlib, tensorboard, tensorflow-intel, tensorflow
  Attempting uninstall: urllib3
    Found existing installation: urllib3 2.0.4
    Uninstalling urllib3-2.0.4:
      Successfully uninstalled urllib3-2.0.4
  Attempting uninstall: typing-extensions
    Found existing installation: typing_extensions 4.7.1
    Uninstalling typing_extensions-4.7.1:
      Successfully uninstalled typing_extensions-4.7.1
  Attempting uninstall: numpy
    Found existing installation: numpy 1.25.2
    Uninstalling numpy-1.25.2:
      Successfully uninstalled numpy-1.25.2
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
pydantic 2.3.0 requires typing-extensions>=4.6.1, but you have typing-extensions 4.5.0 which is incompatible.
pydantic-core 2.6.3 requires typing-extensions!=4.7.0,>=4.6.0, but you have typing-extensions 4.5.0 which is incompatible.
Successfully installed absl-py-1.4.0 astunparse-1.6.3 cachetools-5.3.1 flatbuffers-23.5.26 gast-0.4.0 google-auth-2.22.0 google-auth-oauthlib-1.0.0 google-pasta-0.2.0 grpcio-1.57.0 h5py-3.9.0 keras-2.13.1 libclang-16.0.6 markdown-3.4.4 numpy-1.24.3 oauthlib-3.2.2 opt-einsum-3.3.0 protobuf-4.24.2 pyasn1-0.5.0 pyasn1-modules-0.3.0 requests-oauthlib-1.3.1 rsa-4.9 tensorboard-2.13.0 tensorboard-data-server-0.7.1 tensorflow-2.13.0 tensorflow-estimator-2.13.0 tensorflow-intel-2.13.0 tensorflow-io-gcs-filesystem-0.31.0 termcolor-2.3.0 typing-extensions-4.5.0 urllib3-1.26.16 wheel-0.41.2 wrapt-1.15.0

Due to this error, I installed typing-extensions 4.6.1 by
`pip install typing-extensions==4.6.1`

I got the output as

> Collecting typing-extensions==4.6.1
  Obtaining dependency information for typing-extensions==4.6.1 from https://files.pythonhosted.org/packages/82/ed/8ccf53a0ed10bf8fc8877b5833b40f5f99093cadfe6632b8892f74aead0f/typing_extensions-4.6.1-py3-none-any.whl.metadata
  Downloading typing_extensions-4.6.1-py3-none-any.whl.metadata (2.8 kB)
Downloading typing_extensions-4.6.1-py3-none-any.whl (31 kB)
Installing collected packages: typing-extensions
  Attempting uninstall: typing-extensions
    Found existing installation: typing_extensions 4.5.0
    Uninstalling typing_extensions-4.5.0:
      Successfully uninstalled typing_extensions-4.5.0
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
tensorflow-intel 2.13.0 requires typing-extensions<4.6.0,>=3.6.6, but you have typing-extensions 4.6.1 which is incompatible.
Successfully installed typing-extensions-4.6.1

Then, I again reinstalled typing-extensions 4.5.0 by
`pip install typing-extensions==4.5.0`

Then I again received the error

> Collecting typing-extensions==4.5.0
  Using cached typing_extensions-4.5.0-py3-none-any.whl (27 kB)
Installing collected packages: typing-extensions
  Attempting uninstall: typing-extensions
    Found existing installation: typing_extensions 4.6.1
    Uninstalling typing_extensions-4.6.1:
      Successfully uninstalled typing_extensions-4.6.1
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
pydantic 2.3.0 requires typing-extensions>=4.6.1, but you have typing-extensions 4.5.0 which is incompatible.
pydantic-core 2.6.3 requires typing-extensions!=4.7.0,>=4.6.0, but you have typing-extensions 4.5.0 which is incompatible.
Successfully installed typing-extensions-4.5.0

Please let me know how to fix this error

### Standalone code to reproduce the issue

```shell
Just use 
pip install tensorflow 
and you may receive this error
```


### Relevant log output

_No response_",False
Android  ,"
- Android Device information (use `adb shell getprop ro.build.
- Google Play Services version
  Settings

",False
_pywrap_tensorflow_internal.so: cannot open shared object file: No such file or directory stat:awaiting response type:build/install stale subtype: ubuntu/linux 2.6.0,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf2.6.2

### Custom code

Yes

### OS platform and distribution

ubuntu20.04

### Mobile device

rk3588

### Python version

python3.8

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Traceback (most recent call last):
  File ""<stdin>"", line 1, in <module>
  File ""/usr/local/lib/python3.8/dist-packages/tensorflow/__init__.py"", line 41, in <module>
    from tensorflow.python.tools import module_util as _module_util
  File ""/usr/local/lib/python3.8/dist-packages/tensorflow/python/__init__.py"", line 40, in <module>
    from tensorflow.python.eager import context
  File ""/usr/local/lib/python3.8/dist-packages/tensorflow/python/eager/context.py"", line 35, in <module>
    from tensorflow.python import pywrap_tfe
  File ""/usr/local/lib/python3.8/dist-packages/tensorflow/python/pywrap_tfe.py"", line 28, in <module>
    from tensorflow.python import pywrap_tensorflow
  File ""/usr/local/lib/python3.8/dist-packages/tensorflow/python/pywrap_tensorflow.py"", line 83, in <module>
    raise ImportError(msg)
ImportError: Traceback (most recent call last):
  File ""/usr/local/lib/python3.8/dist-packages/tensorflow/python/pywrap_tensorflow.py"", line 64, in <module>
    from tensorflow.python._pywrap_tensorflow_internal import *
ImportError: /usr/local/lib/python3.8/dist-packages/tensorflow/python/_pywrap_tensorflow_internal.so: cannot open shared object file: No such file or directory

### Standalone code to reproduce the issue

```shell
import tensorflow
Traceback (most recent call last):
  File ""/usr/local/lib/python3.8/dist-packages/tensorflow/python/pywrap_tensorflow.py"", line 64, in <module>
    from tensorflow.python._pywrap_tensorflow_internal import *
ImportError: /usr/local/lib/python3.8/dist-packages/tensorflow/python/_pywrap_tensorflow_internal.so: cannot open shared object file: No such file or directory
```


### Relevant log output

_No response_",False
How to limit GPU memory usage when only prediction in c++? stat:awaiting response type:feature comp:runtime,"### Issue type

Feature Request

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 2.4

### Custom code

Yes

### OS platform and distribution

Windows 10

### Mobile device

_No response_

### Python version

3.7.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11.0 / 8.1.0

### GPU model and memory

RTX 3090 / 24GB

### Current behavior?

I loaded the saved model using the already compiled tensorflow-gpu 2.4.0.
When this model was used for prediction, it was confirmed that all available memory of the gpu was used.
I've seen limiting using the growing method in python, but I don't know how to use it in c++. could you please tell me how?



### Standalone code to reproduce the issue

```shell
#include <stdlib.h>
#include <stdio.h>
#include <tensorflow/c/c_api.h>
#include <iostream>
#include <fstream>
#include <sstream>
#include <string>
#include <vector>
void NoOpDeallocator(void* data, size_t a, void* b) {}

int main() {
    TF_Graph* Graph = TF_NewGraph();
    TF_Status* Status = TF_NewStatus();

    TF_SessionOptions* SessionOpts = TF_NewSessionOptions();
    TF_Buffer* RunOpts = NULL;

    const char* saved_model_dir = ""H:\\my_model\\""; // Path of the model
    const char* tags = ""serve""; // default model serving tag; can change in future
    int ntags = 1;

    TF_Session* Session = TF_LoadSessionFromSavedModel(SessionOpts, RunOpts, saved_model_dir, &tags, ntags, Graph, NULL, Status);
    if (TF_GetCode(Status) == TF_OK)
    {
        printf(""TF_LoadSessionFromSavedModel OK\n"");
    }
    else
    {
        printf(""%s"", TF_Message(Status));
    }
}
```


### Relevant log output

_No response_",False
Will there a MLP model in the future version? type:feature comp:keras TF 2.13,"### Issue type

Feature Request

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13.0

### Custom code

No

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

When building deep learning models like Multi-Layer Perceptrons (MLPs), code reusability and conciseness are crucial factors. Currently, using `tf.keras.Sequential` in TensorFlow allows for convenient creation of sequential models. However, manually adding common operations such as Batch Normalization or Dropout to each layer can lead to code redundancy and an increased burden in terms of coding and maintenance. Therefore, proposing the addition of a feature in TensorFlow to directly create MLPs with Batch Normalization and Dropout is highly beneficial.

Here are several reasons why this feature would be advantageous for TensorFlow users:

1. **Simplified Code**: Users won't need to manually add Batch Normalization and Dropout operations to each layer, resulting in cleaner, more readable, and maintainable code.

2. **Reduced Error Rate**: Manual copy-pasting of code is error-prone, especially as model complexity increases. Automating the integration of Batch Normalization and Dropout operations can reduce issues arising from code errors.

3. **Increased Productivity**: Developers can build and iterate on models more swiftly, focusing on design and parameter tuning rather than rewriting the same code segments for every new model.

4. **Education and Learning**: For newcomers to TensorFlow, this feature can provide a quicker onboarding process, lowering the learning curve and enabling them to grasp and apply deep learning concepts faster.

Certainly, here's the additional information:

I also believe that PyTorch has implemented MLP functionality quite effectively. An example of this can be found in the following URL: [PyTorch MLP](https://pytorch.org/vision/main/generated/torchvision.ops.MLP.html). PyTorch's approach to creating MLPs provides a good reference for how TensorFlow could potentially integrate similar features.

### Standalone code to reproduce the issue

origin
```python
model = tf.keras.Sequential([
    tf.keras.layers.Dense(128),
    tf.keras.layers.BatchNormalization(),
    tf.keras.layers.ReLU(),
    tf.keras.layers.Dropout(0.2),
    tf.keras.layers.Dense(64),
    tf.keras.layers.BatchNormalization(),
    tf.keras.layers.ReLU(),
    tf.keras.layers.Dropout(0.2),
    tf.keras.layers.Dense(32),
    tf.keras.layers.BatchNormalization(),
    tf.keras.layers.ReLU(),
    tf.keras.layers.Dropout(0.2),
    tf.keras.layers.Dense(10),
])
```


with MLP model
```python
model = tf.keras.MLP(
    hidden_channels=[128, 64, 32, 10],
    norm_layer=tf.keras.layers.BatchNormalization,
    activation_layer=tf.keras.layers.ReLU,
    dropout=0.2,
)
```

### Relevant log output

_No response_",False
Cannot build package with bazel stat:awaiting response type:build/install stale subtype: ubuntu/linux,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

newest

### Custom code

Yes

### OS platform and distribution

Debian 12

### Mobile device

_No response_

### Python version

Python 3.9

### Bazel version

newest

### GCC/compiler version

Clang 16

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I have searched everywhere but cannot find anything about this error

### Standalone code to reproduce the issue

```shell
./bazel-bin/tensorflow/tools/pip_package/build_pip_package /home/drowsiness/
TensorFlow Version: 2.15.0
TensorFlow Major Version: 2
TMPDIR: /tmp/tmp.BINOHRyJHF
Fri Aug 25 09:26:15 PM PDT 2023 : === Preparing sources in dir: /tmp/tmp.BINOHRyJHF
Symlink already exists: bazel-bin/tensorflow/tools/pip_package/build_pip_package.runfiles/org_tensorflow/tensorflow/libtensorflow_cc.so.2
~/tensorflow ~/tensorflow
~/tensorflow
~/tensorflow ~/tensorflow
~/tensorflow
~/tensorflow/bazel-bin/tensorflow/tools/pip_package/build_pip_package.runfiles/org_tensorflow ~/tensorflow
~/tensorflow
./bazel-bin/tensorflow/tools/pip_package/build_pip_package: line 255: patchelf: command not found
```


### Relevant log output

_No response_",False
TensorFlow Not Detecting GPU on Compute Node stat:awaiting response type:build/install type:support stale comp:gpu TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

v1.12.1-99044-gc6ecfeac886 2.15.0-dev20230825

### Custom code

No

### OS platform and distribution

CentOS Linux release 7.9.2009 (Core)

### Mobile device

_No response_

### Python version

3.9.13

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11.8.0 / 8.7.0.84

### GPU model and memory

_No response_

### Current behavior?

## Behavior summary 🖥️

I'm trying to set up TensorFlow on a compute node within our scientific computing cluster and am running into a problem. After setting up a new environment and installing TensorFlow, running TensorFlow's `tf.config.list_physical_devices('GPU')` method returns an empty list, indicating no GPU devices are detected. However, `nvidia-smi` shows a Quadro RTX 6000 GPU present on the system. The TensorFlow CPU validation works without issues, but the GPU validation does not.

## Possible Areas of Concern 🚩

1. **Modules vs. Conda/Pip Installations:** I've loaded specific versions of CUDA and cuDNN using the cluster's module system. However, I also used conda and pip to install these within my environment. Could this mixed approach cause any conflicts for TensorFlow? I'm unsure which version TensorFlow might prioritize or if it would create any confusion.
2. **CUDA Version Mismatch?:** When I run `nvidia-smi`, it indicates a CUDA version of 12.2. Yet, I've loaded and installed a CUDA version of 11.8 using both modules and conda. I'm wondering if this difference could lead to any issues. Does TensorFlow need a strict match with the CUDA version?
3. **Different cuDNN Version:** The TensorFlow installation guide mentioned cuDNN version 8.6.0.163, but I installed 8.7.0.84 for what I thought might be better consistency with the modules I loaded. Could this version difference be problematic? Is TensorFlow particular about the cuDNN version it works with?

I'm looking for insights from anyone who might have navigated similar issues or can provide clarity on these points. Also of course if anyone knows how I might go about further troubleshooting/diagnosing this that'd be great. Thanks for the help!  

### Standalone code to reproduce the issue

```shell
# Setting up a new conda environment with python 3.9
conda create --name myenv python=3.9
conda activate myenv

# Running NVIDIA's System Management Interface to check GPU
nvidia-smi

# Loading necessary modules for CUDA/cuDNN
module load cuda-11.8.0-gcc-8.2.0-rqftjjg
module load cudnn-8.7.0.84-11.8-gcc-8.2.0-qibz3ue

# Installing CUDA Toolkit and cuDNN using Conda and Pip
conda install -c conda-forge cudatoolkit=11.8.0
pip install nvidia-cudnn-cu11==8.7.0.84

# Configuring system paths
mkdir -p $CONDA_PREFIX/etc/conda/activate.d
echo 'CUDNN_PATH=$(dirname $(python -c ""import nvidia.cudnn;print(nvidia.cudnn.__file__)""))' >> $CONDA_PREFIX/etc/conda/activate.d/env_vars.sh
echo 'export LD_LIBRARY_PATH=$CUDNN_PATH/lib:$CONDA_PREFIX/lib/:$LD_LIBRARY_PATH' >> $CONDA_PREFIX/etc/conda/activate.d/env_vars.sh

# Upgrading pip and installing TensorFlow
pip install --upgrade pip
pip install tensorflow==2.13.*

# Running CPU validation
python3 -c ""import tensorflow as tf; print(tf.reduce_sum(tf.random.normal([1000, 1000])))""

# Running GPU validation
python3 -c ""import tensorflow as tf; print(tf.config.list_physical_devices('GPU'))""
```


### Relevant log output

```shell
# CPU validation
2023-08-25 14:11:07.056941: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-08-25 14:11:07.105836: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-08-25 14:11:08.620525: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2023-08-25 14:11:10.459520: E tensorflow/compiler/xla/stream_executor/cuda/cuda_driver.cc:268] failed call to cuInit: CUDA_ERROR_UNKNOWN: unknown error
2023-08-25 14:11:10.459591: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:168] retrieving CUDA diagnostic information for host: scu-node018.scu
2023-08-25 14:11:10.459608: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:175] hostname: scu-node018.scu
2023-08-25 14:11:10.459712: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:199] libcuda reported version is: 535.104.5
2023-08-25 14:11:10.459783: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:203] kernel reported version is: 535.104.5
2023-08-25 14:11:10.459811: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:309] kernel version seems to match DSO: 535.104.5
tf.Tensor(-964.9978, shape=(), dtype=float32)

# GPU validation
2023-08-25 14:11:35.537281: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-08-25 14:11:35.582391: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-08-25 14:11:36.286683: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2023-08-25 14:11:36.956393: E tensorflow/compiler/xla/stream_executor/cuda/cuda_driver.cc:268] failed call to cuInit: CUDA_ERROR_UNKNOWN: unknown error
2023-08-25 14:11:36.956458: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:168] retrieving CUDA diagnostic information for host: scu-node018.scu
2023-08-25 14:11:36.956495: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:175] hostname: scu-node018.scu
2023-08-25 14:11:36.956591: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:199] libcuda reported version is: 535.104.5
2023-08-25 14:11:36.956655: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:203] kernel reported version is: 535.104.5
2023-08-25 14:11:36.956683: I tensorflow/compiler/xla/stream_executor/cuda/cuda_diagnostics.cc:309] kernel version seems to match DSO: 535.104.5
[]

# nvidia-smi Outpu
Fri Aug 25 13:59:33 2023
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.104.05             Driver Version: 535.104.05   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  Quadro RTX 6000                Off | 00000000:AF:00.0 Off |                    0 |
| N/A   31C    P0              54W / 250W |      0MiB / 23040MiB |      5%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+

+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
```
",False
Nvidia RTX 3500 Ada generation graphic card not recognised by tensorflow? stat:awaiting response type:build/install subtype:windows TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.13.0

### Custom code

Yes

### OS platform and distribution

Windows 10

### Mobile device

_No response_

### Python version

3.11.4

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

v11

### GPU model and memory

RTX 3500 Ada generation mobile 12GB

### Current behavior?

The RTX 3500 card cannot be recognised by tensorflow. I ran tf.config.list_physical_devices('GPU') and tf.test.is_gpu_available(). The results returned ""0 GPUs available"" and ""False"".

The microsoft visual studio 2017 is also installed.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf

print(""Num GPUs Available: "", len(tf.config.list_physical_devices('GPU')))

tf.test.is_gpu_available()
```


### Relevant log output

_No response_",False
Error starting Tensorflow in Python stat:awaiting response type:build/install type:support stale type:others TF 2.13,"### Issue type

Others

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

Rocky Linux 8.8

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

12

### GPU model and memory

24 GB

### Current behavior?

Unable to load tensorflow in python with CUDA 12.2. Looking for some pointers

### Standalone code to reproduce the issue

```shell
pip install tensorflow
python
>>> import tensorflow as tf
 python3 -c ""import tensorflow as tf; print(tf.config.list_physical_devices('GPU'))""                                                                                
2023-08-24 15:39:47.107770: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-08-24 15:39:47.108805: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.                                                                          
2023-08-24 15:39:47.130307: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.                                                                          
2023-08-24 15:39:47.130612: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.                       
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.                                                                            
2023-08-24 15:39:47.496076: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT                                                                                      
2023-08-24 15:39:48.008342: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:995] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355                                                                                
2023-08-24 15:39:48.023762: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1960] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would
like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.                                                              
Skipping registering GPU devices...
[]
```


### Relevant log output

_No response_",False
Recent update of xnnpack broke compilation of TensorFlow Lite stat:awaiting response type:build/install comp:lite subtype: raspberry pi comp:lite-xnnpack,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Didn't tried

### Source

source

### TensorFlow version

7701a45e3893bbf8c451f6437d039172db89d548

### Custom code

No

### OS platform and distribution

Raspberry Pi 4, Raspbian 

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

Raspberry Pi 4

### Current behavior?

Updating **xnnpack** in https://github.com/tensorflow/tensorflow/commit/7701a45e3893bbf8c451f6437d039172db89d548 broke the compilation with this error:

```
/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/xnnpack/src/configs/gemm-config.c: In function ‘init_f16_gemm_config’:
gmake[3]: Entering directory '/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build'
cd /home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build && /home/pi/.local/pipx/venvs/cmake/lib/python3.9/site-packages/cmake/data/bin/cmake -E cmake_depends ""Unix Makefiles"" /home/pi/src/tensorflow_src/tensorflow/lite /home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/abseil-cpp/absl/strings /home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build /home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/_deps/abseil-cpp-build/absl/strings /home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/_deps/abseil-cpp-build/absl/strings/CMakeFiles/absl_cordz_handle.dir/DependInfo.cmake --color=
/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/xnnpack/src/configs/gemm-config.c:159:18: error: ‘cpuinfo_uarch_cortex_a715’ undeclared (first use in this function); did you mean ‘cpuinfo_uarch_cortex_a710’?
  159 |             case cpuinfo_uarch_cortex_a715:
      |                  ^~~~~~~~~~~~~~~~~~~~~~~~~
      |                  cpuinfo_uarch_cortex_a710
/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/xnnpack/src/configs/gemm-config.c:159:18: note: each undeclared identifier is reported only once for each function it appears in
gmake[3]: Entering directory '/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build'
/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/xnnpack/src/configs/gemm-config.c:162:18: error: ‘cpuinfo_uarch_cortex_x3’ undeclared (first use in this function); did you mean ‘cpuinfo_uarch_cortex_x2’?
  162 |             case cpuinfo_uarch_cortex_x3:
      |                  ^~~~~~~~~~~~~~~~~~~~~~~
      |                  cpuinfo_uarch_cortex_x2
gmake[3]: Leaving directory '/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build'
/usr/bin/gmake  -f _deps/abseil-cpp-build/absl/flags/CMakeFiles/absl_flags_program_name.dir/build.make _deps/abseil-cpp-build/absl/flags/CMakeFiles/absl_flags_program_name.dir/build
```

The version of **cpuinfo** downloaded in `tensorflow/lite/tools/cmake/modules/cpuinfo.cmake` doesn't include `cpuinfo_uarch_cortex_a715` or `cpuinfo_uarch_cortex_x3`

### Standalone code to reproduce the issue

```shell
Follow steps from https://www.tensorflow.org/lite/guide/build_cmake_pip
```


### Relevant log output

```shell
/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/xnnpack/src/configs/gemm-config.c: In function ‘init_f16_gemm_config’:
gmake[3]: Entering directory '/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build'
cd /home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build && /home/pi/.local/pipx/venvs/cmake/lib/python3.9/site-packages/cmake/data/bin/cmake -E cmake_depends ""Unix Makefiles"" /home/pi/src/tensorflow_src/tensorflow/lite /home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/abseil-cpp/absl/strings /home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build /home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/_deps/abseil-cpp-build/absl/strings /home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/_deps/abseil-cpp-build/absl/strings/CMakeFiles/absl_cordz_handle.dir/DependInfo.cmake --color=
/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/xnnpack/src/configs/gemm-config.c:159:18: error: ‘cpuinfo_uarch_cortex_a715’ undeclared (first use in this function); did you mean ‘cpuinfo_uarch_cortex_a710’?
  159 |             case cpuinfo_uarch_cortex_a715:
      |                  ^~~~~~~~~~~~~~~~~~~~~~~~~
      |                  cpuinfo_uarch_cortex_a710
/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/xnnpack/src/configs/gemm-config.c:159:18: note: each undeclared identifier is reported only once for each function it appears in
gmake[3]: Entering directory '/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build'
/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build/xnnpack/src/configs/gemm-config.c:162:18: error: ‘cpuinfo_uarch_cortex_x3’ undeclared (first use in this function); did you mean ‘cpuinfo_uarch_cortex_x2’?
  162 |             case cpuinfo_uarch_cortex_x3:
      |                  ^~~~~~~~~~~~~~~~~~~~~~~
      |                  cpuinfo_uarch_cortex_x2
gmake[3]: Leaving directory '/home/pi/src/tensorflow_src/tensorflow/lite/tools/pip_package/gen/tflite_pip/python3/cmake_build'
/usr/bin/gmake  -f _deps/abseil-cpp-build/absl/flags/CMakeFiles/absl_flags_program_name.dir/build.make _deps/abseil-cpp-build/absl/flags/CMakeFiles/absl_flags_program_name.dir/build
```
",False
Image storage type:support comp:lite,"When TFLite processes image data, which variable will the read in image data be stored in? Is it TfLiteTensor.data?


How can I directly process a single image using TensorFlow Lite source code without relying on an Android app?",False
Use old project folder on tensorflow 2.13 using wls stat:awaiting response stale subtype:windows wsl2 TF 2.10,"Hi everyone, I was working on a project using tensorflow 2.10 with native gpu support. I wrongly updated the tf version to 2.13 that does not support gpu. So, I installed tensorflow 2.13 using wls2, now i don't know how to use the previous folder of my project on the conda environment created. Or intsead how to reinstall tf 2.10",False
Performance difference of passing np array vs tf tensor into tf.train.FloatList stat:awaiting tensorflower comp:apis type:performance TF 2.13,"### Issue type

Performance

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

docker tensorflow/tensorflow:latest-gpu and Ubuntu

### Mobile device

_No response_

### Python version

3.8.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

CUDA Version: 12.0 NVIDIA_SMI 525.125.06

### GPU model and memory

RTX4090

### Current behavior?

Processing numpy array is much faster than processing the same tensor. This is likely connected to https://github.com/tensorflow/tensorflow/issues/30372 (they also serialize TF tensors). Happy to submit a workaround (conversion from tensor to np array). Both CPU and GPU are affected.

### Standalone code to reproduce the issue

```shell
""""""Easily reproducible in Google Colab:
https://colab.research.google.com/drive/1gzI7kYRICSepX7OpC715zYj5_0qwrbPx
""""""

import numpy as np
import tensorflow as tf
import timeit


np_val = np.random.random(size=(10_000))
tf_val = tf.constant(np_val)
  
print(timeit.timeit(lambda: tf.train.FloatList(value=np_val), number=10))
print(timeit.timeit(lambda: tf.train.FloatList(value=tf_val), number=10))
print(timeit.timeit(lambda: tf.train.FloatList(value=tf_val.numpy()), number=10))
```


### Relevant log output

```shell
0.02872585691511631
25.905678499955684
0.02939283801242709
```
",False
`GLIBCXX_3.4.30' not found stat:awaiting response type:build/install stale subtype: ubuntu/linux TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

r2.13

### Custom code

No

### OS platform and distribution

amazon linux 2023

### Mobile device

_No response_

### Python version

3.9

### Bazel version

5.3.0

### GCC/compiler version

gcc 12.2

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

ERROR: /root/tensorflow/tensorflow/core/transforms/remapper/BUILD:14:18: TdGenerate tensorflow/core/transforms/remapper/pdll/MklPDLLPatterns.h.inc [for host] failed: (Exit 1): mlir-pdll failed: error executing command bazel-out/host/bin/external/llvm-project/mlir/mlir-pdll '-x=cpp' tensorflow/core/transforms/remapper/pdll/mkl_patterns.pdll -I ./tensorflow/core/transforms/include -I ... (remaining 15 arguments skipped)
bazel-out/host/bin/external/llvm-project/mlir/mlir-pdll: /lib64/libstdc++.so.6: version `GLIBCXX_3.4.30' not found (required by bazel-out/host/bin/external/llvm-project/mlir/mlir-pdll)


### Standalone code to reproduce the issue

```shell
ERROR: /root/tensorflow/tensorflow/core/transforms/remapper/BUILD:14:18: TdGenerate tensorflow/core/transforms/remapper/pdll/MklPDLLPatterns.h.inc [for host] failed: (Exit 1): mlir-pdll failed: error executing command bazel-out/host/bin/external/llvm-project/mlir/mlir-pdll '-x=cpp' tensorflow/core/transforms/remapper/pdll/mkl_patterns.pdll -I ./tensorflow/core/transforms/include -I ... (remaining 15 arguments skipped)
bazel-out/host/bin/external/llvm-project/mlir/mlir-pdll: /lib64/libstdc++.so.6: version `GLIBCXX_3.4.30' not found (required by bazel-out/host/bin/external/llvm-project/mlir/mlir-pdll)
```


### Relevant log output

```shell
ERROR: /root/tensorflow/tensorflow/core/transforms/remapper/BUILD:14:18: TdGenerate tensorflow/core/transforms/remapper/pdll/MklPDLLPatterns.h.inc [for host] failed: (Exit 1): mlir-pdll failed: error executing command bazel-out/host/bin/external/llvm-project/mlir/mlir-pdll '-x=cpp' tensorflow/core/transforms/remapper/pdll/mkl_patterns.pdll -I ./tensorflow/core/transforms/include -I ... (remaining 15 arguments skipped)
bazel-out/host/bin/external/llvm-project/mlir/mlir-pdll: /lib64/libstdc++.so.6: version `GLIBCXX_3.4.30' not found (required by bazel-out/host/bin/external/llvm-project/mlir/mlir-pdll)
```
",False
ERROR: C:/users/ayush/_bazel_ayush/xv6zejqw/external/llvm_openmp/BUILD.bazel:233:34: Compiling external/llvm_openmp/z_Windows_NT-586_asm.S failed: not all outputs were created or valid stat:awaiting response type:build/install stale subtype:windows TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13

### Custom code

No

### OS platform and distribution

Windows 10

### Mobile device

_No response_

### Python version

3.11.4

### Bazel version

5.3.0

### GCC/compiler version

Visual Studio Build Tools 2019 with C++ tools

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

It was fetching, extracting and compiling everything was going well and afterwards suddenly it outputs failed to build 

### Standalone code to reproduce the issue

```shell
C:\tensorflow>echo %BAZEL_VS%
C:/Program Files(x86)/Microsoft Visual Studio/2019/BuildTools

C:\tensorflow>set BAZEL_VC=C:/Program Files(x86)/Microsoft Visual Studio/2019/BuildTools/VC

C:\tensorflow>set BAZEL_SH=C:/msys64/usr/bin/bash.exe

C:\tensorflow>set BAZEL_WINSDK_FULL_VERSION=10.0.19041.0

C:\tensorflow>git checkout r2.13
Updating files: 100% (6982/6982), done.
Switched to a new branch 'r2.13'
branch 'r2.13' set up to track 'origin/r2.13'.

C:\tensorflow>set PYTHON_BIN_PATH=C:\Users\Ayush\AppData\Local\Programs\Python\Python311\python.exe

C:\tensorflow>set PYTHON_LIB_PATH=C:\Users\Ayush\AppData\Local\Programs\Python\Python311\Lib\site-packages

C:\tensorflow>set PYTHON_DIRECTORY=C:\Users\Ayush\AppData\Local\Programs\Python\Python311

C:\tensorflow>python configure.py
You have bazel 5.3.0 installed.
Do you wish to build TensorFlow with ROCm support? [y/N]: n
No ROCm support will be enabled for TensorFlow.


WARNING: Cannot build with CUDA support on Windows.
Starting in TF 2.11, CUDA build is not supported for Windows. For using TensorFlow GPU on Windows, you will need to build/install TensorFlow in WSL2.

Please specify optimization flags to use during compilation when bazel option ""--config=opt"" is specified [Default is /arch:AVX]:


Would you like to override eigen strong inline for some C++ compilation to reduce the compilation time? [Y/n]: y
Eigen strong inline overridden.

Would you like to interactively configure ./WORKSPACE for Android builds? [y/N]: n
Not configuring the WORKSPACE for Android builds.

Preconfigured Bazel build configs. You can use any of the below by adding ""--config=<>"" to your build command. See .bazelrc for more details.
        --config=mkl            # Build with MKL support.
        --config=mkl_aarch64    # Build with oneDNN and Compute Library for the Arm Architecture (ACL).
        --config=monolithic     # Config for mostly static monolithic build.
        --config=numa           # Build with NUMA support.
        --config=dynamic_kernels        # (Experimental) Build kernels into separate shared objects.
        --config=v1             # Build with TensorFlow 1 API instead of TF 2 API.
Preconfigured Bazel build configs to DISABLE default on features:
        --config=nogcp          # Disable GCP support.
        --config=nonccl         # Disable NVIDIA NCCL support.

C:\tensorflow>bazel build --config=opt --config=mkl --copt=-msse --copt=-msse2 --copt=-msse3 --copt=-msse4.1 --copt=-msse4.2 //tensorflow/tools/pip_package:build_pip_package
```


### Relevant log output

```shell
INFO: Analyzed target //tensorflow/tools/pip_package:build_pip_package (614 packages loaded, 36592 targets configured).
INFO: Found 1 target...
ERROR: C:/users/ayush/_bazel_ayush/xv6zejqw/external/llvm_openmp/BUILD.bazel:233:34: output 'external/llvm_openmp/_objs/libiomp5md.dll/z_Windows_NT-586_asm.obj' was not created
ERROR: C:/users/ayush/_bazel_ayush/xv6zejqw/external/llvm_openmp/BUILD.bazel:233:34: Compiling external/llvm_openmp/z_Windows_NT-586_asm.S failed: not all outputs were created or valid
MASM : warning A4018:invalid command-line option : /bigobj
MASM : warning A4018:invalid command-line option : /Zm500
MASM : warning A4018:invalid command-line option : /Z500
MASM : warning A4018:invalid command-line option : /Z00
MASM : warning A4018:invalid command-line option : /Z0
MASM : warning A4018:invalid command-line option : /EHsc
MASM : warning A4018:invalid command-line option : /wd4351
MASM : warning A4018:invalid command-line option : /wd4291
MASM : warning A4018:invalid command-line option : /wd4250
MASM : warning A4018:invalid command-line option : /wd4996
MASM : warning A4018:invalid command-line option : /showIncludes
 Assembling: bazel-out/x64_windows-opt/bin/external/llvm_openmp/z_Windows_NT-586_asm.S
Target //tensorflow/tools/pip_package:build_pip_package failed to build
INFO: Elapsed time: 6810.134s, Critical Path: 970.02s
INFO: 1408 processes: 307 internal, 1101 local.
FAILED: Build did NOT complete successfully
```
",False
"Error in PredictCost() for the op: op: ""CropAndResize"" attr stat:awaiting response type:others comp:ops TF 2.13","### Issue type

Others

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 2.13.0

### Custom code

Yes

### OS platform and distribution

Ubuntu 20.04

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

We have a model that used to run on python 3.7 + tensorflow 2.4.1. When upgrading to tensorflow 2.13.0, we're seeing this error message, which seems to correlate with the degradation of our model performance. Any idea what might be leading to this error and what could be changed? 

It does seem like when I remove `tf.function` decorator, this error message goes away. So, I'm assuming it has something to do with tracing, but not entirely sure why it's erroring out in tf 2.13 and not in 2.4.1...

```
Error in PredictCost() for the op: op: ""CropAndResize"" attr { key: ""T"" value { type: DT_FLOAT } } attr { key: ""extrapolation_value"" value { f: 0 } } attr { key: ""method"" value { s: ""bilinear"" } } inputs { dtype: DT_FLOAT shape { dim { size: -569 } dim { size: 128 } dim { size: 224 } dim { size: 2 } } } inputs { dtype: DT_FLOAT shape { dim { size: -16 } dim { size: 4 } } } inputs { dtype: DT_INT32 shape { dim { size: -16 } } } inputs { dtype: DT_INT32 shape { dim { size: 2 } } value { dtype: DT_INT32 tensor_shape { dim { size: 2 } } tensor_content: ""\030\000\000\000\020\000\000\000"" } } device { type: ""GPU"" vendor: ""NVIDIA"" model: ""Tesla V100-SXM2-16GB"" frequency: 1530 num_cores: 80 environment { key: ""architecture"" value: ""7.0"" } environment { key: ""cuda"" value: ""11080"" } environment { key: ""cudnn"" value: ""8600"" } num_registers: 65536 l1_cache_size: 24576 l2_cache_size: 6291456 shared_memory_size_per_multiprocessor: 98304 memory_size: 11614814208 bandwidth: 898048000 } outputs { dtype: DT_FLOAT shape { dim { size: -16 } dim { size: 24 } dim { size: 16 } dim { size: 2 } } }
```

### Standalone code to reproduce the issue

```shell
I don't have a standalone code to reproduce the issue, but would just like some feedback on what might be causing the above issue...
```


### Relevant log output

_No response_",False
" W tensorflow/core/grappler/costs/op_level_cost_estimator.cc:689] Error in PredictCost() for the op: op: ""Conv2D"" attr { key: ""T"" value { type: DT_FLOAT } } attr { key: ""data_format"" value { s: ""NCHW"" } } attr { key: ""dilations"" value  stat:awaiting response stale type:others comp:grappler TF 2.7","### Issue type

Others

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf.2.7.0

### Custom code

Yes

### OS platform and distribution

Windows 10

### Mobile device

_No response_

### Python version

3.9.12

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11.6

### GPU model and memory

GPU 8 / NVIDIA SMI 512.98

### Current behavior?

I am getting the below error message while loading the model on tf 2.7.0. But there is no issue with the prediction. 
I have converted Keras model into tf2 and loaded them in production. 



### Standalone code to reproduce the issue

```shell
: W tensorflow/core/grappler/costs/op_level_cost_estimator.cc:689] Error in PredictCost() for the op: op: ""Conv2D"" attr { key: ""T"" value { type: DT_FLOAT } } attr { key: ""data_format"" value { s: ""NCHW"" } } attr { key: ""dilations"" value { list { i: 1 i: 1 i: 1 i: 1 } } } attr { key: ""explicit_paddings"" value { list { } } } attr { key: ""padding"" value { s: ""SAME"" } } attr { key: ""strides"" value { list { i: 1 i: 1 i: 1 i: 1 } } } attr { key: ""use_cudnn_on_gpu"" value { b: true } } inputs { dtype: DT_FLOAT shape { dim { } dim { size: 62 } dim { size: 4 } dim { size: 4 } } } inputs { dtype: DT_FLOAT shape { dim { size: 1 } dim { size: 1 } dim { size: 62 } dim { size: 31 } } } device { type: ""GPU"" vendor: ""NVIDIA"" model: ""NVIDIA GeForce GTX 1070"" frequency: 1695 num_cores: 16 environment { key: ""architecture"" value: ""6.1"" } environment { key: ""cuda"" value: ""11020"" } environment { key: ""cudnn"" value: ""8100"" } num_registers: 65536 l1_cache_size: 24576 l2_cache_size: 2097152 shared_memory_size_per_multiprocessor: 98304 memory_size: 6952124416 bandwidth: 256256000 } outputs { dtype: DT_FLOAT shape { dim { } dim { size: 31 } dim { size: 4 } dim { size: 4 } } }
```


### Relevant log output

_No response_",False
SIGBUS from libc on Android during inference comp:lite TFLiteConverter Android TF 2.13,"### 1. System information

Server that generated the TFLite file:

- OS Platform and Distribution: `Linux debian 6.1.0-9-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.27-1 (2023-05-08) x86_64 GNU/Linux`.
- TensorFlow installation: Pip.
- TensorFlow library: tensorflow 2.13.0.

Android client that interprets this TFLite file and crashed:

- OS Platform and Distribution: Huawei `Hebe-BD00` running version 12.0.1 (presumably HarmonyOS).
- TensorFlow library: [Gradle dependencies on latest TFLite, GPU, support, and select TF Ops](https://github.com/FedCampus/FedKit/blob/f1ba4d438d19b5d984fe8d0fc6defd3710cc5892/android/fed_kit_train/build.gradle.kts).

### 2. Code

#### Option B: Paste your code here or provide a link to a custom end-to-end colab

This code is [under `gen_tflite` in FedKit](https://github.com/FedCampus/FedKit/tree/f1ba4d438d19b5d984fe8d0fc6defd3710cc5892/gen_tflite).
It is used to create [the TFLite files](https://github.com/FedCampus/FedKit/files/12391810/fed_mcrnn1.tflite.zip).

<details>
<summary>gen_tflite/__init__.py</summary>

```python
import tensorflow as tf

SAVED_MODEL_DIR = ""saved_model""


def red(string: str) -> str:
    return f""\033[91m{string}\033[0m""


class BaseTFLiteModel(tf.Module):
    """"""Base TFLite model class to inherit from.
    # Usage
    Inherent from this class and then annotate with `@tflite_model_class`.
    Override these attributes:
    - `X_SHAPE`: Shape of the input to the model.
    - `Y_SHAPE`: Shape of the output from the model.
    - `model`: A `tf.keras.Model` initialized in `__init__`.
    # Functionality
    Provides default implementation of `train`, `infer`, `parameters`, `restore`.
    These methods are not annotated with `@tf.function`;
    they are supposed to be converted by `@tflite_model_class`.""""""

    X_SHAPE: list[int]
    Y_SHAPE: list[int]
    model: tf.keras.Model

    def train(self, x, y):
        return self.model.train_step((x, y))

    def infer(self, x):
        return {""logits"": self.model(x)}

    def parameters(self):
        return {
            f""a{index}"": weight.read_value()
            for index, weight in enumerate(self.model.weights)
        }

    def restore(self, **parameters):
        for index, weight in enumerate(self.model.weights):
            parameter = parameters[f""a{index}""]
            weight.assign(parameter)
        assert self.parameters is not None
        return self.parameters()


def tflite_model_class(cls):
    """"""Convert `cls` that inherits from `BaseTFLiteModel` to a TFLite model class.
    Convert `cls`'s methods using `@tf.function` with proper `input_signature`
    according to `X_SHAPE` and `Y_SHAPE`.
    The converted methods are `train`, `infer`, `parameters`, `restore`.
    Only `restore`'s `input_signature` is not specified because it need to be
    determined after examples of parameters are given.""""""
    cls.x_spec = tf.TensorSpec([None] + cls.X_SHAPE, tf.float32)  # type: ignore
    cls.y_spec = tf.TensorSpec([None] + cls.Y_SHAPE, tf.float32)  # type: ignore
    cls.train = tf.function(
        cls.train,
        input_signature=[cls.x_spec, cls.y_spec],
    )
    cls.infer = tf.function(
        cls.infer,
        input_signature=[cls.x_spec],
    )
    cls.parameters = tf.function(cls.parameters, input_signature=[])
    cls.restore = tf.function(cls.restore)
    return cls


def save_model(model, saved_model_dir):
    parameters = model.parameters.get_concrete_function()
    init_params = parameters()
    print(f""Initial parameters is {init_params}."")
    restore = model.restore.get_concrete_function(**init_params)
    restore_test = restore(**init_params)
    print(f""Restore test result: {restore_test}."")
    tf.saved_model.save(
        model,
        saved_model_dir,
        signatures={
            ""train"": model.train.get_concrete_function(),
            ""infer"": model.infer.get_concrete_function(),
            ""parameters"": parameters,
            ""restore"": restore,
        },
    )

    converted_params = [
        param.numpy() for param in parameters_from_raw_dict(init_params)
    ]
    shape = f""{[list(param.shape) for param in converted_params]}""
    print(f""Model parameter shape: {red(shape)}."")
    byte_sizes = f""{[param.size * param.itemsize for param in converted_params]}""
    print(f""Model parameter sizes in bytes: {red(byte_sizes)}."")
    return converted_params


def convert_saved_model(saved_model_dir):
    converter = tf.lite.TFLiteConverter.from_saved_model(saved_model_dir)
    converter.target_spec.supported_ops = [
        tf.lite.OpsSet.TFLITE_BUILTINS,  # enable TensorFlow Lite ops.
        tf.lite.OpsSet.SELECT_TF_OPS,  # enable TensorFlow ops.
    ]

    converter.experimental_enable_resource_variables = True
    tflite_model = converter.convert()

    return tflite_model


def parameters_from_raw_dict(raw_dict):
    parameters = []
    index = 0
    while True:
        parameter = raw_dict.get(f""a{index}"")
        if parameter is None:
            break
        parameters.append(parameter)
        index += 1
    return parameters


def save_tflite_model(tflite_model, tflite_file):
    with open(tflite_file, ""wb"") as model_file:
        return model_file.write(tflite_model)
```

</details>

<details>
<summary>gen_tflite/fed_mcrnn_eg/run.py</summary>

```python
from os import path

from .. import *
from . import FedMCRNNModel

DIR = path.dirname(__file__)


TFLITE_FILE = f""fed_mcrnn1.tflite""


def main():
    model = FedMCRNNModel()
    save_model(model, SAVED_MODEL_DIR)
    tflite_model = convert_saved_model(SAVED_MODEL_DIR)
    save_tflite_model(tflite_model, TFLITE_FILE)


main() if __name__ == ""__main__"" else None
```

</details>

<details>
<summary>gen_tflite/fed_mcrnn_eg/__init__.py</summary>

```python
from tensorflow import keras

from .. import *


@tflite_model_class
class FedMCRNNModel(BaseTFLiteModel):
    X_SHAPE = [7, 8]
    Y_SHAPE = [1]

    def __init__(self):
        self.model = self.build_model()

    def build_model(self):
        """"""Written and tuned by Aicha Slaitane in Aug 2023.""""""
        model = keras.Sequential()
        # For the first LSTM layer, specify the input_shape
        model.add(
            keras.layers.LSTM(
                # Tune number of units separately.
                units=384,
                input_shape=self.X_SHAPE,
                return_sequences=True,
            )
        )
        model.add(keras.layers.LeakyReLU(0.523629795960645))
        model.add(keras.layers.Dropout(0.372150795833))

        # For subsequent LSTM layers, no need to specify input_shape
        model.add(
            keras.layers.LSTM(
                units=64,
                return_sequences=True,
            )
        )
        model.add(keras.layers.LeakyReLU(0.523629795960645))
        model.add(keras.layers.Dropout(0.372150795833))

        model.add(
            keras.layers.LSTM(
                units=480,
                return_sequences=True,
            )
        )
        model.add(keras.layers.LeakyReLU(0.523629795960645))
        model.add(keras.layers.Dropout(0.372150795833))
        model.add(keras.layers.Flatten())
        model.add(keras.layers.Dense(1))

        model.compile(
            optimizer=keras.optimizers.Adam(learning_rate=0.00668472266354),
            loss=""mean_squared_error"",
            metrics=[""mean_absolute_error""],
        )
        return model
```

</details>

Command to build the TFLite file: `python3 -m gen_tflite.fed_mcrnn_eg.run`.

---

Code used on the Android side is [in `FlowerClient.kt` in FedKit](https://github.com/FedCampus/FedKit/blob/f1ba4d438d19b5d984fe8d0fc6defd3710cc5892/android/fed_kit_train/src/main/java/org/eu/fedcampus/fed_kit_train/FlowerClient.kt).

<details>
<summary>Relevant code</summary>

```kotlin
/**
 * Flower client that handles TensorFlow Lite model [Interpreter] and sample data.
 * @param tfliteFileBuffer TensorFlow Lite model file.
 * @param spec Specification for the samples, see [SampleSpec].
 */
class FlowerClient<X : Any, Y : Any>(
    tfliteFileBuffer: MappedByteBuffer,
    val layersSizes: IntArray,
    val spec: SampleSpec<X, Y>,
) : AutoCloseable {
    val interpreter = Interpreter(tfliteFileBuffer)
    val interpreterLock = ReentrantLock()
    val trainingSamples = mutableListOf<Sample<X, Y>>()
    val testSamples = mutableListOf<Sample<X, Y>>()
    val trainSampleLock = ReentrantReadWriteLock()
    val testSampleLock = ReentrantReadWriteLock()

    /**
     * Run inference on [x] using [interpreter] and return the result.
     */
    fun inference(x: Array<X>): Array<Y> {
        val inputs = mapOf(""x"" to x)
        val logits = spec.emptyY(x.size)
        val outputs = mapOf(""logits"" to logits)
        runSignatureLocked(inputs, outputs, ""infer"")
        return logits
    }

    private fun runSignatureLocked(
        inputs: Map<String, Any>,
        outputs: Map<String, Any>,
        signatureKey: String
    ) {
        interpreterLock.withLock {
            interpreter.runSignature(inputs, outputs, signatureKey)
        }
    }
}
```

</details>


### 3. Failure after conversion

See also [issue `Training Fatel Signal` on FedKit](https://github.com/FedCampus/FedKit/issues/15):

<details>
<summary>Crash log</summary>

```ruby
F/libc    (25011): Fatal signal 7 (SIGBUS), code 2 (BUS_ADRERR), fault addr 0x77db8b7690 in tid 10606 (DefaultDispatch), pid 25011 (.cuhk.fedcampus)
*** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
Build fingerprint: 'Hinova/TINA-AN00/TS-TINA-Q:11/HinovaHebe-BD00/102.0.1.166C11:user/release-keys'
Revision: '0'
ABI: 'arm64'
Timestamp: 2023-08-21 09:42:39+0800
pid: 25011, tid: 10606, name: DefaultDispatch  >>> com.cuhk.fedcampus <<<
uid: 10263
signal 7 (SIGBUS), code 2 (BUS_ADRERR), fault addr 0x77db8b7690
    x0  b4000077a668b344  x1  00000077db8b7690  x2  0000000000000004  x3  0000000000000001
    x4  00000077db8b7694  x5  b4000077a668b348  x6  0000000000000008  x7  0000000000000008
    x8  00000077db8b7690  x9  0000000000000000  x10 b4000077da4d1bc0  x11 00000077db8b7690
    x12 3ddde2cdbc34570b  x13 3deefded3df00685  x14 0000000000000003  x15 00000000ebad6a89
    x16 00000077ce7e1ed0  x17 00000078ef4d8c40  x18 00000077d1238000  x19 0000000000000004
    x20 b4000077a668b340  x21 b4000077f8cc3b10  x22 0000000000000000  x23 0000000000000001
    x24 0000000000000001  x25 0000000000000001  x26 0000000000000001  x27 0000000000000001
    x28 0000000000000002  x29 00000078589791f0
    lr  00000077ce5999ec  sp  0000007858979110  pc  00000078ef4d8b44  pst 0000000080001000
backtrace:
#00 pc 0000000000086b44  /apex/com.android.runtime/lib64/bionic/libc.so (__memcpy+116) (BuildId: ed6fa1d1056492860af901caffabe1a6)
      #01 pc 000000000014e9e8  /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk!libtensorflowlite_jni.so (offset 0x8263000)
      #02 pc 00000000002d5d68  /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk!libtensorflowlite_jni.so (offset 0x8263000)
      #03 pc 00000000002d575c  /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk!libtensorflowlite_jni.so (offset 0x8263000)
      #04 pc 00000000002c25a8  /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk!libtensorflowlite_jni.so (offset 0x8263000)
      #05 pc 0000000000025668  /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk!libtensorflowlite_jni.so (offset 0x8263000) (Java_org_tensorflow_lite_NativeInterpreterWrapper_run+100)
      #06 pc 000000000014fed4  /apex/com.android.art/lib64/libart.so (art_quick_generic_jni_trampoline+148) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #07 pc 00000000001467e8  /apex/com.android.art/lib64/libart.so (art_quick_invoke_static_stub+568) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #08 pc 00000000001bc26c  /apex/com.android.art/lib64/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+236) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #09 pc 00000000003361cc  /apex/com.android.art/lib64/libart.so (art::interpreter::ArtInterpreterToCompiledCodeBridge(art::Thread*, art::ArtMethod*, art::ShadowFrame*, unsigned short, art::JValue*)+376) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #10 pc 000000000032c440  /apex/com.android.art/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+996) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #11 pc 00000000006ce704  /apex/com.android.art/lib64/libart.so (MterpInvokeStatic+548) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #12 pc 0000000000140994  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_static+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #13 pc 00000000003f9aea  [anon:dalvik-classes.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk] (org.tensorflow.lite.NativeInterpreterWrapper.run+122)
      #14 pc 00000000003236fc  /apex/com.android.art/lib64/libart.so (art::interpreter::Execute(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame&, art::JValue, bool, bool) (.llvm.15210458325005997145)+348) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #15 pc 00000000006abad0  /apex/com.android.art/lib64/libart.so (artQuickToInterpreterBridge+780) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #16 pc 000000000014fff8  /apex/com.android.art/lib64/libart.so (art_quick_to_interpreter_bridge+88) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #17 pc 000000000206b0f4  /memfd:jit-cache (deleted) (offset 0x2000000) (org.tensorflow.lite.NativeInterpreterWrapper.runSignature+1044)
      #18 pc 0000000000146564  /apex/com.android.art/lib64/libart.so (art_quick_invoke_stub+548) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #19 pc 00000000001bc250  /apex/com.android.art/lib64/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+208) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #20 pc 00000000003361cc  /apex/com.android.art/lib64/libart.so (art::interpreter::ArtInterpreterToCompiledCodeBridge(art::Thread*, art::ArtMethod*, art::ShadowFrame*, unsigned short, art::JValue*)+376) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #21 pc 000000000032c440  /apex/com.android.art/lib64/libart.so (bool art::interpreter::DoCall<false, false>(art::ArtMethod*, art::Thread*, art::ShadowFrame&, art::Instruction const*, unsigned short, art::JValue*)+996) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #22 pc 00000000006cb78c  /apex/com.android.art/lib64/libart.so (MterpInvokeVirtual+848) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #23 pc 0000000000140814  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_virtual+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #24 pc 00000000003f8e14  [anon:dalvik-classes.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk] (org.tensorflow.lite.Interpreter.runSignature+36)
      #25 pc 00000000006cba2c  /apex/com.android.art/lib64/libart.so (MterpInvokeVirtual+1520) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #26 pc 0000000000140814  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_virtual+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #27 pc 00000000003f6440  [anon:dalvik-classes.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk] (org.eu.fedcampus.fed_kit_train.FlowerClient.runSignatureLocked+20)
      #28 pc 00000000006ce0c8  /apex/com.android.art/lib64/libart.so (MterpInvokeDirect+1248) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #29 pc 0000000000140914  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_direct+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #30 pc 00000000003f5aa0  [anon:dalvik-classes.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk] (org.eu.fedcampus.fed_kit_train.FlowerClient.inference+84)
      #31 pc 00000000006cba2c  /apex/com.android.art/lib64/libart.so (MterpInvokeVirtual+1520) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #32 pc 0000000000140814  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_virtual+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #33 pc 00000000003f616e  [anon:dalvik-classes.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk] (org.eu.fedcampus.fed_kit_train.FlowerClient.evaluate+146)
      #34 pc 00000000006cba2c  /apex/com.android.art/lib64/libart.so (MterpInvokeVirtual+1520) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #35 pc 0000000000140814  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_virtual+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #36 pc 0000000000001284  [anon:dalvik-classes7.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk!classes7.dex] (com.cuhk.fedcampus.train.FedmcrnnClient$evaluate$1.invokeSuspend+52)
      #37 pc 00000000006cba2c  /apex/com.android.art/lib64/libart.so (MterpInvokeVirtual+1520) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #38 pc 0000000000140814  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_virtual+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #39 pc 0000000000001234  [anon:dalvik-classes7.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk!classes7.dex] (com.cuhk.fedcampus.train.FedmcrnnClient$evaluate$1.invoke+16)
      #40 pc 00000000006cba2c  /apex/com.android.art/lib64/libart.so (MterpInvokeVirtual+1520) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #41 pc 0000000000140814  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_virtual+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #42 pc0000000000001208  [anon:dalvik-classes7.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk!classes7.dex] (com.cuhk.fedcampus.train.FedmcrnnClient$evaluate$1.invoke+4)
      #43 pc 00000000006cd464  /apex/com.android.art/lib64/libart.so (MterpInvokeInterface+1808) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #44 pc 0000000000140a14  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_interface+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #45 pc 0000000000001b00  [anon:dalvik-classes7.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk!classes7.dex] (com.cuhk.fedcampus.train.FedmcrnnClient$tryLaunch$1.invokeSuspend+72)
      #46 pc 00000000006cba2c  /apex/com.android.art/lib64/libart.so (MterpInvokeVirtual+1520) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #47 pc 0000000000140814  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_virtual+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #48 pc 0000000000363596  [anon:dalvik-classes.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk] (kotlin.coroutines.jvm.internal.BaseContinuationImpl.resumeWith+42)
      #49 pc 00000000006cd464  /apex/com.android.art/lib64/libart.so (MterpInvokeInterface+1808) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #50 pc 0000000000140a14  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_interface+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #51 pc 00000000003a9a98  [anon:dalvik-classes.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk] (kotlinx.coroutines.DispatchedTask.run+448)
      #52 pc 00000000006cba2c  /apex/com.android.art/lib64/libart.so (MterpInvokeVirtual+1520) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #53 pc 0000000000140814  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_virtual+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #54 pc 00000000003ea81e  [anon:dalvik-classes.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk] (kotlinx.coroutines.scheduling.CoroutineScheduler.runSafely+2)
      #55 pc 00000000006cba2c  /apex/com.android.art/lib64/libart.so (MterpInvokeVirtual+1520) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #56 pc 0000000000140814  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_virtual+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #57 pc 00000000003e93fa  [anon:dalvik-classes.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk] (kotlinx.coroutines.scheduling.CoroutineScheduler$Worker.executeTask+34)
      #58 pc 00000000006ce0c8  /apex/com.android.art/lib64/libart.so (MterpInvokeDirect+1248) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #59 pc 0000000000140914  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_direct+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #60 pc 00000000003e9528  [anon:dalvik-classes.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk] (kotlinx.coroutines.scheduling.CoroutineScheduler$Worker.runWorker+56)
      #61 pc 00000000006ce0c8  /apex/com.android.art/lib64/libart.so (MterpInvokeDirect+1248) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #62 pc 0000000000140914  /apex/com.android.art/lib64/libart.so (mterp_op_invoke_direct+20) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #63 pc 00000000003e94d8  [anon:dalvik-classes.dex extracted in memory from /data/app/~~jOMJSmliax2W9nG0uNnx0g==/com.cuhk.fedcampus-KOBIK4l5h_A1eePLjPC9Jg==/base.apk] (kotlinx.coroutines.scheduling.CoroutineScheduler$Worker.run)
      #64 pc 00000000003236fc  /apex/com.android.art/lib64/libart.so (art::interpreter::Execute(art::Thread*, art::CodeItemDataAccessor const&, art::ShadowFrame&, art::JValue, bool, bool) (.llvm.15210458325005997145)+348) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #65 pc 00000000006abad0  /apex/com.android.art/lib64/libart.so (artQuickToInterpreterBridge+780) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #66 pc 000000000014fff8  /apex/com.android.art/lib64/libart.so (art_quick_to_interpreter_bridge+88) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #67 pc 0000000000146564  /apex/com.android.art/lib64/libart.so (art_quick_invoke_stub+548) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #68 pc 00000000001bc250  /apex/com.android.art/lib64/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+208) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #69 pc 0000000000591268  /apex/com.android.art/lib64/libart.so (art::JValue art::InvokeVirtualOrInterfaceWithJValues<art::ArtMethod*>(art::ScopedObjectAccessAlreadyRunnable const&, _jobject*, art::ArtMethod*, jvalue const*)+460) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #70 pc 00000000005e3bd0  /apex/com.android.art/lib64/libart.so (art::Thread::CreateCallback(void*)+1364) (BuildId: c83b725cb502ebcf2b3b28039ccfbfa6)
      #71 pc 00000000000ed068  /apex/com.android.runtime/lib64/bionic/libc.so (__pthread_start(void*)+64) (BuildId: ed6fa1d1056492860af901caffabe1a6)
      #72 pc 000000000008d5e0  /apex/com.android.runtime/lib64/bionic/libc.so (__start_thread+64) (BuildId: ed6fa1d1056492860af901caffabe1a6)
Lost connection to device.
Exited (sigterm)
```

</details>
",False
Tensorflow on Manjaro stat:awaiting response type:build/install stale subtype: ubuntu/linux TF 2.8,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.8

### Custom code

Yes

### OS platform and distribution

Linux Manjaro

### Mobile device

Android

### Python version

3.11

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

How to setup and perform main configuration on Manjaro platform

### Standalone code to reproduce the issue

```shell
I see nothin expected...
```


### Relevant log output

_No response_",False
GPU error Tensorflow with 2.1 stat:awaiting response stale type:others comp:gpu TF 2.1,"### Issue type

Others

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.1

### Custom code

Yes

### OS platform and distribution

CentOS Linux release 7.4.1708 

### Mobile device

_No response_

### Python version

3.6

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

10/7

### GPU model and memory

Nvidia A100 partitioned virtually in two 40GB GPUs, I am using one of them

### Current behavior?

I am working on 3D_ U-net. I am getting the ptax error with Tensorflow 2.1 when I run the 3D U-net , I am using tensorflow-large-model-support to scale the algorithm



### Standalone code to reproduce the issue

```shell
https://github.com/junaidjawaid1/3d_U-Net-TFLMS/tree/main```


### Relevant log output

```shell
Traceback (most recent call last):

File ""<string>"", line 1, in <module>

ModuleNotFoundError: No module named 'nvidia'

dirname: missing operand

Try 'dirname --help' for more information.

/opt/gridengine/default/spool/compute-0-3/job_scripts/108258: line 8: $'\342\200\213': command not found

/opt/gridengine/default/spool/compute-0-3/job_scripts/108258: line 10: $'\342\200\213': command not found

Traceback (most recent call last):

File ""<string>"", line 1, in <module>

ModuleNotFoundError: No module named 'nvidia'

dirname: missing operand

Try 'dirname --help' for more information.

2023-08-18 18:25:55.025052: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2

2023-08-18 18:25:56.869820: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer.so.7

2023-08-18 18:25:56.881355: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libnvinfer_plugin.so.7

2023-08-18 18:26:00.093020: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1

2023-08-18 18:26:00.188610: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero

2023-08-18 18:26:00.192419: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties:

pciBusID: 2c8f7:00:00.0 name: NVIDIA A100 80GB PCIe MIG 1c.4g.40gb computeCapability: 8.0

coreClock: 1.41GHz coreCount: 14 deviceMemorySize: 39.25GiB deviceMemoryBandwidth: 901.22GiB/s

2023-08-18 18:26:00.192453: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2

2023-08-18 18:26:00.192490: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10

2023-08-18 18:26:00.218166: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10

2023-08-18 18:26:00.304953: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10

2023-08-18 18:26:00.356784: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10

2023-08-18 18:26:00.396554: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10

2023-08-18 18:26:00.396599: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7

2023-08-18 18:26:00.396731: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero

2023-08-18 18:26:00.398058: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero

2023-08-18 18:26:00.399160: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0

2023-08-18 18:26:00.411267: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA

2023-08-18 18:26:00.434767: I tensorflow/core/platform/profile_utils/cpu_utils.cc:101] CPU Frequency: 2249595000 Hz

2023-08-18 18:26:00.439151: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fc06e5d220 initialized for platform Host (this does not guarantee that XLA will be used). Devices:

2023-08-18 18:26:00.439189: I tensorflow/compiler/xla/service/service.cc:176] StreamExecutor device (0): Host, Default Version

2023-08-18 18:26:00.648000: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero

2023-08-18 18:26:00.648956: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fc06ec3b80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:

2023-08-18 18:26:00.648984: I tensorflow/compiler/xla/service/service.cc:176] StreamExecutor device (0): NVIDIA A100 80GB PCIe MIG 1c.4g.40gb, Compute Capability 8.0

2023-08-18 18:26:00.649332: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero

2023-08-18 18:26:00.650184: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1558] Found device 0 with properties:

pciBusID: 2c8f7:00:00.0 name: NVIDIA A100 80GB PCIe MIG 1c.4g.40gb computeCapability: 8.0

coreClock: 1.41GHz coreCount: 14 deviceMemorySize: 39.25GiB deviceMemoryBandwidth: 901.22GiB/s

2023-08-18 18:26:00.650216: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2

2023-08-18 18:26:00.650232: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10

2023-08-18 18:26:00.650249: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10

2023-08-18 18:26:00.650258: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10

2023-08-18 18:26:00.650267: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10

2023-08-18 18:26:00.650276: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10

2023-08-18 18:26:00.650294: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7

2023-08-18 18:26:00.650351: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero

2023-08-18 18:26:00.651127: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero

2023-08-18 18:26:00.651846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1700] Adding visible gpu devices: 0

2023-08-18 18:26:00.651877: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.2

2023-08-18 18:32:04.446608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1099] Device interconnect StreamExecutor with strength 1 edge matrix:

2023-08-18 18:32:04.446938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1105] 0

2023-08-18 18:32:04.446953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1118] 0: N

2023-08-18 18:32:04.447365: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero

2023-08-18 18:32:04.448403: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero

2023-08-18 18:32:04.449678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1244] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 120000 MB memory) -> physical GPU (device: 0, name: NVIDIA A100 80GB PCIe MIG 1c.4g.40gb, pci bus id: 2c8f7:00:00.0, compute capability: 8.0)

2023-08-18 18:32:04.460014: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 117.19G (125829120000 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory

2023-08-18 18:32:04.464233: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 105.47G (113246208000 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory

2023-08-18 18:32:04.468360: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 94.92G (101921587200 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory

2023-08-18 18:32:04.472455: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 85.43G (91729428480 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory

2023-08-18 18:32:04.476553: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 76.89G (82556485632 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory

2023-08-18 18:32:04.480809: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 69.20G (74300833792 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory

2023-08-18 18:32:04.484893: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 62.28G (66870747136 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory

2023-08-18 18:32:04.488957: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 56.05G (60183670784 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory

2023-08-18 18:32:04.493121: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 50.45G (54165303296 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory

2023-08-18 18:32:04.497205: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 45.40G (48748773376 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory

2023-08-18 18:32:04.501259: I tensorflow/stream_executor/cuda/cuda_driver.cc:801] failed to allocate 40.86G (43873894400 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory

WARNING:tensorflow:sample_weight modes were coerced from

...

to

['...']

WARNING:tensorflow:sample_weight modes were coerced from

...

to

['...']

2023-08-18 18:33:25.857187: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10

2023-08-18 18:35:29.287470: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7

2023-08-18 18:46:02.247907: W tensorflow/stream_executor/gpu/redzone_allocator.cc:312] Internal: ptxas exited with non-zero error code 65280, output: ptxas fatal : Value 'sm_80' is not defined for option 'gpu-name'

Relying on driver to perform ptx compilation. This message will be only logged once.

2023-08-18 18:46:36.474700: F tensorflow/stream_executor/cuda/cuda_dnn.cc:516] Check failed: cudnnSetTensorNdDescriptor(handle_.get(), elem_type, nd, [dims.data](https://dims.data/)(), [strides.data](https://strides.data/)()) == CUDNN_STATUS_SUCCESS (3 vs. 0)batch_descriptor: {count: 7 feature_map_count: 146 spatial: 64 0 64 value_min: 0.000000 value_max: 0.000000 layout: BatchDepthYX}

/opt/gridengine/default/spool/compute-0-3/job_scripts/108258: line 13: 237129 Aborted python $PYTHON_SCRIPT
```
",False
CKPT to TFLite stat:awaiting response type:support stale comp:lite TFLiteConverter,"How can I convert ckpt file to TF Lite, while I've only .ckpt file. No meta-file present",False
"`tf.image.crop_to_bounding_box()` assumes `tf.int32` arguments, but not documented as such awaiting review type:feature type:docs-feature TF 2.13","### Issue type

Documentation Feature Request

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.13.0

### Custom code

No

### OS platform and distribution

Linux Ubuntu 22.04 (WSL 2)

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

`tf.image.crop_to_bounding_box()` implicitly assumes that the target width and height are `tf.int32`, but this is not documented anywhere. The cause for this is using `tf.shape()` which has the default `dtype` of `tf.int32`, in a stack operation:
https://github.com/tensorflow/tensorflow/blob/c9fafed9bc8cb0238a775fd4a0680e648c06b5b6/tensorflow/python/ops/image_ops_impl.py#L1250-L1254

### Standalone code to reproduce the issue

```python
import tensorflow as tf

image = tf.zeros([1000, 2000, 3], dtype=tf.uint8)
offset = tf.constant([0, 0], dtype=tf.int64)
size = tf.constant([900, 1500], dtype=tf.int64)
tf.image.crop_to_bounding_box(image, offset[0], offset[1], size[0], size[1])
```


### Relevant log output

```shell
Traceback (most recent call last):
  File ""/.../test.py"", line 6, in <module>
    tf.image.crop_to_bounding_box(image, offset[0], offset[1], size[0], size[1])
  File ""/.../.venv/lib/python3.10/site-packages/tensorflow/python/util/traceback_utils.py"", line 153, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File ""/.../.venv/lib/python3.10/site-packages/tensorflow/python/framework/ops.py"", line 6656, in raise_from_not_ok_status
    raise core._status_to_exception(e) from None  # pylint: disable=protected-access
tensorflow.python.framework.errors_impl.InvalidArgumentError: cannot compute Pack as input #1(zero-based) was expected to be a int32 tensor but is a int64 tensor [Op:Pack] name: stack
```
",False
external/XNNPACK/src/qs8-igemm/gen/4x16c8-minmax-avx512skx.c:242:15: error: implicit declaration of function '_kshiftri_mask64' is invalid in C99 stat:awaiting response type:build/install stale comp:lite TF 2.4,"I run commands
""bazel build -c opt --fat_apk_cpu=x86,x86_64,arm64-v8a,armeabi-v7a   --host_crosstool_top=@bazel_tools//tools/cpp:toolchain   //tensorflow/lite/java:tensorflow-lite""  
use 
tensorflow 2.4.0
 bazel 3.1.0 ,NDK  27 ,SDK 29 ,But what should I do to resolve the following errors！！！

ERROR: /home/ferey/.cache/bazel/_bazel_ferey/97c7558b0863433a4def08aa5708cd20/external/XNNPACK/BUILD.bazel:3516:1: C++ compilation of rule '@XNNPACK//:avx512skx_ukernels' failed (Exit 1)
external/XNNPACK/src/qs8-igemm/gen/4x16c8-minmax-avx512skx.c:242:15: error: implicit declaration of function '_kshiftri_mask64' is invalid in C99 [-Werror,-Wimplicit-function-declaration]
      vmask = _kshiftri_mask64(vmask, 16);
              ^
1 error generated.
Target //tensorflow/lite/java:tensorflow-lite failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 229.018s, Critical Path: 17.13s
INFO: 1788 processes: 1788 local.
FAILED: Build did NOT complete successfully

",False
pybind11_proto from python to C++ type:feature comp:core TF 2.13,"@BlaziusMaximus thanks for the explanation.
I've been exploring how to update the [`import_graph_def()`](https://github.com/tensorflow/tensorflow/blob/v2.13.0/tensorflow/python/framework/importer.py#L353-L411) code-path to use pybind11_protobuf and I could use your help with the following:  Similar to how pybind11_protobuf allows us to pass protos directly from C++ to Python, is there a way to pass a `GraphDef` proto from python to C++ without performing serialization? This would be needed to invoke the [TF_GraphImportGraphDefWithResults](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/c/c_api.cc#L1801) from pywrap session in C++.

_Originally posted by @othakkar in https://github.com/tensorflow/community/issues/453#issuecomment-1674101660_
            ",False
TensorFlow profiler running into OOM issue on GPU stat:awaiting response type:support stale comp:gpu TF 2.11,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

TF 2.11, TF 2.4

### Custom code

No

### OS platform and distribution

Red Had

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

11.2

### GPU model and memory

_No response_

### Current behavior?

Running TensorFlow profiler for longer than 10 second period results into OOM error, crashes the tf inference process and the profiler returns DEADLINE_EXCEEDED. Is there anyway to limit the sampling rate or way to reduce the amount of information being collected to avoid crashing the process?

Here is the code that I run:
tensorflow_profiler.experimental.client(""grpc://localhost:3222"", ""profiles"", 30000)

### Standalone code to reproduce the issue

```shell
tensorflow_profiler.experimental.client(""grpc://localhost:3222"", ""profiles"", 30000)
```


### Relevant log output

```shell
DEADLINE_EXCEEDED
```
",False
`numpy()` making copies with model parameters stat:awaiting tensorflower comp:apis type:performance TF 2.12,"### Issue type

Performance

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.12.0

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

When calling `numpy()` here no copies are made:
```python
import os, psutil
import tensorflow as tf

process = psutil.Process(os.getpid())
x = tf.random.normal((1, 300000))
print(process.memory_info().rss / 1e9). # 0.48
npy = x.numpy()
print(process.memory_info().rss / 1e9). # 0.48
```
However in the below example the increase in memory implies a copy is being made when calling `numpy()` on a model variable, is there any reason for this?

### Standalone code to reproduce the issue

```shell
import os, psutil
import tensorflow as tf

class TestKerasLinear(tf.keras.Model):
    def __init__(self, out_size):
        super(TestKerasLinear, self).__init__()
        self._linear = tf.keras.layers.Dense(out_size)

    def build(self, input_shape):
        super(TestKerasLinear, self).build(input_shape)

    def call(self, x):
        return self._linear(x)

tf_module = TestKerasLinear(1000)
tf_module.build((None, 300000))

process = psutil.Process(os.getpid())
print(process.memory_info().rss / 1e9). # 1.68

npy = tf_module.variables[0].numpy()

print(process.memory_info().rss / 1e9)  # 2.88
```


### Relevant log output

_No response_",False
"When converting tensorflow model to tflite model, is there any way to fix the output order during inference using tflite as Facing an issue of output order of tflite inference on meraki custom cv stat:awaiting response type:support stale comp:lite TF 2.10","I took a pretrained model (SSD MobileNet 320x320) for object detection from the TensorFlow Zoo and configured/tuned it according to my data. I trained a TensorFlow model which detects 2 labels.

I have used the latest checkpoint to save the model, then froze it, and finally performed TF Lite conversion. I did this because I need to upload the TF Lite model only to a Cisco camera. 

I'm facing an issue with the output order during TF Lite inference, as the output arrays get jumbled /rearranged. I need help on how to convert the TensorFlow model to TF Lite efficiently. My TensorFlow version is 2.10",False
On-Device training for LSTM or GRU Model  stat:awaiting response type:feature stale comp:lite comp:lite-examples,"**System information**
- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): web
- TensorFlow installed from (source or binary): colab
- TensorFlow version (or github SHA if from source):colab

Hi I’m new to tensorflow and I’m trying to make LSTM or GRU model to be enable to re-train on-device(Android) with tabular data (mostly customer interaction).

I’m referencing these examples
[On-Device Training 1](https://www.tensorflow.org/lite/examples/on_device_training/overview)

This is an example of a CNN, but not able to understand how can I enable on-device training for lstm or gru model.
Are there any examples for reference? Thanks",False
TensorFlow profiler running into OOM issue on GPU stat:awaiting response type:support stale comp:gpu TF 2.11,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

2.11.0.5

### Custom code

No

### OS platform and distribution

Linux CentOS 7.9.2009

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Running TensorFlow profiler for longer than 10 second period crashes the inference process because of OOM error and the profiler returns DEADLINE_EXCEEDED. Is there anyway to limit the sampling rate or way to reduce the amount of information being collected to avoid crashing the process?

### Standalone code to reproduce the issue

```shell
`tensorflow_profiler.experimental.client(""grpc://localhost:3222"", ""profiles"", 30000)`
```


### Relevant log output

_No response_",False
Tensorflow 1.15 for Raspberry pi build fail stat:awaiting response type:build/install stale comp:lite subtype: ubuntu/linux TF 1.15,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 1.15

### Custom code

No

### OS platform and distribution

Linux and Ubuntu 18.05

### Mobile device

target platform: Raspberry pi 4

### Python version

3.7

### Bazel version

na

### GCC/compiler version

na

### CUDA/cuDNN version

na

### GPU model and memory

na

### Current behavior?

Hi

I am trying to install tensorflow 1.15 on Raspberry pi and found this page:
https://github.com/tensorflow/build/tree/master/raspberry_pi_builds

From my understanding, I can do this at another platform (GPU server, ubuntu 18.05 installed).
I followed the instruction in the page, but came across the following error message:
From my guess, it looks like pip is not recognized in Docker.
Could you tell me how to resolve this issue??

### Standalone code to reproduce the issue

```shell
# I followed the instruction here: https://github.com/tensorflow/build/tree/master/raspberry_pi_builds
# And use this command to build

tensorflow/tools/ci_build/ci_build.sh PI-PYTHON37 \
    tensorflow/tools/ci_build/pi/build_raspberry_pi.sh
```


### Relevant log output

```shell
CI_DOCKER_BUILD_EXTRA_PARAMS: 
CI_DOCKER_EXTRA_PARAMS: 
COMMAND: tensorflow/tools/ci_build/pi/build_raspberry_pi.sh
CI_COMMAND_PREFIX: ./tensorflow/tools/ci_build/builds/with_the_same_user ./tensorflow/tools/ci_build/builds/configured pi-python37
CONTAINER_TYPE: pi-python37
BUILD_TAG: tf_ci
  (docker container name will be tf_ci.pi-python37)

Building container (tf_ci.pi-python37)...
[+] Building 2.9s (10/17)                                                                                                                         
 => [internal] load build definition from Dockerfile.pi-python37                                                                             0.0s
 => => transferring dockerfile: 866B                                                                                                         0.0s
 => [internal] load .dockerignore                                                                                                            0.0s
 => => transferring context: 2B                                                                                                              0.0s
 => [internal] load metadata for docker.io/library/ubuntu:16.04                                                                              1.4s
 => [internal] load build context                                                                                                            0.0s
 => => transferring context: 22.45kB                                                                                                         0.0s
 => [ 1/13] FROM docker.io/library/ubuntu:16.04@sha256:1f1a2d56de1d604801a9671f301190704c25d604a416f59e03c04f5c6ffee0d6                      0.0s
 => CACHED [ 2/13] COPY install/*.sh /install/                                                                                               0.0s
 => CACHED [ 3/13] RUN /install/install_bootstrap_deb_packages.sh                                                                            0.0s
 => CACHED [ 4/13] RUN add-apt-repository -y ppa:openjdk-r/ppa &&     add-apt-repository -y ppa:george-edison55/cmake-3.x                    0.0s
 => CACHED [ 5/13] RUN /install/install_deb_packages.sh                                                                                      0.0s
 => ERROR [ 6/13] RUN /install/install_pip_packages.sh                                                                                       1.4s
------                                                                                                                                            
 > [ 6/13] RUN /install/install_pip_packages.sh:                                                                                                  
#0 0.789 Searching for pip                                                                                                                        
#0 0.789 Reading https://pypi.python.org/simple/pip/                                                                                              
#0 0.867 Couldn't find index page for 'pip' (maybe misspelled?)                                                                                   
#0 0.867 Scanning index of all packages (this may take a while)                                                                                   
#0 0.867 Reading https://pypi.python.org/simple/
#0 0.936 No local packages or download links found for pip
#0 0.937 error: Could not find suitable distribution for Requirement.parse('pip')
------
Dockerfile.pi-python37:11
--------------------
   9 |         add-apt-repository -y ppa:george-edison55/cmake-3.x
  10 |     RUN /install/install_deb_packages.sh
  11 | >>> RUN /install/install_pip_packages.sh
  12 |     RUN /install/install_bazel.sh
  13 |     RUN /install/install_proto3.sh
--------------------
ERROR: failed to solve: process ""/bin/sh -c /install/install_pip_packages.sh"" did not complete successfully: exit code: 1
ERROR: docker build failed. Dockerfile is at /home/keondopark/tensorflow/tensorflow/tools/ci_build/Dockerfile.pi-python37
```
",False
tensorflow lite cmake compilation failed to allocate memory stat:awaiting response type:build/install stale comp:lite wsl2,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

cloned the master branch

### Custom code

Yes

### OS platform and distribution

windows 11 wsl 2 with Ubuntu 20.04.6 LTS

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

6.3.1

### GCC/compiler version

9.4.0

### CUDA/cuDNN version

Cuda compilation tools, release 10.1, V10.1.243

### GPU model and memory

rtx 2060 6GB dedicated 

### Current behavior?

I am using cmake 3.22.2
I cloned tensorflow into a directory tensorflow_src, then I ran ./configure and set ROCm and CUDA support to none, because I am building tflite. Then I made and moved into a build directory. I run `cmake ../tensorflow_src/tensorflow/lite` and `cmake --build . -j` I get quite a lot of errors, the first is ""failed to allocate memory"". But there's not enough space to paste the entire log here. 

I also tried `cmake ../tensorflow_src/tensorflow/lite/examples/minimal` and `cmake --build . -j` and the error I get is that 

I am trying to instantiate the tflite interpreter object in the easiest possible way.

### Standalone code to reproduce the issue

I also tried bazel build in the tensorflow_sec directory, which seems like it executed fine. then I used `g++ -std=c++17 inference.cpp model.cc -Ltensorflow_src/bazel-bin/tensorflow/lite -ltensorflowlite -o inference -Itensorflow_src/tensorflow/lite`

```shell
In file included from inference.cpp:6:
tensorflow_src/tensorflow/lite/interpreter.h:21:10: fatal error: tensorflow/lite/core/interpreter.h: No such file or directory
   21 | #include ""tensorflow/lite/core/interpreter.h""
      |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
compilation terminated.
```

I am following exactly the instructions on tensorflolw website to set up tflite for C++, it seems like there is missing information

### Relevant log output

_No response_",False
[Feature] The Heaviside step function as a activation function stat:awaiting response type:feature stale comp:keras,Some of the implementations like Single Layer Perceptron needs discrete outputs like 0 or 1. Adding this could make the model building ease.,False
Blank invalid,,False
Converter issue stat:awaiting response stale TFLiteConverter,"### 1. System information

- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):
- TensorFlow installation (pip package or built from source):
- TensorFlow library (version, if pip package or github SHA, if built from source):

### 2. Code

Provide code to help us reproduce your issues using one of the following options:

#### Option A: Reference colab notebooks

1)  Reference [TensorFlow Model Colab](https://colab.research.google.com/gist/ymodak/e96a4270b953201d5362c61c1e8b78aa/tensorflow-datasets.ipynb?authuser=1): Demonstrate how to build your TF model.
2)  Reference [TensorFlow Lite Model Colab](https://colab.research.google.com/gist/ymodak/0dfeb28255e189c5c48d9093f296e9a8/tensorflow-lite-debugger-colab.ipynb): Demonstrate how to convert your TF model to a TF Lite model (with quantization, if used) and run TFLite Inference (if possible).

```
(You can paste links or attach files by dragging & dropping them below)
- Provide links to your updated versions of the above two colab notebooks.
- Provide links to your TensorFlow model and (optionally) TensorFlow Lite Model.
```

#### Option B: Paste your code here or provide a link to a custom end-to-end colab

```
(You can paste links or attach files by dragging & dropping them below)
- Include code to invoke the TFLite Converter Python API and the errors.
- Provide links to your TensorFlow model and (optionally) TensorFlow Lite Model.
```

### 3. Failure after conversion
If the conversion is successful, but the generated model is wrong, then state what is wrong:

- Model produces wrong results and/or has lesser accuracy.
- Model produces correct results, but it is slower than expected.

### 4. (optional) RNN conversion support
If converting TF RNN to TFLite fused RNN ops, please prefix [RNN] in the title.

### 5. (optional) Any other info / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.
",False
TFLite cross compile error --> fatal error: cpuid.h: No such file or directory stat:awaiting response type:build/install stale comp:lite,"I am trying to cross compile TFLite cpp code for ARM64 on ubuntu machine. After all the steps of installation I copied the cpp file to tflite_build  directory, I executed the following command:
![image](https://github.com/tensorflow/tensorflow/assets/43563075/c09083e9-a3fc-4124-a2d2-fab960b0503b)
After execution of some seconds I am getting the following error.
![image](https://github.com/tensorflow/tensorflow/assets/43563075/20615390-e05c-42d0-8c52-009df82f7098)
It will be really helpful if someone can help me to resolve the error.
",False
Distributed training with parameter servers example using a single binary stat:awaiting tensorflower type:support comp:dist-strat,"Hello everyone! I am sorry if this is a duplicate issue but from my considerable search - I could not find a single end-to-end distributed parameter-server example to run using tensorflow (using the keras api with `.fit()` method). Also, for some reason - the documentation for parameter-server strategy seems a lot more confusing and difficult to get started with, compared to multi-worker strategy. 

I have been running training jobs using the estimator api before and now trying to update it to TF2.x style distributed training job with parameter-server training strategy using a single binary file for all workers and parameter-servers. I started with the example in documentation here (https://www.tensorflow.org/tutorials/distribute/parameter_server_training) and modified the code to be used as a single binary. 

Code:
```
import tensorflow_datasets as tfds
import tensorflow as tf

import os

cluster_resolver = tf.distribute.cluster_resolver.TFConfigClusterResolver()
if cluster_resolver.task_type in (""worker"", ""ps""):
  # Start a TensorFlow server and wait.
  server = tf.distribute.Server(cluster_resolver.cluster_spec(),
                                      job_name=cluster_resolver.task_type,
                                      task_index=cluster_resolver.task_id,
                                      protocol=cluster_resolver.rpc_layer or ""grpc"",
                                      start=True)
  server.join()
else:
  ## parameter-server
  strategy = tf.distribute.ParameterServerStrategy(cluster_resolver=cluster_resolver)
  global_batch_size = 64
  x = tf.random.uniform((10, 10))
  y = tf.random.uniform((10,))
  dataset = tf.data.Dataset.from_tensor_slices((x, y)).shuffle(10).repeat()
  dataset = dataset.batch(global_batch_size)
  dataset = dataset.prefetch(2)
  with strategy.scope():
    model = tf.keras.models.Sequential([tf.keras.layers.Dense(10)])
    model.compile(tf.keras.optimizers.legacy.SGD(), loss=""mse"", steps_per_execution=10)
  working_dir = ""./my_working_dir""
  log_dir = os.path.join(working_dir, ""log"")
  ckpt_filepath = os.path.join(working_dir, ""ckpt"")
  backup_dir = os.path.join(working_dir, ""backup"")
  callbacks = [
    tf.keras.callbacks.TensorBoard(log_dir=log_dir),
    tf.keras.callbacks.ModelCheckpoint(filepath=ckpt_filepath),
    tf.keras.callbacks.BackupAndRestore(backup_dir=backup_dir),
  ]
  model.fit(dataset, epochs=5, steps_per_epoch=20, callbacks=callbacks)
```

To my understanding, all workers and paramter-servers will start and wait for chief to assign the tasks. Chief or coordinator (documentation uses them interchangeably but is there any difference between the two?) will automatically divide the work based on the information it gets from `cluster_resolver` (let me know if that's wrong interpretation). In any case, I would highly appreciate if someone can point out what I am doing wrong in this example because I have not been able to get it to work!",False
What is the reason sanitizer configs are regarded as outdated?  stat:awaiting response type:build/install type:support subtype: ubuntu/linux,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

mater (7a721887ec4616bd3347815f3ce873a0ab14ea37)

### Custom code

No

### OS platform and distribution

Linux Ubuntu 22.04

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I tried to build tensorflow with config asan, but I found that it was removed at 7a721887ec4616bd3347815f3ce873a0ab14ea37, by @kanglant 

So, I'm curious why these sanitizer flags were regarded as outdated.

Did the community decide to stop supporting sanitizers for tensorflow?
or just because it is not working now? 

Thank you:)

### Standalone code to reproduce the issue

```shell
bazel build --config=asan //tensorflow/tools/pip_package:build_pip_package --jobs `nproc`
```


### Relevant log output

_No response_",False
Could not load dynamic library 'cudart64_110.dll'; dlerror: cudart64_110.dll not found stat:awaiting response type:build/install subtype:windows wsl2 TF 2.10,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.10.0

### Custom code

Yes

### OS platform and distribution

Windows 11

### Mobile device

N/A

### Python version

3.10(Microsoft Store)

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

Cuda: 11.2

### GPU model and memory

RTX 3070 Ti 8GB
### Current behavior?

I installed CUDA 11.2 as recommended for tf 2.10.0, here's the install:
![Screenshot](https://github.com/tensorflow/tensorflow/assets/1494132/59352a2a-f90f-45bf-b8bd-861dc893a9ff)
At first, I thought it was a path issue, but after restarting my pc, I was able to access exe files in that folder:
![image](https://github.com/tensorflow/tensorflow/assets/1494132/5d9ccfca-4417-4045-ba74-fffde7b8a121)
If the files are in path, why can't tensorflow find them?
Many people say to use miniconda, so I did, but I got the same result. Other resolved issues were resolved as the OP's were using the wrong version of CUDA, I checked on the website and I can confirm that my version is the required one.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf
```


### Relevant log output

```shell
2023-07-31 18:56:25.098058: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cudart64_110.dll'; dlerror: cudart64_110.dll not found
2023-07-31 18:56:25.098226: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2023-07-31 18:56:26.164080: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cudart64_110.dll'; dlerror: cudart64_110.dll not found
2023-07-31 18:56:26.164320: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cublas64_11.dll'; dlerror: cublas64_11.dll not found
2023-07-31 18:56:26.164540: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cublasLt64_11.dll'; dlerror: cublasLt64_11.dll not found
2023-07-31 18:56:26.164818: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cufft64_10.dll'; dlerror: cufft64_10.dll not found
2023-07-31 18:56:26.368828: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cusparse64_11.dll'; dlerror: cusparse64_11.dll not found
2023-07-31 18:56:26.369092: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'cudnn64_8.dll'; dlerror: cudnn64_8.dll not found
```
",False
"When building from source code, I always end up with a Python 3.10 whl file, instead of a Python3.8 whl file. stat:awaiting response type:build/install type:support subtype: ubuntu/linux","### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.14.0

### Custom code

No

### OS platform and distribution

Linux Ubuntu 20.04.6 LTS

### Mobile device

_No response_

### Python version

3.8

### Bazel version

1.17

### GCC/compiler version

9.4.0

### CUDA/cuDNN version

11.8/8.7

### GPU model and memory

GTX 1050 Ti 4GB

### Current behavior?

When I try to build the source code from my machine I end up always with a wheel for Python 3.10, although I specified the python path for python3.8 and I don't even have python3.10 installed.

The generated wheel is called tensorflow-2.14.0-cp310-cp310-linux_x86_64.whl

Can you guide why this is happening and how to solve it?

### Standalone code to reproduce the issue

```shell
Just trying to build the source code following the steps from this two sites:

https://gist.github.com/kmhofmann/e368a2ebba05f807fa1a90b3bf9a1e03
https://www.tensorflow.org/install/source
```


### Relevant log output

_No response_",False
absl update required to slove MSVC compile error stat:awaiting response type:build/install stale subtype:windows TF 2.13,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

Windows 10 22H2

### Mobile device

_No response_

### Python version

Anaconda 2023.07-1

### Bazel version

6.3.0

### GCC/compiler version

Visual Studio 2022 (build tools 14.36) + msys2-x86_64-20230718

### CUDA/cuDNN version

CUDA 11.8 + CUDNN 8.6.0 + TensorRT 8.5.3

### GPU model and memory

GTX 750 Ti 2GB

### Current behavior?

Currently, MSVC address sanitizer isn't enabled during compilation and cause compilation error. https://github.com/abseil/abseil-cpp/commit/2927340217c37328319b5869285a6dcdbc13e7a7 (LTS Jan 2023 Patch 3) has fixed it. This update required developers to check if corresponding code is necessary to change.

### Standalone code to reproduce the issue

```shell
1. download https://github.com/tensorflow/tensorflow/archive/refs/tags/v2.13.0.zip and extract
2. comment out Windows CUDA build rejection code in configure.py
3. run `python configure.py` to configure Windows CUDA build
4. run `bazel build --config=opt --define=no_tensorflow_py_deps=true //tensorflow/tools/pip_package:build_pip_package`
```


### Relevant log output

```shell
error: ""no_sanitize_address"" is undefined
```
",False
`FAKE_REQUIRED_PACKAGES` tensorflow-intel prevent poetry installation of `tensorflow-rocm` awaiting review type:build/install subtype: ubuntu/linux TF 2.12,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.12.0.560

### Custom code

Yes

### OS platform and distribution

Archlinux 6.1.38-2-lts

### Mobile device

_No response_

### Python version

3.11

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

AMD Radeon RX 6700 XT - gfx1031

### Current behavior?

Updating  `tensorflow-rocm` using `poetry` produce a not resolvable dependency error due to `tensorflow-intel` ""fake required package"". 
The problem is due to the following lines:
https://github.com/tensorflow/tensorflow/blob/6d2f5ac299ef81e3bcd0a431b2375ebbd8252708/tensorflow/tools/pip_package/setup.py#L140-L142
https://github.com/tensorflow/tensorflow/blob/6d2f5ac299ef81e3bcd0a431b2375ebbd8252708/tensorflow/tools/pip_package/setup.py#L143-L144
In particular, the error is caused by the `_VERSION`. In fact, the same version of `tensorflow-rocm` (`2.12.0.560`) not exists in `tensorflow-intel`.


### Standalone code to reproduce the issue

```shell
poetry new fixme
cd fixme
poetry add tensorflow-rocm==""2.12.0.560""
```

### Relevant log output

```shell
Because tensorflow-rocm (2.12.0.560) depends on tensorflow-intel (2.12.0.560) which doesn't match any versions, tensorflow-rocm is forbidden.
So, because lstm-predictor depends on tensorflow-rocm (2.12.0.560), version solving failed.
```


### Possible fix
Simply truncate the version to the patch version before the FAKE_REQUIRED_PACKAGES list definition.
```python
# _VERSION=""2.12.0.560""
_VERSION = (""."").join(_VERSION.split(""."")[:3])
```

### Other open issue
I open the same issue on [ROCmSoftwarePlatform/tensorflow-upstream](https://github.com/ROCmSoftwarePlatform/tensorflow-upstream) [here](https://github.com/ROCmSoftwarePlatform/tensorflow-upstream/issues/2161#issue-1809512685)",False
Since one week with a few different issues and two platforms I can't import Keras stat:awaiting response type:build/install subtype:macOS,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

SystemError: initialization of _pywrap_checkpoint_reader raised unreported exception

### Custom code

No

### OS platform and distribution

Mac13.4 

### Mobile device

_No response_

### Python version

3.10.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I face the error ""SystemError: initialization of _pywrap_checkpoint_reader raised unreported exception"" when I import keras to build DL model! I worked on make sure that the TensorFlow library is installed also I update the TensorFlow library to the latest version.
I need I help to resolve this issue because I think I trying a lot of recommendations!
Thanks

### Standalone code to reproduce the issue

```shell
Update the TensorFlow library to the latest version.
```


### Relevant log output

_No response_",False
tflite-model-maker installation issue stat:awaiting response type:build/install stale comp:lite TF 2.12 TFLiteModelMaker,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.12.0

### Custom code

Yes

### OS platform and distribution

Windows 11

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

For Image Classification

### Standalone code to reproduce the issue

```shell
error: subprocess-exited-with-error
  
  × Getting requirements to build wheel did not run successfully.
  │ exit code: 1
  ╰─> See above for output.
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  Getting requirements to build wheel ... error
error: subprocess-exited-with-error

× Getting requirements to build wheel did not run successfully.
│ exit code: 1
╰─> See above for output.

note: This error originates from a subprocess, and is likely not a problem with pip.
```


### Relevant log output

_No response_",False
Tflite: C++ API format to add NNAPI delegate stat:awaiting response type:support stale comp:lite comp:apis TFLiteNNAPIDelegate TF 2.10,"
### System information

-   **Have I written custom code (as opposed to using a stock example script
    provided in TensorFlow)**: No
-   **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Ubuntu 20.04
-   **TensorFlow installed from (source or binary)**: binary
-   **TensorFlow version (use command below)**: 2.10
-   **Python version**: 3.10


### Describe the problem
I want to know what is the python API equivalent of adding a tflite delegate to execute the model. 
In python, we can directly add the argument 'experimental_delegates' to tflite.Interpreter and provide the path to the delegate .so file. 

If i want to add NNAPI or GPU delegate when using C++ API, what is the command for that? I couldn't find effective documentation to enable a delegate when using C++.

ModifyGraphWithDelegate is used, but how do i define a delegate up here? I want to make use of NNAPI delegate and i have the .so file for the same as well. Below is the code snippet am using to enable NNAPI delegate

```
  std::map<std::string, tflite::Interpreter::TfLiteDelegatePtr> delegates;
    auto delegate = tflite::Interpreter::TfLiteDelegatePtr(tflite::NnApiDelegate(), [](TfLiteDelegate*) {});
    delegates.emplace(""NNAPI"", std::move(delegate));
    for (const auto& delegate : delegates) {
        interpreter->ModifyGraphWithDelegate(delegate.second.get());
    } 
```

but when i compile the code i get the error:

>  undefined reference to tflite::NnApiDelegate()'

How can i enable NNAPI delegate with C++?

thanks


",False
The issue of updating a formula. type:docs-bug stat:awaiting response stale comp:keras,"https://github.com/tensorflow/tensorflow/blame/d5422e3857a3bcab5063fdd01600d4c15393c887/tensorflow/python/keras/optimizer_v2/adam.py#L443

var.assign_sub(
        (m * alpha) / (math_ops.sqrt(v) - coefficients['epsilon']))
should be：
var.assign_sub(
        (m * alpha) / (math_ops.sqrt(v) + coefficients['epsilon']))",False
`tensorflow-cpu` 2.13.0 missing Mac ARM wheels stat:awaiting response type:build/install stale subtype:macOS TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

2.13.0

### Custom code

No

### OS platform and distribution

macOS 13 ARM

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

[`tensorflow` 2.13.0 added Mac ARM wheels](https://pypi.org/project/tensorflow/2.13.0/#files).

This allows Mac developers to use the standard `tensorflow` package rather than the `tensorflow-macos` package.

But in situations when CPU-only processing is needed, `tensorflow-cpu` is ideal (saving on network and disk usage). The problem is that `tensorflow-cpu` does not have Mac ARM wheels, so it cannot be used on that platform. This is important for teams with different architecture machines that want to share a common lock file produced by something like Poetry or `pip-tools`.

- https://pypi.org/project/tensorflow-cpu/2.13.0/#files

### Standalone code to reproduce the issue

```shell
python -m pip install tensorflow-cpu==2.13.0
```


### Relevant log output

```shell
ERROR: Could not find a version that satisfies the requirement tensorflow-cpu==2.13.0 (from versions: none)
ERROR: No matching distribution found for tensorflow-cpu==2.13.0
```
",False
Failed building from source using clang compiler. Error: libtensorflow_framework.so.2 is a dangling symbolic link stat:awaiting response type:build/install stale comp:mkl subtype: ubuntu/linux TF 2.13,"### System information

-   **Have I written custom code (as opposed to using a stock example script
    provided in TensorFlow)**:  No
-   **OS Platform and Distribution (e.g., Linux Ubuntu 16.04)**: Linux Ubuntu 20.04.6 LTS. Building on Intel x86 CPU
-   **Mobile device (e.g. iPhone 8, Pixel 2, Samsung Galaxy) if the issue
    happens on a mobile device**:
-   **TensorFlow installed from (source or binary)**: Source
-   **TensorFlow version (use command below)**: 2.13
-   **Python version**: 3.10.11
-   **Bazel version (if compiling from source)**: 5.3.0
-   **Clang/Compiler version (if compiling from source)**: Clang 16.0.6
-   **CUDA/cuDNN version**: None (Building on Intel x86 CPU)
-   **GPU model and memory**: None (Building on Intel x86 CPU)
-   **Exact command to reproduce**: 
 bazel build  --config=mkl --config=dbg --verbose_failures  -c opt --copt=-march=native --spawn_strategy=sandboxed --sandbox_debug //tensorflow/tools/pip_package:build_pip_package


### Describe the problem

Error while building Tensorflow 2.13 from source with clang 16.0.6 and bazel 5.3.0. I am using the versions that were tested compatible  from this link: https://www.tensorflow.org/install/source#tested_build_configurations.
Errors:
ERROR: /home/ubuntu/builds/tensorflow/tensorflow/BUILD:1134:21: declared output 'tensorflow/libtensorflow_framework.so.2' is a dangling symbolic link
ERROR: /home/ubuntu/builds/tensorflow/tensorflow/BUILD:1134:21: Executing genrule //tensorflow:libtensorflow_framework.so.2_sym [for host] failed: not all outputs were created or valid

### Source code / logs

Output from above command mentioned:

Starting local Bazel server and connecting to it...
INFO: Options provided by the client:
  Inherited 'common' options: --isatty=1 --terminal_columns=121
INFO: Reading rc options for 'build' from /home/ubuntu/builds/tensorflow/.bazelrc:
  Inherited 'common' options: --experimental_repo_remote_exec
INFO: Reading rc options for 'build' from /home/ubuntu/builds/tensorflow/.bazelrc:
  'build' options: --define framework_shared_object=true --define tsl_protobuf_header_only=true --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone -c opt --announce_rc --define=grpc_no_ares=true --noincompatible_remove_legacy_whole_archive --enable_platform_specific_config --define=with_xla_support=true --config=short_logs --config=v2 --define=no_aws_support=true --define=no_hdfs_support=true --experimental_cc_shared_library --experimental_link_static_libraries_once=false --incompatible_enforce_config_setting_visibility
INFO: Reading rc options for 'build' from /home/ubuntu/builds/tensorflow/.tf_configure.bazelrc:
  'build' options: --action_env PYTHON_BIN_PATH=/home/ubuntu/anaconda3/envs/tf_build/bin/python --action_env PYTHON_LIB_PATH=/home/ubuntu/anaconda3/envs/tf_build/lib/python3.10/site-packages --python_path=/home/ubuntu/anaconda3/envs/tf_build/bin/python
INFO: Reading rc options for 'build' from /home/ubuntu/builds/tensorflow/.bazelrc:
  'build' options: --deleted_packages=tensorflow/compiler/mlir/tfrt,tensorflow/compiler/mlir/tfrt/benchmarks,tensorflow/compiler/mlir/tfrt/jit/python_binding,tensorflow/compiler/mlir/tfrt/jit/transforms,tensorflow/compiler/mlir/tfrt/python_tests,tensorflow/compiler/mlir/tfrt/tests,tensorflow/compiler/mlir/tfrt/tests/ir,tensorflow/compiler/mlir/tfrt/tests/analysis,tensorflow/compiler/mlir/tfrt/tests/jit,tensorflow/compiler/mlir/tfrt/tests/lhlo_to_tfrt,tensorflow/compiler/mlir/tfrt/tests/lhlo_to_jitrt,tensorflow/compiler/mlir/tfrt/tests/tf_to_corert,tensorflow/compiler/mlir/tfrt/tests/tf_to_tfrt_data,tensorflow/compiler/mlir/tfrt/tests/saved_model,tensorflow/compiler/mlir/tfrt/transforms/lhlo_gpu_to_tfrt_gpu,tensorflow/core/runtime_fallback,tensorflow/core/runtime_fallback/conversion,tensorflow/core/runtime_fallback/kernel,tensorflow/core/runtime_fallback/opdefs,tensorflow/core/runtime_fallback/runtime,tensorflow/core/runtime_fallback/util,tensorflow/core/tfrt/eager,tensorflow/core/tfrt/eager/backends/cpu,tensorflow/core/tfrt/eager/backends/gpu,tensorflow/core/tfrt/eager/core_runtime,tensorflow/core/tfrt/eager/cpp_tests/core_runtime,tensorflow/core/tfrt/gpu,tensorflow/core/tfrt/run_handler_thread_pool,tensorflow/core/tfrt/runtime,tensorflow/core/tfrt/saved_model,tensorflow/core/tfrt/graph_executor,tensorflow/core/tfrt/saved_model/tests,tensorflow/core/tfrt/tpu,tensorflow/core/tfrt/utils,tensorflow/core/tfrt/utils/debug
INFO: Found applicable config definition build:short_logs in file /home/ubuntu/builds/tensorflow/.bazelrc: --output_filter=DONT_MATCH_ANYTHING
INFO: Found applicable config definition build:v2 in file /home/ubuntu/builds/tensorflow/.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1
INFO: Found applicable config definition build:mkl in file /home/ubuntu/builds/tensorflow/.bazelrc: --define=build_with_mkl=true --define=enable_mkl=true --define=tensorflow_mkldnn_contraction_kernel=0 --define=build_with_openmp=true -c opt
INFO: Found applicable config definition build:dbg in file /home/ubuntu/builds/tensorflow/.bazelrc: -c dbg --per_file_copt=+.*,-tensorflow.*@-g0 --per_file_copt=+tensorflow/core/kernels.*@-g0 --cxxopt -DTF_LITE_DISABLE_X86_NEON --copt -DDEBUG_BUILD
INFO: Found applicable config definition build:linux in file /home/ubuntu/builds/tensorflow/.bazelrc: --define=build_with_onednn_v3=true --host_copt=-w --copt=-Wno-all --copt=-Wno-extra --copt=-Wno-deprecated --copt=-Wno-deprecated-declarations --copt=-Wno-ignored-attributes --copt=-Wno-array-bounds --copt=-Wunused-result --copt=-Werror=unused-result --copt=-Wswitch --copt=-Werror=switch --copt=-Wno-error=unused-but-set-variable --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include --define=PROTOBUF_INCLUDE_PATH=$(PREFIX)/include --cxxopt=-std=c++17 --host_cxxopt=-std=c++17 --config=dynamic_kernels --experimental_guard_against_concurrent_changes
INFO: Found applicable config definition build:dynamic_kernels in file /home/ubuntu/builds/tensorflow/.bazelrc: --define=dynamic_loaded_kernels=true --copt=-DAUTOLOAD_DYNAMIC_KERNELS
INFO: Analyzed target //tensorflow/tools/pip_package:build_pip_package (614 packages loaded, 38324 targets configured).
INFO: Found 1 target...
ERROR: /home/ubuntu/builds/tensorflow/tensorflow/BUILD:1134:21: declared output 'tensorflow/libtensorflow_framework.so.2' is a dangling symbolic link
ERROR: /home/ubuntu/builds/tensorflow/tensorflow/BUILD:1134:21: Executing genrule //tensorflow:libtensorflow_framework.so.2_sym [for host] failed: not all outputs were created or valid
1690366816.573675378: src/main/tools/linux-sandbox.cc:152: calling pipe(2)...
1690366816.573706039: src/main/tools/linux-sandbox.cc:171: calling clone(2)...
1690366816.573936717: src/main/tools/linux-sandbox.cc:180: linux-sandbox-pid1 has PID 52399
1690366816.573986443: src/main/tools/linux-sandbox-pid1.cc:650: Pid1Main started
1690366816.574047951: src/main/tools/linux-sandbox.cc:197: done manipulating pipes
1690366816.574187327: src/main/tools/linux-sandbox-pid1.cc:269: working dir: /home/ubuntu/.cache/bazel/_bazel_ubuntu/e773aae8e1619280c7c65ec2bcc4c4c5/sandbox/linux-sandbox/2934/execroot/org_tensorflow
1690366816.574204103: src/main/tools/linux-sandbox-pid1.cc:301: writable: /home/ubuntu/.cache/bazel/_bazel_ubuntu/e773aae8e1619280c7c65ec2bcc4c4c5/sandbox/linux-sandbox/2934/execroot/org_tensorflow
1690366816.574210697: src/main/tools/linux-sandbox-pid1.cc:301: writable: /tmp
1690366816.574216986: src/main/tools/linux-sandbox-pid1.cc:301: writable: /dev/shm
1690366816.574277494: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /
1690366816.574284725: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /dev
1690366816.574289479: src/main/tools/linux-sandbox-pid1.cc:371: remount rw: /dev/shm
1690366816.574294383: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /dev/pts
1690366816.574298736: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /dev/hugepages
1690366816.574303348: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /dev/mqueue
1690366816.574307631: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys
1690366816.574312050: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/kernel/security
1690366816.574318166: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup
1690366816.574323186: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/unified
1690366816.574328198: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/systemd
1690366816.574333290: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/hugetlb
1690366816.574337803: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/freezer
1690366816.574342520: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/misc
1690366816.574370614: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/cpu,cpuacct
1690366816.574376364: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/perf_event
1690366816.574380879: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/blkio
1690366816.574385348: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/devices
1690366816.574389735: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/memory
1690366816.574394055: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/cpuset
1690366816.574398740: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/net_cls,net_prio
1690366816.574403141: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/pids
1690366816.574407626: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/cgroup/rdma
1690366816.574412563: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/pstore
1690366816.574417748: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/bpf
1690366816.574422147: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/kernel/debug
1690366816.574427574: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/kernel/tracing
1690366816.574453517: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/fs/fuse/connections
1690366816.574459675: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /sys/kernel/config
1690366816.574464740: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /proc
1690366816.574469467: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /proc/sys/fs/binfmt_misc
1690366816.574478344: src/main/tools/linux-sandbox-pid1.cc:391: remount(nullptr, /proc/sys/fs/binfmt_misc, nullptr, 2101281, nullptr) failure (Operation not permitted) ignored
1690366816.574487890: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /proc/sys/fs/binfmt_misc
1690366816.574499308: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /run
1690366816.574503860: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /run/lock
1690366816.574508265: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /run/snapd/ns
1690366816.574513396: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /run/user/1000
1690366816.574518358: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /snap/amazon-ssm-agent/6563
1690366816.574523566: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /boot/efi
1690366816.574528274: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /snap/amazon-ssm-agent/7497
1690366816.574547267: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /snap/snapd/19361
1690366816.574553038: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /snap/core18/2785
1690366816.574557467: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /snap/core20/1950
1690366816.574562111: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /snap/snapd/19457
1690366816.574566323: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /snap/core18/2751
1690366816.574570473: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /snap/core20/1974
1690366816.574574374: src/main/tools/linux-sandbox-pid1.cc:371: remount ro: /snap/lxd/24061
1690366816.574579365: src/main/tools/linux-sandbox-pid1.cc:371: remount rw: /home/ubuntu/.cache/bazel/_bazel_ubuntu/e773aae8e1619280c7c65ec2bcc4c4c5/sandbox/linux-sandbox/2934/execroot/org_tensorflow
1690366816.574585138: src/main/tools/linux-sandbox-pid1.cc:371: remount rw: /home/ubuntu/.cache/bazel/_bazel_ubuntu/e773aae8e1619280c7c65ec2bcc4c4c5/sandbox/linux-sandbox/2934/execroot/org_tensorflow
1690366816.574589762: src/main/tools/linux-sandbox-pid1.cc:371: remount rw: /tmp
1690366816.574594138: src/main/tools/linux-sandbox-pid1.cc:371: remount rw: /dev/shm
1690366816.574636966: src/main/tools/linux-sandbox-pid1.cc:460: calling fork...
1690366816.574760311: src/main/tools/linux-sandbox-pid1.cc:490: child started with PID 2
1690366816.583691390: src/main/tools/linux-sandbox-pid1.cc:507: wait returned pid=2, status=0x00
1690366816.583704145: src/main/tools/linux-sandbox-pid1.cc:525: child exited normally with code 0
1690366816.583952036: src/main/tools/linux-sandbox.cc:233: child exited normally with code 0
Target //tensorflow/tools/pip_package:build_pip_package failed to build
INFO: Elapsed time: 849.711s, Critical Path: 79.72s
INFO: 4142 processes: 1215 internal, 2927 linux-sandbox.
FAILED: Build did NOT complete successfully",False
How to use the estimator interface to achieve cross-node training without using the strategy of tf itself stat:awaiting response stale comp:dist-strat type:docs-feature TF 2.7,"### Issue type

Documentation Feature Request

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

tf2.7

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 16.04

### Mobile device

_No response_

### Python version

python3.10

### Bazel version

5.1.1

### GCC/compiler version

9.4

### CUDA/cuDNN version

_No response_

### GPU model and memory

Tesla P100 12GB

### Current behavior?

![image](https://github.com/tensorflow/tensorflow/assets/69454138/f7e1159d-cd51-4dca-8890-2b9aebe58e57)

Cross-node training can be achieved in this way in tf1. If I want to use the estimator interface for training, can I put server.target in a certain config (similar to tf.estimator.RunConfig)

### Standalone code to reproduce the issue

```shell
cluster_spec = tf.train.ClusterSpec({
      'chief': ['172.20.21.189:1234'],
      'worker': ['172.20.21.197:1234'],
    })
simple_resolver = tf.distribute.cluster_resolver.SimpleClusterResolver(cluster_spec, task_type=""chief"",task_id=0)
is_per_host = tf.estimator.tpu.InputPipelineConfig.PER_HOST_V2
run_config = tf.estimator.tpu.RunConfig(
      cluster=simple_resolver,
      master=FLAGS.master,
      model_dir=FLAGS.output_dir,
      save_checkpoints_steps=FLAGS.save_checkpoints_steps,
      tpu_config=tf.estimator.tpu.TPUConfig(
          iterations_per_loop=FLAGS.iterations_per_loop,
          num_shards=FLAGS.num_tpu_cores,
          per_host_input_for_training=is_per_host))
I do this configuration in the estimator interface, but he doesn't seem to be training across nodes (multiple servers),It seems to only recognize local devices.
```


### Relevant log output

_No response_",False
Cannot subclass dataset_ops.DatasetV2 stat:awaiting response type:feature stale comp:ops comp:data,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.x

### Custom code

Yes

### OS platform and distribution

Mac OS 13.0

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Hi, I'm from LanceDB team and we're trying to build native support for tf.data. See WIP PR here https://github.com/lancedb/lance/pull/1087 .
Ideally, we'd like to simply subclass `tf.dataset_ops.DatasetV2` so that all the metadata needed to recreate the dataset can be pushed down to our file format that enabled parallelism elegantly.
So, it'd be something like this
```
class LanceTfDataset(dataset_ops.DatasetV2)
    def __init__(self):
       ...
       variant_tensor = tf.Tensor(self, (), dtype=tf.Variant)
       super().__init__(variant_tensor)
 ```
The above code complains that can not create LanceTfDataset to tf.Tensor/variant.

Issue - what exactly is variant_tensor and how do we go about creating one? I read through the docs but couldn't find anything concrete. There was a mention that variant_tensor is a special tensor that tell about the type of the dataset and that it's equivalent to tf.Variant, but the above code doesn't work.

Having a version of tf.dataset that we can use to capture extra metadata would allow us to improve the interface as well:
so instead of lance.tf.data.from_dataset(uri, columns, filter, batch_size) we can just have from_lance(uri).filter(..).batch_size(...).shuffle().

So what's the way to go about subclassing tf Dataset?

### Standalone code to reproduce the issue

```shell
class LanceTfDataset(dataset_ops.DatasetV2)
    def __init__(self):
       ...
       variant_tensor = tf.Tensor(self, (), dtype=tf.Variant)
       super().__init__(variant_tensor)
```


### Relevant log output

_No response_",False
Issues running Transformer model example with estimator api stat:awaiting response type:support type:others comp:model,"Hello everyone! I am trying to run an Image classification training example with Vision Transformer from keras examples (https://keras.io/examples/vision/image_classification_with_vision_transformer/). Everything ran perfectly when I ran it as it is but I started facing issues when i switched training from `model.fit()` to `tf.estimator.train_and_evaluate()` (ofcourse I made the appropriate changes to first convert model to estimator). From what I understand ... the problem lies with saving and reloading the model which is done by the estimator api. The model has custom classes:
```
class Patches(layers.Layer):
    def __init__(self, patch_size, **kwargs):
        super().__init__(**kwargs)
        self.patch_size = patch_size

    def call(self, images):
        batch_size = tf.shape(images)[0]
        patches = tf.image.extract_patches(
            images=images,
            sizes=[1, self.patch_size, self.patch_size, 1],
            strides=[1, self.patch_size, self.patch_size, 1],
            rates=[1, 1, 1, 1],
            padding=""VALID"",
        )
        patch_dims = patches.shape[-1]
        patches = tf.reshape(patches, [batch_size, -1, patch_dims])
        return patches

    ## personal addition
    def get_config(self):
        base_config = super().get_config()
        base_config.update({
            'patch_size': self.patch_size,
        })
        return base_config

class PatchEncoder(layers.Layer):
    def __init__(self, num_patches, projection_dim, **kwargs):
        super().__init__(**kwargs)
        self.num_patches = num_patches
        self.projection = layers.Dense(units=projection_dim)
        self.position_embedding = layers.Embedding(
            input_dim=num_patches, output_dim=projection_dim
        )

    def call(self, patch):
        positions = tf.range(start=0, limit=self.num_patches, delta=1)
        encoded = self.projection(patch) + self.position_embedding(positions)
        return encoded

    ## personal addition
    def get_config(self):
        base_config = super().get_config()
        base_config.update({
            'num_patches': self.num_patches,
            'projection': self.projection,
            'position_embedding': self.position_embedding
        })
        return base_config
```

From looking at some related issues, I found how we need to provide a `get_config()` method to save and reload the model with custom classes so I made small personal modifications but now its sort of giving me a different issue I am unable to understand. 

Error Log:
```
  warnings.warn(
x_train shape: (50000, 32, 32, 3) - y_train shape: (50000, 1)
x_test shape: (10000, 32, 32, 3) - y_test shape: (10000, 1)
WARNING:tensorflow:From train.py:225: RunConfig.__init__ (from tensorflow_estimator.python.estimator.run_config) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.keras instead.
/home/nearchus/.local/lib/python3.8/site-packages/keras/src/backend.py:452: UserWarning: `tf.keras.backend.set_learning_phase` is deprecated and will be removed after 2020-10-11. To update it, simply pass a True/False value to the `training` argument of the `__call__` method of your layer or model.
  warnings.warn(
Traceback (most recent call last):
  File ""train.py"", line 257, in <module>
    history = run_experiment(vit_classifier)
  File ""train.py"", line 231, in run_experiment
    model_est = keras.estimator.model_to_estimator(keras_model=model, model_dir='.', config=run_config)
  File ""/home/nearchus/.local/lib/python3.8/site-packages/keras/src/estimator/__init__.py"", line 376, in model_to_estimator_v2
    return keras_lib.model_to_estimator(
  File ""/home/nearchus/.local/lib/python3.8/site-packages/tensorflow_estimator/python/estimator/keras_lib.py"", line 725, in model_to_estimator
    warm_start_path = _save_first_checkpoint(keras_model, custom_objects,
  File ""/home/nearchus/.local/lib/python3.8/site-packages/tensorflow_estimator/python/estimator/keras_lib.py"", line 457, in _save_first_checkpoint
    model = _clone_and_build_model(ModeKeys.TRAIN, keras_model,
  File ""/home/nearchus/.local/lib/python3.8/site-packages/tensorflow_estimator/python/estimator/keras_lib.py"", line 230, in _clone_and_build_model
    clone = tf.compat.v2.keras.__internal__.models.clone_and_build_model(
  File ""/home/nearchus/.local/lib/python3.8/site-packages/keras/src/models/cloning.py"", line 806, in clone_and_build_model
    clone = clone_model(model, input_tensors=input_tensors)
  File ""/home/nearchus/.local/lib/python3.8/site-packages/keras/src/models/cloning.py"", line 539, in clone_model
    return _clone_functional_model(
  File ""/home/nearchus/.local/lib/python3.8/site-packages/keras/src/models/cloning.py"", line 222, in _clone_functional_model
    model_configs, created_layers = _clone_layers_and_model_config(
  File ""/home/nearchus/.local/lib/python3.8/site-packages/keras/src/models/cloning.py"", line 298, in _clone_layers_and_model_config
    config = functional.get_network_config(
  File ""/home/nearchus/.local/lib/python3.8/site-packages/keras/src/engine/functional.py"", line 1590, in get_network_config
    layer_config = serialize_layer_fn(layer)
  File ""/home/nearchus/.local/lib/python3.8/site-packages/keras/src/models/cloning.py"", line 295, in _copy_layer
    created_layers[layer.name] = layer_fn(layer)
  File ""/home/nearchus/.local/lib/python3.8/site-packages/keras/src/models/cloning.py"", line 52, in _clone_layer
    return layer.__class__.from_config(layer.get_config())
  File ""train.py"", line 108, in from_config
    return cls(**config)
TypeError: __init__() missing 1 required positional argument: 'projection_dim'
```
I thought it might be because of `PatchEncoder` class constructor has custom objects as argument - so i tried to do serialization/deserialization but to no vail. In any case, I would highly appreciate if someone can guide me as to where I am going wrong in this!  


  ",False
`tensorflow-macos` 2.13.0 missing x86 wheels stat:awaiting response type:build/install subtype:macOS TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.13.0

### Custom code

No

### OS platform and distribution

macOS 13 x86

### Mobile device

N/A

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

`tensorflow-macos` 2.13.0 release is [missing x86 wheels for macOS](https://pypi.org/project/tensorflow-macos/2.13.0/#files). This means that using tools like [Poetry](https://python-poetry.org/) or [`pip-tools`](https://github.com/jazzband/pip-tools) to lock versions, it's not possible to use 2.13.0 because if it's locked to that version, it will fail to install on x86 Macs.

[x86 wheels were provided for 2.12.0](https://pypi.org/project/tensorflow-macos/2.12.0/#files).

### Standalone code to reproduce the issue

From an x86 macOS machine:

```shell
python -m pip install tensorflow-macos==2.13.0
```


### Relevant log output

```shell
ERROR: Could not find a version that satisfies the requirement tensorflow-macos==2.13.0 (from versions: 2.9.0, 2.9.1, 2.9.2, 2.10.0, 2.11.0, 2.12.0)
ERROR: No matching distribution found for tensorflow-macos==2.13.0
```",False
"Cannot type ""I Accept"" to extract from hexagon_nn_skel stat:awaiting response stale comp:lite","Workflow:
1. download hexagon_nn_skel.run from [this link](https://storage.cloud.google.com/download.tensorflow.org/tflite/hexagon_nn_skel_v1.20.0.1.run)
2. adb push to /data/local/tmp
3. run cmd: chmod +x tflite_hexagon_nn_skel_v1.20.0.1.run
4. run cmd: .\tflite_hexagon_nn_skel_v1.20.0.1.run
5. **Extraction aborted**: 
![Screenshot 2023-07-25 182129](https://github.com/tensorflow/tensorflow/assets/68681893/09484ae3-7156-4c61-9612-31c57fba8aa3)

Problem: 
After the program shows ""**_Type ""I ACCEPT"" if you agree to the terms of the license:_**"", it didn't give me time to type ""I ACCEPT"", and hence extraction aborted.
",False
float8 support for array ops stat:awaiting tensorflower type:feature comp:ops TF 2.12,"### Issue type

Feature Request

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.12.0

### Custom code

No

### OS platform and distribution

macOS-13.2.1-arm64-arm-64bit

### Mobile device

_No response_

### Python version

3.9.6

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Please add FP8 datatype support for array ops (like Reshape, Transpose, GatherV2, ExpandDims, Squeeze, ConcatV2, Split, Pack, Unpack, and StridedSlice).

### Standalone code to reproduce the issue

```shell
import tensorflow as tf
from tensorflow.python.framework import dtypes

a = tf.constant([[1.2345678, 2.3456789, 3.4567891], [4.5678912, 5.6789123, 6.7891234]], dtype=dtypes.float16)
print(a)

a_fp8 = tf.cast(a, dtypes.float8_e4m3fn)
print(a_fp8)

b = a_fp8[1:2] # tensorflow.python.framework.errors_impl.NotFoundError
b = tf.transpose(a_fp8, [1, 0]) # tensorflow.python.framework.errors_impl.NotFoundError
```


### Relevant log output

_No response_",False
Performance drop with tensorflow 2.13 stat:awaiting response stale comp:keras type:performance TF 2.13,"### Issue type

Performance

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

v2.13.0-rc2-7-g1cb1a030a62 2.13.0

### Custom code

Yes

### OS platform and distribution

Debian GNU/Linux 12 (bookworm)

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I notice a big performance drop between tensorflow 2.12 (CPU) and tensorflow 2.13 (CPU). With the last release (and also with tf-nightly '2.14.0-dev20230724') it takes *4 times* longer to perform a simple sum. It is between keras inputs though some I am not sure if this is directly related to tensorflow or if it comes from keras.

See code below for a very simple example. Note that this is with tensorflow CPU only.
The timings are:
- for tensorflow 2.12.1 + keras 2.12.0: **5.3 s**
- for tensorflow 2.13.0 + keras 2.13.1: **24 s**
- for tensorflow 2.14.0-dev20230724 + keras  2.14.0.dev2023072407: 26 s

### Standalone code to reproduce the issue

```shell
import time

from tensorflow.keras import Input


number_of_executions = 3000

x = Input((1,))
y = Input((1,))

start = time.time()
for i in range(number_of_executions):
    x + y
duration = time.time() - start
print(f""Duration: {duration:.1f}"")
```


### Relevant log output

_No response_",False
converter issue  stat:awaiting response stale TFLiteConverter,"### 1. System information

- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):
- TensorFlow installation (pip package or built from source):
- TensorFlow library (version, if pip package or github SHA, if built from source):

### 2. Code

Provide code to help us reproduce your issues using one of the following options:

#### Option A: Reference colab notebooks

1)  Reference [TensorFlow Model Colab](https://colab.research.google.com/gist/ymodak/e96a4270b953201d5362c61c1e8b78aa/tensorflow-datasets.ipynb?authuser=1): Demonstrate how to build your TF model.
2)  Reference [TensorFlow Lite Model Colab](https://colab.research.google.com/gist/ymodak/0dfeb28255e189c5c48d9093f296e9a8/tensorflow-lite-debugger-colab.ipynb): Demonstrate how to convert your TF model to a TF Lite model (with quantization, if used) and run TFLite Inference (if possible).

```
(You can paste links or attach files by dragging & dropping them below)
- Provide links to your updated versions of the above two colab notebooks.
- Provide links to your TensorFlow model and (optionally) TensorFlow Lite Model.
```

#### Option B: Paste your code here or provide a link to a custom end-to-end colab

```
(You can paste links or attach files by dragging & dropping them below)
- Include code to invoke the TFLite Converter Python API and the errors.
- Provide links to your TensorFlow model and (optionally) TensorFlow Lite Model.
```

### 3. Failure after conversion
If the conversion is successful, but the generated model is wrong, then state what is wrong:

- Model produces wrong results and/or has lesser accuracy.
- Model produces correct results, but it is slower than expected.

### 4. (optional) RNN conversion support
If converting TF RNN to TFLite fused RNN ops, please prefix [RNN] in the title.

### 5. (optional) Any other info / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.
",False
ColumnReduceKernel: min() type casting error and improvement awaiting review comp:ops type:performance TF 2.13,"### Issue type

Performance

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

Windows 10 22H2

### Mobile device

_No response_

### Python version

Anaconda 2023.07-1

### Bazel version

6.2.1

### GCC/compiler version

Visual Studio 2022 (build tools 14.36) + msys2-x86_64-20230718

### CUDA/cuDNN version

CUDA 11.8 + CUDNN 8.6.0 + TensorRT 8.5.3

### GPU model and memory

GTX 750 Ti 2GB

### Current behavior?

There are two type casting errors in reduction_gpu_kernels.cu.h under MSVC. One of them is fixed in https://github.com/tensorflow/tensorflow/pull/61339. Another is related to a TODO.

in [ColumnReduceKernel()](https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/reduction_gpu_kernels.cu.h#L341), the TODO said the followings:

> 1D array necessary due to bug in CUDA 9 compiler.
> TODO(nluehr) revert to 2D array when compiler is ready.
> This is to mimic the following, but without constructors:
> __shared__ storage_type<value_type> partial_sums[TF_RED_WARPSIZE *
> (TF_RED_WARPSIZE + 1)];

Since latest version required CUDA 11, it's time to address the TODO and apply bug fix together.

### Standalone code to reproduce the issue

```shell
1. download https://github.com/tensorflow/tensorflow/archive/refs/tags/v2.13.0.zip and extract
2. comment out Windows CUDA build rejection code in configure.py
3. run `python configure.py` to configure Windows CUDA build
4. run `bazel build --config=opt --define=no_tensorflow_py_deps=true //tensorflow/tools/pip_package:build_pip_package`
```


### Relevant log output

```shell
external/com_google_absl\absl/status/status.h(796): warning #2810-D: ignoring return value type with ""nodiscard"" attribute

.\tensorflow/tsl/platform/file_system.h(571): warning #611-D: overloaded virtual function ""tsl::FileSystem::FilesExist"" is only partially overridden in class ""tsl::WrappedFileSyste
m""

.\tensorflow/tsl/platform/file_system.h(571): warning #611-D: overloaded virtual function ""tsl::FileSystem::CreateDir"" is only partially overridden in class ""tsl::WrappedFileSystem
""

.\tensorflow/tsl/platform/env.h(500): warning #611-D: overloaded virtual function ""tsl::Env::RegisterFileSystem"" is only partially overridden in class ""tsl::EnvWrapper""

.\tensorflow/tsl/platform/float8.h(936): warning #177-D: variable ""aligned_highest"" was declared but never referenced
          detected during:
            instantiation of ""To tsl::float8_internal::ConvertImpl<From, To, kSaturate, kTruncate, std::enable_if_t<<expression>, void>>::run(const From &) [with From=tsl::float8_i
nternal::float8_e4m3b11, To=tsl::float8_internal::float8_e4m3fn, kSaturate=false, kTruncate=false]""
(1018): here
            instantiation of ""Derived tsl::float8_internal::float8_base<Derived>::ConvertFrom(const From &) [with Derived=tsl::float8_internal::float8_e4m3fn, kSaturate=false, kTru
ncate=false, From=tsl::float8_internal::float8_e4m3b11]""
(277): here

.\tensorflow/tsl/platform/float8.h(936): warning #177-D: variable ""aligned_highest"" was declared but never referenced
          detected during:
            instantiation of ""To tsl::float8_internal::ConvertImpl<From, To, kSaturate, kTruncate, std::enable_if_t<<expression>, void>>::run(const From &) [with From=tsl::float8_i
nternal::float8_e4m3b11, To=float, kSaturate=false, kTruncate=false]""
(1024): here
            instantiation of ""To tsl::float8_internal::float8_base<Derived>::ConvertTo<To,kSaturate,kTruncate>(const Derived &) [with Derived=tsl::float8_internal::float8_e4m3b11,
To=float, kSaturate=false, kTruncate=false]""
(75): here
            instantiation of ""tsl::float8_internal::float8_base<Derived>::operator float() const [with Derived=tsl::float8_internal::float8_e4m3b11]""
(116): here
            instantiation of ""Derived tsl::float8_internal::float8_base<Derived>::operator-(const Derived &) const [with Derived=tsl::float8_internal::float8_e4m3b11]""
(302): here

.\tensorflow/core/kernels/reduction_gpu_kernels.cu.h(392): error: no instance of overloaded function ""tensorflow::min"" matches the argument list
            argument types are: (int, unsigned int)
          detected during:
            instantiation of ""void tensorflow::functor::ColumnReduceKernel(T, OUT_T, int, int, Op, std::iterator_traits<T>::value_type) [with T=const float *, OUT_T=float *, Op=cub
::Max]""
(828): here
            instantiation of ""void tensorflow::functor::LaunchColumnReduction_LTE4096Cols(tensorflow::OpKernelContext *, OUT_T, IN_T, int, int, Op, T, const gpuStream_t &) [with T=
float, Op=cub::Max, OUT_T=float *, IN_T=const float *]""
(862): here
            instantiation of ""void tensorflow::functor::LaunchColumnReduction(tensorflow::OpKernelContext *, OUT_T, IN_T, int, int, Op, T, const gpuStream_t &) [with T=float, Op=cu
b::Max, OUT_T=float *, IN_T=const float *]""
(1088): here
            instantiation of ""void tensorflow::functor::ReduceImpl<T,Op,OUT_T,IN_T,ReductionAxes>(tensorflow::OpKernelContext *, OUT_T, IN_T, int, int, int, int, int, const Reducti
onAxes &, Op) [with T=float, Op=cub::Max, OUT_T=float *, IN_T=const float *, ReductionAxes=const Eigen::array<Eigen::DenseIndex, 1ULL> &]""
E:\_bazel_tensorflow\4zvk5ci6\execroot\org_tensorflow\tensorflow\core\kernels\multinomial_op_gpu.cu.cc(111): here
            instantiation of ""void tensorflow::functor::MultinomialFunctor<tensorflow::functor::GPUDevice, T, OutputType>::operator()(tensorflow::OpKernelContext *, const tensorflo
w::functor::GPUDevice &, tensorflow::TTypes<T, 1, Eigen::DenseIndex>::ConstMatrix, tensorflow::TTypes<float, 1, Eigen::DenseIndex>::Flat, tensorflow::TTypes<float, 1, Eigen::DenseI
ndex>::Flat, tensorflow::TTypes<float, 1, Eigen::DenseIndex>::Flat, int, int, int, const tsl::random::PhiloxRandom &, tensorflow::TTypes<OutputType, 1, Eigen::DenseIndex>::Matrix)
[with T=Eigen::half, OutputType=tsl::int32]""
E:\_bazel_tensorflow\4zvk5ci6\execroot\org_tensorflow\tensorflow\core\kernels\multinomial_op_gpu.cu.cc(126): here

1 error detected in the compilation of ""tensorflow/core/kernels/multinomial_op_gpu.cu.cc"".
nvcc warning : The 'compute_35', 'compute_37', 'sm_35', and 'sm_37' architectures are deprecated, and may be removed in a future release (Use -Wno-deprecated-gpu-targets to suppres
s warning).
Target //tensorflow/tools/pip_package:build_pip_package failed to build
INFO: Elapsed time: 1996.828s, Critical Path: 480.15s
INFO: 441 processes: 7 internal, 434 local.
FAILED: Build did NOT complete successfully
```
",False
rocm_helpers missing dependency declarations type:build/install subtype: ubuntu/linux,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

master/nightly

### Custom code

Yes

### OS platform and distribution

`Arch Linux (Linux 6.4.4-arch1-1 #1 SMP PREEMPT_DYNAMIC x86_64 GNU/Linux)`

### Mobile device

N/A

### Python version

3.10

### Bazel version

6.1.0

### GCC/compiler version

gcc (GCC) 13.1.1 20230714

### CUDA/cuDNN version

None

### GPU model and memory

AMD Radeon RX 7900 XT

### Current behavior?

After adding `#include <stdint.h>` to line 16 of `tensorflow/tsl/lib/io/cache.cc` to fix a different error, and using the installation method described in the reproduce field.

Bazel gives the error described in the attached log.

This persists through different Bazel versions, and full cleans.

I am using the following archlinux packages for ROCm:
```
local/opencl-amd 1:5.6.0-2
    ROCr OpenCL stack
local/opencl-amd-dev 1:5.6.0-1
    OpenCL SDK / HIP SDK / ROCM Compiler.
```

### Standalone code to reproduce the issue

```shell
./configure
You have bazel 6.1.0 installed.
Please specify the location of python. [Default is /usr/bin/python3]:

Found possible Python library paths:
  /usr/lib/python3.11/site-packages
Please input the desired Python library path to use.  Default is [/usr/lib/python3.11/site-packages]

Do you wish to build TensorFlow with ROCm support? [y/N]: y
ROCm support will be enabled for TensorFlow.

Do you wish to build TensorFlow with CUDA support? [y/N]:
No CUDA support will be enabled for TensorFlow.

Do you want to use Clang to build TensorFlow? [Y/n]:
Clang will be used to compile TensorFlow.

Please specify the path to clang executable. [Default is /usr/bin/clang]:

You have Clang 17.0.0 installed.

Please specify optimization flags to use during compilation when bazel option ""--config=opt"" is specified [Default is -Wno-sign-compare]:

Would you like to interactively configure ./WORKSPACE for Android builds? [y/N]:
Not configuring the WORKSPACE for Android builds.



bazel build --config=opt --verbose_failures //tensorflow/tools/pip_package:build_pip_package
```


### Relevant log output

```shell
ERROR: /home/user/Repos/tensorflow/tensorflow/compiler/xla/stream_executor/rocm/BUILD:527:11: Compiling tensorflow/compiler/xla/stream_executor/rocm/rocm_helpers.cu.cc [for tool] failed: undeclared inclusion(s) in rule '//tensorflow/compiler/xla/stream_executor/rocm:rocm_helpers':
this rule is missing dependency declarations for the following files included by 'tensorflow/compiler/xla/stream_executor/rocm/rocm_helpers.cu.cc':
  '/opt/rocm-5.6.0/include/hip/hip_version.h'
  '/opt/rocm-5.6.0/include/hip/hip_runtime.h'
  '/opt/rocm-5.6.0/include/hip/hip_common.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/amd_hip_runtime.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/amd_hip_common.h'
  '/opt/rocm-5.6.0/include/hip/hip_runtime_api.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/host_defines.h'
  '/opt/rocm-5.6.0/include/hip/driver_types.h'
  '/opt/rocm-5.6.0/include/hip/texture_types.h'
  '/opt/rocm-5.6.0/include/hip/channel_descriptor.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/amd_channel_descriptor.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/amd_hip_vector_types.h'
  '/opt/rocm-5.6.0/include/hip/surface_types.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/amd_hip_runtime_pt_api.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/hip_ldg.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/amd_hip_atomic.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/amd_device_functions.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/math_fwd.h'
  '/opt/rocm-5.6.0/include/hip/hip_vector_types.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/device_library_decls.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/amd_warp_functions.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/amd_hip_unsafe_atomics.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/amd_surface_functions.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/ockl_image.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/texture_fetch_functions.h'
  '/opt/rocm-5.6.0/include/hip/hip_texture_types.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/texture_indirect_functions.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/amd_math_functions.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/hip_fp16_math_fwd.h'
  '/opt/rocm-5.6.0/include/hip/library_types.h'
  '/opt/rocm-5.6.0/include/hip/hip_bfloat16.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/amd_hip_bfloat16.h'
  '/opt/rocm-5.6.0/include/hip/hip_fp16.h'
  '/opt/rocm-5.6.0/include/hip/amd_detail/amd_hip_fp16.h'
clang-16: warning: argument unused during compilation: '-fcuda-flush-denormals-to-zero' [-Wunused-command-line-argument]
Target //tensorflow/tools/pip_package:build_pip_package failed to build
INFO: Elapsed time: 3.270s, Critical Path: 3.10s
INFO: 77 processes: 53 internal, 24 local.
FAILED: Build did NOT complete successfully
```
",False
Need Help with TensorFlow Lite Model Running on GPU - Output Interpretation Issue (Android Studio Kotlin) stat:awaiting response type:support stale comp:lite TFLiteGpuDelegate Android,"Hello. I have created an Android application in Android Studio that uses a tflite model. Its implementation works without any issues and looks as follows:

val model = Ssd.newInstance(context)

// Creates inputs for reference.
val inputFeature0 = TensorBuffer.createFixedSize(intArrayOf(1, 320, 320, 3), DataType.UINT8)
inputFeature0.loadBuffer(byteBuffer)

// Runs model inference and gets result.
val outputs = model.process(inputFeature0)
val outputFeature0 = outputs.outputFeature0AsTensorBuffer
val outputFeature1 = outputs.outputFeature1AsTensorBuffer
val outputFeature2 = outputs.outputFeature2AsTensorBuffer
val outputFeature3 = outputs.outputFeature3AsTensorBuffer

// Releases model resources if no longer used.
model.close()

However, the application is running slowly, and I would like to perform the model computations on the GPU.

I am facing an issue with the input and output parts.

I couldn't find any information about it anywhere. The current code looks like this:

val options = Interpreter.Options().apply {
    if(compatList.isDelegateSupportedOnThisDevice) {
        val delegateOptions = compatList.bestOptionsForThisDevice
        this.addDelegate(GpuDelegate(delegateOptions))
    } else {
        this.setNumThreads(4)
    }
}
interpreter = Interpreter(loadModelFile(assets,""Ssd.tflite""), options)
val inputFeature0 = TensorBuffer.createFixedSize(intArrayOf(1, 320, 320, 3), DataType.FLOAT32)
inputFeature0.loadBuffer(byteBuffer)

Then, I should create the input.buffer for the main line:

interpreter.run(inputFeature0.buffer, outputs.buffer)

I tried doing some adjustments, but the outputs.buffer I got as a result was something I couldn't interpret. Has anyone encountered a similar problem? If so, please, I would appreciate your help.

",False
esrgan re-convert to tflite fail stat:awaiting response stale type:performance TFLiteConverter TF 2.13,"### 1. System information

- OS Platform and Distribution: macOS 12.2.1; Apple M1; MacBook Pro
- TensorFlow installation : pip3 install tensorflow
- TensorFlow library: 2.13.0

### 2. Code

Provide code to help us reproduce your issues using one of the following options:

#### Option A: Reference colab notebooks

1)  Reference [TensorFlow Model Colab](https://colab.research.google.com/gist/ymodak/e96a4270b953201d5362c61c1e8b78aa/tensorflow-datasets.ipynb?authuser=1): Demonstrate how to build your TF model.
2)  Reference [TensorFlow Lite Model Colab](https://colab.research.google.com/gist/ymodak/0dfeb28255e189c5c48d9093f296e9a8/tensorflow-lite-debugger-colab.ipynb): Demonstrate how to convert your TF model to a TF Lite model (with quantization, if used) and run TFLite Inference (if possible).

```
convert tflite:  https://github.com/tensorflow/examples/blob/master/lite/examples/super_resolution/ml/super_resolution.ipynb
```

#### Option B: Paste your code here or provide a link to a custom end-to-end colab

```
test demo:  https://github.com/tensorflow/examples/tree/master/lite/examples/super_resolution
```

### 3. Failure after conversion
If the conversion is successful, but the generated model is wrong, then state what is wrong:

- Model produces some errors

### 4. (optional) RNN conversion support
model is esrgan

### 5. (optional) Any other info / logs
case1.  enable optimize like ""tf.lite.Optimize.DEFAULT"",  load model fail: Didn't find op for builtin opcode 'DEQUANTIZE' version '5'
case2. disable optimize, set_shape 50x50, run fail msg: Something went wrong when copying input buffer to input tensor
case3. disable optimize, set_shape 640x360, run fail msg: signal 11 (SIGSEGV): stack pointer is in a non-existent map; likely due to stack overflow.  function crash: SuperResolution.cpp->DoSuperResolution() line at: TfLiteInterpreterAllocateTensors
",False
Cannot build tensorflow2.7-gpu version with bazel3.7.2 stat:awaiting response type:build/install stale subtype: ubuntu/linux TF 2.7,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf2.7

### Custom code

No

### OS platform and distribution

Linux Ubuntu 22.04

### Mobile device

Linux Ubuntu 22.04

### Python version

3.8

### Bazel version

3.7.2

### GCC/compiler version

gcc 11

### CUDA/cuDNN version

12.1/8.9

### GPU model and memory

Quadro RTX 8000, 48GB

### Current behavior?

Context: I can use the exact same source codes to successfully build the CPU-only version. I hope to get a gpu version with the same code.

So I ran `bazel clean`, it looks fine.

Then I run `bazel build --config=cuda //tensorflow/tools/pip_package:build_pip_package`. I have tried for several times, but everytime got the following error: (I only paste the main part here, before this there were some regular bazel output, e.g., INFO:...)

```
ERROR: An error occurred during the fetch of repository 'local_config_cuda':
   Traceback (most recent call last):
        File ""/home/xiaxia/tensorflow/third_party/gpus/cuda_configure.bzl"", line 1401, column 38, in _cuda_autoconf_impl
                _create_local_cuda_repository(repository_ctx)
        File ""/home/xiaxia/tensorflow/third_party/gpus/cuda_configure.bzl"", line 1076, column 27, in _create_local_cuda_repository
                cuda_libs = _find_libs(repository_ctx, check_cuda_libs_script, cuda_config)
        File ""/home/xiaxia/tensorflow/third_party/gpus/cuda_configure.bzl"", line 606, column 21, in _find_libs
                _check_cuda_libs(repository_ctx, check_cuda_libs_script, check_cuda_libs_params.values())
        File ""/home/xiaxia/tensorflow/third_party/gpus/cuda_configure.bzl"", line 501, column 28, in _check_cuda_libs
                checked_paths = execute(repository_ctx, [python_bin, ""-c"", cmd]).stdout.splitlines()
        File ""/home/xiaxia/tensorflow/third_party/remote_config/common.bzl"", line 230, column 13, in execute
                fail(
Error in fail: Repository command failed
Expected even number of arguments
INFO: Found applicable config definition build:cuda in file /home/xiaxia/tensorflow/.bazelrc: --repo_env TF_NEED_CUDA=1 --crosstool_top=@local_config_cuda//c
INFO: Found applicable config definition build:cuda in file /home/xiaxia/tensorflow/.bazelrc: --repo_env TF_NEED_CUDA=1 --crosstool_top=@local_config_cuda//c
WARNING: The following configs were expanded more than once: [cuda]. For repeatable flags, repeats are counted twice and may lead to unexpected behavior.
ERROR: @local_config_cuda//:enable_cuda :: Error loading option @local_config_cuda//:enable_cuda: Repository command failed
Expected even number of arguments
```

Note that, I do not have root/admin role of the remote ubuntu machine, will it be a problem? I also tried to implement cuda and cudnn in my /home/ directory, but it still not help.

Please provide me with any advice, and thanks a lot!

### Standalone code to reproduce the issue

```shell
Sorry I don't know how to share my problem as reproducible, it happens in the process of building tensorflow.
```


### Relevant log output

```shell
WARNING: The following configs were expanded more than once: [cuda]. For repeatable flags, repeats are counted twice and may lead to unexpected behavior.
INFO: Options provided by the client:
  Inherited 'common' options: --isatty=1 --terminal_columns=157
INFO: Reading rc options for 'build' from /home/xiaxia/tensorflow/.bazelrc:
  Inherited 'common' options: --experimental_repo_remote_exec
INFO: Reading rc options for 'build' from /home/xiaxia/tensorflow/.bazelrc:
  'build' options: --define framework_shared_object=true --java_toolchain=@tf_toolchains//toolchains/java:tf_java_toolchain --host_java_toolchain=@tf_toolchains//toolchains/java:tf_java_toolchain --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone -c opt --announce_rc --define=grpc_no_ares=true --noincompatible_remove_legacy_whole_archive --enable_platform_specific_config --define=with_xla_support=true --config=short_logs --config=v2 --define=no_aws_support=true --define=no_hdfs_support=true
INFO: Reading rc options for 'build' from /home/xiaxia/tensorflow/.tf_configure.bazelrc:
  'build' options: --action_env PYTHON_BIN_PATH=/home/xiaxia/anaconda3/envs/tf-cus-gpu/bin/python3 --action_env PYTHON_LIB_PATH=/home/xiaxia/anaconda3/envs/tf-cus-gpu/lib/python3.8/site-packages --python_path=/home/xiaxia/anaconda3/envs/tf-cus-gpu/bin/python3 --action_env TF_CUDA_VERSION=12.2 --action_env TF_CUDNN_VERSION=8 --action_env TF_NCCL_VERSION= --action_env TF_CUDA_PATHS=/home/xiaxia/cuda-12.2 --action_env CUDA_TOOLKIT_PATH=/home/xiaxia/cuda-12.2 --action_env TF_CUDA_COMPUTE_CAPABILITIES=3.5,7.0 --action_env LD_LIBRARY_PATH=/usr/local/cuda-12.1/targets/x86_64-linux/lib:/usr/local/cuda-12.1/targets/x86_64-linux/lib:/usr/local/cuda-12.1/targets/x86_64-linux/lib::/home/xiaxia/cuda-12.2/lib64:/home/xiaxia/cuda-12.2/lib64 --action_env GCC_HOST_COMPILER_PATH=/usr/bin/x86_64-linux-gnu-gcc-11 --config=cuda
INFO: Reading rc options for 'build' from /home/xiaxia/tensorflow/.bazelrc:
  'build' options: --deleted_packages=tensorflow/compiler/mlir/tfrt,tensorflow/compiler/mlir/tfrt/benchmarks,tensorflow/compiler/mlir/tfrt/jit/python_binding,tensorflow/compiler/mlir/tfrt/jit/transforms,tensorflow/compiler/mlir/tfrt/python_tests,tensorflow/compiler/mlir/tfrt/tests,tensorflow/compiler/mlir/tfrt/tests/saved_model,tensorflow/compiler/mlir/tfrt/transforms/lhlo_gpu_to_tfrt_gpu,tensorflow/core/runtime_fallback,tensorflow/core/runtime_fallback/conversion,tensorflow/core/runtime_fallback/kernel,tensorflow/core/runtime_fallback/opdefs,tensorflow/core/runtime_fallback/runtime,tensorflow/core/runtime_fallback/util,tensorflow/core/tfrt/common,tensorflow/core/tfrt/eager,tensorflow/core/tfrt/eager/backends/cpu,tensorflow/core/tfrt/eager/backends/gpu,tensorflow/core/tfrt/eager/core_runtime,tensorflow/core/tfrt/eager/cpp_tests/core_runtime,tensorflow/core/tfrt/fallback,tensorflow/core/tfrt/gpu,tensorflow/core/tfrt/run_handler_thread_pool,tensorflow/core/tfrt/runtime,tensorflow/core/tfrt/saved_model,tensorflow/core/tfrt/saved_model/tests,tensorflow/core/tfrt/tpu,tensorflow/core/tfrt/utils
INFO: Found applicable config definition build:short_logs in file /home/xiaxia/tensorflow/.bazelrc: --output_filter=DONT_MATCH_ANYTHING
INFO: Found applicable config definition build:v2 in file /home/xiaxia/tensorflow/.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1
INFO: Found applicable config definition build:cuda in file /home/xiaxia/tensorflow/.bazelrc: --repo_env TF_NEED_CUDA=1 --crosstool_top=@local_config_cuda//crosstool:toolchain --@local_config_cuda//:enable_cuda
INFO: Found applicable config definition build:cuda in file /home/xiaxia/tensorflow/.bazelrc: --repo_env TF_NEED_CUDA=1 --crosstool_top=@local_config_cuda//crosstool:toolchain --@local_config_cuda//:enable_cuda
INFO: Found applicable config definition build:linux in file /home/xiaxia/tensorflow/.bazelrc: --copt=-w --host_copt=-w --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include --define=PROTOBUF_INCLUDE_PATH=$(PREFIX)/include --cxxopt=-std=c++14 --host_cxxopt=-std=c++14 --config=dynamic_kernels --distinct_host_configuration=false --experimental_guard_against_concurrent_changes
INFO: Found applicable config definition build:dynamic_kernels in file /home/xiaxia/tensorflow/.bazelrc: --define=dynamic_loaded_kernels=true --copt=-DAUTOLOAD_DYNAMIC_KERNELS
INFO: Repository local_config_cuda instantiated at:
  /home/xiaxia/tensorflow/WORKSPACE:15:14: in <toplevel>
  /home/xiaxia/tensorflow/tensorflow/workspace2.bzl:1080:19: in workspace
  /home/xiaxia/tensorflow/tensorflow/workspace2.bzl:94:19: in _tf_toolchains
Repository rule cuda_configure defined at:
  /home/xiaxia/tensorflow/third_party/gpus/cuda_configure.bzl:1448:33: in <toplevel>
ERROR: An error occurred during the fetch of repository 'local_config_cuda':
   Traceback (most recent call last):
        File ""/home/xiaxia/tensorflow/third_party/gpus/cuda_configure.bzl"", line 1401, column 38, in _cuda_autoconf_impl
                _create_local_cuda_repository(repository_ctx)
        File ""/home/xiaxia/tensorflow/third_party/gpus/cuda_configure.bzl"", line 1076, column 27, in _create_local_cuda_repository
                cuda_libs = _find_libs(repository_ctx, check_cuda_libs_script, cuda_config)
        File ""/home/xiaxia/tensorflow/third_party/gpus/cuda_configure.bzl"", line 606, column 21, in _find_libs
                _check_cuda_libs(repository_ctx, check_cuda_libs_script, check_cuda_libs_params.values())
        File ""/home/xiaxia/tensorflow/third_party/gpus/cuda_configure.bzl"", line 501, column 28, in _check_cuda_libs
                checked_paths = execute(repository_ctx, [python_bin, ""-c"", cmd]).stdout.splitlines()
        File ""/home/xiaxia/tensorflow/third_party/remote_config/common.bzl"", line 230, column 13, in execute
                fail(
Error in fail: Repository command failed
Expected even number of arguments
INFO: Found applicable config definition build:cuda in file /home/xiaxia/tensorflow/.bazelrc: --repo_env TF_NEED_CUDA=1 --crosstool_top=@local_config_cuda//crosstool:toolchain --@local_config_cuda//:enable_cuda
INFO: Found applicable config definition build:cuda in file /home/xiaxia/tensorflow/.bazelrc: --repo_env TF_NEED_CUDA=1 --crosstool_top=@local_config_cuda//crosstool:toolchain --@local_config_cuda//:enable_cuda
WARNING: The following configs were expanded more than once: [cuda]. For repeatable flags, repeats are counted twice and may lead to unexpected behavior.
ERROR: @local_config_cuda//:enable_cuda :: Error loading option @local_config_cuda//:enable_cuda: Repository command failed
Expected even number of arguments
```
",False
 RuntimeError: Quantization to 16x8-bit not yet supported for op: 'FLOOR_MOD'    stat:awaiting response stale type:performance TFLiteConverter TF 2.12,"### 1. System information

- OS Platform and Distribution (e.g., Linux Ubuntu 16.04):
google colab
- TensorFlow installation (pip package or built from source):
- pip
- TensorFlow library (version, if pip package or github SHA, if built from source):
- 2.12.0

### 2. Code
I have following model.
```python
(train_images, train_labels), (test_images, test_labels) = tf.keras.datasets.mnist.load_data()

train_labels = train_labels[:1000]
test_labels = test_labels[:1000]

train_images = train_images[:1000].reshape(-1, 28 * 28) / 255.0
test_images = test_images[:1000].reshape(-1, 28 * 28) / 255.0


# Normalize the input image so that each pixel value is between 0 to 1.
train_images = train_images.astype(np.float32) / 255.0
test_images = test_images.astype(np.float32) / 255.0


# Define a simple sequential model

model_infrence = tf.keras.Sequential([
    MyDense(512, activation='relu', input_shape=(784,)),
    keras.layers.Dense(512, activation='relu', input_shape=(784,)),
    keras.layers.Dropout(0.2),
    keras.layers.Dense(10)
  ])

model_infrence.compile(optimizer='adam',
                loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True),
                metrics=[tf.keras.metrics.SparseCategoricalAccuracy()])



# Create a basic model instance


# Display the model's architecture
model_infrence.summary()

# Create a basic model instance


# Display the model's architecture
model_infrence.summary()
```

Then I custom one of the dense layers like so 
```python
# Copyright 2015 The TensorFlow Authors. All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the ""License"");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an ""AS IS"" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# ==============================================================================
""""""Contains the Dense layer.""""""


import tensorflow.compat.v2 as tf

from keras import activations
from keras import backend
from keras import constraints
from keras import initializers
from keras import regularizers
from keras.dtensor import utils
from keras.engine.base_layer import Layer
from keras.engine.input_spec import InputSpec

# isort: off
from tensorflow.python.util.tf_export import keras_export


@keras_export(""keras.layers.Dense"")
class MyDense(Layer):
    """"""Just your regular densely-connected NN layer.

    `Dense` implements the operation:
    `output = activation(dot(input, kernel) + bias)`
    where `activation` is the element-wise activation function
    passed as the `activation` argument, `kernel` is a weights matrix
    created by the layer, and `bias` is a bias vector created by the layer
    (only applicable if `use_bias` is `True`). These are all attributes of
    `Dense`.

    Note: If the input to the layer has a rank greater than 2, then `Dense`
    computes the dot product between the `inputs` and the `kernel` along the
    last axis of the `inputs` and axis 0 of the `kernel` (using `tf.tensordot`).
    For example, if input has dimensions `(batch_size, d0, d1)`, then we create
    a `kernel` with shape `(d1, units)`, and the `kernel` operates along axis 2
    of the `input`, on every sub-tensor of shape `(1, 1, d1)` (there are
    `batch_size * d0` such sub-tensors).  The output in this case will have
    shape `(batch_size, d0, units)`.

    Besides, layer attributes cannot be modified after the layer has been called
    once (except the `trainable` attribute).
    When a popular kwarg `input_shape` is passed, then keras will create
    an input layer to insert before the current layer. This can be treated
    equivalent to explicitly defining an `InputLayer`.

    Example:

    >>> # Create a `Sequential` model and add a Dense layer as the first layer.
    >>> model = tf.keras.models.Sequential()
    >>> model.add(tf.keras.Input(shape=(16,)))
    >>> model.add(tf.keras.layers.Dense(32, activation='relu'))
    >>> # Now the model will take as input arrays of shape (None, 16)
    >>> # and output arrays of shape (None, 32).
    >>> # Note that after the first layer, you don't need to specify
    >>> # the size of the input anymore:
    >>> model.add(tf.keras.layers.Dense(32))
    >>> model.output_shape
    (None, 32)

    Args:
        units: Positive integer, dimensionality of the output space.
        activation: Activation function to use.
            If you don't specify anything, no activation is applied
            (ie. ""linear"" activation: `a(x) = x`).
        use_bias: Boolean, whether the layer uses a bias vector.
        kernel_initializer: Initializer for the `kernel` weights matrix.
        bias_initializer: Initializer for the bias vector.
        kernel_regularizer: Regularizer function applied to
            the `kernel` weights matrix.
        bias_regularizer: Regularizer function applied to the bias vector.
        activity_regularizer: Regularizer function applied to
            the output of the layer (its ""activation"").
        kernel_constraint: Constraint function applied to
            the `kernel` weights matrix.
        bias_constraint: Constraint function applied to the bias vector.

    Input shape:
        N-D tensor with shape: `(batch_size, ..., input_dim)`.
        The most common situation would be
        a 2D input with shape `(batch_size, input_dim)`.

    Output shape:
        N-D tensor with shape: `(batch_size, ..., units)`.
        For instance, for a 2D input with shape `(batch_size, input_dim)`,
        the output would have shape `(batch_size, units)`.
    """"""

    @utils.allow_initializer_layout
    def __init__(
        self,
        units,
        activation=None,
        use_bias=True,
        kernel_initializer=""glorot_uniform"",
        bias_initializer=""zeros"",
        kernel_regularizer=None,
        bias_regularizer=None,
        activity_regularizer=None,
        kernel_constraint=None,
        bias_constraint=None,
        **kwargs,
    ):
        super().__init__(activity_regularizer=activity_regularizer, **kwargs)

        self.units = int(units) if not isinstance(units, int) else units
        if self.units < 0:
            raise ValueError(
                ""Received an invalid value for `units`, expected ""
                f""a positive integer. Received: units={units}""
            )
        self.activation = activations.get(activation)
        self.use_bias = use_bias
        self.kernel_initializer = initializers.get(kernel_initializer)
        self.bias_initializer = initializers.get(bias_initializer)
        self.kernel_regularizer = regularizers.get(kernel_regularizer)
        self.bias_regularizer = regularizers.get(bias_regularizer)
        self.kernel_constraint = constraints.get(kernel_constraint)
        self.bias_constraint = constraints.get(bias_constraint)

        self.input_spec = InputSpec(min_ndim=2)
        self.supports_masking = True

    def build(self, input_shape):
        dtype = tf.as_dtype(self.dtype or backend.floatx())
        if not (dtype.is_floating or dtype.is_complex):
            raise TypeError(
                ""A Dense layer can only be built with a floating-point ""
                f""dtype. Received: dtype={dtype}""
            )

        input_shape = tf.TensorShape(input_shape)
        last_dim = tf.compat.dimension_value(input_shape[-1])
        if last_dim is None:
            raise ValueError(
                ""The last dimension of the inputs to a Dense layer ""
                ""should be defined. Found None. ""
                f""Full input shape received: {input_shape}""
            )
        self.input_spec = InputSpec(min_ndim=2, axes={-1: last_dim})
        self.kernel = self.add_weight(
            ""kernel"",
            shape=[last_dim, self.units],
            initializer=self.kernel_initializer,
            regularizer=self.kernel_regularizer,
            constraint=self.kernel_constraint,
            dtype=self.dtype,
            trainable=True,
        )
        if self.use_bias:
            self.bias = self.add_weight(
                ""bias"",
                shape=[
                    self.units,
                ],
                initializer=self.bias_initializer,
                regularizer=self.bias_regularizer,
                constraint=self.bias_constraint,
                dtype=self.dtype,
                trainable=True,
            )
        else:
            self.bias = None
        self.built = True

    def call(self, inputs):
        if inputs.dtype.base_dtype != self._compute_dtype_object.base_dtype:
            inputs = tf.cast(inputs, dtype=self._compute_dtype_object)

        is_ragged = isinstance(inputs, tf.RaggedTensor)
        if is_ragged:
            # In case we encounter a RaggedTensor with a fixed last dimension
            # (last dimension not ragged), we can flatten the input and restore
            # the ragged dimensions at the end.
            if tf.compat.dimension_value(inputs.shape[-1]) is None:
                raise ValueError(
                    ""Dense layer only supports RaggedTensors when the ""
                    ""innermost dimension is non-ragged. Received: ""
                    f""inputs.shape={inputs.shape}.""
                )
            original_inputs = inputs
            if inputs.flat_values.shape.rank > 1:
                inputs = inputs.flat_values
            else:
                # Innermost partition is encoded using uniform_row_length.
                # (This is unusual, but we can handle it.)
                if inputs.shape.rank == 2:
                    inputs = inputs.to_tensor()
                    is_ragged = False
                else:
                    for _ in range(original_inputs.ragged_rank - 1):
                        inputs = inputs.values
                    inputs = inputs.to_tensor()
                    original_inputs = tf.RaggedTensor.from_nested_row_splits(
                        inputs, original_inputs.nested_row_splits[:-1]
                    )

        rank = inputs.shape.rank
        if rank == 2 or rank is None:
            # We use embedding_lookup_sparse as a more efficient matmul
            # operation for large sparse input tensors. The op will result in a
            # sparse gradient, as opposed to
            # sparse_ops.sparse_tensor_dense_matmul which results in dense
            # gradients. This can lead to sigfinicant speedups, see b/171762937.
            if isinstance(inputs, tf.SparseTensor):
                # We need to fill empty rows, as the op assumes at least one id
                # per row.
                inputs, _ = tf.sparse.fill_empty_rows(inputs, 0)
                # We need to do some munging of our input to use the embedding
                # lookup as a matrix multiply. We split our input matrix into
                # separate ids and weights tensors. The values of the ids tensor
                # should be the column indices of our input matrix and the
                # values of the weights tensor can continue to the actual matrix
                # weights.  The column arrangement of ids and weights will be
                # summed over and does not matter. See the documentation for
                # sparse_ops.sparse_tensor_dense_matmul a more detailed
                # explanation of the inputs to both ops.
                ids = tf.SparseTensor(
                    indices=inputs.indices,
                    values=inputs.indices[:, 1],
                    dense_shape=inputs.dense_shape,
                )
                weights = inputs
                outputs = tf.nn.embedding_lookup_sparse(
                    self.kernel, ids, weights, combiner=""sum""
                )
            else:
                

                  print(inputs)
                  quotient, x = divmod(inputs, (2**n))
                  #x = inputs % (2**n);
                  quotient1, x1 = divmod(inputs, (2**n - 1))
                  #x1 = inputs % (2**n - 1);
                  quotient2, x2 = divmod(inputs, (2**n + 1))
                  #x2 = inputs % (2**n + 1);
                  # w =  self.w % (2**n);
                  quotient3, w = divmod(self.w, (2**n))
                  # w1 = self.w % (2**n - 1);
                  quotient4, w1 = divmod(self.w, (2**n - 1))
                  # w2 = self.w % (2**n + 1)
                  quotient5, w2 = divmod(self.w, (2**n + 1))
                  quotient6, z = divmod((tf.matmul(x, w) + self.b), (2**n))
                  # z = (tf.matmul(x, w) + self.b) % (2**n)
                  quotient7, z1 = divmod((tf.matmul(x, w) + self.b), (2**n - 1))
                  # z1 = (tf.matmul(x1, w1) + self.b) % (2**n - 1)
                  quotient8, z2 = divmod((tf.matmul(x, w) + self.b), (2**n + 1))
                  # z2 = tf.matmul(x2, w2) + self.b % (2**n + 1)

                  Dm = (2**n) * (2**n - 1) * (2**n + 1);
                  m1 = math.floor(((2**n) * (2**n - 1) * (2**n + 1))/(2**n));
                  m2 = math.floor(((2**n) * (2**n - 1) * (2**n + 1))/(2**n - 1));
                  m3 = math.floor(((2**n) * (2**n - 1) * (2**n + 1))/(2**n + 1));

                  outputs = rns_to_decimal(Dm, z, z1, z2, m1, m2, m3, n)
                  print(outputs)
        # Broadcast kernel to inputs.
        else:
            outputs = tf.tensordot(inputs, self.kernel, [[rank - 1], [0]])
            # Reshape the output back to the original ndim of the input.
            if not tf.executing_eagerly():
                shape = inputs.shape.as_list()
                output_shape = shape[:-1] + [self.kernel.shape[-1]]
                outputs.set_shape(output_shape)

        # if self.use_bias:
        #     outputs = tf.nn.bias_add(outputs, self.bias)

        if self.activation is not None:
            outputs = self.activation(outputs)

        if is_ragged:
            outputs = original_inputs.with_flat_values(outputs)

        return outputs

    def compute_output_shape(self, input_shape):
        input_shape = tf.TensorShape(input_shape)
        input_shape = input_shape.with_rank_at_least(2)
        if tf.compat.dimension_value(input_shape[-1]) is None:
            raise ValueError(
                ""The last dimension of the input shape of a Dense layer ""
                ""should be defined. Found None. ""
                f""Received: input_shape={input_shape}""
            )
        return input_shape[:-1].concatenate(self.units)

    def get_config(self):
        config = super().get_config()
        config.update(
            {
                ""units"": self.units,
                ""activation"": activations.serialize(self.activation),
                ""use_bias"": self.use_bias,
                ""kernel_initializer"": initializers.serialize(
                    self.kernel_initializer
                ),
                ""bias_initializer"": initializers.serialize(
                    self.bias_initializer
                ),
                ""kernel_regularizer"": regularizers.serialize(
                    self.kernel_regularizer
                ),
                ""bias_regularizer"": regularizers.serialize(
                    self.bias_regularizer
                ),
                ""activity_regularizer"": regularizers.serialize(
                    self.activity_regularizer
                ),
                ""kernel_constraint"": constraints.serialize(
                    self.kernel_constraint
                ),
                ""bias_constraint"": constraints.serialize(self.bias_constraint),
            }
        )
        return config
    def rns_to_decimal(dm, z1, z2, z3, m1, m2, m3, n = 6):
        M1 = 2**n
        M2 = 2**n - 1
        M3 = 2**n + 1
        x1 = 1
        x2 = 1
        x3 = 1
        quotient, mm1 = divmod(m1, M1)
       # mm1 = m1 % M1
        for i in range(1, M1):
            quotient1, X = divmod((i * mm1), M1)
            if X == 1:
                x1 = i
        quotient2, mm2 = divmod(m2, M2)
       # mm2 = m2 % M2
        for i in range(1, M2):
            quotient3, X1 = divmod((i * mm2), M2)
            if X1 == 1:
                x2 = i
       # mm3 = m3 % M3
        quotient4, mm3 = divmod(m3, M3)
        for i in range(1, M3):
            quotient5, X2 = divmod((i * mm3), M3)
            if X2 == 1:
                x3 = i
        quotient5, num = divmod((z1 * m1 * x1 + z2 * m2 * x2 + z3 * m3 * x3), dm)
       # num = (z1 * m1 * x1 + z2 * m2 * x2 + z3 * m3 * x3) % dm
        return num
```

The only change to original layer is following code:

```python
                  quotient, x = divmod(inputs, (2**n))
                  #x = inputs % (2**n);
                  quotient1, x1 = divmod(inputs, (2**n - 1))
                  #x1 = inputs % (2**n - 1);
                  quotient2, x2 = divmod(inputs, (2**n + 1))
                  #x2 = inputs % (2**n + 1);
                  # w =  self.w % (2**n);
                  quotient3, w = divmod(self.w, (2**n))
                  # w1 = self.w % (2**n - 1);
                  quotient4, w1 = divmod(self.w, (2**n - 1))
                  # w2 = self.w % (2**n + 1)
                  quotient5, w2 = divmod(self.w, (2**n + 1))
                  quotient6, z = divmod((tf.matmul(x, w) + self.b), (2**n))
                  # z = (tf.matmul(x, w) + self.b) % (2**n)
                  quotient7, z1 = divmod((tf.matmul(x, w) + self.b), (2**n - 1))
                  # z1 = (tf.matmul(x1, w1) + self.b) % (2**n - 1)
                  quotient8, z2 = divmod((tf.matmul(x, w) + self.b), (2**n + 1))
                  # z2 = tf.matmul(x2, w2) + self.b % (2**n + 1)

                  Dm = (2**n) * (2**n - 1) * (2**n + 1);
                  m1 = math.floor(((2**n) * (2**n - 1) * (2**n + 1))/(2**n));
                  m2 = math.floor(((2**n) * (2**n - 1) * (2**n + 1))/(2**n - 1));
                  m3 = math.floor(((2**n) * (2**n - 1) * (2**n + 1))/(2**n + 1));

                  outputs = rns_to_decimal(Dm, z, z1, z2, m1, m2, m3, n)
```

Provide code to help us reproduce your issues using one of the following options:

#### Option A: Reference colab notebooks

1)  Reference [TensorFlow Model Colab](https://colab.research.google.com/gist/ymodak/e96a4270b953201d5362c61c1e8b78aa/tensorflow-datasets.ipynb?authuser=1): Demonstrate how to build your TF model.
2)  Reference [TensorFlow Lite Model Colab](https://colab.research.google.com/gist/ymodak/0dfeb28255e189c5c48d9093f296e9a8/tensorflow-lite-debugger-colab.ipynb): Demonstrate how to convert your TF model to a TF Lite model (with quantization, if used) and run TFLite Inference (if possible).

```
(You can paste links or attach files by dragging & dropping them below)
- Provide links to your updated versions of the above two colab notebooks.
- Provide links to your TensorFlow model and (optionally) TensorFlow Lite Model.
```

#### Option B: Paste your code here or provide a link to a custom end-to-end colab

```
(You can paste links or attach files by dragging & dropping them below)
- Include code to invoke the TFLite Converter Python API and the errors.
- Provide links to your TensorFlow model and (optionally) TensorFlow Lite Model.
```

### 3. Failure after conversion
If the conversion is successful, but the generated model is wrong, then state what is wrong:

- Model produces wrong results and/or has lesser accuracy.
- Model produces correct results, but it is slower than expected.

### 4. (optional) RNN conversion support
If converting TF RNN to TFLite fused RNN ops, please prefix [RNN] in the title.

### 5. (optional) Any other info / logs
Include any logs or source code that would be helpful to diagnose the problem. If including tracebacks, please include the full traceback. Large logs and files should be attached.
",False
Failed to build tensorflow on Apple silicon. stat:awaiting tensorflower type:build/install subtype:macOS TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf 2.13

### Custom code

No

### OS platform and distribution

macOS 13.4.1

### Mobile device

None

### Python version

3.11

### Bazel version

5.3.0-homebrew

### GCC/compiler version

Apple clang version 14.0.3 (clang-1403.0.22.14.1)

### CUDA/cuDNN version

None

### GPU model and memory

None

### Current behavior?

After failing to build tensorflow using the default options, I attempted the solution suggested in this issue (https://github.com/tensorflow/tensorflow/issues/60179). However, I found that installing `coreutils` directly still resulted in the same problem.

### Standalone code to reproduce the issue

Default settings used for all options.
```shell
bazel build //tensorflow/tools/pip_package:build_pip_package
```
 

### Relevant log output

```shell
INFO: Options provided by the client:
  Inherited 'common' options: --isatty=1 --terminal_columns=80
INFO: Reading rc options for 'build' from /Users/sunruiqi/Desktop/tensorflow-2.13.0/.bazelrc:
  Inherited 'common' options: --experimental_repo_remote_exec
INFO: Reading rc options for 'build' from /Users/sunruiqi/Desktop/tensorflow-2.13.0/.bazelrc:
  'build' options: --define framework_shared_object=true --define tsl_protobuf_header_only=true --define=use_fast_cpp_protos=true --define=allow_oversize_protos=true --spawn_strategy=standalone -c opt --announce_rc --define=grpc_no_ares=true --noincompatible_remove_legacy_whole_archive --enable_platform_specific_config --define=with_xla_support=true --config=short_logs --config=v2 --define=no_aws_support=true --define=no_hdfs_support=true --experimental_cc_shared_library --experimental_link_static_libraries_once=false --incompatible_enforce_config_setting_visibility
INFO: Reading rc options for 'build' from /Users/sunruiqi/Desktop/tensorflow-2.13.0/.tf_configure.bazelrc:
  'build' options: --action_env PYTHON_BIN_PATH=/Users/sunruiqi/miniconda3/envs/tensorflow-macos/bin/python3 --action_env PYTHON_LIB_PATH=/Users/sunruiqi/miniconda3/envs/tensorflow-macos/lib/python3.11/site-packages --python_path=/Users/sunruiqi/miniconda3/envs/tensorflow-macos/bin/python3
INFO: Reading rc options for 'build' from /Users/sunruiqi/Desktop/tensorflow-2.13.0/.bazelrc:
  'build' options: --deleted_packages=tensorflow/compiler/mlir/tfrt,tensorflow/compiler/mlir/tfrt/benchmarks,tensorflow/compiler/mlir/tfrt/jit/python_binding,tensorflow/compiler/mlir/tfrt/jit/transforms,tensorflow/compiler/mlir/tfrt/python_tests,tensorflow/compiler/mlir/tfrt/tests,tensorflow/compiler/mlir/tfrt/tests/ir,tensorflow/compiler/mlir/tfrt/tests/analysis,tensorflow/compiler/mlir/tfrt/tests/jit,tensorflow/compiler/mlir/tfrt/tests/lhlo_to_tfrt,tensorflow/compiler/mlir/tfrt/tests/lhlo_to_jitrt,tensorflow/compiler/mlir/tfrt/tests/tf_to_corert,tensorflow/compiler/mlir/tfrt/tests/tf_to_tfrt_data,tensorflow/compiler/mlir/tfrt/tests/saved_model,tensorflow/compiler/mlir/tfrt/transforms/lhlo_gpu_to_tfrt_gpu,tensorflow/core/runtime_fallback,tensorflow/core/runtime_fallback/conversion,tensorflow/core/runtime_fallback/kernel,tensorflow/core/runtime_fallback/opdefs,tensorflow/core/runtime_fallback/runtime,tensorflow/core/runtime_fallback/util,tensorflow/core/tfrt/eager,tensorflow/core/tfrt/eager/backends/cpu,tensorflow/core/tfrt/eager/backends/gpu,tensorflow/core/tfrt/eager/core_runtime,tensorflow/core/tfrt/eager/cpp_tests/core_runtime,tensorflow/core/tfrt/gpu,tensorflow/core/tfrt/run_handler_thread_pool,tensorflow/core/tfrt/runtime,tensorflow/core/tfrt/saved_model,tensorflow/core/tfrt/graph_executor,tensorflow/core/tfrt/saved_model/tests,tensorflow/core/tfrt/tpu,tensorflow/core/tfrt/utils,tensorflow/core/tfrt/utils/debug
INFO: Found applicable config definition build:short_logs in file /Users/sunruiqi/Desktop/tensorflow-2.13.0/.bazelrc: --output_filter=DONT_MATCH_ANYTHING
INFO: Found applicable config definition build:v2 in file /Users/sunruiqi/Desktop/tensorflow-2.13.0/.bazelrc: --define=tf_api_version=2 --action_env=TF2_BEHAVIOR=1
INFO: Found applicable config definition build:macos in file /Users/sunruiqi/Desktop/tensorflow-2.13.0/.bazelrc: --apple_platform_type=macos --copt=-DGRPC_BAZEL_BUILD --copt=-w --define=PREFIX=/usr --define=LIBDIR=$(PREFIX)/lib --define=INCLUDEDIR=$(PREFIX)/include --define=PROTOBUF_INCLUDE_PATH=$(PREFIX)/include --cxxopt=-std=c++17 --host_cxxopt=-std=c++17
INFO: Analyzed target //tensorflow/tools/pip_package:build_pip_package (611 packages loaded, 37637 targets configured).
INFO: Found 1 target...
ERROR: /Users/sunruiqi/Desktop/tensorflow-2.13.0/tensorflow/BUILD:1134:21: declared output 'tensorflow/libtensorflow_framework.2.dylib' was not created by genrule. This is probably because the genrule actually didn't create this output, or because the output was a directory and the genrule was run remotely (note that only the contents of declared file outputs are copied from genrules run remotely)
ERROR: /Users/sunruiqi/Desktop/tensorflow-2.13.0/tensorflow/BUILD:1134:21: Executing genrule //tensorflow:libtensorflow_framework.2.dylib_sym failed: not all outputs were created or valid
realpath: illegal option -- -
usage: realpath [-q] [path ...]
Target //tensorflow/tools/pip_package:build_pip_package failed to build
Use --verbose_failures to see the command lines of failed build steps.
INFO: Elapsed time: 438.472s, Critical Path: 37.63s
INFO: 5437 processes: 1278 internal, 4159 local.
FAILED: Build did NOT complete successfully
```
",False
`tf.data.Dataset` only supports Python-style iteration in eager mode or within tf.function. stale comp:data comp:tf.function,"The first is the map function:
    def map_function(example):

        feature_map = {""wav_raw"": tf.io.FixedLenFeature([], tf.string)}
        parsed_example = tf.io.parse_single_example(example, features=feature_map)

        wav_slice = tf.io.decode_raw(parsed_example[""wav_raw""], out_type=tf.float64)
        wav_slice = tf.cast(wav_slice, tf.float32) / 2 ** 15

        return wav_slice

The second one is the training process:

     for epoch in range(args.num_epochs):
              
        trainset = tf.data.TFRecordDataset(args.trainset_tfrecords_path)
        trainset = trainset.map(map_func=map_function,
                                num_parallel_calls=num_cpus)  # num_parallel_calls should be number of cpu cores

        #trainset = trainset.shuffle(buffer_size=args.batch_size * 200, reshuffle_each_iteration=True)
        trainset = trainset.batch(batch_size=args.batch_size)
        trainset = trainset.prefetch(buffer_size=args.batch_size)


        # train_loss for each epoch
        train_loss_epoch = []
        train_loss = 0.0

        # record the train time for each epoch
        start = time.time()
        # MASK参数

        #EMA_MODEL来选择mask的index

        binary_mask = RandomMaskingGenerator(input_size,frame_length,mask_ratio)
        # bmr:0为掩码，1为未掩码；
        # bm_T:1为掩码,0为未掩码；
        # bm,bm_T = binary_mask()
        

        for step, _input in enumerate(trainset):
            bm, bm_T, _ = binary_mask.random_mask(_input.shape[0],alpha_e_max)#.totally_random_mask(_input.shape[0])
            print(""_input"",_input)
            # print(""bm_shape"", bm.shape)
            # print(""bm_T_shape"", bm_T.shape)
            loss_value = train_step(_input,_input*bm,bm_T)
            loss_float = float(loss_value)

            train_loss_epoch.append(loss_float)

            # Calculate the accumulated train loss value
            train_loss += loss_float



        # average train loss for each epoch
        train_loss /= (step + 1)
        train_loss_all.append(train_loss)

        # print log
        log = ""train epoch {}/{}, train_loss = {:.06f}, time = {:.06f}""
The third one is the train_step function:

    @tf.function
    def train_step(_input,_input_mask,bm_T):
        with tf.GradientTape() as tape:
            enc_output, batch_mean, batch_var = sem_enc(_input_mask)
            #输入进去semantic decoder
            print(""main:"",enc_output)
            _output = sem_dec([enc_output, batch_mean, batch_var])
            loss_value = mse_loss(tf.multiply(_input, bm_T), _output)
            tf.print(loss_value)
            loss_whole = loss_value

        grads = tape.gradient(loss_whole, weights_all)  # compute gradients
        optimizer.apply_gradients(zip(grads, weights_all))  # update parameters

        return loss_whole



The _ouput generated by sem_dec() is the value I wanted change it from kerasTensor to TF.tensor; I could send you the whole codes, if you need, this is my email: limingxiao@link.cuhk.edu.cn. Thank you for your reply!

_Originally posted by @lmx666-gif in https://github.com/tensorflow/tensorflow/issues/61307#issuecomment-1643164557_
            ",False
How to get raw buffer pointer from python tf.Tensor stat:awaiting response type:feature stale comp:core TF 2.13,"### Issue type

Feature Request

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

binary

### TensorFlow version

2.13

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

In C++ api, tensorflow::Tensor has `data()` method which returns pointer to memory array. While in python api tf.Tensor does not allow to get raw data pointer. Is there any solution or workaround for this?

### Standalone code to reproduce the issue

```shell
tensorflow::Tensor.data()
tf.Tensor
```


### Relevant log output

_No response_",False
Tesla v100 Tensorflow CUDA Support stat:awaiting response type:support stale comp:gpu TF 2.4,"### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.4

### Custom code

Yes

### OS platform and distribution

RHEL 7.9

### Mobile device

_No response_

### Python version

3.6

### Bazel version

_No response_

### GCC/compiler version

4.3

### CUDA/cuDNN version

11/8, 10.1/7.6

### GPU model and memory

Tesla V100 2GB Vram

### Current behavior?

Attempting to fetch value instead of handling error Internal: failed to get device attribute 13 for device 0: CUDA_ERROR_UNKNOWN: unknown error.

NVIDIA-SMI give the following output:| NVIDIA-SMI 450.51.05 Driver Version: 450.51.05 CUDA Version: 11.0

nvcc-V the following output:
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2019 NVIDIA Corporation
Built on Fri_Feb__8_19:08:17_PST_2019
Cuda compilation tools, release 10.1, V10.1.105


### Standalone code to reproduce the issue

```shell
Doesnt happen with Windows or Ubuntu systems.
```


### Relevant log output

_No response_",False
LSTM support for quantisation aware training. stat:awaiting response stale TFLiteConverter,I wonder if quantization-aware training has the support for lstm? ,False
"How can I profile ""Inference"" by Profiler, and view performance profile by tensorboard comp:tensorboard stat:awaiting response type:support stale TF 2.9","### Issue type

Support

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.9.3

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 20.04

### Mobile device

_No response_

### Python version

3.7

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I want to profiling ""Inference"" by Profiler. 
However, the test of profiling training is success. But, when I try to profiling inference, the profiling log generated is empty and there are no active dashboards for the current data set.
How can I find the tutorial about analyzing the performance of inference?


### Standalone code to reproduce the issue

```shell
saved_model_loaded = tf.saved_model.load(FLAGS.weights, tags=[tag_constants.SERVING])
infer = saved_model_loaded.signatures['serving_default']
batch_data = tf.constant(images_data)
options = tf.profiler.experimental.ProfilerOptions(host_tracer_level = 3, python_tracer_level = 1, device_tracer_level = 1)
tf.profiler.experimental.start('logdir', options)
pred_bbox = infer(batch_data)
tf.profiler.experimental.stop()
```


### Relevant log output

_No response_",False
Android GPU Delegate Error while using groups in Conv2d stat:awaiting response stale comp:lite TFLiteGpuDelegate,"**System information**
- Android 13:
- TensorFlow installed from binary:
 
**use GPU Delegate**

**use model**

```python
        self.g_a0 = tf.keras.layers.Conv2D(
            N,
            kernel_size=5,
            strides=2,
            padding=""same"",
            # data_format=""channels_first"",
        )
        self.g_a1_test1 = tf.keras.layers.Conv2D(
            N,
            3,
            padding=""same"",
            groups=N,
            # data_format=""channels_first"",
        )
```
**error on android**
```
java.lang.IllegalArgumentException: Internal error: Failed to apply delegate: Can not open OpenCL library on this device - undefined symbol: clGetCommandBufferInfoKHR
Falling back to OpenGL
TfLiteGpuDelegate Init: No shader implementation for split
TfLiteGpuDelegate Prepare: delegate is not initialized
Node number 2 (TfLiteGpuDelegateV2) failed to prepare.
Restored original execution plan after delegate application failure.
```


**use anothor model**

```python
        self.g_a0 = tf.keras.layers.Conv2D(
            N,
            kernel_size=5,
            strides=2,
            padding=""same"",
            # data_format=""channels_first"",
        )
        self.g_a1_test1 = tf.keras.layers.Conv2D(
            N,
            3,
            padding=""same"",
            # groups=N,
            # data_format=""channels_first"",
        )
```
No errors on Android",False
Converted(quantized) model of simple dense neural network returns same repeated output stat:awaiting response type:performance TFLiteConverter TF 2.7,"### 1. System information

- OS Platform and Distribution (e.g., Linux Ubuntu 16.04): Ubuntu 22.04.2 LTS
- TensorFlow installation (pip package or built from source):
```bash
export condaPip=`which -a pip | grep $condaEnvName`


$condaPip install tensorflow==2.7.0
$condaPip install numpy
$condaPip install pandas
$condaPip install scikit-learn
$condaPip install statsmodels 
$condaPip install matplotlib
$condaPip install future
$condaPip install onnx
$condaPip install torchviz
$condaPip install mpi
$condaPip install torch
$condaPip install tqdm
$condaPip install pydot
$condaPip install ipympl
$condaPip install seaborn
$condaPip install tabulate
$condaPip install xgboost
$condaPip install catboost
$condaPip install bokeh
```
Installed using conda
- TensorFlow library (version, if pip package or github SHA, if built from source):
Listed above

### 2. Code

Provide code to help us reproduce your issues using one of the following options:
```python
    dnn_model = keras.Sequential([
        normalizer,
        layers.Dense(512, activation='relu', input_dim=x_train.shape[1]),
        layers.Dense(512, activation='relu'),
        layers.Dense(1, activation='sigmoid')
    ])
```
https://www.tensorflow.org/lite/performance/post_training_quantization
My model code is simple as above
And I used **Post Training Quantization using TF.Lite.Converter** (32-float to 8-int)
Integer only post training quantization (https://www.tensorflow.org/lite/performance/post_training_quantization#integer_only)

(Input dim: 8)


### 3. Failure after conversion
#### Reset input shape
After the conversion, the model has been distorted and i solved the problem with resetting input format
```python
interpreter.resize_tensor_input(input_details['index'], (1,8))
```
And it works well but it returns same output all the time from different inputs
Like this,
```
[array([[76]], dtype=uint8), array([[76]], dtype=uint8), array([[76]], dtype=uint8), array([[76]], ...
```

I googled the cases same as mine, but some pointed out learning epochs, or Model structure.
Nothing was problematic with learning epochs and I suppose there are some model compatibility for quantization
I tried other tensorflow versions (2.13.0, or nightly: 2.14.0-dev20230706) but still same as before.

#### Quantization w/ floating value
https://www.tensorflow.org/lite/performance/post_training_quantization#integer_with_float_fallback_using_default_float_inputoutput
I tried quantization using float32 input/output, but it's same with float value
```
[array([[0.36328125]], dtype=float32), array([[0.36328125]], dtype=float32), array([[0.36328125]], dtype=float32), array([[0.36328125]], dtype=float32), array([[0.36328125]], dtype=float32), ...
```

#### Quantized Model Weights
I printed out model weights, but not sure why it happens

I'm afriad the most of model weights are going 0 during conversion, and it became useless.
So the identical output is returned due to Model Bias.
(You can see the weights of quantized model below)

Do you have any idea why it happens or any tips ? 

### 5. (optional) Any other info / logs

#### The predicted output of original model (Expected)
```
[0.04892164 0.05425507 0.34756148 0.12509596 0.05663526 0.05041704
 0.01185179 0.33582878 0.0572255  0.07754967 0.20722428 0.208343
 0.48504433 0.10513872 0.05141798 0.03368005 0.09833255 0.2034252
 0.109099   0.48486084 0.23009542 0.08055633 0.06971437 0.14443058
 0.12913615 0.03327829 0.06535947 0.4671367  0.20984942 0.35980904
...
 0.23956934 0.23102319 0.10548833 0.06846321 0.16444126 0.04730341
 0.47125074 0.1931791  0.16075167 0.06618178 0.06408405 0.50926745
 0.12504464 0.73206306 0.22954968 0.00386357 0.19742006 0.09496576
 0.04637471 0.06708863 0.37460512 0.17932612 0.10157627 0.04863232
 0.04412654 0.50302374 0.06885636 0.21528003 0.09171575 0.0635072
 0.08805934 0.3634451  0.57593703 0.09678486]
```

#### Quantized model weights

<details> 
<summary> Click to watch </summary>

```
Quantized weights
[[  0 161   1 199 181 127   0   0]]
[[-128  127 -126 -126 -126 -127 -127 -127]]
[[ 127 -128 -128 -128 -128 -128 -128 -128]]
[[  80   23  -77 ...    0    7  115]
 [  74   55  -27 ...   70   56  103]
 [ 112  -89   43 ...  -18 -112  -91]
 ...
 [  45  104   -4 ...  -57   91   47]
 [  43   97  -94 ...   19  113  -43]
 [ 110   50  110 ...   34   18    3]]
[  57  -20  195  271  152  140  164  230  186  199 -129   -9  -25  204
  192  -11  183  -83  210  137  166   13  -21   36  248  243 -118  128
 -114  224  221   85  221  134 -142  -60  108  194  118  222  183   39
  201  104 -130   51    7  -39   16  246  224  103 -103  -43  -36  198
  156  -87  224  175   76 -105  -54   97  -69   62  -26 -169  238   63
   99  235   32 -130  -98  152  247  -56  145  191 -122  161   88 -119
   -2  -17  104  158  147  123  221  189  236  170  266  191  210  162
  -43  193  -94  208  -94   71 -130   97  -95  -29  181  244  183 -120
   72  -40 -106 -151   41  125  210  -92   84  -14  187    1  141  -94
   43  141  195  201   -7  227  178    8   67  243   97  229  200   38
  195  197  203   26  186   94  170 -138  210  209   49 -150 -146  202
  187  199  -91  196   95  216  222  203  213  237  167  -39  187  180
  183  -80  -28  170  -62  243   69   48  -57  178  241  213  247   42
  207  131 -111 -117  149 -114 -131  152  143  -36 -124  -81 -141  126
  259  127   89   -4  124  -63  229  192  191   -4  -79  -46   35  -99
  195   77  -62  185  194   30  -75  192  130   35  179 -155  -96   -7
  178   29  177 -105  197   39  237  176  171  201   24  199  -70 -149
  236  220  211 -165  165  248 -100  -71 -152 -123   77  183  159  -72
  186   37 -127  159  183  211  171 -120   38   -7  183  208  -28 -101
  174  176  234  204  182  165  238  145  232  159  256   50  -59   77
  -31  109   -3 -117   41   48  140  131  203  235  117  106   80  197
   32  166  141  183  203  -62   59  183  -36  -54  188   28  221 -108
 -136  -79  190  161  199  111   62  153  -12  139  205  247  233  154
  209  222 -130   27  209 -103  -83  240  130  210  184  138 -104   72
  173   28   14  206  -80  119  177  124  158  200  242  230   83  156
  242    7  190  210  -94  114  210  224  225  -42  232  -34  -67  -39
  230  165  199  224 -134  163  156   -7  136  134  176    2  209   73
   40  192 -109  216  227  201   -6  157  250   81  142   19  218  187
  -52   13  236   29  -24  243   90  135  143  174  189  218  146  239
  173  230  211  211  139  248  178  217  210  206  -86  136  -65  198
  201  218  238  192  223 -125 -178  203   16 -146 -162 -116  198  220
  232  179  105  -51  137 -111  -35 -154  266  -38  -88 -123  189  -95
  -98  237  159  -63  186   72   71  -25  182  168  239  216  171  168
  253  -33  223 -148  109  186  198 -157  229  198  210  100  155 -130
  112  210  111 -114   59  190  224   50  177 -119  144  -95 -110  182
  225  183   56  223  119  171  155  200  220  156  -73  178   44  200
  194   -6  -65  220   18   81  -20  -43]
[[  23   24  -26 ...   36  -24   37]
 [  48   40  -87 ...   44  -32  -21]
 [  -2   16  -38 ... -101  -28  104]
 ...
 [  64   89    2 ...  -37   95  -48]
 [  47  -14  107 ...  -85  -23 -106]
 [  12   31  -60 ...   63  -71  -85]]
[ 2110  2151 -1352  1999  1340  -833 -1006  -657 -1454  -641  2383  2034
  2358  -577 -1184  2455  2270  2831  -626 -1301  2957  2355  -665 -1340
  2138  -948  1411  -747  -690 -1268  2206  -575  2340  2376    70  2465
  -530  -668 -1109   951  2015  2042  -825  -976  2430  -682 -1268  -174
 -1176  1994  -440  -954  -727 -1087 -1017 -1290  -968  2100  1938  -783
  1915  -175  2582  -340  1964 -1330  2090  1963  -688 -1356   -22  1897
  2157  2447  1994  2207  -593 -1213 -1291  2120  2198 -1067  -918  2017
  1983  2399  2494  2201  1857 -1121  2406  2163   -48  -895 -1257 -1288
  2175  2481  2058  2170  3646  -714 -1171  1959  2715  2042  2605  -928
  -473  2099  2286  2298  1995  1968  2472  -356  -901   971  2610  -796
  2199  2135  1871  2212  1927  -972  2225  -975  -820  -932 -1070  2459
  -755  -721  1895  2021  -967  1987  -689 -1477  2076 -1138  2072 -1029
  -413  1856  -649  2216  2087  2194  1955  1996  2144  1895  3004  -780
  1739 -1404  -586 -1151  1895  -940 -1537  3030  -282   832  2043  1985
  2074  1936  2167 -1049  2218  -531 -1049  -843 -1189  -541  2679  -911
  2163  1518  -842 -1254  -966  1975 -1307  -983 -1360  -761  2085 -1137
  2005 -1255  2499  2207  -797 -1105  2200  1923  1895  -885  -633  1901
  1926 -1021  2195  1965 -1151  -952  -502 -1146  2204 -1306  2188  1859
 -1117  1888 -1144  1930  2082  -522 -1029   326  2102 -1007  2078  2298
  2038  1992 -1017  1646 -1298  1881 -1000  1916  2775  -558  2738 -1283
  -715 -1176 -1282  2161  2398  1922  -746 -1193  2281 -1019  2200  2021
  2053  1871 -1253  -621 -1009 -1205  2219  -925 -1342     0  2216  -885
 -1417 -1225 -1295  2147  -984  2133  1986  2767 -1077  1961  2159 -1142
 -1275   259  2182 -1005  -987 -1213  2103  2014  2043 -1087 -1509 -1196
 -1394  -303 -1050  -995  2462  2664  2005 -1157  -931  2737 -1013 -1521
  -751  -934  2335  2780 -1111  2000  1935  2166  2061  2373  2191  -682
 -1478  1882  -505  2093  1916 -1253  -304  2630  1891 -1145 -1167  1923
  1887  1956  2147  2966  -332  -270   336 -1002 -1138  -676  2056  -930
  -520  2277  1894  -970 -1346  -768  1858  2171  2364  2105  -795  2191
  -999  2027 -1141  -381 -1358  -732  1929  -469 -1206 -1283  1889  2446
 -1072 -1082  2227  2127 -1278  2183 -1148  1875  2052  2225 -1003  -741
 -1108 -1066 -1231  2373  1970  2116  2023  -234  1028  2289  1832 -1344
  -649 -1129  1993   505   625  -932 -1135 -1160  -355 -1130  2307 -1242
 -1087  2216  1848  -836  -150  2590  1926  2043  -896  -810  1922 -1031
  -869  2524  -476  -228    76 -1179  -469  2511  2012 -1650  1855  2989
  2400  2430  -155 -1171  -961 -1158  1823 -1036 -1244  2838  2554  2139
  1925  -972  -403   364 -1263  2226  2255  2024  2200  2205 -1223  1982
  1809  -921  2116  2142  -843  2195  -212 -1501  2415  -676  -607  2274
  2172  2157 -1212 -1000  2007  2753 -1065 -1048 -1231  1937  2695 -1240
  -953 -1246  -608  1932  1148 -1232  2039  2225 -1069  2009  2291  2003
  2003 -1369  2226 -1174  2264  -890  2128  1888  3043  -734  -719 -1385
 -1140  2348  2233  2103  2280  2138  2450  2377 -1008  2026  1958  1892
 -1075 -1108  1946 -1078  2522  1899  1416  1882]
[[ -67  -52   50  -61  -66   54  107   16   83   32  -22  -59  -30  113
    95  -30 -123  -93    1   55   -5  -24   28   58  -77   60  -67   22
    59   21  -99   15  -18  -33   60  -62  111   22   10  -51  -74  -54
    36    1  -27   16  103  108   59  -37   53   80    9  100   62   78
   112  -94 -100   93  -96   23  -87   19  -86   88  -91 -102   97   20
    32  -59  -88  -98  -11 -106   90   18    5  -41  -67   16    9  -54
   -38  -70 -119 -102  -89  110  -16  -75   88    5    5    8  -36  -55
  -108  -49  -12   31   45 -115  -70 -120  -71   39   43 -124  -44  -27
   -21  -62 -127   77  105  -52  -30   46  -79  -46  -83  -64  -28   91
   -80  116   99   52   99   -9   38  116  -87  -63   64  -93   71   82
  -108   70  -48  111   31 -109   40  -62  -45  -92 -115  -73 -112 -118
    -7   48  -11   27   85   86  -59   11   40  -31   25  -88  -83 -116
   -99  -39  -37   36  -12  112   65   79   60    1  -51   73  -34  -55
    28   53   98 -122   16   85   59  111  -60   40 -125   19  -78  -35
    55   12  -26  -87  -96   85   16 -100  -45   94 -109   -9   18    5
    61   64  -93   17   -5 -124  110  -41   77  -67  -74   69  105  -68
   -28   32  -20  -18  -81  -57   38  -84   14  -53   48 -105  -52   54
   -92   78   40   89   24  -49 -106  -90   33   34 -111   74   -9  -72
   -93  -87   55   49   10   23  -93   31    4  -60  -41   57   18   34
    93  -96    3  -79  -47  -21  114  -36  -13   97   66   72   -7   89
   103   61  -36 -120  -57  111    7   83   38   10   37   17  -96  -12
   -57   48    7  -75    8   31   16   34 -122  -12   62 -118  -71  -85
   -47 -121 -108   34   78  -86   79  -56  -90   60   73  -10  -31   30
    92  -99  -80 -119  -34  -55   63   81   69   19   78   70  -47  113
    16  -97  -61   16   26   66 -103 -110  -31  -43  108  -78   81 -123
    62   61   66   71 -113   34   29   57 -117  -22   93   21  -59 -118
   102  -81   35  -61  -98  -58   74   44   16   38   70  -36  -66  -49
   -34   18   -2  -48 -103   23   23   32  -35  -94  -68   64   24  114
    58   83  -30   22    6  -72 -116   58   44  -32  -31  -89   69   62
   -70   47   48 -106   66   73  117   16  108 -101 -114   97  -75  -15
   -27  -95   39   58   23   44  -74   77   79  -12   -8  -30  -65   76
    49  -98   68  -36  -31  -26 -120  -30   17 -100  -56   89  -43  -49
    59  -99   83   36  -37   10  100  -18 -119  -64  111   42  -96   -6
    30   87   20  -86  -48    5   92   13   96  -31  -36  112 -112 -112
    71  -81 -109 -101  -36   72  -37   54  -89   69  -55  -67  -14    7
    89  113   52  -24  -25  -51  -57  -13  -24  -73   91 -104  -49  -51
   112  110  -60   25  -46  -77  -72   -9]]
[-960]
[[   0 -110   -2   74  -75  127    0    0]]
[[  80 -116    4   33  -75  127    0    0]]
[[-64  -8  50   9   0   0   0   0]]
[[   0 -110   -2   74  -75  127    0    0   96   33   50    9    0    0
     0    0  105   98   47  112  121  116  104  111  110   51   46   56
    47  115  105  116  -80   -2   96    9    0    0    0    0  112   40
    55    9    0    0    0    0    0    0    0    0    0    0    0    0
    98   55   -4   74  -75  127    0    0   80 -116    4   33  -75  127
     0    0    0 -110  124   40   -2  127    0    0    0    0    0    0
     0    0    0    0  -30   27   -5   74  -75  127    0    0  -64   -8
    50    9    0    0    0    0  -64   -8   50    9    0    0    0    0
     0    0    0    0    0    0    0    0  -14   81   -4   74  -75  127
     0    0  -64  -87   58   45  -75  127    0    0    0    0    0    0
     0    0    0    0    0    0    0    0    0    0    0    0  -14   27
    -5   74  -75  127    0    0    0  -34  106   42  -75  127    0    0
     0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0  106   55   -4   74  -75  127    0    0  -80   35   19   41
   -75  127    0    0  120  126   -2   74  -75  127    0    0    0    0
     0    0    0    0    0    0  -22   27   -5   74  -75  127    0    0
   -32   73 -109    8    0    0    0    0    2    0    0    0    0    0
     0    0  116  102   46   69  110  113  117  101  117  101   84   80
    85   69  109   98  101  100  100  105  110  103   73  110  116  101
   103  101  114   66   97  116   99  104    0  103  101  115   47  107
  -127    3    0    0    0    0    0    0   48  -86   50    9    0    0
     0    0  -48   54   29    9    0    0    0    0    0    0    0    0
     0    0    0    0   97    3    0    0    0    0    0    0  -48   48
    50    9    0    0    0    0  -32 -100    1  -57  -75  127    0    0
     0    0    0    0    0    0    0    0   65    3    0    0    0    0
     0    0 -128   88   62    9    0    0    0    0    0   87   27    9
     0    0    0    0   16 -120 -109    8    0    0    0    0   88    1
     1   75  -75  127    0    0   80   50  -73    7    0    0    0    0
     2    0    0    0    3    0    0    0  120  126   -2   74  -75  127
     0    0  -32   49  -73    7    0    0    0    0    0 -110   -2   74
   -75  127    0    0    0   50  -73    7    0    0    0    0  109  101
    47   99   99   47   97  110   97   99  111  110  100   97   51   47
   -80   -2   96    9    0    0    0    0  112   40   55    9    0    0
     0    0    0    0    0    0    0    0    0    0   82   55   -4   74
   -75  127    0    0   80 -116    4   33  -75  127    0    0    0 -110
   124   40   -2  127    0    0    0    0    0    0    0    0    0    0
   -30   27   -5   74  -75  127    0    0]]
[[ -64   -8   50    9    0    0    0    0  -64   -8   50    9    0    0
     0    0    0    0    0    0    0    0    0    0  -22   81   -4   74
   -75  127    0    0  -64  -87   58   45  -75  127    0    0    0    0
     0    0    0    0    0    0    0    0    0    0    0    0    0    0
   -14   27   -5   74  -75  127    0    0    0  -34  106   42  -75  127
     0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   90   55   -4   74  -75  127    0    0   16   36
    19   41  -75  127    0    0  120  126   -2   74  -75  127    0    0
     0    0    0    0    0    0    0    0  -22   27   -5   74  -75  127
     0    0   40   74 -109    8    0    0    0    0    9    0    0    0
     0    0    0    0  116  102   46   69  110  113  117  101  117  101
    84   80   85   69  109   98  101  100  100  105  110  103   82   97
   103  103  101  100   84  101  110  115  111  114   66   97  116   99
   104    0  -31    1    0    0    0    0    0    0  -64   36   33    9
     0    0    0    0  -64   17   48    9    0    0    0    0    0    0
     0    0    0    0    0    0 -127    1    0    0    0    0    0    0
  -128   25   50    9    0    0    0    0  -32 -100    1  -57  -75  127
     0    0    0    0    0    0    0    0    0    0   97    1    0    0
     0    0    0    0   96    6   31    9    0    0    0    0  -80  -49
    86    9    0    0    0    0   16 -120 -109    8    0    0    0    0
    80    1    1   75  -75  127    0    0  -16   51  -73    7    0    0
     0    0    2    0    0    0    3    0    0    0  120  126   -2   74
   -75  127    0    0 -128   51  -73    7    0    0    0    0    0 -110
    -2   74  -75  127    0    0  -96   51  -73    7    0    0    0    0
    98   47  112  121  116  104  111  110   51   46   56   47  115  105
   116  101  -80   -2   96    9    0    0    0    0  112   40   55    9
     0    0    0    0    0    0    0    0    0    0    0    0   66   55
    -4   74  -75  127    0    0   80 -116    4   33  -75  127    0    0
     0 -110  124   40   -2  127    0    0    0    0    0    0    0    0
     0    0  -30   27   -5   74  -75  127    0    0  -64   -8   50    9
     0    0    0    0  -64   -8   50    9    0    0    0    0    0    0
     0    0    0    0    0    0  -30   81   -4   74  -75  127    0    0
   -64  -87   58   45  -75  127    0    0    0    0    0    0    0    0
     0    0    0    0    0    0    0    0    0    0  -14   27   -5   74
   -75  127    0    0    0  -34  106   42  -75  127    0    0    0    0
     0    0    0    0    0    0    0    0    0    0    0    0    0    0
    74   55   -4   74  -75  127    0    0]]
[[0]]
[[80]]
```

</details>


#### Debugger
- I used debugger
  - https://www.tensorflow.org/lite/performance/quantization_debugger

![image](https://github.com/tensorflow/tensorflow/assets/15901475/a67571a4-e017-4bcd-a6a0-80fdfbc8a62f)
",False
import tensorflow error stat:awaiting response type:build/install stale subtype:windows TF 2.12,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

2.12.0

### Custom code

Yes

### OS platform and distribution

windows 10

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

not able to import tensorflow

### Standalone code to reproduce the issue

```shell
import tensorflow
```


### Relevant log output

```shell
TypeError                                 Traceback (most recent call last)
Cell In [69], line 1
----> 1 import tensorflow

File ~\AppData\Roaming\Python\Python39\site-packages\tensorflow\__init__.py:37
     34 import sys as _sys
     35 import typing as _typing
---> 37 from tensorflow.python.tools import module_util as _module_util
     38 from tensorflow.python.util.lazy_loader import LazyLoader as _LazyLoader
     40 # Make sure code inside the TensorFlow codebase can use tf2.enabled() at import.

File ~\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\__init__.py:42
     37 from tensorflow.python.eager import context
     39 # pylint: enable=wildcard-import
     40 
     41 # Bring in subpackages.
---> 42 from tensorflow.python import data
     43 from tensorflow.python import distribute
     44 # from tensorflow.python import keras

File ~\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\data\__init__.py:21
     15 """"""`tf.data.Dataset` API for input pipelines.
     16 
     17 See [Importing Data](https://tensorflow.org/guide/data) for an overview.
     18 """"""
     20 # pylint: disable=unused-import
---> 21 from tensorflow.python.data import experimental
     22 from tensorflow.python.data.ops.dataset_ops import AUTOTUNE
     23 from tensorflow.python.data.ops.dataset_ops import Dataset

File ~\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\data\experimental\__init__.py:97
     15 """"""Experimental API for building input pipelines.
     16 
     17 This module contains experimental `Dataset` sources and transformations that can
   (...)
     93 @@UNKNOWN_CARDINALITY
     94 """"""
     96 # pylint: disable=unused-import
---> 97 from tensorflow.python.data.experimental import service
     98 from tensorflow.python.data.experimental.ops.batching import dense_to_ragged_batch
     99 from tensorflow.python.data.experimental.ops.batching import dense_to_sparse_batch

File ~\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\data\experimental\service\__init__.py:419
      1 # Copyright 2020 The TensorFlow Authors. All Rights Reserved.
      2 #
      3 # Licensed under the Apache License, Version 2.0 (the ""License"");
   (...)
     13 # limitations under the License.
     14 # ==============================================================================
     15 """"""API for using the tf.data service.
     16 
     17 This module contains:
   (...)
    416   job of ParameterServerStrategy).
    417 """"""
--> 419 from tensorflow.python.data.experimental.ops.data_service_ops import distribute
    420 from tensorflow.python.data.experimental.ops.data_service_ops import from_dataset_id
    421 from tensorflow.python.data.experimental.ops.data_service_ops import register_dataset

File ~\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\data\experimental\ops\data_service_ops.py:22
     20 from tensorflow.core.protobuf import data_service_pb2
     21 from tensorflow.python import tf2
---> 22 from tensorflow.python.data.experimental.ops import compression_ops
     23 from tensorflow.python.data.experimental.service import _pywrap_server_lib
     24 from tensorflow.python.data.experimental.service import _pywrap_utils

File ~\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\data\experimental\ops\compression_ops.py:16
      1 # Copyright 2020 The TensorFlow Authors. All Rights Reserved.
      2 #
      3 # Licensed under the Apache License, Version 2.0 (the ""License"");
   (...)
     13 # limitations under the License.
     14 # ==============================================================================
     15 """"""Ops for compressing and uncompressing dataset elements.""""""
---> 16 from tensorflow.python.data.util import structure
     17 from tensorflow.python.ops import gen_experimental_dataset_ops as ged_ops
     20 def compress(element):

File ~\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\data\util\structure.py:22
     18 import itertools
     20 import wrapt
---> 22 from tensorflow.python.data.util import nest
     23 from tensorflow.python.framework import composite_tensor
     24 from tensorflow.python.framework import ops

File ~\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\data\util\nest.py:34
      1 # Copyright 2017 The TensorFlow Authors. All Rights Reserved.
      2 #
      3 # Licensed under the Apache License, Version 2.0 (the ""License"");
   (...)
     13 # limitations under the License.
     14 # ==============================================================================
     16 """"""## Functions for working with arbitrarily nested sequences of elements.
     17 
     18 NOTE(mrry): This fork of the `tensorflow.python.util.nest` module
   (...)
     31    arrays.
     32 """"""
---> 34 from tensorflow.python.framework import sparse_tensor as _sparse_tensor
     35 from tensorflow.python.util import _pywrap_utils
     36 from tensorflow.python.util import nest

File ~\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\framework\sparse_tensor.py:25
     23 from tensorflow.python import tf2
     24 from tensorflow.python.framework import composite_tensor
---> 25 from tensorflow.python.framework import constant_op
     26 from tensorflow.python.framework import dtypes
     27 from tensorflow.python.framework import ops

File ~\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\framework\constant_op.py:25
     23 from tensorflow.core.framework import types_pb2
     24 from tensorflow.python.eager import context
---> 25 from tensorflow.python.eager import execute
     26 from tensorflow.python.framework import dtypes
     27 from tensorflow.python.framework import op_callbacks

File ~\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\eager\execute.py:21
     19 from tensorflow.python import pywrap_tfe
     20 from tensorflow.python.eager import core
---> 21 from tensorflow.python.framework import dtypes
     22 from tensorflow.python.framework import ops
     23 from tensorflow.python.framework import tensor_shape

File ~\AppData\Roaming\Python\Python39\site-packages\tensorflow\python\framework\dtypes.py:37
     34 from tensorflow.core.function import trace_type
     35 from tensorflow.tools.docs import doc_controls
---> 37 _np_bfloat16 = _pywrap_bfloat16.TF_bfloat16_type()
     38 _np_float8_e4m3fn = _pywrap_float8.TF_float8_e4m3fn_type()
     39 _np_float8_e5m2 = _pywrap_float8.TF_float8_e5m2_type()

TypeError: Unable to convert function return value to a Python type! The signature was
	() -> handle
```
",False
ImportError: undefined symbol after install stat:awaiting response type:build/install stale subtype: ubuntu/linux,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

1.7.0

### Custom code

No

### OS platform and distribution

Linux-4.14.0-xilinx-v2018.3-armv7l-with-pynqlinux-v2.6-WFH

### Mobile device

no

### Python version

3.6.5

### Bazel version

0.10.0- (@non-git)

### GCC/compiler version

GCC 7.3.0

### CUDA/cuDNN version

no

### GPU model and memory

_No response_

### Current behavior?

I'm facing with the ImportError - Undefined symbol when trying to import tensorflow after successfully compiling from source and installed Tensorflow 1.7.0 on a 32 bit architecture. 

### Standalone code to reproduce the issue

```shell
> Build configurations for Tensorflow:

build --action_env PYTHON_BIN_PATH=""/usr/bin/python3""
build --action_env PYTHON_LIB_PATH=""/usr/local/lib/python3.6/dist-packages""
build --force_python=py3
build --host_force_python=py3
build --python_path=""/usr/bin/python3""
build:gcp --define with_gcp_support=true
build:hdfs --define with_hdfs_support=true
build:s3 --define with_s3_support=true
build:kafka --define with_kafka_support=true
build:xla --define with_xla_support=true
build:gdr --define with_gdr_support=true
build:verbs --define with_verbs_support=true
build --action_env TF_NEED_OPENCL_SYCL=""0""
build --action_env TF_NEED_CUDA=""0""
build --define grpc_no_ares=true
build:opt --copt=-march=native
build:opt --host_copt=-march=native
build:opt --define with_default_optimizations=true
build --copt=-DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK
build --host_copt=-DGEMMLOWP_ALLOW_SLOW_SCALAR_FALLBACK


> After bazel build:

sudo python3 -m pip install /tmp/tensorflow_pkg/tensorflow-1.7.0-cp36-cp36m-linux_armv7l.whl

> Importing in python3 

import tensorflow as tf
```


### Relevant log output

```shell
xilinx@pynq:/tmp/tensorflow_pkg$ python3 -c ""import tensorflow as tf; print(tf.GIT_VERSION, tf.VERSION)""
Traceback (most recent call last):
  File ""/usr/local/lib/python3.6/dist-packages/tensorflow/python/pywrap_tensorflow.py"", line 58, in <module>
    from tensorflow.python.pywrap_tensorflow_internal import *
  File ""/usr/local/lib/python3.6/dist-packages/tensorflow/python/pywrap_tensorflow_internal.py"", line 28, in <module>
    _pywrap_tensorflow_internal = swig_import_helper()
  File ""/usr/local/lib/python3.6/dist-packages/tensorflow/python/pywrap_tensorflow_internal.py"", line 24, in swig_import_helper
    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)
  File ""/usr/lib/python3.6/imp.py"", line 243, in load_module
    return load_dynamic(name, filename, file)
  File ""/usr/lib/python3.6/imp.py"", line 343, in load_dynamic
    return _load(spec)
ImportError: /usr/local/lib/python3.6/dist-packages/tensorflow/python/_pywrap_tensorflow_internal.so: undefined symbol: _ZN10tensorflow9ConcatCPUINS_8bfloat16EEEvPNS_10DeviceBaseERKSt6vectorISt10unique_ptrINS_6TTypesIT_Li2EiE11ConstMatrixESt14default_deleteIS9_EESaISC_EEPNS8_6MatrixE

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""<string>"", line 1, in <module>
  File ""/usr/local/lib/python3.6/dist-packages/tensorflow/__init__.py"", line 24, in <module>
    from tensorflow.python import *  # pylint: disable=redefined-builtin
  File ""/usr/local/lib/python3.6/dist-packages/tensorflow/python/__init__.py"", line 49, in <module>
    from tensorflow.python import pywrap_tensorflow
  File ""/usr/local/lib/python3.6/dist-packages/tensorflow/python/pywrap_tensorflow.py"", line 74, in <module>
    raise ImportError(msg)
ImportError: Traceback (most recent call last):
  File ""/usr/local/lib/python3.6/dist-packages/tensorflow/python/pywrap_tensorflow.py"", line 58, in <module>
    from tensorflow.python.pywrap_tensorflow_internal import *
  File ""/usr/local/lib/python3.6/dist-packages/tensorflow/python/pywrap_tensorflow_internal.py"", line 28, in <module>
    _pywrap_tensorflow_internal = swig_import_helper()
  File ""/usr/local/lib/python3.6/dist-packages/tensorflow/python/pywrap_tensorflow_internal.py"", line 24, in swig_import_helper
    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)
  File ""/usr/lib/python3.6/imp.py"", line 243, in load_module
    return load_dynamic(name, filename, file)
  File ""/usr/lib/python3.6/imp.py"", line 343, in load_dynamic
    return _load(spec)
ImportError: /usr/local/lib/python3.6/dist-packages/tensorflow/python/_pywrap_tensorflow_internal.so: undefined symbol: _ZN10tensorflow9ConcatCPUINS_8bfloat16EEEvPNS_10DeviceBaseERKSt6vectorISt10unique_ptrINS_6TTypesIT_Li2EiE11ConstMatrixESt14default_deleteIS9_EESaISC_EEPNS8_6MatrixE


Failed to load the native TensorFlow runtime.

See https://www.tensorflow.org/install/install_sources#common_installation_problems

for some common reasons and solutions.  Include the entire stack trace
above this error message when asking for help.
```
",False
xla_cpu_gpu_device: MSVC compile errors stat:awaiting response type:build/install stale subtype:windows TF 2.13,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.13.0

### Custom code

Yes

### OS platform and distribution

Windows 10 22H2

### Mobile device

_No response_

### Python version

Anaconda 2023.07-1

### Bazel version

6.2.1

### GCC/compiler version

Visual Studio 2022 (build tools 14.36) + msys2-x86_64-20230718

### CUDA/cuDNN version

CUDA 11.8 + CUDNN 8.6.0 + TensorRT 8.5.3

### GPU model and memory

GTX 750 Ti 2GB

### Current behavior?

This issue required two fixes.

First, `external/local_config_cuda/crosstool/windows/msvc_wrapper_for_nvcc.py` adds too many unrelated include path to compilation command. Related scripts or header dependencies need to be fixed. Minimum command is just like:
`nvcc -v -c -x=c++ -std=c++17 tensorflow/compiler/jit/xla_cpu_device.cc -I .,bazel-out/x64_windows-opt/bin,external/eigen_archive,
external/com_google_absl,external/com_google_protobuf/src,external/farmhash_archive/src,external/llvm-project/llvm/include,
external/llvm-raw/llvm/include,external/llvm-project/mlir/include,bazel-out/x64_windows-opt/bin/external/llvm-project/mlir/include,
external/tf_runtime/include -o bazel-out/x64_windows-opt/bin/tensorflow/compiler/jit/_objs/xla_cpu_device/xla_cpu_device.obj`

Second, `nvcc` will pass the above command to `cl.exe`. Then MSVC will throw some syntax errors and stop. If I use `clang-cl` provided by Visual Studio, some warnings may appear but the `.obj` compilation is successful. Following linux build migration to clang, I think the compiler path of `msvc_wrapper_for_nvcc.py` can change to `clang-cl` to avoid syntax errors.

### Standalone code to reproduce the issue

```shell
1. download https://github.com/tensorflow/tensorflow/archive/refs/tags/v2.13.0.zip and extract
2. comment out Windows CUDA build rejection code in configure.py
3. run `python configure.py` to configure Windows CUDA build
4. run `bazel build --config=opt --define=no_tensorflow_py_deps=true //tensorflow/tools/pip_package:build_pip_package`
```


### Relevant log output

```shell
ERROR: E:/tensorflow-2.13.0-createprocessw/tensorflow/compiler/jit/BUILD:113:11: Compiling tensorflow/compiler/jit/xla_cpu_device.cc failed: (Exit -1): python.exe failed: error exe
cuting command (from target //tensorflow/compiler/jit:xla_cpu_device)
  cd /d E:/_bazel_tensorflow/4zvk5ci6/execroot/org_tensorflow
  SET CUDA_TOOLKIT_PATH=C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v11.8
    SET INCLUDE=C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.36.32532\include;C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.3
6.32532\ATLMFC\include;C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Auxiliary\VS\include;C:\Program Files (x86)\Windows Kits\10\include\10.0.22621.0\ucrt;C:\Program F
iles (x86)\Windows Kits\10\\include\10.0.22621.0\\um;C:\Program Files (x86)\Windows Kits\10\\include\10.0.22621.0\\shared;C:\Program Files (x86)\Windows Kits\10\\include\10.0.22621
.0\\winrt;C:\Program Files (x86)\Windows Kits\10\\include\10.0.22621.0\\cppwinrt
    SET LIB=C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.36.32532\ATLMFC\lib\x64;C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\1
4.36.32532\lib\x64;C:\Program Files (x86)\Windows Kits\10\lib\10.0.22621.0\ucrt\x64;C:\Program Files (x86)\Windows Kits\10\\lib\10.0.22621.0\\um\x64
    SET PATH=C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.36.32532\bin\HostX64\x64;C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\V
C\VCPackages;C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\CommonExtensions\Microsoft\TestWindow;C:\Program Files\Microsoft Visual Studio\2022\Community\Commo
n7\IDE\CommonExtensions\Microsoft\TeamFoundation\Team Explorer;C:\Program Files\Microsoft Visual Studio\2022\Community\MSBuild\Current\bin\Roslyn;C:\Program Files\Microsoft Visual
Studio\2022\Community\Team Tools\Performance Tools\x64;C:\Program Files\Microsoft Visual Studio\2022\Community\Team Tools\Performance Tools;C:\Program Files (x86)\Windows Kits\10\b
in\10.0.22621.0\\x64;C:\Program Files (x86)\Windows Kits\10\bin\\x64;C:\Program Files\Microsoft Visual Studio\2022\Community\\MSBuild\Current\Bin\amd64;C:\Windows\Microsoft.NET\Fra
mework64\v4.0.30319;C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\;C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\Tools\;;C:\Windows\system32
;C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\CommonExtensions\Microsoft\CMake\CMake\bin;C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\
CommonExtensions\Microsoft\CMake\Ninja;C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\IDE\VC\Linux\bin\ConnectionManagerExe
    SET PWD=/proc/self/cwd
    SET PYTHON_BIN_PATH=C:/Users/tensorflow/anaconda3/python.exe
    SET PYTHON_LIB_PATH=C:/Users/tensorflow/anaconda3/lib/site-packages
    SET RUNFILES_MANIFEST_ONLY=1
    SET TEMP=C:\msys64\tmp
    SET TF2_BEHAVIOR=1
    SET TF_CUDA_COMPUTE_CAPABILITIES=3.5,5.0,7.0
    SET TMP=C:\msys64\tmp
  C:\Users\tensorflow\anaconda3\python.exe -B external/local_config_cuda/crosstool/windows/msvc_wrapper_for_nvcc.py /nologo /DCOMPILER_MSVC /DNOMINMAX /D_WIN32_WINNT=0x0600 /D_CRT_
SECURE_NO_DEPRECATE /D_CRT_SECURE_NO_WARNINGS /D_SILENCE_STDEXT_HASH_DEPRECATION_WARNINGS /bigobj /Zm500 /J /Gy /GF /EHsc /wd4351 /wd4291 /wd4250 /wd4996 /I. /Ibazel-out/x64_window
s-opt/bin /Iexternal/eigen_archive /Ibazel-out/x64_windows-opt/bin/external/eigen_archive /Iexternal/com_google_absl /Ibazel-out/x64_windows-opt/bin/external/com_google_absl /Iexte
rnal/nsync /Ibazel-out/x64_windows-opt/bin/external/nsync /Iexternal/double_conversion /Ibazel-out/x64_windows-opt/bin/external/double_conversion /Iexternal/com_google_protobuf /Ib
azel-out/x64_windows-opt/bin/external/com_google_protobuf /Iexternal/llvm-project /Ibazel-out/x64_windows-opt/bin/external/llvm-project /Iexternal/llvm_terminfo /Ibazel-out/x64_win
dows-opt/bin/external/llvm_terminfo /Iexternal/llvm_zlib /Ibazel-out/x64_windows-opt/bin/external/llvm_zlib /Iexternal/gif /Ibazel-out/x64_windows-opt/bin/external/gif /Iexternal/l
ibjpeg_turbo /Ibazel-out/x64_windows-opt/bin/external/libjpeg_turbo /Iexternal/com_googlesource_code_re2 /Ibazel-out/x64_windows-opt/bin/external/com_googlesource_code_re2 /Iextern
al/farmhash_archive /Ibazel-out/x64_windows-opt/bin/external/farmhash_archive /Iexternal/fft2d /Ibazel-out/x64_windows-opt/bin/external/fft2d /Iexternal/highwayhash /Ibazel-out/x64
_windows-opt/bin/external/highwayhash /Iexternal/zlib /Ibazel-out/x64_windows-opt/bin/external/zlib /Iexternal/snappy /Ibazel-out/x64_windows-opt/bin/external/snappy /Iexternal/loc
al_config_cuda /Ibazel-out/x64_windows-opt/bin/external/local_config_cuda /Iexternal/local_config_rocm /Ibazel-out/x64_windows-opt/bin/external/local_config_rocm /Iexternal/local_c
onfig_tensorrt /Ibazel-out/x64_windows-opt/bin/external/local_config_tensorrt /Iexternal/cudnn_frontend_archive /Ibazel-out/x64_windows-opt/bin/external/cudnn_frontend_archive /Iex
ternal/curl /Ibazel-out/x64_windows-opt/bin/external/curl /Iexternal/boringssl /Ibazel-out/x64_windows-opt/bin/external/boringssl /Iexternal/jsoncpp_git /Ibazel-out/x64_windows-opt
/bin/external/jsoncpp_git /Iexternal/com_github_grpc_grpc /Ibazel-out/x64_windows-opt/bin/external/com_github_grpc_grpc /Iexternal/upb /Ibazel-out/x64_windows-opt/bin/external/upb
/Iexternal/mkl_dnn_v1 /Ibazel-out/x64_windows-opt/bin/external/mkl_dnn_v1 /Iexternal/stablehlo /Ibazel-out/x64_windows-opt/bin/external/stablehlo /Iexternal/tf_runtime /Ibazel-out/
x64_windows-opt/bin/external/tf_runtime /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/BuiltinAttributeInterfacesIncGen /Ibazel-out/x64_windows-opt/bi
n/external/llvm-project/mlir/_virtual_includes/BuiltinAttributesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/BuiltinDialectBytecodeGen /Ibaze
l-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/BuiltinDialectIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/BuiltinLoca
tionAttributesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/BuiltinOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtu
al_includes/BuiltinTypeInterfacesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/BuiltinTypesIncGen /Ibazel-out/x64_windows-opt/bin/external/llv
m-project/mlir/_virtual_includes/CallOpInterfacesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/CastOpInterfacesIncGen /Ibazel-out/x64_windows-
opt/bin/external/llvm-project/mlir/_virtual_includes/FunctionInterfacesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/InferTypeOpInterfaceIncGe
n /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/OpAsmInterfaceIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/Reg
ionKindInterfaceIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/SideEffectInterfacesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project
/mlir/_virtual_includes/SymbolInterfacesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/TensorEncodingIncGen /Ibazel-out/x64_windows-opt/bin/ext
ernal/llvm-project/mlir/_virtual_includes/ArithBaseIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ArithCanonicalizationIncGen /Ibazel-out/x64_w
indows-opt/bin/external/llvm-project/mlir/_virtual_includes/ArithOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ArithOpsInterfacesIncGen /Ib
azel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/InferIntRangeInterfaceIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/
VectorInterfacesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ControlFlowInterfacesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-projec
t/mlir/_virtual_includes/ControlFlowOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/FuncIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-
project/mlir/_virtual_includes/AsmParserTokenKinds /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/QuantOpsIncGen /Ibazel-out/x64_windows-opt/bin/exter
nal/llvm-project/mlir/_virtual_includes/LoopLikeInterfaceIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/Mem2RegInterfacesIncGen /Ibazel-out/x64
_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/DialectUtilsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ViewLikeInterfaceIncGe
n /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/PDLOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/PDLTypesInc
Gen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/PDLInterpOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/Con
versionPassIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/TransformsPassIncGen /Ibazel-out/x64_windows-opt/bin/external/local_config_cuda/cuda/
_virtual_includes/cuda_headers_virtual /Ibazel-out/x64_windows-opt/bin/external/local_config_tensorrt/_virtual_includes/tensorrt_headers /Ibazel-out/x64_windows-opt/bin/external/lo
cal_config_cuda/cuda/_virtual_includes/cudnn_header /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/DerivedAttributeOpInterfaceIncGen /Ibazel-out/x64_w
indows-opt/bin/external/llvm-project/mlir/_virtual_includes/MLProgramAttributesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/MLProgramOpsIncGe
n /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/MLProgramTypesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/Run
timeVerifiableOpInterfaceIncGen /Ibazel-out/x64_windows-opt/bin/external/cudnn_frontend_archive/_virtual_includes/cudnn_frontend /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler
/xla/mlir_hlo/_virtual_includes/mlir_hlo /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/canonicalize_inc_gen /Ibazel-out/x64_windows-opt/bin/ten
sorflow/compiler/xla/mlir_hlo/_virtual_includes/convert_op_folder /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/hlo_ops_attrs_inc_gen /Ibazel-o
ut/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/hlo_ops_common /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/hlo_ops_
enums_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/hlo_ops_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_v
irtual_includes/hlo_ops_pattern_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/hlo_ops_typedefs_inc_gen /Ibazel-out/x64_windows-opt/bin/
external/llvm-project/mlir/_virtual_includes/ComplexAttributesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ComplexBaseIncGen /Ibazel-out/x64_
windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ComplexOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/LLVMDialectInterfaceIncGe
n /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/LLVMIntrinsicOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/L
LVMOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/LLVMTypesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includ
es/CopyOpInterfaceIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/MemRefBaseIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_v
irtual_includes/MemRefOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ShapedOpInterfacesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-
project/mlir/_virtual_includes/DestinationStyleOpInterfaceIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ValueBoundsOpInterfaceIncGen /Ibazel-o
ut/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/MLIRShapeCanonicalizationIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/Sha
peOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/AffineMemoryOpInterfacesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_
virtual_includes/AffineOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ParallelCombiningOpInterfaceIncGen /Ibazel-out/x64_windows-opt/bin/ext
ernal/llvm-project/mlir/_virtual_includes/TensorOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/TilingInterfaceIncGen /Ibazel-out/x64_windows
-opt/bin/external/llvm-project/mlir/_virtual_includes/SparseTensorAttrDefsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/SparseTensorOpsIncGen
/Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/SparseTensorTypesIncGen /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/base /Ibaz
el-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/base_attr_interfaces_inc_gen /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/broadcast_utils /I
bazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/chlo_ops /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/chlo_attrs_inc_gen /Ibazel-out/x64_
windows-opt/bin/external/stablehlo/_virtual_includes/chlo_enums_inc_gen /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/chlo_ops_inc_gen /Ibazel-out/x64_window
s-opt/bin/external/stablehlo/_virtual_includes/stablehlo_assembly_format /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/stablehlo_type_inference /Ibazel-out/x
64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/mhlo_passes /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/chlo_legalize_t
o_hlo /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/chlo_legalize_to_hlo_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_h
lo/_virtual_includes/map_chlo_to_hlo_op /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/AllocationOpInterfaceIncGen /Ibazel-out/x64_windows-opt/bin/ext
ernal/llvm-project/mlir/_virtual_includes/BufferizableOpInterfaceIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/BufferizationBaseIncGen /Ibazel
-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/BufferizationEnumsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/Bufferiz
ationOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/SCFDeviceMappingInterfacesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/m
lir/_virtual_includes/SCFIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/SCFPassIncGen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/m
lir_hlo/_virtual_includes/hlo_legalize_to_stablehlo /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/map_stablehlo_to_hlo_op /Ibazel-out/x64_windo
ws-opt/bin/external/stablehlo/_virtual_includes/stablehlo_ops /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/stablehlo_attrs_inc_gen /Ibazel-out/x64_windows-o
pt/bin/external/stablehlo/_virtual_includes/stablehlo_enums_inc_gen /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/stablehlo_ops_inc_gen /Ibazel-out/x64_windo
ws-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/legalize_to_linalg_utils /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/map_mhlo_t
o_scalar_op /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/MathBaseIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes
/MathOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/MaskableOpInterfaceIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_vi
rtual_includes/MaskingOpInterfaceIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/VectorOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-p
roject/mlir/_virtual_includes/LinalgEnumsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/LinalgInterfacesIncGen /Ibazel-out/x64_windows-opt/bin/
external/llvm-project/mlir/_virtual_includes/LinalgOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/LinalgStructuredOpsIncGen /Ibazel-out/x64_
windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/legalize_to_standard_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/l
hlo /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/lhlo_ops_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_in
cludes/lhlo_ops_structs_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/lhlo_structured_interface /Ibazel-out/x64_windows-opt/bin/tensorf
low/compiler/xla/mlir_hlo/_virtual_includes/lhlo_structured_interface_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/lower_complex_inc_g
en /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/map_hlo_to_lhlo_op /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_i
ncludes/mhlo_pass_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/mhlo_rng_utils /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/
mlir_hlo/_virtual_includes/mhlo_scatter_gather_utils /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/shape_component_analysis /Ibazel-out/x64_win
dows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/stablehlo_legalize_to_hlo /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/thlo /I
bazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/gml_st /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/gml_st_op
s_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/thlo_ops_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virt
ual_includes/thlo_bufferizable_op_interface /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/type_conversion /Ibazel-out/x64_windows-opt/bin/exter
nal/llvm-project/mlir/_virtual_includes/BufferizationPassIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/FuncTransformsPassIncGen /Ibazel-out/x6
4_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/unfuse_batch_norm /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/AffinePassIncGen
 /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ArithPassIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/DLTIBaseI
ncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/GPUBaseIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/GPUOps
IncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/LinalgPassIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/Me
mRefPassIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/NVGPUIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes
/NVGPUPassIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/TensorPassIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_i
ncludes/VectorEnumsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/VectorPassIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_
virtual_includes/X86VectorIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ShapeTransformsPassIncGen /Ibazel-out/x64_windows-opt/bin/tensorflow/c
ompiler/xla/mlir_hlo/_virtual_includes/lhlo_gpu /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/lhlo_gpu_ops_attrdefs_inc_gen /Ibazel-out/x64_win
dows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/lhlo_gpu_ops_dialect_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/lhlo
_gpu_ops_enums_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/lhlo_gpu_ops_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/x
la/mlir_hlo/_virtual_includes/lhlo_gpu_ops_ops /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/stablehlo_passes /Ibazel-out/x64_windows-opt/bin/external/stable
hlo/_virtual_includes/stablehlo_pass_inc_gen /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/version /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtua
l_includes/vhlo_ops /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/vhlo_attr_interfaces_inc_gen /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_in
cludes/vhlo_attrs_inc_gen /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/vhlo_enums_inc_gen /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includ
es/vhlo_op_interfaces_inc_gen /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/vhlo_ops_inc_gen /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_incl
udes/vhlo_types /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includes/vhlo_type_interfaces_inc_gen /Ibazel-out/x64_windows-opt/bin/external/stablehlo/_virtual_includ
es/vhlo_types_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/hlo_dialect_registration /Ibazel-out/x64_windows-opt/bin/external/stablehlo
/_virtual_includes/register /Ibazel-out/x64_windows-opt/bin/external/llvm-project/llvm/_virtual_includes/NVPTXCodeGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/llvm/_vi
rtual_includes/NVPTXCommonTableGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/llvm/_virtual_includes/NVPTXInfo /Ibazel-out/x64_windows-opt/bin/external/llvm-project/llvm
/_virtual_includes/NVPTXUtilsAndDesc /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/AsyncOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-proje
ct/mlir/_virtual_includes/GPUPassIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/LLVMConversionIncGen /Ibazel-out/x64_windows-opt/bin/external/l
lvm-project/mlir/_virtual_includes/LLVMPassIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/NVVMOpsIncGen /Ibazel-out/x64_windows-opt/bin/externa
l/llvm-project/mlir/_virtual_includes/LLVMIntrinsicConversionIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/OpenMPInterfacesIncGen /Ibazel-out/
x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/OpenMPOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/OpenMPTypeInterfacesIn
cGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ROCDLConversionIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes
/ROCDLOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/AMXIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/
ArmNeonIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ArmSVEIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes
/NVVMConversionIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ShapeToStandardGen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_h
lo/_virtual_includes/transforms_passes /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/deallocation /Ibazel-out/x64_windows-opt/bin/tensorflow/co
mpiler/xla/mlir_hlo/_virtual_includes/deallocation_ops_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/deallocation_utils /Ibazel-out/x64
_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/deallocation_passes /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/deallocat
ion_passes_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/gml_st_bufferizable_op_interface /Ibazel-out/x64_windows-opt/bin/tensorflow/co
mpiler/xla/mlir_hlo/_virtual_includes/gml_st_passes /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/gml_st_passes_inc_gen /Ibazel-out/x64_windows
-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/gml_st_transforms /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/transforms_passes_i
nc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/userange_analysis /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_incl
udes/TransformDialectEnumsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/TransformDialectIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-p
roject/mlir/_virtual_includes/TransformDialectInterfacesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/TransformDialectMatchInterfacesIncGen /I
bazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/TransformOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/Transform
TypesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/TransformDialectTransformsIncGen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/ml
ir_hlo/_virtual_includes/all_passes /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/lmhlo_pass_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow
/compiler/xla/mlir_hlo/_virtual_includes/lmhlo_passes /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/map_lmhlo_to_scalar_op /Ibazel-out/x64_wind
ows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/map_lhlo_to_hlo_op /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/thlo_passes /Ib
azel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/thlo_passes_inc_gen /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includ
es/transforms_gpu_passes /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/mlir_hlo/_virtual_includes/gpu_transforms_passes_inc_gen /Ibazel-out/x64_windows-opt/bin/external/l
lvm-project/mlir/_virtual_includes/GPUToNVVMGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/AMDGPUIncGen /Ibazel-out/x64_windows-opt/bin/external/l
lvm-project/mlir/_virtual_includes/GPUToROCDLTGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/AMXConversionIncGen /Ibazel-out/x64_windows-opt/bin/e
xternal/llvm-project/mlir/_virtual_includes/ArmNeonConversionIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/ArmSVEConversionIncGen /Ibazel-out/
x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/OpenACCOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/OpenACCTypeInterfaces
IncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/OpenACCTypesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/
X86VectorConversionIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/llvm/_virtual_includes/X86CodeGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/llvm/_virtua
l_includes/X86CommonTableGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/llvm/_virtual_includes/X86Info /Ibazel-out/x64_windows-opt/bin/external/llvm-project/llvm/_virtua
l_includes/X86UtilsAndDesc /Ibazel-out/x64_windows-opt/bin/external/llvm-project/llvm/_virtual_includes/JITLinkTableGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/llvm/_
virtual_includes/X86DisassemblerInternalHeaders /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/SPIRVAttrUtilsGen /Ibazel-out/x64_windows-opt/bin/exter
nal/llvm-project/mlir/_virtual_includes/SPIRVAttributesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/SPIRVAvailabilityIncGen /Ibazel-out/x64_w
indows-opt/bin/external/llvm-project/mlir/_virtual_includes/SPIRVCanonicalizationIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/SPIRVOpsIncGen
/Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/SPIRVSerializationGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/Inde
xEnumsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/IndexOpsIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_include
s/TosaDialectIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/TosaInterfacesIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_vi
rtual_includes/TosaPassIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/_virtual_includes/SparseTensorPassIncGen /Ibazel-out/x64_windows-opt/bin/external/llvm-proj
ect/mlir/_virtual_includes/AsyncPassIncGen /Ithird_party/eigen3/mkl_include /Ibazel-out/x64_windows-opt/bin/third_party/eigen3/mkl_include /Iexternal/eigen_archive /Ibazel-out/x64_
windows-opt/bin/external/eigen_archive /Iexternal/nsync/public /Ibazel-out/x64_windows-opt/bin/external/nsync/public /Iexternal/com_google_protobuf/src /Ibazel-out/x64_windows-opt/
bin/external/com_google_protobuf/src /Iexternal/llvm-project/llvm/include /Ibazel-out/x64_windows-opt/bin/external/llvm-project/llvm/include /Iexternal/llvm-project/mlir/include /I
bazel-out/x64_windows-opt/bin/external/llvm-project/mlir/include /Itensorflow/compiler/mlir/tensorflow/include /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/mlir/tensorflow/i
nclude /Iexternal/gif /Ibazel-out/x64_windows-opt/bin/external/gif /Iexternal/gif/windows /Ibazel-out/x64_windows-opt/bin/external/gif/windows /Iexternal/farmhash_archive/src /Ibaz
el-out/x64_windows-opt/bin/external/farmhash_archive/src /Iexternal/zlib /Ibazel-out/x64_windows-opt/bin/external/zlib /Iexternal/local_config_cuda/cuda /Ibazel-out/x64_windows-opt
/bin/external/local_config_cuda/cuda /Iexternal/local_config_cuda/cuda/cuda/include /Ibazel-out/x64_windows-opt/bin/external/local_config_cuda/cuda/cuda/include /Iexternal/local_co
nfig_rocm/rocm /Ibazel-out/x64_windows-opt/bin/external/local_config_rocm/rocm /Iexternal/local_config_rocm/rocm/rocm/include /Ibazel-out/x64_windows-opt/bin/external/local_config_
rocm/rocm/rocm/include /Iexternal/local_config_rocm/rocm/rocm/include/rocrand /Ibazel-out/x64_windows-opt/bin/external/local_config_rocm/rocm/rocm/include/rocrand /Iexternal/local_
config_rocm/rocm/rocm/include/roctracer /Ibazel-out/x64_windows-opt/bin/external/local_config_rocm/rocm/rocm/include/roctracer /Iexternal/curl/include /Ibazel-out/x64_windows-opt/b
in/external/curl/include /Iexternal/boringssl/src/include /Ibazel-out/x64_windows-opt/bin/external/boringssl/src/include /Iexternal/jsoncpp_git/include /Ibazel-out/x64_windows-opt/
bin/external/jsoncpp_git/include /Iexternal/com_github_grpc_grpc/include /Ibazel-out/x64_windows-opt/bin/external/com_github_grpc_grpc/include /Iexternal/com_github_grpc_grpc/src/c
ore/ext/upb-generated /Ibazel-out/x64_windows-opt/bin/external/com_github_grpc_grpc/src/core/ext/upb-generated /Iexternal/com_github_grpc_grpc/third_party/address_sorting/include /
Ibazel-out/x64_windows-opt/bin/external/com_github_grpc_grpc/third_party/address_sorting/include /Iexternal/mkl_dnn_v1/include /Ibazel-out/x64_windows-opt/bin/external/mkl_dnn_v1/i
nclude /Iexternal/mkl_dnn_v1/src /Ibazel-out/x64_windows-opt/bin/external/mkl_dnn_v1/src /Iexternal/mkl_dnn_v1/src/common /Ibazel-out/x64_windows-opt/bin/external/mkl_dnn_v1/src/co
mmon /Iexternal/mkl_dnn_v1/src/common/ittnotify /Ibazel-out/x64_windows-opt/bin/external/mkl_dnn_v1/src/common/ittnotify /Iexternal/mkl_dnn_v1/src/cpu /Ibazel-out/x64_windows-opt/b
in/external/mkl_dnn_v1/src/cpu /Iexternal/mkl_dnn_v1/src/cpu/gemm /Ibazel-out/x64_windows-opt/bin/external/mkl_dnn_v1/src/cpu/gemm /Iexternal/mkl_dnn_v1/src/cpu/x64/xbyak /Ibazel-o
ut/x64_windows-opt/bin/external/mkl_dnn_v1/src/cpu/x64/xbyak /Itensorflow/compiler/xla/translate/hlo_to_mhlo/include /Ibazel-out/x64_windows-opt/bin/tensorflow/compiler/xla/transla
te/hlo_to_mhlo/include /Iexternal/tf_runtime/include /Ibazel-out/x64_windows-opt/bin/external/tf_runtime/include /Iexternal/tf_runtime/third_party/llvm_derived/include /Ibazel-out/
x64_windows-opt/bin/external/tf_runtime/third_party/llvm_derived/include /Iexternal/llvm-project/llvm/lib/Target/NVPTX /Ibazel-out/x64_windows-opt/bin/external/llvm-project/llvm/li
b/Target/NVPTX /Iexternal/llvm-project/llvm/lib/Target/X86 /Ibazel-out/x64_windows-opt/bin/external/llvm-project/llvm/lib/Target/X86 /Iexternal/llvm-project/mlir/lib/Conversion/Fun
cToSPIRV /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/lib/Conversion/FuncToSPIRV /Iexternal/llvm-project/mlir/lib/Conversion/MathToSPIRV /Ibazel-out/x64_windows-opt/b
in/external/llvm-project/mlir/lib/Conversion/MathToSPIRV /Iexternal/llvm-project/mlir/lib/Conversions/GPUToSPIRV /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/lib/Conv
ersions/GPUToSPIRV /Iexternal/llvm-project/mlir/lib/Conversion/MemRefToSPIRV /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/lib/Conversion/MemRefToSPIRV /Iexternal/llvm
-project/mlir/lib/Conversion/TensorToLinalg /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/lib/Conversion/TensorToLinalg /Iexternal/llvm-project/mlir/lib/Conversion/Ten
sorToSPIRV /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/lib/Conversion/TensorToSPIRV /Iexternal/llvm-project/mlir/lib/Conversion/TosaToArith /Ibazel-out/x64_windows-o
pt/bin/external/llvm-project/mlir/lib/Conversion/TosaToArith /Iexternal/llvm-project/mlir/lib/Conversion/TosaToLinalg /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/lib
/Conversion/TosaToLinalg /Iexternal/llvm-project/mlir/lib/Conversion/TosaToSCF /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/lib/Conversion/TosaToSCF /Iexternal/llvm-p
roject/mlir/lib/Conversion/TosaToTensor /Ibazel-out/x64_windows-opt/bin/external/llvm-project/mlir/lib/Conversion/TosaToTensor /DEIGEN_MPL2_ONLY /DEIGEN_MAX_ALIGN_BYTES=64 /D_CRT_S
ECURE_NO_DEPRECATE /D_CRT_SECURE_NO_WARNINGS /D_CRT_NONSTDC_NO_DEPRECATE /D_CRT_NONSTDC_NO_WARNINGS /D_SCL_SECURE_NO_DEPRECATE /D_SCL_SECURE_NO_WARNINGS /DUNICODE /D_UNICODE /DLTDL
_SHLIB_EXT="".dll"" /DLLVM_PLUGIN_EXT="".dll"" /DLLVM_NATIVE_ARCH=""X86"" /DLLVM_NATIVE_ASMPARSER=LLVMInitializeX86AsmParser /DLLVM_NATIVE_ASMPRINTER=LLVMInitializeX86AsmPrinter /DLLVM_N
ATIVE_DISASSEMBLER=LLVMInitializeX86Disassembler /DLLVM_NATIVE_TARGET=LLVMInitializeX86Target /DLLVM_NATIVE_TARGETINFO=LLVMInitializeX86TargetInfo /DLLVM_NATIVE_TARGETMC=LLVMInitia
lizeX86TargetMC /DLLVM_NATIVE_TARGETMCA=LLVMInitializeX86TargetMCA /DLLVM_HOST_TRIPLE=""x86_64-pc-win32"" /DLLVM_DEFAULT_TARGET_TRIPLE=""x86_64-pc-win32"" /DLLVM_VERSION_MAJOR=17 /DLLV
M_VERSION_MINOR=0 /DLLVM_VERSION_PATCH=0 /DLLVM_VERSION_STRING=""17.0.0git"" /D__STDC_LIMIT_MACROS /D__STDC_CONSTANT_MACROS /D__STDC_FORMAT_MACROS /DBLAKE3_USE_NEON=0 /DBLAKE3_NO_AVX
2 /DBLAKE3_NO_AVX512 /DBLAKE3_NO_SSE2 /DBLAKE3_NO_SSE41 /DTF_USE_SNAPPY /DTF_ENABLE_ACTIVITY_WATCHER /DCURL_STATICLIB /DGRPC_ARES=0 /DTENSORFLOW_USE_CUSTOM_CONTRACTION_KERNEL /DTEN
SORFLOW_USE_MKLDNN_CONTRACTION_KERNEL /DEIGEN_USE_AVX512_GEMM_KERNELS=0 /DGOOGLE_CUDA=1 /DEIGEN_ALTIVEC_USE_CUSTOM_PACK=0 /DEIGEN_NEON_GEBP_NR=4 /DTF_LLVM_X86_AVAILABLE=1 /DBAZEL_C
URRENT_REPOSITORY="""" /showIncludes /O2 /DNDEBUG /W0 /Zc:__cplusplus /D_USE_MATH_DEFINES /d2ReducedOptimizeHugeFunctions -DWIN32_LEAN_AND_MEAN -DNOGDI /Zc:preprocessor /d2ReducedOpt
imizeHugeFunctions /arch:AVX2 /std:c++17 /Fobazel-out/x64_windows-opt/bin/tensorflow/compiler/jit/_objs/xla_cpu_device/xla_cpu_device.obj /c tensorflow/compiler/jit/xla_cpu_device.
cc
# Configuration: 65bceb0453d201701ee7f6753c2bb4140d61507260ca636610d54b27f4c27251
# Execution platform: @local_execution_config_platform//:platform
Action failed to execute: java.io.IOException: ERROR: src/main/native/windows/process.cc(165): CreateProcessWithExplicitHandles(""C:\Users\tensorflow\anaconda3\python.exe"" -B extern
al/local_config_cuda/crosstool/windows/msvc_wrapper_for_nvcc.py /nologo /DCOMPILER_MSVC /DNOMINMAX /D_WIN32_WINNT=0x0600 /D_CRT_SECURE_NO_DEPRECATE /D_CRT_SECURE_NO_WARNINGS /D_SIL
ENCE_STDEXT_HASH_DEPRECATION_WARNINGS /bigobj /Zm500 /J /Gy /GF /EHsc /wd4351 /wd4291 /wd4250 /wd4996 /I. /Ibazel-out/x64_windows-opt/bin /Iexternal/eigen_archive /Ibazel-out/x64_w
indows-opt/bin/external/eigen_archive /Iexternal/com_google_absl /Ibazel-out/x64_wi(...)): command is longer than CreateProcessW's limit (32767 characters)
Target //tensorflow/compiler/jit:jit failed to build
INFO: Elapsed time: 768.468s, Critical Path: 94.60s
INFO: 5 processes: 5 internal.
FAILED: Build did NOT complete successfully
```
",False
